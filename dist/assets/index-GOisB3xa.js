const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.es-D62rbPxN.js","assets/vendor-CbAkzOPl.js"])))=>i.map(i=>d[i]);
import{r as Se,a as T4,S as k4,L as I4,P as C4,D as Mv,b as P4,c as Bv,C as F4,U as Vv,d as gu,e as Tp,f as Xf,B as Uv,g as Hh,h as R4,W as Gh,A as qv,K as D4,i as $h,T as pi,X as Ir,j as Ts,k as zv,l as L4,H as kp,m as j4,R as Tm,n as Kh,o as Wv,M as Hv,p as jc,q as O4,s as M4}from"./vendor-CbAkzOPl.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function t(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=t(a);fetch(a.href,s)}})();var Gv={exports:{}},Yf={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var B4=Se,V4=Symbol.for("react.element"),U4=Symbol.for("react.fragment"),q4=Object.prototype.hasOwnProperty,z4=B4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,W4={key:!0,ref:!0,__self:!0,__source:!0};function $v(r,e,t){var n,a={},s=null,i=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(i=e.ref);for(n in e)q4.call(e,n)&&!W4.hasOwnProperty(n)&&(a[n]=e[n]);if(r&&r.defaultProps)for(n in e=r.defaultProps,e)a[n]===void 0&&(a[n]=e[n]);return{$$typeof:V4,type:r,key:s,ref:i,props:a,_owner:z4.current}}Yf.Fragment=U4;Yf.jsx=$v;Yf.jsxs=$v;Gv.exports=Yf;var h=Gv.exports,Kv,Fg=T4;Kv=Fg.createRoot,Fg.hydrateRoot;let bs={admin:{username:"admin",password:"admin",role:"admin"},vendor:{username:"vendedor",password:"user",role:"vendor"}};const H4=(r,e)=>{r==="admin"?bs.admin={...bs.admin,username:e.username,password:e.password}:bs.vendor={...bs.vendor,username:e.username,password:e.password}},G4=r=>r.username===bs.admin.username&&r.password===bs.admin.password?{username:bs.admin.username,role:bs.admin.role}:r.username===bs.vendor.username&&r.password===bs.vendor.password?{username:bs.vendor.username,role:bs.vendor.role}:null,zs={backgroundImage:"https://images.unsplash.com/photo-1522335789203-aabd1fc54bc9?q=80&w=2087&auto=format&fit=crop",logoUrl:"",faviconUrl:"/vite.svg",tabTitle:"Alvaro Rugama - Sistema de Gestión",colors:{primary:"#7C3AED",secondary:"#4F46E5"},businessInfo:{name:"Alvaro Rugama",subtitle:"Make Up Studio & Beauty Salon"}},$4=r=>{localStorage.setItem("loginConfig",JSON.stringify(r))},Jf=()=>{var r,e,t,n;try{const a=localStorage.getItem("loginConfig");if(!a)return zs;const s=JSON.parse(a);return{backgroundImage:s.backgroundImage??zs.backgroundImage,logoUrl:s.logoUrl??zs.logoUrl,tabTitle:s.tabTitle??zs.tabTitle,colors:{primary:((r=s.colors)==null?void 0:r.primary)??zs.colors.primary,secondary:((e=s.colors)==null?void 0:e.secondary)??zs.colors.secondary},businessInfo:{name:((t=s.businessInfo)==null?void 0:t.name)??zs.businessInfo.name,subtitle:((n=s.businessInfo)==null?void 0:n.subtitle)??zs.businessInfo.subtitle}}}catch(a){return console.error("Error loading login config:",a),zs}};function K4({onLogin:r}){const[e]=Se.useState(()=>{try{return Jf()}catch(l){return console.error("Error loading config:",l),zs}}),[t,n]=Se.useState(""),[a,s]=Se.useState(""),[i,o]=Se.useState(""),c=l=>{l.preventDefault();const u=G4({username:t,password:a});u?r(u):o("Invalid credentials")};return h.jsxs("div",{className:"min-h-screen flex items-center justify-center p-4 relative",style:{backgroundImage:`url("${e.backgroundImage}")`,backgroundSize:"cover",backgroundPosition:"center"},children:[h.jsx("div",{className:"absolute inset-0 bg-black/40"}),h.jsxs("div",{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-xl w-full max-w-md p-8 relative",children:[h.jsxs("div",{className:"flex flex-col items-center mb-8",children:[h.jsx("div",{className:"p-3 rounded-full mb-4",style:{backgroundColor:`${e.colors.primary}20`},children:e.logoUrl?h.jsx("img",{src:e.logoUrl,alt:"Logo",className:"w-12 h-12 object-contain"}):h.jsx(k4,{className:"w-8 h-8",style:{color:e.colors.primary}})}),h.jsx("h1",{className:"text-2xl font-bold text-center text-gray-800 mb-1",children:e.businessInfo.name}),h.jsx("p",{className:"font-medium",style:{color:e.colors.primary},children:e.businessInfo.subtitle})]}),h.jsxs("form",{onSubmit:c,className:"space-y-6",children:[i&&h.jsx("div",{className:"bg-red-50 text-red-500 p-3 rounded-lg text-sm text-center",children:"Credenciales inválidas"}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Usuario"}),h.jsx("input",{type:"text",value:t,onChange:l=>n(l.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent bg-white",required:!0})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contraseña"}),h.jsx("input",{type:"password",value:a,onChange:l=>s(l.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent bg-white",required:!0})]}),h.jsx("button",{type:"submit",className:"w-full text-white py-2 rounded-lg transition-colors",style:{backgroundColor:e.colors.primary,"&:hover":{backgroundColor:`${e.colors.primary}dd`}},children:"Iniciar Sesión"})]})]})]})}const Xv=[{icon:P4,label:"Productos",path:"products"},{icon:Bv,label:"Ventas",path:"sales"},{icon:F4,label:"Colaboradores",path:"staff"},{icon:Vv,label:"Clientes",path:"clients"},{icon:gu,label:"Gastos",path:"expenses"},{icon:Tp,label:"Citas",path:"appointments"},{icon:Xf,label:"Créditos",path:"credits"},{icon:Uv,label:"Reportes",path:"reports"},{icon:Hh,label:"Facturas",path:"receipts"},{icon:R4,label:"Configuración",path:"settings"},{icon:Gh,label:"Caja Chica",path:"cash"}],X4=[...Xv,{icon:C4,label:"Apariencia",path:"appearance"},{icon:Mv,label:"Base de Datos",path:"database"}];function Y4({userRole:r,username:e,onLogout:t,onNavigate:n}){const a=Jf(),s=[{icon:Bv,label:"Ventas",path:"sales"},{icon:Vv,label:"Clientes",path:"clients"},{icon:gu,label:"Gastos",path:"expenses"},{icon:Tp,label:"Citas",path:"appointments"},{icon:Xf,label:"Créditos",path:"credits"},{icon:Uv,label:"Reportes",path:"reports"},{icon:Gh,label:"Caja Chica",path:"cash"}],i=r==="admin"?e==="masteradmin"?X4:Xv:s;return h.jsxs("div",{className:"bg-white h-screen w-64 shadow-lg flex flex-col",children:[h.jsxs("div",{className:"p-6 border-b",children:[h.jsx("h2",{className:"text-xl font-bold",style:{color:a.colors.primary},children:a.businessInfo.name}),h.jsx("p",{className:"text-sm text-gray-600",children:a.businessInfo.subtitle})]}),h.jsx("nav",{className:"flex-1 p-4",children:h.jsx("ul",{className:"space-y-2",children:i.map(o=>h.jsx("li",{children:h.jsxs("button",{onClick:()=>n(o.path),className:"w-full flex items-center space-x-3 px-4 py-2 text-gray-700 rounded-lg transition-colors",style:{"&:hover":{backgroundColor:`${a.colors.primary}10`,color:a.colors.primary}},children:[h.jsx(o.icon,{className:"w-5 h-5"}),h.jsx("span",{children:o.label})]})},o.label))})}),h.jsx("div",{className:"p-4 border-t",children:h.jsxs("button",{onClick:t,className:"w-full flex items-center space-x-3 px-4 py-2 text-red-600 rounded-lg hover:bg-red-50 transition-colors",children:[h.jsx(I4,{className:"w-5 h-5"}),h.jsx("span",{children:"Cerrar Sesión"})]})})]})}function J4({userRole:r}){const[e,t]=Se.useState({username:"",password:"",confirmPassword:""}),[n,a]=Se.useState({username:"",password:"",confirmPassword:""}),[s,i]=Se.useState(null),o=c=>{const l=c==="admin"?e:n;if(l.password!==l.confirmPassword){i({type:"error",text:"Las contraseñas no coinciden"});return}if(l.password.length<6){i({type:"error",text:"La contraseña debe tener al menos 6 caracteres"});return}try{H4(c,{username:l.username,password:l.password}),i({type:"success",text:"Credenciales actualizadas correctamente"}),c==="admin"?t({username:"",password:"",confirmPassword:""}):a({username:"",password:"",confirmPassword:""})}catch{i({type:"error",text:"Error al actualizar las credenciales"})}};return r!=="admin"?h.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:h.jsxs("div",{className:"flex items-center space-x-2 text-yellow-600",children:[h.jsx(qv,{className:"w-5 h-5"}),h.jsx("p",{children:"Solo los administradores pueden acceder a esta sección."})]})}):h.jsx("div",{className:"space-y-8",children:h.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[h.jsxs("h2",{className:"text-xl font-semibold text-gray-800 mb-6 flex items-center",children:[h.jsx(D4,{className:"w-5 h-5 mr-2"}),"Gestión de Credenciales"]}),s&&h.jsx("div",{className:`p-4 rounded-lg mb-6 ${s.type==="success"?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`,children:s.text}),h.jsxs("div",{className:"space-y-8",children:[h.jsxs("div",{className:"border-b pb-6",children:[h.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-4",children:"Credenciales de Administrador"}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nuevo Usuario"}),h.jsx("input",{type:"text",value:e.username,onChange:c=>t({...e,username:c.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nueva Contraseña"}),h.jsx("input",{type:"password",value:e.password,onChange:c=>t({...e,password:c.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirmar Contraseña"}),h.jsx("input",{type:"password",value:e.confirmPassword,onChange:c=>t({...e,confirmPassword:c.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),h.jsx("button",{onClick:()=>o("admin"),className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors",children:"Actualizar Credenciales de Administrador"})]})]}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-4",children:"Credenciales de Vendedor"}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nuevo Usuario"}),h.jsx("input",{type:"text",value:n.username,onChange:c=>a({...n,username:c.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nueva Contraseña"}),h.jsx("input",{type:"password",value:n.password,onChange:c=>a({...n,password:c.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirmar Contraseña"}),h.jsx("input",{type:"password",value:n.confirmPassword,onChange:c=>a({...n,confirmPassword:c.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),h.jsx("button",{onClick:()=>o("vendor"),className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors",children:"Actualizar Credenciales de Vendedor"})]})]})]})]})})}const et=r=>new Intl.NumberFormat("es-NI",{style:"currency",currency:"NIO"}).format(r);function Q4({products:r,onEdit:e,onDelete:t}){return h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"min-w-full bg-white rounded-lg overflow-hidden",children:[h.jsx("thead",{className:"bg-gray-50",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Código"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nombre"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cantidad"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Precio Costo"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Precio Venta"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Categoría"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),h.jsx("tbody",{className:"divide-y divide-gray-200",children:r.map(n=>h.jsxs("tr",{className:"hover:bg-gray-50",children:[h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:n.code}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:h.jsxs("div",{className:"flex items-center",children:[n.imageUrl&&h.jsx("img",{src:n.imageUrl,alt:n.name,className:"h-8 w-8 rounded-full mr-3 object-cover"}),h.jsx("span",{children:n.name}),n.quantity<=n.lowStockThreshold&&h.jsx("div",{className:"ml-2 flex items-center text-red-500",title:"Stock bajo",children:h.jsx(qv,{className:"w-4 h-4"})})]})}),h.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:[h.jsx("span",{className:n.quantity<=n.lowStockThreshold?"text-red-600 font-medium":"text-gray-900",children:n.quantity}),n.quantity<=n.lowStockThreshold&&h.jsxs("p",{className:"text-xs text-red-500",children:["Bajo stock (Min: ",n.lowStockThreshold,")"]})]}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:et(n.costPrice)}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:et(n.salePrice)}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:n.category}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:h.jsxs("div",{className:"flex space-x-2",children:[h.jsx("button",{onClick:()=>e(n),className:"text-indigo-600 hover:text-indigo-900",children:h.jsx($h,{className:"w-4 h-4"})}),h.jsx("button",{onClick:()=>t(n.id),className:"text-red-600 hover:text-red-900",children:h.jsx(pi,{className:"w-4 h-4"})})]})})]},n.id))})]})})}function Z4({product:r,categories:e,onSubmit:t,onClose:n,existingCodes:a}){const[s,i]=Se.useState({code:"",name:"",quantity:0,costPrice:0,salePrice:0,category:"",imageUrl:"",lowStockThreshold:5}),[o,c]=Se.useState({});Se.useEffect(()=>{r&&i(r)},[r]);const l=()=>{const d={};return s.code?!r&&a.includes(s.code)&&(d.code="Este código ya existe"):d.code="El código es requerido",s.name||(d.name="El nombre es requerido"),s.quantity<0&&(d.quantity="La cantidad no puede ser negativa"),s.costPrice<=0&&(d.costPrice="El precio de costo debe ser mayor a 0"),s.salePrice<=0&&(d.salePrice="El precio de venta debe ser mayor a 0"),s.salePrice<=s.costPrice&&(d.salePrice="El precio de venta debe ser mayor al precio de costo"),s.category||(d.category="La categoría es requerida"),s.lowStockThreshold<0&&(d.lowStockThreshold="La alerta de stock bajo no puede ser negativa"),c(d),Object.keys(d).length===0},u=d=>{d.preventDefault(),l()&&t(s)};return h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[h.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:r?"Editar Producto":"Nuevo Producto"}),h.jsx("button",{onClick:n,className:"text-gray-500 hover:text-gray-700",children:h.jsx(Ir,{className:"w-6 h-6"})})]}),h.jsxs("form",{onSubmit:u,className:"p-6 space-y-4",children:[h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Código *"}),h.jsx("input",{type:"text",value:s.code,onChange:d=>i({...s,code:d.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",disabled:!!r}),o.code&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:o.code})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre *"}),h.jsx("input",{type:"text",value:s.name,onChange:d=>i({...s,name:d.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),o.name&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:o.name})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cantidad *"}),h.jsx("input",{type:"number",value:s.quantity,onChange:d=>i({...s,quantity:Number(d.target.value)}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),o.quantity&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:o.quantity})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Precio de Costo *"}),h.jsx("input",{type:"number",step:"0.01",value:s.costPrice,onChange:d=>i({...s,costPrice:Number(d.target.value)}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),o.costPrice&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:o.costPrice})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Precio de Venta *"}),h.jsx("input",{type:"number",step:"0.01",value:s.salePrice,onChange:d=>i({...s,salePrice:Number(d.target.value)}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),o.salePrice&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:o.salePrice})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Categoría *"}),h.jsxs("select",{value:s.category,onChange:d=>i({...s,category:d.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[h.jsx("option",{value:"",children:"Seleccionar categoría"}),e.map(d=>h.jsx("option",{value:d,children:d},d))]}),o.category&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:o.category})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"URL de Imagen (opcional)"}),h.jsx("input",{type:"url",value:s.imageUrl,onChange:d=>i({...s,imageUrl:d.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Alerta de Stock Bajo"}),h.jsx("input",{type:"number",value:s.lowStockThreshold,onChange:d=>i({...s,lowStockThreshold:Number(d.target.value)}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),o.lowStockThreshold&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:o.lowStockThreshold})]})]}),h.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[h.jsx("button",{type:"button",onClick:n,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancelar"}),h.jsx("button",{type:"submit",className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:r?"Guardar Cambios":"Crear Producto"})]})]})]})})}function e3({categories:r,onAddCategory:e,onDeleteCategory:t}){const[n,a]=Se.useState(""),[s,i]=Se.useState(""),o=c=>{if(c.preventDefault(),!n.trim()){i("El nombre de la categoría es requerido");return}if(r.some(l=>l.name.toLowerCase()===n.toLowerCase())){i("Esta categoría ya existe");return}e(n),a(""),i("")};return h.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[h.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Gestionar Categorías"}),h.jsxs("form",{onSubmit:o,className:"flex gap-2 mb-4",children:[h.jsxs("div",{className:"flex-1",children:[h.jsx("input",{type:"text",value:n,onChange:c=>a(c.target.value),placeholder:"Nueva categoría",className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),s&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:s})]}),h.jsxs("button",{type:"submit",className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 flex items-center",children:[h.jsx(Ts,{className:"w-4 h-4 mr-1"}),"Agregar"]})]}),h.jsx("div",{className:"space-y-2",children:r.map(c=>h.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[h.jsx("span",{className:"text-gray-700",children:c.name}),h.jsx("button",{onClick:()=>t(c.id),className:"text-red-600 hover:text-red-900",children:h.jsx(Ir,{className:"w-4 h-4"})})]},c.id))})]})}var Rg={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yv=function(r){const e=[];let t=0;for(let n=0;n<r.length;n++){let a=r.charCodeAt(n);a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=a&63|128):(a&64512)===55296&&n+1<r.length&&(r.charCodeAt(n+1)&64512)===56320?(a=65536+((a&1023)<<10)+(r.charCodeAt(++n)&1023),e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=a&63|128):(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=a&63|128)}return e},t3=function(r){const e=[];let t=0,n=0;for(;t<r.length;){const a=r[t++];if(a<128)e[n++]=String.fromCharCode(a);else if(a>191&&a<224){const s=r[t++];e[n++]=String.fromCharCode((a&31)<<6|s&63)}else if(a>239&&a<365){const s=r[t++],i=r[t++],o=r[t++],c=((a&7)<<18|(s&63)<<12|(i&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const s=r[t++],i=r[t++];e[n++]=String.fromCharCode((a&15)<<12|(s&63)<<6|i&63)}}return e.join("")},Jv={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let a=0;a<r.length;a+=3){const s=r[a],i=a+1<r.length,o=i?r[a+1]:0,c=a+2<r.length,l=c?r[a+2]:0,u=s>>2,d=(s&3)<<4|o>>4;let g=(o&15)<<2|l>>6,p=l&63;c||(p=64,i||(g=64)),n.push(t[u],t[d],t[g],t[p])}return n.join("")},encodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(r):this.encodeByteArray(Yv(r),e)},decodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(r):t3(this.decodeStringToByteArray(r,e))},decodeStringToByteArray(r,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let a=0;a<r.length;){const s=t[r.charAt(a++)],o=a<r.length?t[r.charAt(a)]:0;++a;const l=a<r.length?t[r.charAt(a)]:64;++a;const d=a<r.length?t[r.charAt(a)]:64;if(++a,s==null||o==null||l==null||d==null)throw new r3;const g=s<<2|o>>4;if(n.push(g),l!==64){const p=o<<4&240|l>>2;if(n.push(p),d!==64){const y=l<<6&192|d;n.push(y)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class r3 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const n3=function(r){const e=Yv(r);return Jv.encodeByteArray(e,!0)},vf=function(r){return n3(r).replace(/\./g,"")},a3=function(r){try{return Jv.decodeString(r,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s3(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i3=()=>s3().__FIREBASE_DEFAULTS__,o3=()=>{if(typeof process>"u"||typeof Rg>"u")return;const r=Rg.__FIREBASE_DEFAULTS__;if(r)return JSON.parse(r)},c3=()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=r&&a3(r[1]);return e&&JSON.parse(e)},Ip=()=>{try{return i3()||o3()||c3()}catch(r){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`);return}},l3=r=>{var e,t;return(t=(e=Ip())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[r]},u3=r=>{const e=l3(r);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),n]:[e.substring(0,t),n]},Qv=()=>{var r;return(r=Ip())===null||r===void 0?void 0:r.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h3{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f3(r,e){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",a=r.iat||0,s=r.sub||r.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const i=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:a,exp:a+3600,auth_time:a,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},r);return[vf(JSON.stringify(t)),vf(JSON.stringify(i)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yf(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function d3(){var r;const e=(r=Ip())===null||r===void 0?void 0:r.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Zv(){return!d3()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ey(){try{return typeof indexedDB=="object"}catch{return!1}}function m3(){return new Promise((r,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(n);a.onsuccess=()=>{a.result.close(),t||self.indexedDB.deleteDatabase(n),r(!0)},a.onupgradeneeded=()=>{t=!1},a.onerror=()=>{var s;e(((s=a.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p3="FirebaseError";class xu extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=p3,Object.setPrototypeOf(this,xu.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ty.prototype.create)}}class ty{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},a=`${this.service}/${e}`,s=this.errors[e],i=s?g3(s,n):"Error",o=`${this.serviceName}: ${i} (${a}).`;return new xu(a,o,n)}}function g3(r,e){return r.replace(x3,(t,n)=>{const a=e[n];return a!=null?String(a):`<${n}?>`})}const x3=/\{\$([^}]+)}/g;function km(r,e){if(r===e)return!0;const t=Object.keys(r),n=Object.keys(e);for(const a of t){if(!n.includes(a))return!1;const s=r[a],i=e[a];if(Dg(s)&&Dg(i)){if(!km(s,i))return!1}else if(s!==i)return!1}for(const a of n)if(!t.includes(a))return!1;return!0}function Dg(r){return r!==null&&typeof r=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qi(r){return r&&r._delegate?r._delegate:r}class yh{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yc="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v3{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new h3;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:t});a&&n.resolve(a)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),a=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(a)return null;throw s}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(w3(e))try{this.getOrInitializeService({instanceIdentifier:yc})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:a});n.resolve(s)}catch{}}}}clearInstance(e=yc){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=yc){return this.instances.has(e)}getOptions(e=yc){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[s,i]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);n===o&&i.resolve(a)}return a}onInit(e,t){var n;const a=this.normalizeInstanceIdentifier(t),s=(n=this.onInitCallbacks.get(a))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(a,s);const i=this.instances.get(a);return i&&e(i,a),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const a of n)try{a(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:y3(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=yc){return this.component?this.component.multipleInstances?e:yc:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function y3(r){return r===yc?void 0:r}function w3(r){return r.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _3{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new v3(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fr;(function(r){r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT"})(fr||(fr={}));const b3={debug:fr.DEBUG,verbose:fr.VERBOSE,info:fr.INFO,warn:fr.WARN,error:fr.ERROR,silent:fr.SILENT},E3=fr.INFO,S3={[fr.DEBUG]:"log",[fr.VERBOSE]:"log",[fr.INFO]:"info",[fr.WARN]:"warn",[fr.ERROR]:"error"},A3=(r,e,...t)=>{if(e<r.logLevel)return;const n=new Date().toISOString(),a=S3[e];if(a)console[a](`[${n}]  ${r.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class ry{constructor(e){this.name=e,this._logLevel=E3,this._logHandler=A3,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in fr))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?b3[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,fr.DEBUG,...e),this._logHandler(this,fr.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,fr.VERBOSE,...e),this._logHandler(this,fr.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,fr.INFO,...e),this._logHandler(this,fr.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,fr.WARN,...e),this._logHandler(this,fr.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,fr.ERROR,...e),this._logHandler(this,fr.ERROR,...e)}}const N3=(r,e)=>e.some(t=>r instanceof t);let Lg,jg;function T3(){return Lg||(Lg=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function k3(){return jg||(jg=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const ny=new WeakMap,Im=new WeakMap,ay=new WeakMap,Xd=new WeakMap,Cp=new WeakMap;function I3(r){const e=new Promise((t,n)=>{const a=()=>{r.removeEventListener("success",s),r.removeEventListener("error",i)},s=()=>{t(jo(r.result)),a()},i=()=>{n(r.error),a()};r.addEventListener("success",s),r.addEventListener("error",i)});return e.then(t=>{t instanceof IDBCursor&&ny.set(t,r)}).catch(()=>{}),Cp.set(e,r),e}function C3(r){if(Im.has(r))return;const e=new Promise((t,n)=>{const a=()=>{r.removeEventListener("complete",s),r.removeEventListener("error",i),r.removeEventListener("abort",i)},s=()=>{t(),a()},i=()=>{n(r.error||new DOMException("AbortError","AbortError")),a()};r.addEventListener("complete",s),r.addEventListener("error",i),r.addEventListener("abort",i)});Im.set(r,e)}let Cm={get(r,e,t){if(r instanceof IDBTransaction){if(e==="done")return Im.get(r);if(e==="objectStoreNames")return r.objectStoreNames||ay.get(r);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return jo(r[e])},set(r,e,t){return r[e]=t,!0},has(r,e){return r instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in r}};function P3(r){Cm=r(Cm)}function F3(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=r.call(Yd(this),e,...t);return ay.set(n,e.sort?e.sort():[e]),jo(n)}:k3().includes(r)?function(...e){return r.apply(Yd(this),e),jo(ny.get(this))}:function(...e){return jo(r.apply(Yd(this),e))}}function R3(r){return typeof r=="function"?F3(r):(r instanceof IDBTransaction&&C3(r),N3(r,T3())?new Proxy(r,Cm):r)}function jo(r){if(r instanceof IDBRequest)return I3(r);if(Xd.has(r))return Xd.get(r);const e=R3(r);return e!==r&&(Xd.set(r,e),Cp.set(e,r)),e}const Yd=r=>Cp.get(r);function D3(r,e,{blocked:t,upgrade:n,blocking:a,terminated:s}={}){const i=indexedDB.open(r,e),o=jo(i);return n&&i.addEventListener("upgradeneeded",c=>{n(jo(i.result),c.oldVersion,c.newVersion,jo(i.transaction),c)}),t&&i.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),o.then(c=>{s&&c.addEventListener("close",()=>s()),a&&c.addEventListener("versionchange",l=>a(l.oldVersion,l.newVersion,l))}).catch(()=>{}),o}const L3=["get","getKey","getAll","getAllKeys","count"],j3=["put","add","delete","clear"],Jd=new Map;function Og(r,e){if(!(r instanceof IDBDatabase&&!(e in r)&&typeof e=="string"))return;if(Jd.get(e))return Jd.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,a=j3.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(a||L3.includes(t)))return;const s=async function(i,...o){const c=this.transaction(i,a?"readwrite":"readonly");let l=c.store;return n&&(l=l.index(o.shift())),(await Promise.all([l[t](...o),a&&c.done]))[0]};return Jd.set(e,s),s}P3(r=>({...r,get:(e,t,n)=>Og(e,t)||r.get(e,t,n),has:(e,t)=>!!Og(e,t)||r.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O3{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(M3(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function M3(r){const e=r.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Pm="@firebase/app",Mg="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zi=new ry("@firebase/app"),B3="@firebase/app-compat",V3="@firebase/analytics-compat",U3="@firebase/analytics",q3="@firebase/app-check-compat",z3="@firebase/app-check",W3="@firebase/auth",H3="@firebase/auth-compat",G3="@firebase/database",$3="@firebase/data-connect",K3="@firebase/database-compat",X3="@firebase/functions",Y3="@firebase/functions-compat",J3="@firebase/installations",Q3="@firebase/installations-compat",Z3="@firebase/messaging",eE="@firebase/messaging-compat",tE="@firebase/performance",rE="@firebase/performance-compat",nE="@firebase/remote-config",aE="@firebase/remote-config-compat",sE="@firebase/storage",iE="@firebase/storage-compat",oE="@firebase/firestore",cE="@firebase/vertexai-preview",lE="@firebase/firestore-compat",uE="firebase",hE="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fm="[DEFAULT]",fE={[Pm]:"fire-core",[B3]:"fire-core-compat",[U3]:"fire-analytics",[V3]:"fire-analytics-compat",[z3]:"fire-app-check",[q3]:"fire-app-check-compat",[W3]:"fire-auth",[H3]:"fire-auth-compat",[G3]:"fire-rtdb",[$3]:"fire-data-connect",[K3]:"fire-rtdb-compat",[X3]:"fire-fn",[Y3]:"fire-fn-compat",[J3]:"fire-iid",[Q3]:"fire-iid-compat",[Z3]:"fire-fcm",[eE]:"fire-fcm-compat",[tE]:"fire-perf",[rE]:"fire-perf-compat",[nE]:"fire-rc",[aE]:"fire-rc-compat",[sE]:"fire-gcs",[iE]:"fire-gcs-compat",[oE]:"fire-fst",[lE]:"fire-fst-compat",[cE]:"fire-vertex","fire-js":"fire-js",[uE]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wf=new Map,dE=new Map,Rm=new Map;function Bg(r,e){try{r.container.addComponent(e)}catch(t){zi.debug(`Component ${e.name} failed to register with FirebaseApp ${r.name}`,t)}}function _f(r){const e=r.name;if(Rm.has(e))return zi.debug(`There were multiple attempts to register component ${e}.`),!1;Rm.set(e,r);for(const t of wf.values())Bg(t,r);for(const t of dE.values())Bg(t,r);return!0}function mE(r,e){const t=r.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),r.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pE={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Oo=new ty("app","Firebase",pE);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gE{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new yh("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Oo.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xE=hE;function sy(r,e={}){let t=r;typeof e!="object"&&(e={name:e});const n=Object.assign({name:Fm,automaticDataCollectionEnabled:!1},e),a=n.name;if(typeof a!="string"||!a)throw Oo.create("bad-app-name",{appName:String(a)});if(t||(t=Qv()),!t)throw Oo.create("no-options");const s=wf.get(a);if(s){if(km(t,s.options)&&km(n,s.config))return s;throw Oo.create("duplicate-app",{appName:a})}const i=new _3(a);for(const c of Rm.values())i.addComponent(c);const o=new gE(t,n,i);return wf.set(a,o),o}function vE(r=Fm){const e=wf.get(r);if(!e&&r===Fm&&Qv())return sy();if(!e)throw Oo.create("no-app",{appName:r});return e}function Kl(r,e,t){var n;let a=(n=fE[r])!==null&&n!==void 0?n:r;t&&(a+=`-${t}`);const s=a.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${a}" with version "${e}":`];s&&o.push(`library name "${a}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),zi.warn(o.join(" "));return}_f(new yh(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yE="firebase-heartbeat-database",wE=1,wh="firebase-heartbeat-store";let Qd=null;function iy(){return Qd||(Qd=D3(yE,wE,{upgrade:(r,e)=>{switch(e){case 0:try{r.createObjectStore(wh)}catch(t){console.warn(t)}}}}).catch(r=>{throw Oo.create("idb-open",{originalErrorMessage:r.message})})),Qd}async function _E(r){try{const t=(await iy()).transaction(wh),n=await t.objectStore(wh).get(oy(r));return await t.done,n}catch(e){if(e instanceof xu)zi.warn(e.message);else{const t=Oo.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});zi.warn(t.message)}}}async function Vg(r,e){try{const n=(await iy()).transaction(wh,"readwrite");await n.objectStore(wh).put(e,oy(r)),await n.done}catch(t){if(t instanceof xu)zi.warn(t.message);else{const n=Oo.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});zi.warn(n.message)}}}function oy(r){return`${r.name}!${r.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bE=1024,EE=30*24*60*60*1e3;class SE{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new NE(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,t;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Ug();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(i=>i.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:a}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(i=>{const o=new Date(i.date).valueOf();return Date.now()-o<=EE}),this._storage.overwrite(this._heartbeatsCache))}catch(n){zi.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Ug(),{heartbeatsToSend:n,unsentEntries:a}=AE(this._heartbeatsCache.heartbeats),s=vf(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return zi.warn(t),""}}}function Ug(){return new Date().toISOString().substring(0,10)}function AE(r,e=bE){const t=[];let n=r.slice();for(const a of r){const s=t.find(i=>i.agent===a.agent);if(s){if(s.dates.push(a.date),qg(t)>e){s.dates.pop();break}}else if(t.push({agent:a.agent,dates:[a.date]}),qg(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class NE{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return ey()?m3().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await _E(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return Vg(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return Vg(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function qg(r){return vf(JSON.stringify({version:2,heartbeats:r})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TE(r){_f(new yh("platform-logger",e=>new O3(e),"PRIVATE")),_f(new yh("heartbeat",e=>new SE(e),"PRIVATE")),Kl(Pm,Mg,r),Kl(Pm,Mg,"esm2017"),Kl("fire-js","")}TE("");var zg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ic,cy;(function(){var r;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(I,N){function F(){}F.prototype=N.prototype,I.D=N.prototype,I.prototype=new F,I.prototype.constructor=I,I.C=function(j,S,A){for(var C=Array(arguments.length-2),J=2;J<arguments.length;J++)C[J-2]=arguments[J];return N.prototype[S].apply(j,C)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,t),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(I,N,F){F||(F=0);var j=Array(16);if(typeof N=="string")for(var S=0;16>S;++S)j[S]=N.charCodeAt(F++)|N.charCodeAt(F++)<<8|N.charCodeAt(F++)<<16|N.charCodeAt(F++)<<24;else for(S=0;16>S;++S)j[S]=N[F++]|N[F++]<<8|N[F++]<<16|N[F++]<<24;N=I.g[0],F=I.g[1],S=I.g[2];var A=I.g[3],C=N+(A^F&(S^A))+j[0]+3614090360&4294967295;N=F+(C<<7&4294967295|C>>>25),C=A+(S^N&(F^S))+j[1]+3905402710&4294967295,A=N+(C<<12&4294967295|C>>>20),C=S+(F^A&(N^F))+j[2]+606105819&4294967295,S=A+(C<<17&4294967295|C>>>15),C=F+(N^S&(A^N))+j[3]+3250441966&4294967295,F=S+(C<<22&4294967295|C>>>10),C=N+(A^F&(S^A))+j[4]+4118548399&4294967295,N=F+(C<<7&4294967295|C>>>25),C=A+(S^N&(F^S))+j[5]+1200080426&4294967295,A=N+(C<<12&4294967295|C>>>20),C=S+(F^A&(N^F))+j[6]+2821735955&4294967295,S=A+(C<<17&4294967295|C>>>15),C=F+(N^S&(A^N))+j[7]+4249261313&4294967295,F=S+(C<<22&4294967295|C>>>10),C=N+(A^F&(S^A))+j[8]+1770035416&4294967295,N=F+(C<<7&4294967295|C>>>25),C=A+(S^N&(F^S))+j[9]+2336552879&4294967295,A=N+(C<<12&4294967295|C>>>20),C=S+(F^A&(N^F))+j[10]+4294925233&4294967295,S=A+(C<<17&4294967295|C>>>15),C=F+(N^S&(A^N))+j[11]+2304563134&4294967295,F=S+(C<<22&4294967295|C>>>10),C=N+(A^F&(S^A))+j[12]+1804603682&4294967295,N=F+(C<<7&4294967295|C>>>25),C=A+(S^N&(F^S))+j[13]+4254626195&4294967295,A=N+(C<<12&4294967295|C>>>20),C=S+(F^A&(N^F))+j[14]+2792965006&4294967295,S=A+(C<<17&4294967295|C>>>15),C=F+(N^S&(A^N))+j[15]+1236535329&4294967295,F=S+(C<<22&4294967295|C>>>10),C=N+(S^A&(F^S))+j[1]+4129170786&4294967295,N=F+(C<<5&4294967295|C>>>27),C=A+(F^S&(N^F))+j[6]+3225465664&4294967295,A=N+(C<<9&4294967295|C>>>23),C=S+(N^F&(A^N))+j[11]+643717713&4294967295,S=A+(C<<14&4294967295|C>>>18),C=F+(A^N&(S^A))+j[0]+3921069994&4294967295,F=S+(C<<20&4294967295|C>>>12),C=N+(S^A&(F^S))+j[5]+3593408605&4294967295,N=F+(C<<5&4294967295|C>>>27),C=A+(F^S&(N^F))+j[10]+38016083&4294967295,A=N+(C<<9&4294967295|C>>>23),C=S+(N^F&(A^N))+j[15]+3634488961&4294967295,S=A+(C<<14&4294967295|C>>>18),C=F+(A^N&(S^A))+j[4]+3889429448&4294967295,F=S+(C<<20&4294967295|C>>>12),C=N+(S^A&(F^S))+j[9]+568446438&4294967295,N=F+(C<<5&4294967295|C>>>27),C=A+(F^S&(N^F))+j[14]+3275163606&4294967295,A=N+(C<<9&4294967295|C>>>23),C=S+(N^F&(A^N))+j[3]+4107603335&4294967295,S=A+(C<<14&4294967295|C>>>18),C=F+(A^N&(S^A))+j[8]+1163531501&4294967295,F=S+(C<<20&4294967295|C>>>12),C=N+(S^A&(F^S))+j[13]+2850285829&4294967295,N=F+(C<<5&4294967295|C>>>27),C=A+(F^S&(N^F))+j[2]+4243563512&4294967295,A=N+(C<<9&4294967295|C>>>23),C=S+(N^F&(A^N))+j[7]+1735328473&4294967295,S=A+(C<<14&4294967295|C>>>18),C=F+(A^N&(S^A))+j[12]+2368359562&4294967295,F=S+(C<<20&4294967295|C>>>12),C=N+(F^S^A)+j[5]+4294588738&4294967295,N=F+(C<<4&4294967295|C>>>28),C=A+(N^F^S)+j[8]+2272392833&4294967295,A=N+(C<<11&4294967295|C>>>21),C=S+(A^N^F)+j[11]+1839030562&4294967295,S=A+(C<<16&4294967295|C>>>16),C=F+(S^A^N)+j[14]+4259657740&4294967295,F=S+(C<<23&4294967295|C>>>9),C=N+(F^S^A)+j[1]+2763975236&4294967295,N=F+(C<<4&4294967295|C>>>28),C=A+(N^F^S)+j[4]+1272893353&4294967295,A=N+(C<<11&4294967295|C>>>21),C=S+(A^N^F)+j[7]+4139469664&4294967295,S=A+(C<<16&4294967295|C>>>16),C=F+(S^A^N)+j[10]+3200236656&4294967295,F=S+(C<<23&4294967295|C>>>9),C=N+(F^S^A)+j[13]+681279174&4294967295,N=F+(C<<4&4294967295|C>>>28),C=A+(N^F^S)+j[0]+3936430074&4294967295,A=N+(C<<11&4294967295|C>>>21),C=S+(A^N^F)+j[3]+3572445317&4294967295,S=A+(C<<16&4294967295|C>>>16),C=F+(S^A^N)+j[6]+76029189&4294967295,F=S+(C<<23&4294967295|C>>>9),C=N+(F^S^A)+j[9]+3654602809&4294967295,N=F+(C<<4&4294967295|C>>>28),C=A+(N^F^S)+j[12]+3873151461&4294967295,A=N+(C<<11&4294967295|C>>>21),C=S+(A^N^F)+j[15]+530742520&4294967295,S=A+(C<<16&4294967295|C>>>16),C=F+(S^A^N)+j[2]+3299628645&4294967295,F=S+(C<<23&4294967295|C>>>9),C=N+(S^(F|~A))+j[0]+4096336452&4294967295,N=F+(C<<6&4294967295|C>>>26),C=A+(F^(N|~S))+j[7]+1126891415&4294967295,A=N+(C<<10&4294967295|C>>>22),C=S+(N^(A|~F))+j[14]+2878612391&4294967295,S=A+(C<<15&4294967295|C>>>17),C=F+(A^(S|~N))+j[5]+4237533241&4294967295,F=S+(C<<21&4294967295|C>>>11),C=N+(S^(F|~A))+j[12]+1700485571&4294967295,N=F+(C<<6&4294967295|C>>>26),C=A+(F^(N|~S))+j[3]+2399980690&4294967295,A=N+(C<<10&4294967295|C>>>22),C=S+(N^(A|~F))+j[10]+4293915773&4294967295,S=A+(C<<15&4294967295|C>>>17),C=F+(A^(S|~N))+j[1]+2240044497&4294967295,F=S+(C<<21&4294967295|C>>>11),C=N+(S^(F|~A))+j[8]+1873313359&4294967295,N=F+(C<<6&4294967295|C>>>26),C=A+(F^(N|~S))+j[15]+4264355552&4294967295,A=N+(C<<10&4294967295|C>>>22),C=S+(N^(A|~F))+j[6]+2734768916&4294967295,S=A+(C<<15&4294967295|C>>>17),C=F+(A^(S|~N))+j[13]+1309151649&4294967295,F=S+(C<<21&4294967295|C>>>11),C=N+(S^(F|~A))+j[4]+4149444226&4294967295,N=F+(C<<6&4294967295|C>>>26),C=A+(F^(N|~S))+j[11]+3174756917&4294967295,A=N+(C<<10&4294967295|C>>>22),C=S+(N^(A|~F))+j[2]+718787259&4294967295,S=A+(C<<15&4294967295|C>>>17),C=F+(A^(S|~N))+j[9]+3951481745&4294967295,I.g[0]=I.g[0]+N&4294967295,I.g[1]=I.g[1]+(S+(C<<21&4294967295|C>>>11))&4294967295,I.g[2]=I.g[2]+S&4294967295,I.g[3]=I.g[3]+A&4294967295}n.prototype.u=function(I,N){N===void 0&&(N=I.length);for(var F=N-this.blockSize,j=this.B,S=this.h,A=0;A<N;){if(S==0)for(;A<=F;)a(this,I,A),A+=this.blockSize;if(typeof I=="string"){for(;A<N;)if(j[S++]=I.charCodeAt(A++),S==this.blockSize){a(this,j),S=0;break}}else for(;A<N;)if(j[S++]=I[A++],S==this.blockSize){a(this,j),S=0;break}}this.h=S,this.o+=N},n.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var N=1;N<I.length-8;++N)I[N]=0;var F=8*this.o;for(N=I.length-8;N<I.length;++N)I[N]=F&255,F/=256;for(this.u(I),I=Array(16),N=F=0;4>N;++N)for(var j=0;32>j;j+=8)I[F++]=this.g[N]>>>j&255;return I};function s(I,N){var F=o;return Object.prototype.hasOwnProperty.call(F,I)?F[I]:F[I]=N(I)}function i(I,N){this.h=N;for(var F=[],j=!0,S=I.length-1;0<=S;S--){var A=I[S]|0;j&&A==N||(F[S]=A,j=!1)}this.g=F}var o={};function c(I){return-128<=I&&128>I?s(I,function(N){return new i([N|0],0>N?-1:0)}):new i([I|0],0>I?-1:0)}function l(I){if(isNaN(I)||!isFinite(I))return d;if(0>I)return w(l(-I));for(var N=[],F=1,j=0;I>=F;j++)N[j]=I/F|0,F*=4294967296;return new i(N,0)}function u(I,N){if(I.length==0)throw Error("number format error: empty string");if(N=N||10,2>N||36<N)throw Error("radix out of range: "+N);if(I.charAt(0)=="-")return w(u(I.substring(1),N));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var F=l(Math.pow(N,8)),j=d,S=0;S<I.length;S+=8){var A=Math.min(8,I.length-S),C=parseInt(I.substring(S,S+A),N);8>A?(A=l(Math.pow(N,A)),j=j.j(A).add(l(C))):(j=j.j(F),j=j.add(l(C)))}return j}var d=c(0),g=c(1),p=c(16777216);r=i.prototype,r.m=function(){if(v(this))return-w(this).m();for(var I=0,N=1,F=0;F<this.g.length;F++){var j=this.i(F);I+=(0<=j?j:4294967296+j)*N,N*=4294967296}return I},r.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(y(this))return"0";if(v(this))return"-"+w(this).toString(I);for(var N=l(Math.pow(I,6)),F=this,j="";;){var S=q(F,N).g;F=E(F,S.j(N));var A=((0<F.g.length?F.g[0]:F.h)>>>0).toString(I);if(F=S,y(F))return A+j;for(;6>A.length;)A="0"+A;j=A+j}},r.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function y(I){if(I.h!=0)return!1;for(var N=0;N<I.g.length;N++)if(I.g[N]!=0)return!1;return!0}function v(I){return I.h==-1}r.l=function(I){return I=E(this,I),v(I)?-1:y(I)?0:1};function w(I){for(var N=I.g.length,F=[],j=0;j<N;j++)F[j]=~I.g[j];return new i(F,~I.h).add(g)}r.abs=function(){return v(this)?w(this):this},r.add=function(I){for(var N=Math.max(this.g.length,I.g.length),F=[],j=0,S=0;S<=N;S++){var A=j+(this.i(S)&65535)+(I.i(S)&65535),C=(A>>>16)+(this.i(S)>>>16)+(I.i(S)>>>16);j=C>>>16,A&=65535,C&=65535,F[S]=C<<16|A}return new i(F,F[F.length-1]&-2147483648?-1:0)};function E(I,N){return I.add(w(N))}r.j=function(I){if(y(this)||y(I))return d;if(v(this))return v(I)?w(this).j(w(I)):w(w(this).j(I));if(v(I))return w(this.j(w(I)));if(0>this.l(p)&&0>I.l(p))return l(this.m()*I.m());for(var N=this.g.length+I.g.length,F=[],j=0;j<2*N;j++)F[j]=0;for(j=0;j<this.g.length;j++)for(var S=0;S<I.g.length;S++){var A=this.i(j)>>>16,C=this.i(j)&65535,J=I.i(S)>>>16,ue=I.i(S)&65535;F[2*j+2*S]+=C*ue,R(F,2*j+2*S),F[2*j+2*S+1]+=A*ue,R(F,2*j+2*S+1),F[2*j+2*S+1]+=C*J,R(F,2*j+2*S+1),F[2*j+2*S+2]+=A*J,R(F,2*j+2*S+2)}for(j=0;j<N;j++)F[j]=F[2*j+1]<<16|F[2*j];for(j=N;j<2*N;j++)F[j]=0;return new i(F,0)};function R(I,N){for(;(I[N]&65535)!=I[N];)I[N+1]+=I[N]>>>16,I[N]&=65535,N++}function P(I,N){this.g=I,this.h=N}function q(I,N){if(y(N))throw Error("division by zero");if(y(I))return new P(d,d);if(v(I))return N=q(w(I),N),new P(w(N.g),w(N.h));if(v(N))return N=q(I,w(N)),new P(w(N.g),N.h);if(30<I.g.length){if(v(I)||v(N))throw Error("slowDivide_ only works with positive integers.");for(var F=g,j=N;0>=j.l(I);)F=z(F),j=z(j);var S=K(F,1),A=K(j,1);for(j=K(j,2),F=K(F,2);!y(j);){var C=A.add(j);0>=C.l(I)&&(S=S.add(F),A=C),j=K(j,1),F=K(F,1)}return N=E(I,S.j(N)),new P(S,N)}for(S=d;0<=I.l(N);){for(F=Math.max(1,Math.floor(I.m()/N.m())),j=Math.ceil(Math.log(F)/Math.LN2),j=48>=j?1:Math.pow(2,j-48),A=l(F),C=A.j(N);v(C)||0<C.l(I);)F-=j,A=l(F),C=A.j(N);y(A)&&(A=g),S=S.add(A),I=E(I,C)}return new P(S,I)}r.A=function(I){return q(this,I).h},r.and=function(I){for(var N=Math.max(this.g.length,I.g.length),F=[],j=0;j<N;j++)F[j]=this.i(j)&I.i(j);return new i(F,this.h&I.h)},r.or=function(I){for(var N=Math.max(this.g.length,I.g.length),F=[],j=0;j<N;j++)F[j]=this.i(j)|I.i(j);return new i(F,this.h|I.h)},r.xor=function(I){for(var N=Math.max(this.g.length,I.g.length),F=[],j=0;j<N;j++)F[j]=this.i(j)^I.i(j);return new i(F,this.h^I.h)};function z(I){for(var N=I.g.length+1,F=[],j=0;j<N;j++)F[j]=I.i(j)<<1|I.i(j-1)>>>31;return new i(F,I.h)}function K(I,N){var F=N>>5;N%=32;for(var j=I.g.length-F,S=[],A=0;A<j;A++)S[A]=0<N?I.i(A+F)>>>N|I.i(A+F+1)<<32-N:I.i(A+F);return new i(S,I.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,cy=n,i.prototype.add=i.prototype.add,i.prototype.multiply=i.prototype.j,i.prototype.modulo=i.prototype.A,i.prototype.compare=i.prototype.l,i.prototype.toNumber=i.prototype.m,i.prototype.toString=i.prototype.toString,i.prototype.getBits=i.prototype.i,i.fromNumber=l,i.fromString=u,Ic=i}).apply(typeof zg<"u"?zg:typeof self<"u"?self:typeof window<"u"?window:{});var D0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ly,Ju,uy,nf,Dm,hy,fy,dy;(function(){var r,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(m,T,L){return m==Array.prototype||m==Object.prototype||(m[T]=L.value),m};function t(m){m=[typeof globalThis=="object"&&globalThis,m,typeof window=="object"&&window,typeof self=="object"&&self,typeof D0=="object"&&D0];for(var T=0;T<m.length;++T){var L=m[T];if(L&&L.Math==Math)return L}throw Error("Cannot find global object")}var n=t(this);function a(m,T){if(T)e:{var L=n;m=m.split(".");for(var X=0;X<m.length-1;X++){var Ee=m[X];if(!(Ee in L))break e;L=L[Ee]}m=m[m.length-1],X=L[m],T=T(X),T!=X&&T!=null&&e(L,m,{configurable:!0,writable:!0,value:T})}}function s(m,T){m instanceof String&&(m+="");var L=0,X=!1,Ee={next:function(){if(!X&&L<m.length){var Re=L++;return{value:T(Re,m[Re]),done:!1}}return X=!0,{done:!0,value:void 0}}};return Ee[Symbol.iterator]=function(){return Ee},Ee}a("Array.prototype.values",function(m){return m||function(){return s(this,function(T,L){return L})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function c(m){var T=typeof m;return T=T!="object"?T:m?Array.isArray(m)?"array":T:"null",T=="array"||T=="object"&&typeof m.length=="number"}function l(m){var T=typeof m;return T=="object"&&m!=null||T=="function"}function u(m,T,L){return m.call.apply(m.bind,arguments)}function d(m,T,L){if(!m)throw Error();if(2<arguments.length){var X=Array.prototype.slice.call(arguments,2);return function(){var Ee=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Ee,X),m.apply(T,Ee)}}return function(){return m.apply(T,arguments)}}function g(m,T,L){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:d,g.apply(null,arguments)}function p(m,T){var L=Array.prototype.slice.call(arguments,1);return function(){var X=L.slice();return X.push.apply(X,arguments),m.apply(this,X)}}function y(m,T){function L(){}L.prototype=T.prototype,m.aa=T.prototype,m.prototype=new L,m.prototype.constructor=m,m.Qb=function(X,Ee,Re){for(var Ze=Array(arguments.length-2),Gt=2;Gt<arguments.length;Gt++)Ze[Gt-2]=arguments[Gt];return T.prototype[Ee].apply(X,Ze)}}function v(m){const T=m.length;if(0<T){const L=Array(T);for(let X=0;X<T;X++)L[X]=m[X];return L}return[]}function w(m,T){for(let L=1;L<arguments.length;L++){const X=arguments[L];if(c(X)){const Ee=m.length||0,Re=X.length||0;m.length=Ee+Re;for(let Ze=0;Ze<Re;Ze++)m[Ee+Ze]=X[Ze]}else m.push(X)}}class E{constructor(T,L){this.i=T,this.j=L,this.h=0,this.g=null}get(){let T;return 0<this.h?(this.h--,T=this.g,this.g=T.next,T.next=null):T=this.i(),T}}function R(m){return/^[\s\xa0]*$/.test(m)}function P(){var m=o.navigator;return m&&(m=m.userAgent)?m:""}function q(m){return q[" "](m),m}q[" "]=function(){};var z=P().indexOf("Gecko")!=-1&&!(P().toLowerCase().indexOf("webkit")!=-1&&P().indexOf("Edge")==-1)&&!(P().indexOf("Trident")!=-1||P().indexOf("MSIE")!=-1)&&P().indexOf("Edge")==-1;function K(m,T,L){for(const X in m)T.call(L,m[X],X,m)}function I(m,T){for(const L in m)T.call(void 0,m[L],L,m)}function N(m){const T={};for(const L in m)T[L]=m[L];return T}const F="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function j(m,T){let L,X;for(let Ee=1;Ee<arguments.length;Ee++){X=arguments[Ee];for(L in X)m[L]=X[L];for(let Re=0;Re<F.length;Re++)L=F[Re],Object.prototype.hasOwnProperty.call(X,L)&&(m[L]=X[L])}}function S(m){var T=1;m=m.split(":");const L=[];for(;0<T&&m.length;)L.push(m.shift()),T--;return m.length&&L.push(m.join(":")),L}function A(m){o.setTimeout(()=>{throw m},0)}function C(){var m=ne;let T=null;return m.g&&(T=m.g,m.g=m.g.next,m.g||(m.h=null),T.next=null),T}class J{constructor(){this.h=this.g=null}add(T,L){const X=ue.get();X.set(T,L),this.h?this.h.next=X:this.g=X,this.h=X}}var ue=new E(()=>new me,m=>m.reset());class me{constructor(){this.next=this.g=this.h=null}set(T,L){this.h=T,this.g=L,this.next=null}reset(){this.next=this.g=this.h=null}}let pe,ge=!1,ne=new J,we=()=>{const m=o.Promise.resolve(void 0);pe=()=>{m.then(Oe)}};var Oe=()=>{for(var m;m=C();){try{m.h.call(m.g)}catch(L){A(L)}var T=ue;T.j(m),100>T.h&&(T.h++,m.next=T.g,T.g=m)}ge=!1};function k(){this.s=this.s,this.C=this.C}k.prototype.s=!1,k.prototype.ma=function(){this.s||(this.s=!0,this.N())},k.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function O(m,T){this.type=m,this.g=this.target=T,this.defaultPrevented=!1}O.prototype.h=function(){this.defaultPrevented=!0};var M=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var m=!1,T=Object.defineProperty({},"passive",{get:function(){m=!0}});try{const L=()=>{};o.addEventListener("test",L,T),o.removeEventListener("test",L,T)}catch{}return m}();function U(m,T){if(O.call(this,m?m.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,m){var L=this.type=m.type,X=m.changedTouches&&m.changedTouches.length?m.changedTouches[0]:null;if(this.target=m.target||m.srcElement,this.g=T,T=m.relatedTarget){if(z){e:{try{q(T.nodeName);var Ee=!0;break e}catch{}Ee=!1}Ee||(T=null)}}else L=="mouseover"?T=m.fromElement:L=="mouseout"&&(T=m.toElement);this.relatedTarget=T,X?(this.clientX=X.clientX!==void 0?X.clientX:X.pageX,this.clientY=X.clientY!==void 0?X.clientY:X.pageY,this.screenX=X.screenX||0,this.screenY=X.screenY||0):(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0),this.button=m.button,this.key=m.key||"",this.ctrlKey=m.ctrlKey,this.altKey=m.altKey,this.shiftKey=m.shiftKey,this.metaKey=m.metaKey,this.pointerId=m.pointerId||0,this.pointerType=typeof m.pointerType=="string"?m.pointerType:ee[m.pointerType]||"",this.state=m.state,this.i=m,m.defaultPrevented&&U.aa.h.call(this)}}y(U,O);var ee={2:"touch",3:"pen",4:"mouse"};U.prototype.h=function(){U.aa.h.call(this);var m=this.i;m.preventDefault?m.preventDefault():m.returnValue=!1};var he="closure_listenable_"+(1e6*Math.random()|0),de=0;function fe(m,T,L,X,Ee){this.listener=m,this.proxy=null,this.src=T,this.type=L,this.capture=!!X,this.ha=Ee,this.key=++de,this.da=this.fa=!1}function be(m){m.da=!0,m.listener=null,m.proxy=null,m.src=null,m.ha=null}function Me(m){this.src=m,this.g={},this.h=0}Me.prototype.add=function(m,T,L,X,Ee){var Re=m.toString();m=this.g[Re],m||(m=this.g[Re]=[],this.h++);var Ze=Xe(m,T,X,Ee);return-1<Ze?(T=m[Ze],L||(T.fa=!1)):(T=new fe(T,this.src,Re,!!X,Ee),T.fa=L,m.push(T)),T};function Z(m,T){var L=T.type;if(L in m.g){var X=m.g[L],Ee=Array.prototype.indexOf.call(X,T,void 0),Re;(Re=0<=Ee)&&Array.prototype.splice.call(X,Ee,1),Re&&(be(T),m.g[L].length==0&&(delete m.g[L],m.h--))}}function Xe(m,T,L,X){for(var Ee=0;Ee<m.length;++Ee){var Re=m[Ee];if(!Re.da&&Re.listener==T&&Re.capture==!!L&&Re.ha==X)return Ee}return-1}var st="closure_lm_"+(1e6*Math.random()|0),Fe={};function se(m,T,L,X,Ee){if(Array.isArray(T)){for(var Re=0;Re<T.length;Re++)se(m,T[Re],L,X,Ee);return null}return L=Ft(L),m&&m[he]?m.K(T,L,l(X)?!!X.capture:!!X,Ee):qe(m,T,L,!1,X,Ee)}function qe(m,T,L,X,Ee,Re){if(!T)throw Error("Invalid event type");var Ze=l(Ee)?!!Ee.capture:!!Ee,Gt=_t(m);if(Gt||(m[st]=Gt=new Me(m)),L=Gt.add(T,L,X,Ze,Re),L.proxy)return L;if(X=lt(),L.proxy=X,X.src=m,X.listener=L,m.addEventListener)M||(Ee=Ze),Ee===void 0&&(Ee=!1),m.addEventListener(T.toString(),X,Ee);else if(m.attachEvent)m.attachEvent(ot(T.toString()),X);else if(m.addListener&&m.removeListener)m.addListener(X);else throw Error("addEventListener and attachEvent are unavailable.");return L}function lt(){function m(L){return T.call(m.src,m.listener,L)}const T=ht;return m}function $e(m,T,L,X,Ee){if(Array.isArray(T))for(var Re=0;Re<T.length;Re++)$e(m,T[Re],L,X,Ee);else X=l(X)?!!X.capture:!!X,L=Ft(L),m&&m[he]?(m=m.i,T=String(T).toString(),T in m.g&&(Re=m.g[T],L=Xe(Re,L,X,Ee),-1<L&&(be(Re[L]),Array.prototype.splice.call(Re,L,1),Re.length==0&&(delete m.g[T],m.h--)))):m&&(m=_t(m))&&(T=m.g[T.toString()],m=-1,T&&(m=Xe(T,L,X,Ee)),(L=-1<m?T[m]:null)&&rt(L))}function rt(m){if(typeof m!="number"&&m&&!m.da){var T=m.src;if(T&&T[he])Z(T.i,m);else{var L=m.type,X=m.proxy;T.removeEventListener?T.removeEventListener(L,X,m.capture):T.detachEvent?T.detachEvent(ot(L),X):T.addListener&&T.removeListener&&T.removeListener(X),(L=_t(T))?(Z(L,m),L.h==0&&(L.src=null,T[st]=null)):be(m)}}}function ot(m){return m in Fe?Fe[m]:Fe[m]="on"+m}function ht(m,T){if(m.da)m=!0;else{T=new U(T,this);var L=m.listener,X=m.ha||m.src;m.fa&&rt(m),m=L.call(X,T)}return m}function _t(m){return m=m[st],m instanceof Me?m:null}var At="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ft(m){return typeof m=="function"?m:(m[At]||(m[At]=function(T){return m.handleEvent(T)}),m[At])}function Et(){k.call(this),this.i=new Me(this),this.M=this,this.F=null}y(Et,k),Et.prototype[he]=!0,Et.prototype.removeEventListener=function(m,T,L,X){$e(this,m,T,L,X)};function It(m,T){var L,X=m.F;if(X)for(L=[];X;X=X.F)L.push(X);if(m=m.M,X=T.type||T,typeof T=="string")T=new O(T,m);else if(T instanceof O)T.target=T.target||m;else{var Ee=T;T=new O(X,m),j(T,Ee)}if(Ee=!0,L)for(var Re=L.length-1;0<=Re;Re--){var Ze=T.g=L[Re];Ee=Vt(Ze,X,!0,T)&&Ee}if(Ze=T.g=m,Ee=Vt(Ze,X,!0,T)&&Ee,Ee=Vt(Ze,X,!1,T)&&Ee,L)for(Re=0;Re<L.length;Re++)Ze=T.g=L[Re],Ee=Vt(Ze,X,!1,T)&&Ee}Et.prototype.N=function(){if(Et.aa.N.call(this),this.i){var m=this.i,T;for(T in m.g){for(var L=m.g[T],X=0;X<L.length;X++)be(L[X]);delete m.g[T],m.h--}}this.F=null},Et.prototype.K=function(m,T,L,X){return this.i.add(String(m),T,!1,L,X)},Et.prototype.L=function(m,T,L,X){return this.i.add(String(m),T,!0,L,X)};function Vt(m,T,L,X){if(T=m.i.g[String(T)],!T)return!0;T=T.concat();for(var Ee=!0,Re=0;Re<T.length;++Re){var Ze=T[Re];if(Ze&&!Ze.da&&Ze.capture==L){var Gt=Ze.listener,nr=Ze.ha||Ze.src;Ze.fa&&Z(m.i,Ze),Ee=Gt.call(nr,X)!==!1&&Ee}}return Ee&&!X.defaultPrevented}function Nt(m,T,L){if(typeof m=="function")L&&(m=g(m,L));else if(m&&typeof m.handleEvent=="function")m=g(m.handleEvent,m);else throw Error("Invalid listener argument");return 2147483647<Number(T)?-1:o.setTimeout(m,T||0)}function dt(m){m.g=Nt(()=>{m.g=null,m.i&&(m.i=!1,dt(m))},m.l);const T=m.h;m.h=null,m.m.apply(null,T)}class tt extends k{constructor(T,L){super(),this.m=T,this.l=L,this.h=null,this.i=!1,this.g=null}j(T){this.h=arguments,this.g?this.i=!0:dt(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function sr(m){k.call(this),this.h=m,this.g={}}y(sr,k);var Ct=[];function rn(m){K(m.g,function(T,L){this.g.hasOwnProperty(L)&&rt(T)},m),m.g={}}sr.prototype.N=function(){sr.aa.N.call(this),rn(this)},sr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var cr=o.JSON.stringify,Cr=o.JSON.parse,Pa=class{stringify(m){return o.JSON.stringify(m,void 0)}parse(m){return o.JSON.parse(m,void 0)}};function rr(){}rr.prototype.h=null;function Ha(m){return m.h||(m.h=m.i())}function Pr(){}var In={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function va(){O.call(this,"d")}y(va,O);function xr(){O.call(this,"c")}y(xr,O);var Rt={},ir=null;function Fa(){return ir=ir||new Et}Rt.La="serverreachability";function nn(m){O.call(this,Rt.La,m)}y(nn,O);function Ln(m){const T=Fa();It(T,new nn(T))}Rt.STAT_EVENT="statevent";function ya(m,T){O.call(this,Rt.STAT_EVENT,m),this.stat=T}y(ya,O);function bt(m){const T=Fa();It(T,new ya(T,m))}Rt.Ma="timingevent";function ta(m,T){O.call(this,Rt.Ma,m),this.size=T}y(ta,O);function _n(m,T){if(typeof m!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){m()},T)}function an(){this.g=!0}an.prototype.xa=function(){this.g=!1};function Jr(m,T,L,X,Ee,Re){m.info(function(){if(m.g)if(Re)for(var Ze="",Gt=Re.split("&"),nr=0;nr<Gt.length;nr++){var $t=Gt[nr].split("=");if(1<$t.length){var wr=$t[0];$t=$t[1];var Or=wr.split("_");Ze=2<=Or.length&&Or[1]=="type"?Ze+(wr+"="+$t+"&"):Ze+(wr+"=redacted&")}}else Ze=null;else Ze=Re;return"XMLHTTP REQ ("+X+") [attempt "+Ee+"]: "+T+`
`+L+`
`+Ze})}function Kr(m,T,L,X,Ee,Re,Ze){m.info(function(){return"XMLHTTP RESP ("+X+") [ attempt "+Ee+"]: "+T+`
`+L+`
`+Re+" "+Ze})}function W(m,T,L,X){m.info(function(){return"XMLHTTP TEXT ("+T+"): "+te(m,L)+(X?" "+X:"")})}function oe(m,T){m.info(function(){return"TIMEOUT: "+T})}an.prototype.info=function(){};function te(m,T){if(!m.g)return T;if(!T)return null;try{var L=JSON.parse(T);if(L){for(m=0;m<L.length;m++)if(Array.isArray(L[m])){var X=L[m];if(!(2>X.length)){var Ee=X[1];if(Array.isArray(Ee)&&!(1>Ee.length)){var Re=Ee[0];if(Re!="noop"&&Re!="stop"&&Re!="close")for(var Ze=1;Ze<Ee.length;Ze++)Ee[Ze]=""}}}}return cr(L)}catch{return T}}var re={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},ie={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ce;function Te(){}y(Te,rr),Te.prototype.g=function(){return new XMLHttpRequest},Te.prototype.i=function(){return{}},ce=new Te;function je(m,T,L,X){this.j=m,this.i=T,this.l=L,this.R=X||1,this.U=new sr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ke}function ke(){this.i=null,this.g="",this.h=!1}var Ie={},Le={};function Je(m,T,L){m.L=1,m.v=bi(_a(T)),m.m=L,m.P=!0,it(m,null)}function it(m,T){m.F=Date.now(),ft(m),m.A=_a(m.v);var L=m.A,X=m.R;Array.isArray(X)||(X=[String(X)]),zt(L.i,"t",X),m.C=0,L=m.j.J,m.h=new ke,m.g=B(m.j,L?T:null,!m.m),0<m.O&&(m.M=new tt(g(m.Y,m,m.g),m.O)),T=m.U,L=m.g,X=m.ca;var Ee="readystatechange";Array.isArray(Ee)||(Ee&&(Ct[0]=Ee.toString()),Ee=Ct);for(var Re=0;Re<Ee.length;Re++){var Ze=se(L,Ee[Re],X||T.handleEvent,!1,T.h||T);if(!Ze)break;T.g[Ze.key]=Ze}T=m.H?N(m.H):{},m.m?(m.u||(m.u="POST"),T["Content-Type"]="application/x-www-form-urlencoded",m.g.ea(m.A,m.u,m.m,T)):(m.u="GET",m.g.ea(m.A,m.u,null,T)),Ln(),Jr(m.i,m.u,m.A,m.l,m.R,m.m)}je.prototype.ca=function(m){m=m.target;const T=this.M;T&&Cn(m)==3?T.j():this.Y(m)},je.prototype.Y=function(m){try{if(m==this.g)e:{const Or=Cn(this.g);var T=this.g.Ba();const Os=this.g.Z();if(!(3>Or)&&(Or!=3||this.g&&(this.h.h||this.g.oa()||ml(this.g)))){this.J||Or!=4||T==7||(T==8||0>=Os?Ln(3):Ln(2)),lr(this);var L=this.g.Z();this.X=L;t:if(gt(this)){var X=ml(this.g);m="";var Ee=X.length,Re=Cn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Fr(this),ur(this);var Ze="";break t}this.h.i=new o.TextDecoder}for(T=0;T<Ee;T++)this.h.h=!0,m+=this.h.i.decode(X[T],{stream:!(Re&&T==Ee-1)});X.length=0,this.h.g+=m,this.C=0,Ze=this.h.g}else Ze=this.g.oa();if(this.o=L==200,Kr(this.i,this.u,this.A,this.l,this.R,Or,L),this.o){if(this.T&&!this.K){t:{if(this.g){var Gt,nr=this.g;if((Gt=nr.g?nr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!R(Gt)){var $t=Gt;break t}}$t=null}if(L=$t)W(this.i,this.l,L,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,wa(this,L);else{this.o=!1,this.s=3,bt(12),Fr(this),ur(this);break e}}if(this.P){L=!0;let Gn;for(;!this.J&&this.C<Ze.length;)if(Gn=nt(this,Ze),Gn==Le){Or==4&&(this.s=4,bt(14),L=!1),W(this.i,this.l,null,"[Incomplete Response]");break}else if(Gn==Ie){this.s=4,bt(15),W(this.i,this.l,Ze,"[Invalid Chunk]"),L=!1;break}else W(this.i,this.l,Gn,null),wa(this,Gn);if(gt(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Or!=4||Ze.length!=0||this.h.h||(this.s=1,bt(16),L=!1),this.o=this.o&&L,!L)W(this.i,this.l,Ze,"[Invalid Chunked Response]"),Fr(this),ur(this);else if(0<Ze.length&&!this.W){this.W=!0;var wr=this.j;wr.g==this&&wr.ba&&!wr.M&&(wr.j.info("Great, no buffering proxy detected. Bytes received: "+Ze.length),lo(wr),wr.M=!0,bt(11))}}else W(this.i,this.l,Ze,null),wa(this,Ze);Or==4&&Fr(this),this.o&&!this.J&&(Or==4?ti(this.j,this):(this.o=!1,ft(this)))}else Zs(this.g),L==400&&0<Ze.indexOf("Unknown SID")?(this.s=3,bt(12)):(this.s=0,bt(13)),Fr(this),ur(this)}}}catch{}finally{}};function gt(m){return m.g?m.u=="GET"&&m.L!=2&&m.j.Ca:!1}function nt(m,T){var L=m.C,X=T.indexOf(`
`,L);return X==-1?Le:(L=Number(T.substring(L,X)),isNaN(L)?Ie:(X+=1,X+L>T.length?Le:(T=T.slice(X,X+L),m.C=X+L,T)))}je.prototype.cancel=function(){this.J=!0,Fr(this)};function ft(m){m.S=Date.now()+m.I,Ot(m,m.I)}function Ot(m,T){if(m.B!=null)throw Error("WatchDog timer not null");m.B=_n(g(m.ba,m),T)}function lr(m){m.B&&(o.clearTimeout(m.B),m.B=null)}je.prototype.ba=function(){this.B=null;const m=Date.now();0<=m-this.S?(oe(this.i,this.A),this.L!=2&&(Ln(),bt(17)),Fr(this),this.s=2,ur(this)):Ot(this,this.S-m)};function ur(m){m.j.G==0||m.J||ti(m.j,m)}function Fr(m){lr(m);var T=m.M;T&&typeof T.ma=="function"&&T.ma(),m.M=null,rn(m.U),m.g&&(T=m.g,m.g=null,T.abort(),T.ma())}function wa(m,T){try{var L=m.j;if(L.G!=0&&(L.g==m||Wn(L.h,m))){if(!m.K&&Wn(L.h,m)&&L.G==3){try{var X=L.Da.g.parse(T)}catch{X=null}if(Array.isArray(X)&&X.length==3){var Ee=X;if(Ee[0]==0){e:if(!L.u){if(L.g)if(L.g.F+3e3<m.F)js(L),so(L);else break e;Ti(L),bt(18)}}else L.za=Ee[1],0<L.za-L.T&&37500>Ee[2]&&L.F&&L.v==0&&!L.C&&(L.C=_n(g(L.Za,L),6e3));if(1>=$a(L.h)&&L.ca){try{L.ca()}catch{}L.ca=void 0}}else ra(L,11)}else if((m.K||L.g==m)&&js(L),!R(T))for(Ee=L.Da.g.parse(T),T=0;T<Ee.length;T++){let $t=Ee[T];if(L.T=$t[0],$t=$t[1],L.G==2)if($t[0]=="c"){L.K=$t[1],L.ia=$t[2];const wr=$t[3];wr!=null&&(L.la=wr,L.j.info("VER="+L.la));const Or=$t[4];Or!=null&&(L.Aa=Or,L.j.info("SVER="+L.Aa));const Os=$t[5];Os!=null&&typeof Os=="number"&&0<Os&&(X=1.5*Os,L.L=X,L.j.info("backChannelRequestTimeoutMs_="+X)),X=L;const Gn=m.g;if(Gn){const ri=Gn.g?Gn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ri){var Re=X.h;Re.g||ri.indexOf("spdy")==-1&&ri.indexOf("quic")==-1&&ri.indexOf("h2")==-1||(Re.j=Re.l,Re.g=new Set,Re.h&&(qr(Re,Re.h),Re.h=null))}if(X.D){const ni=Gn.g?Gn.g.getResponseHeader("X-HTTP-Session-Id"):null;ni&&(X.ya=ni,_r(X.I,X.D,ni))}}L.G=3,L.l&&L.l.ua(),L.ba&&(L.R=Date.now()-m.F,L.j.info("Handshake RTT: "+L.R+"ms")),X=L;var Ze=m;if(X.qa=_(X,X.J?X.ia:null,X.W),Ze.K){ec(X.h,Ze);var Gt=Ze,nr=X.L;nr&&(Gt.I=nr),Gt.B&&(lr(Gt),ft(Gt)),X.g=Ze}else co(X);0<L.i.length&&io(L)}else $t[0]!="stop"&&$t[0]!="close"||ra(L,7);else L.G==3&&($t[0]=="stop"||$t[0]=="close"?$t[0]=="stop"?ra(L,7):Ls(L):$t[0]!="noop"&&L.l&&L.l.ta($t),L.v=0)}}Ln(4)}catch{}}var Cs=class{constructor(m,T){this.g=m,this.map=T}};function Ga(m){this.l=m||10,o.PerformanceNavigationTiming?(m=o.performance.getEntriesByType("navigation"),m=0<m.length&&(m[0].nextHopProtocol=="hq"||m[0].nextHopProtocol=="h2")):m=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=m?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ra(m){return m.h?!0:m.g?m.g.size>=m.j:!1}function $a(m){return m.h?1:m.g?m.g.size:0}function Wn(m,T){return m.h?m.h==T:m.g?m.g.has(T):!1}function qr(m,T){m.g?m.g.add(T):m.h=T}function ec(m,T){m.h&&m.h==T?m.h=null:m.g&&m.g.has(T)&&m.g.delete(T)}Ga.prototype.cancel=function(){if(this.i=tc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const m of this.g.values())m.cancel();this.g.clear()}};function tc(m){if(m.h!=null)return m.i.concat(m.h.D);if(m.g!=null&&m.g.size!==0){let T=m.i;for(const L of m.g.values())T=T.concat(L.D);return T}return v(m.i)}function cl(m){if(m.V&&typeof m.V=="function")return m.V();if(typeof Map<"u"&&m instanceof Map||typeof Set<"u"&&m instanceof Set)return Array.from(m.values());if(typeof m=="string")return m.split("");if(c(m)){for(var T=[],L=m.length,X=0;X<L;X++)T.push(m[X]);return T}T=[],L=0;for(X in m)T[L++]=m[X];return T}function rc(m){if(m.na&&typeof m.na=="function")return m.na();if(!m.V||typeof m.V!="function"){if(typeof Map<"u"&&m instanceof Map)return Array.from(m.keys());if(!(typeof Set<"u"&&m instanceof Set)){if(c(m)||typeof m=="string"){var T=[];m=m.length;for(var L=0;L<m;L++)T.push(L);return T}T=[],L=0;for(const X in m)T[L++]=X;return T}}}function ll(m,T){if(m.forEach&&typeof m.forEach=="function")m.forEach(T,void 0);else if(c(m)||typeof m=="string")Array.prototype.forEach.call(m,T,void 0);else for(var L=rc(m),X=cl(m),Ee=X.length,Re=0;Re<Ee;Re++)T.call(void 0,X[Re],L&&L[Re],m)}var Da=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Yi(m,T){if(m){m=m.split("&");for(var L=0;L<m.length;L++){var X=m[L].indexOf("="),Ee=null;if(0<=X){var Re=m[L].substring(0,X);Ee=m[L].substring(X+1)}else Re=m[L];T(Re,Ee?decodeURIComponent(Ee.replace(/\+/g," ")):"")}}}function sn(m){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,m instanceof sn){this.h=m.h,_i(this,m.j),this.o=m.o,this.g=m.g,Ji(this,m.s),this.l=m.l;var T=m.i,L=new Js;L.i=T.i,T.g&&(L.g=new Map(T.g),L.h=T.h),nc(this,L),this.m=m.m}else m&&(T=String(m).match(Da))?(this.h=!1,_i(this,T[1]||"",!0),this.o=Ei(T[2]||""),this.g=Ei(T[3]||"",!0),Ji(this,T[4]),this.l=Ei(T[5]||"",!0),nc(this,T[6]||"",!0),this.m=Ei(T[7]||"")):(this.h=!1,this.i=new Js(null,this.h))}sn.prototype.toString=function(){var m=[],T=this.j;T&&m.push(Ps(T,ul,!0),":");var L=this.g;return(L||T=="file")&&(m.push("//"),(T=this.o)&&m.push(Ps(T,ul,!0),"@"),m.push(encodeURIComponent(String(L)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),L=this.s,L!=null&&m.push(":",String(L))),(L=this.l)&&(this.g&&L.charAt(0)!="/"&&m.push("/"),m.push(Ps(L,L.charAt(0)=="/"?Fs:Nu,!0))),(L=this.i.toString())&&m.push("?",L),(L=this.m)&&m.push("#",Ps(L,Zi)),m.join("")};function _a(m){return new sn(m)}function _i(m,T,L){m.j=L?Ei(T,!0):T,m.j&&(m.j=m.j.replace(/:$/,""))}function Ji(m,T){if(T){if(T=Number(T),isNaN(T)||0>T)throw Error("Bad port number "+T);m.s=T}else m.s=null}function nc(m,T,L){T instanceof Js?(m.i=T,Tu(m.i,m.h)):(L||(T=Ps(T,Qi)),m.i=new Js(T,m.h))}function _r(m,T,L){m.i.set(T,L)}function bi(m){return _r(m,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),m}function Ei(m,T){return m?T?decodeURI(m.replace(/%25/g,"%2525")):decodeURIComponent(m):""}function Ps(m,T,L){return typeof m=="string"?(m=encodeURI(m).replace(T,Au),L&&(m=m.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m):null}function Au(m){return m=m.charCodeAt(0),"%"+(m>>4&15).toString(16)+(m&15).toString(16)}var ul=/[#\/\?@]/g,Nu=/[#\?:]/g,Fs=/[#\?]/g,Qi=/[#\?@]/g,Zi=/#/g;function Js(m,T){this.h=this.g=null,this.i=m||null,this.j=!!T}function zr(m){m.g||(m.g=new Map,m.h=0,m.i&&Yi(m.i,function(T,L){m.add(decodeURIComponent(T.replace(/\+/g," ")),L)}))}r=Js.prototype,r.add=function(m,T){zr(this),this.i=null,m=Qs(this,m);var L=this.g.get(m);return L||this.g.set(m,L=[]),L.push(T),this.h+=1,this};function hl(m,T){zr(m),T=Qs(m,T),m.g.has(T)&&(m.i=null,m.h-=m.g.get(T).length,m.g.delete(T))}function ac(m,T){return zr(m),T=Qs(m,T),m.g.has(T)}r.forEach=function(m,T){zr(this),this.g.forEach(function(L,X){L.forEach(function(Ee){m.call(T,Ee,X,this)},this)},this)},r.na=function(){zr(this);const m=Array.from(this.g.values()),T=Array.from(this.g.keys()),L=[];for(let X=0;X<T.length;X++){const Ee=m[X];for(let Re=0;Re<Ee.length;Re++)L.push(T[X])}return L},r.V=function(m){zr(this);let T=[];if(typeof m=="string")ac(this,m)&&(T=T.concat(this.g.get(Qs(this,m))));else{m=Array.from(this.g.values());for(let L=0;L<m.length;L++)T=T.concat(m[L])}return T},r.set=function(m,T){return zr(this),this.i=null,m=Qs(this,m),ac(this,m)&&(this.h-=this.g.get(m).length),this.g.set(m,[T]),this.h+=1,this},r.get=function(m,T){return m?(m=this.V(m),0<m.length?String(m[0]):T):T};function zt(m,T,L){hl(m,T),0<L.length&&(m.i=null,m.g.set(Qs(m,T),v(L)),m.h+=L.length)}r.toString=function(){if(this.i)return this.i;if(!this.g)return"";const m=[],T=Array.from(this.g.keys());for(var L=0;L<T.length;L++){var X=T[L];const Re=encodeURIComponent(String(X)),Ze=this.V(X);for(X=0;X<Ze.length;X++){var Ee=Re;Ze[X]!==""&&(Ee+="="+encodeURIComponent(String(Ze[X]))),m.push(Ee)}}return this.i=m.join("&")};function Qs(m,T){return T=String(T),m.j&&(T=T.toLowerCase()),T}function Tu(m,T){T&&!m.j&&(zr(m),m.i=null,m.g.forEach(function(L,X){var Ee=X.toLowerCase();X!=Ee&&(hl(this,X),zt(this,Ee,L))},m)),m.j=T}function ls(m,T){const L=new an;if(o.Image){const X=new Image;X.onload=p(Ka,L,"TestLoadImage: loaded",!0,T,X),X.onerror=p(Ka,L,"TestLoadImage: error",!1,T,X),X.onabort=p(Ka,L,"TestLoadImage: abort",!1,T,X),X.ontimeout=p(Ka,L,"TestLoadImage: timeout",!1,T,X),o.setTimeout(function(){X.ontimeout&&X.ontimeout()},1e4),X.src=m}else T(!1)}function fl(m,T){const L=new an,X=new AbortController,Ee=setTimeout(()=>{X.abort(),Ka(L,"TestPingServer: timeout",!1,T)},1e4);fetch(m,{signal:X.signal}).then(Re=>{clearTimeout(Ee),Re.ok?Ka(L,"TestPingServer: ok",!0,T):Ka(L,"TestPingServer: server error",!1,T)}).catch(()=>{clearTimeout(Ee),Ka(L,"TestPingServer: error",!1,T)})}function Ka(m,T,L,X,Ee){try{Ee&&(Ee.onload=null,Ee.onerror=null,Ee.onabort=null,Ee.ontimeout=null),X(L)}catch{}}function eo(){this.g=new Pa}function sc(m,T,L){const X=L||"";try{ll(m,function(Ee,Re){let Ze=Ee;l(Ee)&&(Ze=cr(Ee)),T.push(X+Re+"="+encodeURIComponent(Ze))})}catch(Ee){throw T.push(X+"type="+encodeURIComponent("_badmap")),Ee}}function to(m){this.l=m.Ub||null,this.j=m.eb||!1}y(to,rr),to.prototype.g=function(){return new ro(this.l,this.j)},to.prototype.i=function(m){return function(){return m}}({});function ro(m,T){Et.call(this),this.D=m,this.o=T,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}y(ro,Et),r=ro.prototype,r.open=function(m,T){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=m,this.A=T,this.readyState=1,Xa(this)},r.send=function(m){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const T={headers:this.u,method:this.B,credentials:this.m,cache:void 0};m&&(T.body=m),(this.D||o).fetch(new Request(this.A,T)).then(this.Sa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Rs(this)),this.readyState=0},r.Sa=function(m){if(this.g&&(this.l=m,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=m.headers,this.readyState=2,Xa(this)),this.g&&(this.readyState=3,Xa(this),this.g)))if(this.responseType==="arraybuffer")m.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in m){if(this.j=m.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;dl(this)}else m.text().then(this.Ra.bind(this),this.ga.bind(this))};function dl(m){m.j.read().then(m.Pa.bind(m)).catch(m.ga.bind(m))}r.Pa=function(m){if(this.g){if(this.o&&m.value)this.response.push(m.value);else if(!this.o){var T=m.value?m.value:new Uint8Array(0);(T=this.v.decode(T,{stream:!m.done}))&&(this.response=this.responseText+=T)}m.done?Rs(this):Xa(this),this.readyState==3&&dl(this)}},r.Ra=function(m){this.g&&(this.response=this.responseText=m,Rs(this))},r.Qa=function(m){this.g&&(this.response=m,Rs(this))},r.ga=function(){this.g&&Rs(this)};function Rs(m){m.readyState=4,m.l=null,m.j=null,m.v=null,Xa(m)}r.setRequestHeader=function(m,T){this.u.append(m,T)},r.getResponseHeader=function(m){return this.h&&this.h.get(m.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";const m=[],T=this.h.entries();for(var L=T.next();!L.done;)L=L.value,m.push(L[0]+": "+L[1]),L=T.next();return m.join(`\r
`)};function Xa(m){m.onreadystatechange&&m.onreadystatechange.call(m)}Object.defineProperty(ro.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(m){this.m=m?"include":"same-origin"}});function Ds(m){let T="";return K(m,function(L,X){T+=X,T+=":",T+=L,T+=`\r
`}),T}function ic(m,T,L){e:{for(X in L){var X=!1;break e}X=!0}X||(L=Ds(L),typeof m=="string"?L!=null&&encodeURIComponent(String(L)):_r(m,T,L))}function yr(m){Et.call(this),this.headers=new Map,this.o=m||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}y(yr,Et);var oc=/^https?$/i,no=["POST","PUT"];r=yr.prototype,r.Ha=function(m){this.J=m},r.ea=function(m,T,L,X){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+m);T=T?T.toUpperCase():"GET",this.D=m,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ce.g(),this.v=this.o?Ha(this.o):Ha(ce),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(T,String(m),!0),this.B=!1}catch(Re){cc(this,Re);return}if(m=L||"",L=new Map(this.headers),X)if(Object.getPrototypeOf(X)===Object.prototype)for(var Ee in X)L.set(Ee,X[Ee]);else if(typeof X.keys=="function"&&typeof X.get=="function")for(const Re of X.keys())L.set(Re,X.get(Re));else throw Error("Unknown input type for opt_headers: "+String(X));X=Array.from(L.keys()).find(Re=>Re.toLowerCase()=="content-type"),Ee=o.FormData&&m instanceof o.FormData,!(0<=Array.prototype.indexOf.call(no,T,void 0))||X||Ee||L.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Re,Ze]of L)this.g.setRequestHeader(Re,Ze);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ya(this),this.u=!0,this.g.send(m),this.u=!1}catch(Re){cc(this,Re)}};function cc(m,T){m.h=!1,m.g&&(m.j=!0,m.g.abort(),m.j=!1),m.l=T,m.m=5,lc(m),Si(m)}function lc(m){m.A||(m.A=!0,It(m,"complete"),It(m,"error"))}r.abort=function(m){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=m||7,It(this,"complete"),It(this,"abort"),Si(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Si(this,!0)),yr.aa.N.call(this)},r.Ea=function(){this.s||(this.B||this.u||this.j?uc(this):this.bb())},r.bb=function(){uc(this)};function uc(m){if(m.h&&typeof i<"u"&&(!m.v[1]||Cn(m)!=4||m.Z()!=2)){if(m.u&&Cn(m)==4)Nt(m.Ea,0,m);else if(It(m,"readystatechange"),Cn(m)==4){m.h=!1;try{const Ze=m.Z();e:switch(Ze){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var T=!0;break e;default:T=!1}var L;if(!(L=T)){var X;if(X=Ze===0){var Ee=String(m.D).match(Da)[1]||null;!Ee&&o.self&&o.self.location&&(Ee=o.self.location.protocol.slice(0,-1)),X=!oc.test(Ee?Ee.toLowerCase():"")}L=X}if(L)It(m,"complete"),It(m,"success");else{m.m=6;try{var Re=2<Cn(m)?m.g.statusText:""}catch{Re=""}m.l=Re+" ["+m.Z()+"]",lc(m)}}finally{Si(m)}}}}function Si(m,T){if(m.g){Ya(m);const L=m.g,X=m.v[0]?()=>{}:null;m.g=null,m.v=null,T||It(m,"ready");try{L.onreadystatechange=X}catch{}}}function Ya(m){m.I&&(o.clearTimeout(m.I),m.I=null)}r.isActive=function(){return!!this.g};function Cn(m){return m.g?m.g.readyState:0}r.Z=function(){try{return 2<Cn(this)?this.g.status:-1}catch{return-1}},r.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.Oa=function(m){if(this.g){var T=this.g.responseText;return m&&T.indexOf(m)==0&&(T=T.substring(m.length)),Cr(T)}};function ml(m){try{if(!m.g)return null;if("response"in m.g)return m.g.response;switch(m.H){case"":case"text":return m.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in m.g)return m.g.mozResponseArrayBuffer}return null}catch{return null}}function Zs(m){const T={};m=(m.g&&2<=Cn(m)&&m.g.getAllResponseHeaders()||"").split(`\r
`);for(let X=0;X<m.length;X++){if(R(m[X]))continue;var L=S(m[X]);const Ee=L[0];if(L=L[1],typeof L!="string")continue;L=L.trim();const Re=T[Ee]||[];T[Ee]=Re,Re.push(L)}I(T,function(X){return X.join(", ")})}r.Ba=function(){return this.m},r.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Hn(m,T,L){return L&&L.internalChannelParams&&L.internalChannelParams[m]||T}function ao(m){this.Aa=0,this.i=[],this.j=new an,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Hn("failFast",!1,m),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Hn("baseRetryDelayMs",5e3,m),this.cb=Hn("retryDelaySeedMs",1e4,m),this.Wa=Hn("forwardChannelMaxRetries",2,m),this.wa=Hn("forwardChannelRequestTimeoutMs",2e4,m),this.pa=m&&m.xmlHttpFactory||void 0,this.Xa=m&&m.Tb||void 0,this.Ca=m&&m.useFetchStreams||!1,this.L=void 0,this.J=m&&m.supportsCrossDomainXhr||!1,this.K="",this.h=new Ga(m&&m.concurrentRequestLimit),this.Da=new eo,this.P=m&&m.fastHandshake||!1,this.O=m&&m.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=m&&m.Rb||!1,m&&m.xa&&this.j.xa(),m&&m.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&m&&m.detectBufferingProxy||!1,this.ja=void 0,m&&m.longPollingTimeout&&0<m.longPollingTimeout&&(this.ja=m.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}r=ao.prototype,r.la=8,r.G=1,r.connect=function(m,T,L,X){bt(0),this.W=m,this.H=T||{},L&&X!==void 0&&(this.H.OSID=L,this.H.OAID=X),this.F=this.X,this.I=_(this,null,this.W),io(this)};function Ls(m){if(Ai(m),m.G==3){var T=m.U++,L=_a(m.I);if(_r(L,"SID",m.K),_r(L,"RID",T),_r(L,"TYPE","terminate"),ei(m,L),T=new je(m,m.j,T),T.L=2,T.v=bi(_a(L)),L=!1,o.navigator&&o.navigator.sendBeacon)try{L=o.navigator.sendBeacon(T.v.toString(),"")}catch{}!L&&o.Image&&(new Image().src=T.v,L=!0),L||(T.g=B(T.j,null),T.g.ea(T.v)),T.F=Date.now(),ft(T)}ho(m)}function so(m){m.g&&(lo(m),m.g.cancel(),m.g=null)}function Ai(m){so(m),m.u&&(o.clearTimeout(m.u),m.u=null),js(m),m.h.cancel(),m.s&&(typeof m.s=="number"&&o.clearTimeout(m.s),m.s=null)}function io(m){if(!Ra(m.h)&&!m.s){m.s=!0;var T=m.Ga;pe||we(),ge||(pe(),ge=!0),ne.add(T,m),m.B=0}}function hc(m,T){return $a(m.h)>=m.h.j-(m.s?1:0)?!1:m.s?(m.i=T.D.concat(m.i),!0):m.G==1||m.G==2||m.B>=(m.Va?0:m.Wa)?!1:(m.s=_n(g(m.Ga,m,T),uo(m,m.B)),m.B++,!0)}r.Ga=function(m){if(this.s)if(this.s=null,this.G==1){if(!m){this.U=Math.floor(1e5*Math.random()),m=this.U++;const Ee=new je(this,this.j,m);let Re=this.o;if(this.S&&(Re?(Re=N(Re),j(Re,this.S)):Re=this.S),this.m!==null||this.O||(Ee.H=Re,Re=null),this.P)e:{for(var T=0,L=0;L<this.i.length;L++){t:{var X=this.i[L];if("__data__"in X.map&&(X=X.map.__data__,typeof X=="string")){X=X.length;break t}X=void 0}if(X===void 0)break;if(T+=X,4096<T){T=L;break e}if(T===4096||L===this.i.length-1){T=L+1;break e}}T=1e3}else T=1e3;T=Ni(this,Ee,T),L=_a(this.I),_r(L,"RID",m),_r(L,"CVER",22),this.D&&_r(L,"X-HTTP-Session-Id",this.D),ei(this,L),Re&&(this.O?T="headers="+encodeURIComponent(String(Ds(Re)))+"&"+T:this.m&&ic(L,this.m,Re)),qr(this.h,Ee),this.Ua&&_r(L,"TYPE","init"),this.P?(_r(L,"$req",T),_r(L,"SID","null"),Ee.T=!0,Je(Ee,L,null)):Je(Ee,L,T),this.G=2}}else this.G==3&&(m?oo(this,m):this.i.length==0||Ra(this.h)||oo(this))};function oo(m,T){var L;T?L=T.l:L=m.U++;const X=_a(m.I);_r(X,"SID",m.K),_r(X,"RID",L),_r(X,"AID",m.T),ei(m,X),m.m&&m.o&&ic(X,m.m,m.o),L=new je(m,m.j,L,m.B+1),m.m===null&&(L.H=m.o),T&&(m.i=T.D.concat(m.i)),T=Ni(m,L,1e3),L.I=Math.round(.5*m.wa)+Math.round(.5*m.wa*Math.random()),qr(m.h,L),Je(L,X,T)}function ei(m,T){m.H&&K(m.H,function(L,X){_r(T,X,L)}),m.l&&ll({},function(L,X){_r(T,X,L)})}function Ni(m,T,L){L=Math.min(m.i.length,L);var X=m.l?g(m.l.Na,m.l,m):null;e:{var Ee=m.i;let Re=-1;for(;;){const Ze=["count="+L];Re==-1?0<L?(Re=Ee[0].g,Ze.push("ofs="+Re)):Re=0:Ze.push("ofs="+Re);let Gt=!0;for(let nr=0;nr<L;nr++){let $t=Ee[nr].g;const wr=Ee[nr].map;if($t-=Re,0>$t)Re=Math.max(0,Ee[nr].g-100),Gt=!1;else try{sc(wr,Ze,"req"+$t+"_")}catch{X&&X(wr)}}if(Gt){X=Ze.join("&");break e}}}return m=m.i.splice(0,L),T.D=m,X}function co(m){if(!m.g&&!m.u){m.Y=1;var T=m.Fa;pe||we(),ge||(pe(),ge=!0),ne.add(T,m),m.v=0}}function Ti(m){return m.g||m.u||3<=m.v?!1:(m.Y++,m.u=_n(g(m.Fa,m),uo(m,m.v)),m.v++,!0)}r.Fa=function(){if(this.u=null,pl(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var m=2*this.R;this.j.info("BP detection timer enabled: "+m),this.A=_n(g(this.ab,this),m)}},r.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,bt(10),so(this),pl(this))};function lo(m){m.A!=null&&(o.clearTimeout(m.A),m.A=null)}function pl(m){m.g=new je(m,m.j,"rpc",m.Y),m.m===null&&(m.g.H=m.o),m.g.O=0;var T=_a(m.qa);_r(T,"RID","rpc"),_r(T,"SID",m.K),_r(T,"AID",m.T),_r(T,"CI",m.F?"0":"1"),!m.F&&m.ja&&_r(T,"TO",m.ja),_r(T,"TYPE","xmlhttp"),ei(m,T),m.m&&m.o&&ic(T,m.m,m.o),m.L&&(m.g.I=m.L);var L=m.g;m=m.ia,L.L=1,L.v=bi(_a(T)),L.m=null,L.P=!0,it(L,m)}r.Za=function(){this.C!=null&&(this.C=null,so(this),Ti(this),bt(19))};function js(m){m.C!=null&&(o.clearTimeout(m.C),m.C=null)}function ti(m,T){var L=null;if(m.g==T){js(m),lo(m),m.g=null;var X=2}else if(Wn(m.h,T))L=T.D,ec(m.h,T),X=1;else return;if(m.G!=0){if(T.o)if(X==1){L=T.m?T.m.length:0,T=Date.now()-T.F;var Ee=m.B;X=Fa(),It(X,new ta(X,L)),io(m)}else co(m);else if(Ee=T.s,Ee==3||Ee==0&&0<T.X||!(X==1&&hc(m,T)||X==2&&Ti(m)))switch(L&&0<L.length&&(T=m.h,T.i=T.i.concat(L)),Ee){case 1:ra(m,5);break;case 4:ra(m,10);break;case 3:ra(m,6);break;default:ra(m,2)}}}function uo(m,T){let L=m.Ta+Math.floor(Math.random()*m.cb);return m.isActive()||(L*=2),L*T}function ra(m,T){if(m.j.info("Error code "+T),T==2){var L=g(m.fb,m),X=m.Xa;const Ee=!X;X=new sn(X||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||_i(X,"https"),bi(X),Ee?ls(X.toString(),L):fl(X.toString(),L)}else bt(2);m.G=0,m.l&&m.l.sa(T),ho(m),Ai(m)}r.fb=function(m){m?(this.j.info("Successfully pinged google.com"),bt(2)):(this.j.info("Failed to ping google.com"),bt(1))};function ho(m){if(m.G=0,m.ka=[],m.l){const T=tc(m.h);(T.length!=0||m.i.length!=0)&&(w(m.ka,T),w(m.ka,m.i),m.h.i.length=0,v(m.i),m.i.length=0),m.l.ra()}}function _(m,T,L){var X=L instanceof sn?_a(L):new sn(L);if(X.g!="")T&&(X.g=T+"."+X.g),Ji(X,X.s);else{var Ee=o.location;X=Ee.protocol,T=T?T+"."+Ee.hostname:Ee.hostname,Ee=+Ee.port;var Re=new sn(null);X&&_i(Re,X),T&&(Re.g=T),Ee&&Ji(Re,Ee),L&&(Re.l=L),X=Re}return L=m.D,T=m.ya,L&&T&&_r(X,L,T),_r(X,"VER",m.la),ei(m,X),X}function B(m,T,L){if(T&&!m.J)throw Error("Can't create secondary domain capable XhrIo object.");return T=m.Ca&&!m.pa?new yr(new to({eb:L})):new yr(m.pa),T.Ha(m.J),T}r.isActive=function(){return!!this.l&&this.l.isActive(this)};function le(){}r=le.prototype,r.ua=function(){},r.ta=function(){},r.sa=function(){},r.ra=function(){},r.isActive=function(){return!0},r.Na=function(){};function xe(){}xe.prototype.g=function(m,T){return new Ae(m,T)};function Ae(m,T){Et.call(this),this.g=new ao(T),this.l=m,this.h=T&&T.messageUrlParams||null,m=T&&T.messageHeaders||null,T&&T.clientProtocolHeaderRequired&&(m?m["X-Client-Protocol"]="webchannel":m={"X-Client-Protocol":"webchannel"}),this.g.o=m,m=T&&T.initMessageHeaders||null,T&&T.messageContentType&&(m?m["X-WebChannel-Content-Type"]=T.messageContentType:m={"X-WebChannel-Content-Type":T.messageContentType}),T&&T.va&&(m?m["X-WebChannel-Client-Profile"]=T.va:m={"X-WebChannel-Client-Profile":T.va}),this.g.S=m,(m=T&&T.Sb)&&!R(m)&&(this.g.m=m),this.v=T&&T.supportsCrossDomainXhr||!1,this.u=T&&T.sendRawJson||!1,(T=T&&T.httpSessionIdParam)&&!R(T)&&(this.g.D=T,m=this.h,m!==null&&T in m&&(m=this.h,T in m&&delete m[T])),this.j=new pt(this)}y(Ae,Et),Ae.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ae.prototype.close=function(){Ls(this.g)},Ae.prototype.o=function(m){var T=this.g;if(typeof m=="string"){var L={};L.__data__=m,m=L}else this.u&&(L={},L.__data__=cr(m),m=L);T.i.push(new Cs(T.Ya++,m)),T.G==3&&io(T)},Ae.prototype.N=function(){this.g.l=null,delete this.j,Ls(this.g),delete this.g,Ae.aa.N.call(this)};function Ve(m){va.call(this),m.__headers__&&(this.headers=m.__headers__,this.statusCode=m.__status__,delete m.__headers__,delete m.__status__);var T=m.__sm__;if(T){e:{for(const L in T){m=L;break e}m=void 0}(this.i=m)&&(m=this.i,T=T!==null&&m in T?T[m]:void 0),this.data=T}else this.data=m}y(Ve,va);function Qe(){xr.call(this),this.status=1}y(Qe,xr);function pt(m){this.g=m}y(pt,le),pt.prototype.ua=function(){It(this.g,"a")},pt.prototype.ta=function(m){It(this.g,new Ve(m))},pt.prototype.sa=function(m){It(this.g,new Qe)},pt.prototype.ra=function(){It(this.g,"b")},xe.prototype.createWebChannel=xe.prototype.g,Ae.prototype.send=Ae.prototype.o,Ae.prototype.open=Ae.prototype.m,Ae.prototype.close=Ae.prototype.close,dy=function(){return new xe},fy=function(){return Fa()},hy=Rt,Dm={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},re.NO_ERROR=0,re.TIMEOUT=8,re.HTTP_ERROR=6,nf=re,ie.COMPLETE="complete",uy=ie,Pr.EventType=In,In.OPEN="a",In.CLOSE="b",In.ERROR="c",In.MESSAGE="d",Et.prototype.listen=Et.prototype.K,Ju=Pr,yr.prototype.listenOnce=yr.prototype.L,yr.prototype.getLastError=yr.prototype.Ka,yr.prototype.getLastErrorCode=yr.prototype.Ba,yr.prototype.getStatus=yr.prototype.Z,yr.prototype.getResponseJson=yr.prototype.Oa,yr.prototype.getResponseText=yr.prototype.oa,yr.prototype.send=yr.prototype.ea,yr.prototype.setWithCredentials=yr.prototype.Ha,ly=yr}).apply(typeof D0<"u"?D0:typeof self<"u"?self:typeof window<"u"?window:{});const Wg="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Yn.UNAUTHENTICATED=new Yn(null),Yn.GOOGLE_CREDENTIALS=new Yn("google-credentials-uid"),Yn.FIRST_PARTY=new Yn("first-party-uid"),Yn.MOCK_USER=new Yn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vu="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oc=new ry("@firebase/firestore");function Ml(){return Oc.logLevel}function at(r,...e){if(Oc.logLevel<=fr.DEBUG){const t=e.map(Pp);Oc.debug(`Firestore (${vu}): ${r}`,...t)}}function Ta(r,...e){if(Oc.logLevel<=fr.ERROR){const t=e.map(Pp);Oc.error(`Firestore (${vu}): ${r}`,...t)}}function Mc(r,...e){if(Oc.logLevel<=fr.WARN){const t=e.map(Pp);Oc.warn(`Firestore (${vu}): ${r}`,...t)}}function Pp(r){if(typeof r=="string")return r;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(r)}catch{return r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tt(r="Unexpected state"){const e=`FIRESTORE (${vu}) INTERNAL ASSERTION FAILED: `+r;throw Ta(e),new Error(e)}function kt(r,e){r||Tt()}function Ht(r,e){return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ge={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class wt extends xu{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class di{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class my{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class kE{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Yn.UNAUTHENTICATED))}shutdown(){}}class IE{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class CE{constructor(e){this.t=e,this.currentUser=Yn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){kt(this.o===void 0);let n=this.i;const a=c=>this.i!==n?(n=this.i,t(c)):Promise.resolve();let s=new di;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new di,e.enqueueRetryable(()=>a(this.currentUser))};const i=()=>{const c=s;e.enqueueRetryable(async()=>{await c.promise,await a(this.currentUser)})},o=c=>{at("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),i())};this.t.onInit(c=>o(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?o(c):(at("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new di)}},0),i()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(at("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(kt(typeof n.accessToken=="string"),new my(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return kt(e===null||typeof e=="string"),new Yn(e)}}class PE{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=Yn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class FE{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new PE(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Yn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class RE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class DE{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){kt(this.o===void 0);const n=s=>{s.error!=null&&at("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const i=s.token!==this.R;return this.R=s.token,at("FirebaseAppCheckTokenProvider",`Received ${i?"new":"existing"} token.`),i?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const a=s=>{at("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>a(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?a(s):at("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(kt(typeof t.token=="string"),this.R=t.token,new RE(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LE(r){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<r;n++)t[n]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class py{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const a=LE(40);for(let s=0;s<a.length;++s)n.length<20&&a[s]<t&&(n+=e.charAt(a[s]%e.length))}return n}}function Xt(r,e){return r<e?-1:r>e?1:0}function au(r,e,t){return r.length===e.length&&r.every((n,a)=>t(n,e[a]))}function gy(r){return r+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tn{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new wt(Ge.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new wt(Ge.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new wt(Ge.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new wt(Ge.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return tn.fromMillis(Date.now())}static fromDate(e){return tn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new tn(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Xt(this.nanoseconds,e.nanoseconds):Xt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dt{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Dt(e)}static min(){return new Dt(new tn(0,0))}static max(){return new Dt(new tn(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _h{constructor(e,t,n){t===void 0?t=0:t>e.length&&Tt(),n===void 0?n=e.length-t:n>e.length-t&&Tt(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return _h.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof _h?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let a=0;a<n;a++){const s=e.get(a),i=t.get(a);if(s<i)return-1;if(s>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Nr extends _h{construct(e,t,n){return new Nr(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new wt(Ge.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(a=>a.length>0))}return new Nr(t)}static emptyPath(){return new Nr([])}}const jE=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Qr extends _h{construct(e,t,n){return new Qr(e,t,n)}static isValidIdentifier(e){return jE.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Qr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Qr(["__name__"])}static fromServerFormat(e){const t=[];let n="",a=0;const s=()=>{if(n.length===0)throw new wt(Ge.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let i=!1;for(;a<e.length;){const o=e[a];if(o==="\\"){if(a+1===e.length)throw new wt(Ge.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[a+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new wt(Ge.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,a+=2}else o==="`"?(i=!i,a++):o!=="."||i?(n+=o,a++):(s(),a++)}if(s(),i)throw new wt(Ge.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Qr(t)}static emptyPath(){return new Qr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(e){this.path=e}static fromPath(e){return new vt(Nr.fromString(e))}static fromName(e){return new vt(Nr.fromString(e).popFirst(5))}static empty(){return new vt(Nr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Nr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Nr.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new vt(new Nr(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bf{constructor(e,t,n,a){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=a}}function Lm(r){return r.fields.find(e=>e.kind===2)}function wc(r){return r.fields.filter(e=>e.kind!==2)}bf.UNKNOWN_ID=-1;class af{constructor(e,t){this.fieldPath=e,this.kind=t}}class bh{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new bh(0,os.min())}}function OE(r,e){const t=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,a=Dt.fromTimestamp(n===1e9?new tn(t+1,0):new tn(t,n));return new os(a,vt.empty(),e)}function xy(r){return new os(r.readTime,r.key,-1)}class os{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new os(Dt.min(),vt.empty(),-1)}static max(){return new os(Dt.max(),vt.empty(),-1)}}function Fp(r,e){let t=r.readTime.compareTo(e.readTime);return t!==0?t:(t=vt.comparator(r.documentKey,e.documentKey),t!==0?t:Xt(r.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vy="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class yy{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jc(r){if(r.code!==Ge.FAILED_PRECONDITION||r.message!==vy)throw r;at("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class De{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Tt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new De((n,a)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,a)},this.catchCallback=s=>{this.wrapFailure(t,s).next(n,a)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof De?t:De.resolve(t)}catch(t){return De.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):De.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):De.reject(t)}static resolve(e){return new De((t,n)=>{t(e)})}static reject(e){return new De((t,n)=>{n(e)})}static waitFor(e){return new De((t,n)=>{let a=0,s=0,i=!1;e.forEach(o=>{++a,o.next(()=>{++s,i&&s===a&&t()},c=>n(c))}),i=!0,s===a&&t()})}static or(e){let t=De.resolve(!1);for(const n of e)t=t.next(a=>a?De.resolve(a):n());return t}static forEach(e,t){const n=[];return e.forEach((a,s)=>{n.push(t.call(this,a,s))}),this.waitFor(n)}static mapArray(e,t){return new De((n,a)=>{const s=e.length,i=new Array(s);let o=0;for(let c=0;c<s;c++){const l=c;t(e[l]).next(u=>{i[l]=u,++o,o===s&&n(i)},u=>a(u))}})}static doWhile(e,t){return new De((n,a)=>{const s=()=>{e()===!0?t().next(()=>{s()},a):n()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qf{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new di,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new sh(e,t.error)):this.V.resolve()},this.transaction.onerror=n=>{const a=Rp(n.target.error);this.V.reject(new sh(e,a))}}static open(e,t,n,a){try{return new Qf(t,e.transaction(a,n))}catch(s){throw new sh(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(at("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new BE(t)}}class Mo{constructor(e,t,n){this.name=e,this.version=t,this.p=n,Mo.S(yf())===12.2&&Ta("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return at("SimpleDb","Removing database:",e),bc(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!ey())return!1;if(Mo.v())return!0;const e=yf(),t=Mo.S(e),n=0<t&&t<10,a=wy(e),s=0<a&&a<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||s)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}async M(e){return this.db||(at("SimpleDb","Opening database:",this.name),this.db=await new Promise((t,n)=>{const a=indexedDB.open(this.name,this.version);a.onsuccess=s=>{const i=s.target.result;t(i)},a.onblocked=()=>{n(new sh(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=s=>{const i=s.target.error;i.name==="VersionError"?n(new wt(Ge.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):i.name==="InvalidStateError"?n(new wt(Ge.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+i)):n(new sh(e,i))},a.onupgradeneeded=s=>{at("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const i=s.target.result;this.p.O(i,a.transaction,s.oldVersion,this.version).next(()=>{at("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,a){const s=t==="readonly";let i=0;for(;;){++i;try{this.db=await this.M(e);const o=Qf.open(this.db,e,s?"readonly":"readwrite",n),c=a(o).next(l=>(o.g(),l)).catch(l=>(o.abort(l),De.reject(l))).toPromise();return c.catch(()=>{}),await o.m,c}catch(o){const c=o,l=c.name!=="FirebaseError"&&i<3;if(at("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),this.close(),!l)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function wy(r){const e=r.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class ME{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return bc(this.B.delete())}}class sh extends wt{constructor(e,t){super(Ge.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Xo(r){return r.name==="IndexedDbTransactionError"}class BE{constructor(e){this.store=e}put(e,t){let n;return t!==void 0?(at("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(at("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),bc(n)}add(e){return at("SimpleDb","ADD",this.store.name,e,e),bc(this.store.add(e))}get(e){return bc(this.store.get(e)).next(t=>(t===void 0&&(t=null),at("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return at("SimpleDb","DELETE",this.store.name,e),bc(this.store.delete(e))}count(){return at("SimpleDb","COUNT",this.store.name),bc(this.store.count())}U(e,t){const n=this.options(e,t),a=n.index?this.store.index(n.index):this.store;if(typeof a.getAll=="function"){const s=a.getAll(n.range);return new De((i,o)=>{s.onerror=c=>{o(c.target.error)},s.onsuccess=c=>{i(c.target.result)}})}{const s=this.cursor(n),i=[];return this.W(s,(o,c)=>{i.push(c)}).next(()=>i)}}G(e,t){const n=this.store.getAll(e,t===null?void 0:t);return new De((a,s)=>{n.onerror=i=>{s(i.target.error)},n.onsuccess=i=>{a(i.target.result)}})}j(e,t){at("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,t);n.H=!1;const a=this.cursor(n);return this.W(a,(s,i,o)=>o.delete())}J(e,t){let n;t?n=e:(n={},t=e);const a=this.cursor(n);return this.W(a,t)}Y(e){const t=this.cursor({});return new De((n,a)=>{t.onerror=s=>{const i=Rp(s.target.error);a(i)},t.onsuccess=s=>{const i=s.target.result;i?e(i.primaryKey,i.value).next(o=>{o?i.continue():n()}):n()}})}W(e,t){const n=[];return new De((a,s)=>{e.onerror=i=>{s(i.target.error)},e.onsuccess=i=>{const o=i.target.result;if(!o)return void a();const c=new ME(o),l=t(o.primaryKey,o.value,c);if(l instanceof De){const u=l.catch(d=>(c.done(),De.reject(d)));n.push(u)}c.isDone?a():c.K===null?o.continue():o.continue(c.K)}}).next(()=>De.waitFor(n))}options(e,t){let n;return e!==void 0&&(typeof e=="string"?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.H?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function bc(r){return new De((e,t)=>{r.onsuccess=n=>{const a=n.target.result;e(a)},r.onerror=n=>{const a=Rp(n.target.error);t(a)}})}let Hg=!1;function Rp(r){const e=Mo.S(yf());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(r.message.indexOf(t)>=0){const n=new wt("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Hg||(Hg=!0,setTimeout(()=>{throw n},0)),n}}return r}class VE{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){at("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{at("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(t){Xo(t)?at("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):await Jc(t)}await this.X(6e4)})}}class UE{constructor(e,t){this.localStore=e,this.persistence=t}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))}te(e,t){const n=new Set;let a=t,s=!0;return De.doWhile(()=>s===!0&&a>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(i=>{if(i!==null&&!n.has(i))return at("IndexBackfiller",`Processing collection: ${i}`),this.ne(e,i,a).next(o=>{a-=o,n.add(i)});s=!1})).next(()=>t-a)}ne(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(a=>this.localStore.localDocuments.getNextDocuments(e,t,a,n).next(s=>{const i=s.changes;return this.localStore.indexManager.updateIndexEntries(e,i).next(()=>this.re(a,s)).next(o=>(at("IndexBackfiller",`Updating offset: ${o}`),this.localStore.indexManager.updateCollectionGroup(e,t,o))).next(()=>i.size)}))}re(e,t){let n=e;return t.changes.forEach((a,s)=>{const i=xy(s);Fp(i,n)>0&&(n=i)}),new os(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.ie(n),this.se=n=>t.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Ss.oe=-1;function Zf(r){return r==null}function Eh(r){return r===0&&1/r==-1/0}function qE(r){return typeof r=="number"&&Number.isInteger(r)&&!Eh(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ka(r){let e="";for(let t=0;t<r.length;t++)e.length>0&&(e=Gg(e)),e=zE(r.get(t),e);return Gg(e)}function zE(r,e){let t=e;const n=r.length;for(let a=0;a<n;a++){const s=r.charAt(a);switch(s){case"\0":t+="";break;case"":t+="";break;default:t+=s}}return t}function Gg(r){return r+""}function li(r){const e=r.length;if(kt(e>=2),e===2)return kt(r.charAt(0)===""&&r.charAt(1)===""),Nr.emptyPath();const t=e-2,n=[];let a="";for(let s=0;s<e;){const i=r.indexOf("",s);switch((i<0||i>t)&&Tt(),r.charAt(i+1)){case"":const o=r.substring(s,i);let c;a.length===0?c=o:(a+=o,c=a,a=""),n.push(c);break;case"":a+=r.substring(s,i),a+="\0";break;case"":a+=r.substring(s,i+1);break;default:Tt()}s=i+2}return new Nr(n)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $g=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sf(r,e){return[r,ka(e)]}function _y(r,e,t){return[r,ka(e),t]}const WE={},HE=["prefixPath","collectionGroup","readTime","documentId"],GE=["prefixPath","collectionGroup","documentId"],$E=["collectionGroup","readTime","prefixPath","documentId"],KE=["canonicalId","targetId"],XE=["targetId","path"],YE=["path","targetId"],JE=["collectionId","parent"],QE=["indexId","uid"],ZE=["uid","sequenceNumber"],eS=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],tS=["indexId","uid","orderedDocumentKey"],rS=["userId","collectionPath","documentId"],nS=["userId","collectionPath","largestBatchId"],aS=["userId","collectionGroup","largestBatchId"],by=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],sS=[...by,"documentOverlays"],Ey=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Sy=Ey,Dp=[...Sy,"indexConfiguration","indexState","indexEntries"],iS=Dp,oS=[...Dp,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jm extends yy{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}}function Dn(r,e){const t=Ht(r);return Mo.F(t._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kg(r){let e=0;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function Qc(r,e){for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function Ay(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yr{constructor(e,t){this.comparator=e,this.root=t||Jn.EMPTY}insert(e,t){return new Yr(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Jn.BLACK,null,null))}remove(e){return new Yr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Jn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const a=this.comparator(e,n.key);if(a===0)return t+n.left.size;a<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new L0(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new L0(this.root,e,this.comparator,!1)}getReverseIterator(){return new L0(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new L0(this.root,e,this.comparator,!0)}}class L0{constructor(e,t,n,a){this.isReverse=a,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&a&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Jn{constructor(e,t,n,a,s){this.key=e,this.value=t,this.color=n??Jn.RED,this.left=a??Jn.EMPTY,this.right=s??Jn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,a,s){return new Jn(e??this.key,t??this.value,n??this.color,a??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let a=this;const s=n(e,a.key);return a=s<0?a.copy(null,null,null,a.left.insert(e,t,n),null):s===0?a.copy(null,t,null,null,null):a.copy(null,null,null,null,a.right.insert(e,t,n)),a.fixUp()}removeMin(){if(this.left.isEmpty())return Jn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,a=this;if(t(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,t),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),t(e,a.key)===0){if(a.right.isEmpty())return Jn.EMPTY;n=a.right.min(),a=a.copy(n.key,n.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,t))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Jn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Jn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Tt();const e=this.left.check();if(e!==this.right.check())throw Tt();return e+(this.isRed()?0:1)}}Jn.EMPTY=null,Jn.RED=!0,Jn.BLACK=!1;Jn.EMPTY=new class{constructor(){this.size=0}get key(){throw Tt()}get value(){throw Tt()}get color(){throw Tt()}get left(){throw Tt()}get right(){throw Tt()}copy(e,t,n,a,s){return this}insert(e,t,n){return new Jn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jr{constructor(e){this.comparator=e,this.data=new Yr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const a=n.getNext();if(this.comparator(a.key,e[1])>=0)return;t(a.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Xg(this.data.getIterator())}getIteratorFrom(e){return new Xg(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof jr)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const a=t.getNext().key,s=n.getNext().key;if(this.comparator(a,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new jr(this.comparator);return t.data=e,t}}class Xg{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Il(r){return r.hasNext()?r.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua{constructor(e){this.fields=e,e.sort(Qr.comparator)}static empty(){return new Ua([])}unionWith(e){let t=new jr(Qr.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Ua(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return au(this.fields,e.fields,(t,n)=>t.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ny extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(a){try{return atob(a)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Ny("Invalid base64 string: "+s):s}}(e);return new kn(t)}static fromUint8Array(e){const t=function(a){let s="";for(let i=0;i<a.length;++i)s+=String.fromCharCode(a[i]);return s}(e);return new kn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const n=new Uint8Array(t.length);for(let a=0;a<t.length;a++)n[a]=t.charCodeAt(a);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Xt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}kn.EMPTY_BYTE_STRING=new kn("");const cS=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Wi(r){if(kt(!!r),typeof r=="string"){let e=0;const t=cS.exec(r);if(kt(!!t),t[1]){let a=t[1];a=(a+"000000000").substr(0,9),e=Number(a)}const n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Xr(r.seconds),nanos:Xr(r.nanos)}}function Xr(r){return typeof r=="number"?r:typeof r=="string"?Number(r):0}function Vo(r){return typeof r=="string"?kn.fromBase64String(r):kn.fromUint8Array(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lp(r){var e,t;return((t=(((e=r==null?void 0:r.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function jp(r){const e=r.mapValue.fields.__previous_value__;return Lp(e)?jp(e):e}function Sh(r){const e=Wi(r.mapValue.fields.__local_write_time__.timestampValue);return new tn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lS{constructor(e,t,n,a,s,i,o,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=a,this.ssl=s,this.forceLongPolling=i,this.autoDetectLongPolling=o,this.longPollingOptions=c,this.useFetchStreams=l}}class Bc{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Bc("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Bc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fo={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},of={nullValue:"NULL_VALUE"};function Vc(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?Lp(r)?4:Ty(r)?9007199254740991:ed(r)?10:11:Tt()}function gi(r,e){if(r===e)return!0;const t=Vc(r);if(t!==Vc(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return Sh(r).isEqual(Sh(e));case 3:return function(a,s){if(typeof a.timestampValue=="string"&&typeof s.timestampValue=="string"&&a.timestampValue.length===s.timestampValue.length)return a.timestampValue===s.timestampValue;const i=Wi(a.timestampValue),o=Wi(s.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(r,e);case 5:return r.stringValue===e.stringValue;case 6:return function(a,s){return Vo(a.bytesValue).isEqual(Vo(s.bytesValue))}(r,e);case 7:return r.referenceValue===e.referenceValue;case 8:return function(a,s){return Xr(a.geoPointValue.latitude)===Xr(s.geoPointValue.latitude)&&Xr(a.geoPointValue.longitude)===Xr(s.geoPointValue.longitude)}(r,e);case 2:return function(a,s){if("integerValue"in a&&"integerValue"in s)return Xr(a.integerValue)===Xr(s.integerValue);if("doubleValue"in a&&"doubleValue"in s){const i=Xr(a.doubleValue),o=Xr(s.doubleValue);return i===o?Eh(i)===Eh(o):isNaN(i)&&isNaN(o)}return!1}(r,e);case 9:return au(r.arrayValue.values||[],e.arrayValue.values||[],gi);case 10:case 11:return function(a,s){const i=a.mapValue.fields||{},o=s.mapValue.fields||{};if(Kg(i)!==Kg(o))return!1;for(const c in i)if(i.hasOwnProperty(c)&&(o[c]===void 0||!gi(i[c],o[c])))return!1;return!0}(r,e);default:return Tt()}}function Ah(r,e){return(r.values||[]).find(t=>gi(t,e))!==void 0}function Uo(r,e){if(r===e)return 0;const t=Vc(r),n=Vc(e);if(t!==n)return Xt(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return Xt(r.booleanValue,e.booleanValue);case 2:return function(s,i){const o=Xr(s.integerValue||s.doubleValue),c=Xr(i.integerValue||i.doubleValue);return o<c?-1:o>c?1:o===c?0:isNaN(o)?isNaN(c)?0:-1:1}(r,e);case 3:return Yg(r.timestampValue,e.timestampValue);case 4:return Yg(Sh(r),Sh(e));case 5:return Xt(r.stringValue,e.stringValue);case 6:return function(s,i){const o=Vo(s),c=Vo(i);return o.compareTo(c)}(r.bytesValue,e.bytesValue);case 7:return function(s,i){const o=s.split("/"),c=i.split("/");for(let l=0;l<o.length&&l<c.length;l++){const u=Xt(o[l],c[l]);if(u!==0)return u}return Xt(o.length,c.length)}(r.referenceValue,e.referenceValue);case 8:return function(s,i){const o=Xt(Xr(s.latitude),Xr(i.latitude));return o!==0?o:Xt(Xr(s.longitude),Xr(i.longitude))}(r.geoPointValue,e.geoPointValue);case 9:return Jg(r.arrayValue,e.arrayValue);case 10:return function(s,i){var o,c,l,u;const d=s.fields||{},g=i.fields||{},p=(o=d.value)===null||o===void 0?void 0:o.arrayValue,y=(c=g.value)===null||c===void 0?void 0:c.arrayValue,v=Xt(((l=p==null?void 0:p.values)===null||l===void 0?void 0:l.length)||0,((u=y==null?void 0:y.values)===null||u===void 0?void 0:u.length)||0);return v!==0?v:Jg(p,y)}(r.mapValue,e.mapValue);case 11:return function(s,i){if(s===Fo.mapValue&&i===Fo.mapValue)return 0;if(s===Fo.mapValue)return 1;if(i===Fo.mapValue)return-1;const o=s.fields||{},c=Object.keys(o),l=i.fields||{},u=Object.keys(l);c.sort(),u.sort();for(let d=0;d<c.length&&d<u.length;++d){const g=Xt(c[d],u[d]);if(g!==0)return g;const p=Uo(o[c[d]],l[u[d]]);if(p!==0)return p}return Xt(c.length,u.length)}(r.mapValue,e.mapValue);default:throw Tt()}}function Yg(r,e){if(typeof r=="string"&&typeof e=="string"&&r.length===e.length)return Xt(r,e);const t=Wi(r),n=Wi(e),a=Xt(t.seconds,n.seconds);return a!==0?a:Xt(t.nanos,n.nanos)}function Jg(r,e){const t=r.values||[],n=e.values||[];for(let a=0;a<t.length&&a<n.length;++a){const s=Uo(t[a],n[a]);if(s)return s}return Xt(t.length,n.length)}function su(r){return Om(r)}function Om(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?function(t){const n=Wi(t);return`time(${n.seconds},${n.nanos})`}(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?function(t){return Vo(t).toBase64()}(r.bytesValue):"referenceValue"in r?function(t){return vt.fromName(t).toString()}(r.referenceValue):"geoPointValue"in r?function(t){return`geo(${t.latitude},${t.longitude})`}(r.geoPointValue):"arrayValue"in r?function(t){let n="[",a=!0;for(const s of t.values||[])a?a=!1:n+=",",n+=Om(s);return n+"]"}(r.arrayValue):"mapValue"in r?function(t){const n=Object.keys(t.fields||{}).sort();let a="{",s=!0;for(const i of n)s?s=!1:a+=",",a+=`${i}:${Om(t.fields[i])}`;return a+"}"}(r.mapValue):Tt()}function Op(r,e){return{referenceValue:`projects/${r.projectId}/databases/${r.database}/documents/${e.path.canonicalString()}`}}function Mm(r){return!!r&&"integerValue"in r}function Nh(r){return!!r&&"arrayValue"in r}function Qg(r){return!!r&&"nullValue"in r}function Zg(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function cf(r){return!!r&&"mapValue"in r}function ed(r){var e,t;return((t=(((e=r==null?void 0:r.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function ih(r){if(r.geoPointValue)return{geoPointValue:Object.assign({},r.geoPointValue)};if(r.timestampValue&&typeof r.timestampValue=="object")return{timestampValue:Object.assign({},r.timestampValue)};if(r.mapValue){const e={mapValue:{fields:{}}};return Qc(r.mapValue.fields,(t,n)=>e.mapValue.fields[t]=ih(n)),e}if(r.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ih(r.arrayValue.values[t]);return e}return Object.assign({},r)}function Ty(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const ky={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function uS(r){return"nullValue"in r?of:"booleanValue"in r?{booleanValue:!1}:"integerValue"in r||"doubleValue"in r?{doubleValue:NaN}:"timestampValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in r?{stringValue:""}:"bytesValue"in r?{bytesValue:""}:"referenceValue"in r?Op(Bc.empty(),vt.empty()):"geoPointValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in r?{arrayValue:{}}:"mapValue"in r?ed(r)?ky:{mapValue:{}}:Tt()}function hS(r){return"nullValue"in r?{booleanValue:!1}:"booleanValue"in r?{doubleValue:NaN}:"integerValue"in r||"doubleValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in r?{stringValue:""}:"stringValue"in r?{bytesValue:""}:"bytesValue"in r?Op(Bc.empty(),vt.empty()):"referenceValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in r?{arrayValue:{}}:"arrayValue"in r?ky:"mapValue"in r?ed(r)?{mapValue:{}}:Fo:Tt()}function ex(r,e){const t=Uo(r.value,e.value);return t!==0?t:r.inclusive&&!e.inclusive?-1:!r.inclusive&&e.inclusive?1:0}function tx(r,e){const t=Uo(r.value,e.value);return t!==0?t:r.inclusive&&!e.inclusive?1:!r.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fa{constructor(e){this.value=e}static empty(){return new fa({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!cf(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ih(t)}setAll(e){let t=Qr.emptyPath(),n={},a=[];e.forEach((i,o)=>{if(!t.isImmediateParentOf(o)){const c=this.getFieldsMap(t);this.applyChanges(c,n,a),n={},a=[],t=o.popLast()}i?n[o.lastSegment()]=ih(i):a.push(o.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,n,a)}delete(e){const t=this.field(e.popLast());cf(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return gi(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let a=t.mapValue.fields[e.get(n)];cf(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=a),t=a}return t.mapValue.fields}applyChanges(e,t,n){Qc(t,(a,s)=>e[a]=s);for(const a of n)delete e[a]}clone(){return new fa(ih(this.value))}}function Iy(r){const e=[];return Qc(r.fields,(t,n)=>{const a=new Qr([t]);if(cf(n)){const s=Iy(n.mapValue).fields;if(s.length===0)e.push(a);else for(const i of s)e.push(a.child(i))}else e.push(a)}),new Ua(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un{constructor(e,t,n,a,s,i,o){this.key=e,this.documentType=t,this.version=n,this.readTime=a,this.createTime=s,this.data=i,this.documentState=o}static newInvalidDocument(e){return new un(e,0,Dt.min(),Dt.min(),Dt.min(),fa.empty(),0)}static newFoundDocument(e,t,n,a){return new un(e,1,t,Dt.min(),n,a,0)}static newNoDocument(e,t){return new un(e,2,t,Dt.min(),Dt.min(),fa.empty(),0)}static newUnknownDocument(e,t){return new un(e,3,t,Dt.min(),Dt.min(),fa.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Dt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=fa.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=fa.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Dt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof un&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new un(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iu{constructor(e,t){this.position=e,this.inclusive=t}}function rx(r,e,t){let n=0;for(let a=0;a<r.position.length;a++){const s=e[a],i=r.position[a];if(s.field.isKeyField()?n=vt.comparator(vt.fromName(i.referenceValue),t.key):n=Uo(i,t.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function nx(r,e){if(r===null)return e===null;if(e===null||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!gi(r.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ef{constructor(e,t="asc"){this.field=e,this.dir=t}}function fS(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cy{}class or extends Cy{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new dS(e,t,n):t==="array-contains"?new gS(e,n):t==="in"?new jy(e,n):t==="not-in"?new xS(e,n):t==="array-contains-any"?new vS(e,n):new or(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new mS(e,n):new pS(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Uo(t,this.value)):t!==null&&Vc(this.value)===Vc(t)&&this.matchesComparison(Uo(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Tt()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Dr extends Cy{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new Dr(e,t)}matches(e){return ou(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function ou(r){return r.op==="and"}function Bm(r){return r.op==="or"}function Mp(r){return Py(r)&&ou(r)}function Py(r){for(const e of r.filters)if(e instanceof Dr)return!1;return!0}function Vm(r){if(r instanceof or)return r.field.canonicalString()+r.op.toString()+su(r.value);if(Mp(r))return r.filters.map(e=>Vm(e)).join(",");{const e=r.filters.map(t=>Vm(t)).join(",");return`${r.op}(${e})`}}function Fy(r,e){return r instanceof or?function(n,a){return a instanceof or&&n.op===a.op&&n.field.isEqual(a.field)&&gi(n.value,a.value)}(r,e):r instanceof Dr?function(n,a){return a instanceof Dr&&n.op===a.op&&n.filters.length===a.filters.length?n.filters.reduce((s,i,o)=>s&&Fy(i,a.filters[o]),!0):!1}(r,e):void Tt()}function Ry(r,e){const t=r.filters.concat(e);return Dr.create(t,r.op)}function Dy(r){return r instanceof or?function(t){return`${t.field.canonicalString()} ${t.op} ${su(t.value)}`}(r):r instanceof Dr?function(t){return t.op.toString()+" {"+t.getFilters().map(Dy).join(" ,")+"}"}(r):"Filter"}class dS extends or{constructor(e,t,n){super(e,t,n),this.key=vt.fromName(n.referenceValue)}matches(e){const t=vt.comparator(e.key,this.key);return this.matchesComparison(t)}}class mS extends or{constructor(e,t){super(e,"in",t),this.keys=Ly("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class pS extends or{constructor(e,t){super(e,"not-in",t),this.keys=Ly("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Ly(r,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(n=>vt.fromName(n.referenceValue))}class gS extends or{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Nh(t)&&Ah(t.arrayValue,this.value)}}class jy extends or{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Ah(this.value.arrayValue,t)}}class xS extends or{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ah(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!Ah(this.value.arrayValue,t)}}class vS extends or{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Nh(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>Ah(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yS{constructor(e,t=null,n=[],a=[],s=null,i=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=a,this.limit=s,this.startAt=i,this.endAt=o,this.ue=null}}function Um(r,e=null,t=[],n=[],a=null,s=null,i=null){return new yS(r,e,t,n,a,s,i)}function Uc(r){const e=Ht(r);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>Vm(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),Zf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>su(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>su(n)).join(",")),e.ue=t}return e.ue}function Xh(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!fS(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!Fy(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!nx(r.startAt,e.startAt)&&nx(r.endAt,e.endAt)}function Sf(r){return vt.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}function Af(r,e){return r.filters.filter(t=>t instanceof or&&t.field.isEqual(e))}function ax(r,e,t){let n=of,a=!0;for(const s of Af(r,e)){let i=of,o=!0;switch(s.op){case"<":case"<=":i=uS(s.value);break;case"==":case"in":case">=":i=s.value;break;case">":i=s.value,o=!1;break;case"!=":case"not-in":i=of}ex({value:n,inclusive:a},{value:i,inclusive:o})<0&&(n=i,a=o)}if(t!==null){for(let s=0;s<r.orderBy.length;++s)if(r.orderBy[s].field.isEqual(e)){const i=t.position[s];ex({value:n,inclusive:a},{value:i,inclusive:t.inclusive})<0&&(n=i,a=t.inclusive);break}}return{value:n,inclusive:a}}function sx(r,e,t){let n=Fo,a=!0;for(const s of Af(r,e)){let i=Fo,o=!0;switch(s.op){case">=":case">":i=hS(s.value),o=!1;break;case"==":case"in":case"<=":i=s.value;break;case"<":i=s.value,o=!1;break;case"!=":case"not-in":i=Fo}tx({value:n,inclusive:a},{value:i,inclusive:o})>0&&(n=i,a=o)}if(t!==null){for(let s=0;s<r.orderBy.length;++s)if(r.orderBy[s].field.isEqual(e)){const i=t.position[s];tx({value:n,inclusive:a},{value:i,inclusive:t.inclusive})>0&&(n=i,a=t.inclusive);break}}return{value:n,inclusive:a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class td{constructor(e,t=null,n=[],a=[],s=null,i="F",o=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=a,this.limit=s,this.limitType=i,this.startAt=o,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function wS(r,e,t,n,a,s,i,o){return new td(r,e,t,n,a,s,i,o)}function rd(r){return new td(r)}function ix(r){return r.filters.length===0&&r.limit===null&&r.startAt==null&&r.endAt==null&&(r.explicitOrderBy.length===0||r.explicitOrderBy.length===1&&r.explicitOrderBy[0].field.isKeyField())}function _S(r){return r.collectionGroup!==null}function oh(r){const e=Ht(r);if(e.ce===null){e.ce=[];const t=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(i){let o=new jr(Qr.comparator);return i.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(o=o.add(l.field))})}),o})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Ef(s,n))}),t.has(Qr.keyField().canonicalString())||e.ce.push(new Ef(Qr.keyField(),n))}return e.ce}function As(r){const e=Ht(r);return e.le||(e.le=bS(e,oh(r))),e.le}function bS(r,e){if(r.limitType==="F")return Um(r.path,r.collectionGroup,e,r.filters,r.limit,r.startAt,r.endAt);{e=e.map(a=>{const s=a.dir==="desc"?"asc":"desc";return new Ef(a.field,s)});const t=r.endAt?new iu(r.endAt.position,r.endAt.inclusive):null,n=r.startAt?new iu(r.startAt.position,r.startAt.inclusive):null;return Um(r.path,r.collectionGroup,e,r.filters,r.limit,t,n)}}function qm(r,e,t){return new td(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function nd(r,e){return Xh(As(r),As(e))&&r.limitType===e.limitType}function Oy(r){return`${Uc(As(r))}|lt:${r.limitType}`}function Bl(r){return`Query(target=${function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(a=>Dy(a)).join(", ")}]`),Zf(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(a=>function(i){return`${i.field.canonicalString()} (${i.dir})`}(a)).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(a=>su(a)).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(a=>su(a)).join(",")),`Target(${n})`}(As(r))}; limitType=${r.limitType})`}function Yh(r,e){return e.isFoundDocument()&&function(n,a){const s=a.key.path;return n.collectionGroup!==null?a.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):vt.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(r,e)&&function(n,a){for(const s of oh(n))if(!s.field.isKeyField()&&a.data.field(s.field)===null)return!1;return!0}(r,e)&&function(n,a){for(const s of n.filters)if(!s.matches(a))return!1;return!0}(r,e)&&function(n,a){return!(n.startAt&&!function(i,o,c){const l=rx(i,o,c);return i.inclusive?l<=0:l<0}(n.startAt,oh(n),a)||n.endAt&&!function(i,o,c){const l=rx(i,o,c);return i.inclusive?l>=0:l>0}(n.endAt,oh(n),a))}(r,e)}function ES(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}function My(r){return(e,t)=>{let n=!1;for(const a of oh(r)){const s=SS(a,e,t);if(s!==0)return s;n=n||a.field.isKeyField()}return 0}}function SS(r,e,t){const n=r.field.isKeyField()?vt.comparator(e.key,t.key):function(s,i,o){const c=i.data.field(s),l=o.data.field(s);return c!==null&&l!==null?Uo(c,l):Tt()}(r.field,e,t);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return Tt()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yo{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[a,s]of n)if(this.equalsFn(a,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),a=this.inner[n];if(a===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<a.length;s++)if(this.equalsFn(a[s][0],e))return void(a[s]=[e,t]);a.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let a=0;a<n.length;a++)if(this.equalsFn(n[a][0],e))return n.length===1?delete this.inner[t]:n.splice(a,1),this.innerSize--,!0;return!1}forEach(e){Qc(this.inner,(t,n)=>{for(const[a,s]of n)e(a,s)})}isEmpty(){return Ay(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AS=new Yr(vt.comparator);function as(){return AS}const By=new Yr(vt.comparator);function Qu(...r){let e=By;for(const t of r)e=e.insert(t.key,t);return e}function Vy(r){let e=By;return r.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function ui(){return ch()}function Uy(){return ch()}function ch(){return new Yo(r=>r.toString(),(r,e)=>r.isEqual(e))}const NS=new Yr(vt.comparator),TS=new jr(vt.comparator);function er(...r){let e=TS;for(const t of r)e=e.add(t);return e}const kS=new jr(Xt);function IS(){return kS}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bp(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Eh(e)?"-0":e}}function qy(r){return{integerValue:""+r}}function CS(r,e){return qE(e)?qy(e):Bp(r,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ad{constructor(){this._=void 0}}function PS(r,e,t){return r instanceof Th?function(a,s){const i={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return s&&Lp(s)&&(s=jp(s)),s&&(i.fields.__previous_value__=s),{mapValue:i}}(t,e):r instanceof cu?Wy(r,e):r instanceof lu?Hy(r,e):function(a,s){const i=zy(a,s),o=ox(i)+ox(a.Pe);return Mm(i)&&Mm(a.Pe)?qy(o):Bp(a.serializer,o)}(r,e)}function FS(r,e,t){return r instanceof cu?Wy(r,e):r instanceof lu?Hy(r,e):t}function zy(r,e){return r instanceof kh?function(n){return Mm(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class Th extends ad{}class cu extends ad{constructor(e){super(),this.elements=e}}function Wy(r,e){const t=Gy(e);for(const n of r.elements)t.some(a=>gi(a,n))||t.push(n);return{arrayValue:{values:t}}}class lu extends ad{constructor(e){super(),this.elements=e}}function Hy(r,e){let t=Gy(e);for(const n of r.elements)t=t.filter(a=>!gi(a,n));return{arrayValue:{values:t}}}class kh extends ad{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function ox(r){return Xr(r.integerValue||r.doubleValue)}function Gy(r){return Nh(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RS{constructor(e,t){this.field=e,this.transform=t}}function DS(r,e){return r.field.isEqual(e.field)&&function(n,a){return n instanceof cu&&a instanceof cu||n instanceof lu&&a instanceof lu?au(n.elements,a.elements,gi):n instanceof kh&&a instanceof kh?gi(n.Pe,a.Pe):n instanceof Th&&a instanceof Th}(r.transform,e.transform)}class LS{constructor(e,t){this.version=e,this.transformResults=t}}class ea{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new ea}static exists(e){return new ea(void 0,e)}static updateTime(e){return new ea(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function lf(r,e){return r.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(r.updateTime):r.exists===void 0||r.exists===e.isFoundDocument()}class sd{}function $y(r,e){if(!r.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return r.isNoDocument()?new Jh(r.key,ea.none()):new yu(r.key,r.data,ea.none());{const t=r.data,n=fa.empty();let a=new jr(Qr.comparator);for(let s of e.fields)if(!a.has(s)){let i=t.field(s);i===null&&s.length>1&&(s=s.popLast(),i=t.field(s)),i===null?n.delete(s):n.set(s,i),a=a.add(s)}return new Gi(r.key,n,new Ua(a.toArray()),ea.none())}}function jS(r,e,t){r instanceof yu?function(a,s,i){const o=a.value.clone(),c=lx(a.fieldTransforms,s,i.transformResults);o.setAll(c),s.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(r,e,t):r instanceof Gi?function(a,s,i){if(!lf(a.precondition,s))return void s.convertToUnknownDocument(i.version);const o=lx(a.fieldTransforms,s,i.transformResults),c=s.data;c.setAll(Ky(a)),c.setAll(o),s.convertToFoundDocument(i.version,c).setHasCommittedMutations()}(r,e,t):function(a,s,i){s.convertToNoDocument(i.version).setHasCommittedMutations()}(0,e,t)}function lh(r,e,t,n){return r instanceof yu?function(s,i,o,c){if(!lf(s.precondition,i))return o;const l=s.value.clone(),u=ux(s.fieldTransforms,c,i);return l.setAll(u),i.convertToFoundDocument(i.version,l).setHasLocalMutations(),null}(r,e,t,n):r instanceof Gi?function(s,i,o,c){if(!lf(s.precondition,i))return o;const l=ux(s.fieldTransforms,c,i),u=i.data;return u.setAll(Ky(s)),u.setAll(l),i.convertToFoundDocument(i.version,u).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(r,e,t,n):function(s,i,o){return lf(s.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):o}(r,e,t)}function OS(r,e){let t=null;for(const n of r.fieldTransforms){const a=e.data.field(n.field),s=zy(n.transform,a||null);s!=null&&(t===null&&(t=fa.empty()),t.set(n.field,s))}return t||null}function cx(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&!!function(n,a){return n===void 0&&a===void 0||!(!n||!a)&&au(n,a,(s,i)=>DS(s,i))}(r.fieldTransforms,e.fieldTransforms)&&(r.type===0?r.value.isEqual(e.value):r.type!==1||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask))}class yu extends sd{constructor(e,t,n,a=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class Gi extends sd{constructor(e,t,n,a,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=a,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Ky(r){const e=new Map;return r.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const n=r.data.field(t);e.set(t,n)}}),e}function lx(r,e,t){const n=new Map;kt(r.length===t.length);for(let a=0;a<t.length;a++){const s=r[a],i=s.transform,o=e.data.field(s.field);n.set(s.field,FS(i,o,t[a]))}return n}function ux(r,e,t){const n=new Map;for(const a of r){const s=a.transform,i=t.data.field(a.field);n.set(a.field,PS(s,i,e))}return n}class Jh extends sd{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Xy extends sd{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vp{constructor(e,t,n,a){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=a}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let a=0;a<this.mutations.length;a++){const s=this.mutations[a];s.key.isEqual(e.key)&&jS(s,e,n[a])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=lh(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=lh(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Uy();return this.mutations.forEach(a=>{const s=e.get(a.key),i=s.overlayedDocument;let o=this.applyToLocalView(i,s.mutatedFields);o=t.has(a.key)?null:o;const c=$y(i,o);c!==null&&n.set(a.key,c),i.isValidDocument()||i.convertToNoDocument(Dt.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),er())}isEqual(e){return this.batchId===e.batchId&&au(this.mutations,e.mutations,(t,n)=>cx(t,n))&&au(this.baseMutations,e.baseMutations,(t,n)=>cx(t,n))}}class Up{constructor(e,t,n,a){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=a}static from(e,t,n){kt(e.mutations.length===n.length);let a=function(){return NS}();const s=e.mutations;for(let i=0;i<s.length;i++)a=a.insert(s[i].key,n[i].version);return new Up(e,t,n,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qp{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MS{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var An,hr;function BS(r){switch(r){default:return Tt();case Ge.CANCELLED:case Ge.UNKNOWN:case Ge.DEADLINE_EXCEEDED:case Ge.RESOURCE_EXHAUSTED:case Ge.INTERNAL:case Ge.UNAVAILABLE:case Ge.UNAUTHENTICATED:return!1;case Ge.INVALID_ARGUMENT:case Ge.NOT_FOUND:case Ge.ALREADY_EXISTS:case Ge.PERMISSION_DENIED:case Ge.FAILED_PRECONDITION:case Ge.ABORTED:case Ge.OUT_OF_RANGE:case Ge.UNIMPLEMENTED:case Ge.DATA_LOSS:return!0}}function Yy(r){if(r===void 0)return Ta("GRPC error has no .code"),Ge.UNKNOWN;switch(r){case An.OK:return Ge.OK;case An.CANCELLED:return Ge.CANCELLED;case An.UNKNOWN:return Ge.UNKNOWN;case An.DEADLINE_EXCEEDED:return Ge.DEADLINE_EXCEEDED;case An.RESOURCE_EXHAUSTED:return Ge.RESOURCE_EXHAUSTED;case An.INTERNAL:return Ge.INTERNAL;case An.UNAVAILABLE:return Ge.UNAVAILABLE;case An.UNAUTHENTICATED:return Ge.UNAUTHENTICATED;case An.INVALID_ARGUMENT:return Ge.INVALID_ARGUMENT;case An.NOT_FOUND:return Ge.NOT_FOUND;case An.ALREADY_EXISTS:return Ge.ALREADY_EXISTS;case An.PERMISSION_DENIED:return Ge.PERMISSION_DENIED;case An.FAILED_PRECONDITION:return Ge.FAILED_PRECONDITION;case An.ABORTED:return Ge.ABORTED;case An.OUT_OF_RANGE:return Ge.OUT_OF_RANGE;case An.UNIMPLEMENTED:return Ge.UNIMPLEMENTED;case An.DATA_LOSS:return Ge.DATA_LOSS;default:return Tt()}}(hr=An||(An={}))[hr.OK=0]="OK",hr[hr.CANCELLED=1]="CANCELLED",hr[hr.UNKNOWN=2]="UNKNOWN",hr[hr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",hr[hr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",hr[hr.NOT_FOUND=5]="NOT_FOUND",hr[hr.ALREADY_EXISTS=6]="ALREADY_EXISTS",hr[hr.PERMISSION_DENIED=7]="PERMISSION_DENIED",hr[hr.UNAUTHENTICATED=16]="UNAUTHENTICATED",hr[hr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",hr[hr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",hr[hr.ABORTED=10]="ABORTED",hr[hr.OUT_OF_RANGE=11]="OUT_OF_RANGE",hr[hr.UNIMPLEMENTED=12]="UNIMPLEMENTED",hr[hr.INTERNAL=13]="INTERNAL",hr[hr.UNAVAILABLE=14]="UNAVAILABLE",hr[hr.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VS(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const US=new Ic([4294967295,4294967295],0);function hx(r){const e=VS().encode(r),t=new cy;return t.update(e),new Uint8Array(t.digest())}function fx(r){const e=new DataView(r.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),a=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Ic([t,n],0),new Ic([a,s],0)]}class zp{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Zu(`Invalid padding: ${t}`);if(n<0)throw new Zu(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Zu(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new Zu(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Ic.fromNumber(this.Ie)}Ee(e,t,n){let a=e.add(t.multiply(Ic.fromNumber(n)));return a.compare(US)===1&&(a=new Ic([a.getBits(0),a.getBits(1)],0)),a.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=hx(e),[n,a]=fx(t);for(let s=0;s<this.hashCount;s++){const i=this.Ee(n,a,s);if(!this.de(i))return!1}return!0}static create(e,t,n){const a=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),i=new zp(s,a,t);return n.forEach(o=>i.insert(o)),i}insert(e){if(this.Ie===0)return;const t=hx(e),[n,a]=fx(t);for(let s=0;s<this.hashCount;s++){const i=this.Ee(n,a,s);this.Ae(i)}}Ae(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Zu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class id{constructor(e,t,n,a,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=a,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const a=new Map;return a.set(e,Qh.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new id(Dt.min(),a,new Yr(Xt),as(),er())}}class Qh{constructor(e,t,n,a,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=a,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Qh(n,t,er(),er(),er())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uf{constructor(e,t,n,a){this.Re=e,this.removedTargetIds=t,this.key=n,this.Ve=a}}class Jy{constructor(e,t){this.targetId=e,this.me=t}}class Qy{constructor(e,t,n=kn.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=a}}class dx{constructor(){this.fe=0,this.ge=px(),this.pe=kn.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=er(),t=er(),n=er();return this.ge.forEach((a,s)=>{switch(s){case 0:e=e.add(a);break;case 2:t=t.add(a);break;case 1:n=n.add(a);break;default:Tt()}}),new Qh(this.pe,this.ye,e,t,n)}Ce(){this.we=!1,this.ge=px()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,kt(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class qS{constructor(e){this.Le=e,this.Be=new Map,this.ke=as(),this.qe=mx(),this.Qe=new Yr(Xt)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const n=this.Ge(t);switch(e.state){case 0:this.ze(t)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),n.De(e.resumeToken));break;default:Tt()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((n,a)=>{this.ze(a)&&t(a)})}He(e){const t=e.targetId,n=e.me.count,a=this.Je(t);if(a){const s=a.target;if(Sf(s))if(n===0){const i=new vt(s.path);this.Ue(t,i,un.newNoDocument(i,Dt.min()))}else kt(n===1);else{const i=this.Ye(t);if(i!==n){const o=this.Ze(e),c=o?this.Xe(o,e,i):1;if(c!==0){this.je(t);const l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,l)}}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:a=0},hashCount:s=0}=t;let i,o;try{i=Vo(n).toUint8Array()}catch(c){if(c instanceof Ny)return Mc("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{o=new zp(i,a,s)}catch(c){return Mc(c instanceof Zu?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return o.Ie===0?null:o}Xe(e,t,n){return t.me.count===n-this.nt(e,t.targetId)?0:2}nt(e,t){const n=this.Le.getRemoteKeysForTarget(t);let a=0;return n.forEach(s=>{const i=this.Le.tt(),o=`projects/${i.projectId}/databases/${i.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.Ue(t,s,null),a++)}),a}rt(e){const t=new Map;this.Be.forEach((s,i)=>{const o=this.Je(i);if(o){if(s.current&&Sf(o.target)){const c=new vt(o.target.path);this.ke.get(c)!==null||this.it(i,c)||this.Ue(i,c,un.newNoDocument(c,e))}s.be&&(t.set(i,s.ve()),s.Ce())}});let n=er();this.qe.forEach((s,i)=>{let o=!0;i.forEachWhile(c=>{const l=this.Je(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(s))}),this.ke.forEach((s,i)=>i.setReadTime(e));const a=new id(e,t,this.Qe,this.ke,n);return this.ke=as(),this.qe=mx(),this.Qe=new Yr(Xt),a}$e(e,t){if(!this.ze(e))return;const n=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,n),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,n){if(!this.ze(e))return;const a=this.Ge(e);this.it(e,t)?a.Fe(t,1):a.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),n&&(this.ke=this.ke.insert(t,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new dx,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new jr(Xt),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||at("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new dx),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function mx(){return new Yr(vt.comparator)}function px(){return new Yr(vt.comparator)}const zS={asc:"ASCENDING",desc:"DESCENDING"},WS={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},HS={and:"AND",or:"OR"};class GS{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function zm(r,e){return r.useProto3Json||Zf(e)?e:{value:e}}function uu(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Zy(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function $S(r,e){return uu(r,e.toTimestamp())}function Ia(r){return kt(!!r),Dt.fromTimestamp(function(t){const n=Wi(t);return new tn(n.seconds,n.nanos)}(r))}function Wp(r,e){return Wm(r,e).canonicalString()}function Wm(r,e){const t=function(a){return new Nr(["projects",a.projectId,"databases",a.database])}(r).child("documents");return e===void 0?t:t.child(e)}function e5(r){const e=Nr.fromString(r);return kt(l5(e)),e}function Nf(r,e){return Wp(r.databaseId,e.path)}function Cc(r,e){const t=e5(e);if(t.get(1)!==r.databaseId.projectId)throw new wt(Ge.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new wt(Ge.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new vt(n5(t))}function t5(r,e){return Wp(r.databaseId,e)}function r5(r){const e=e5(r);return e.length===4?Nr.emptyPath():n5(e)}function Hm(r){return new Nr(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function n5(r){return kt(r.length>4&&r.get(4)==="documents"),r.popFirst(5)}function gx(r,e,t){return{name:Nf(r,e),fields:t.value.mapValue.fields}}function KS(r,e,t){const n=Cc(r,e.name),a=Ia(e.updateTime),s=e.createTime?Ia(e.createTime):Dt.min(),i=new fa({mapValue:{fields:e.fields}}),o=un.newFoundDocument(n,a,s,i);return t&&o.setHasCommittedMutations(),t?o.setHasCommittedMutations():o}function XS(r,e){let t;if("targetChange"in e){e.targetChange;const n=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:Tt()}(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],s=function(l,u){return l.useProto3Json?(kt(u===void 0||typeof u=="string"),kn.fromBase64String(u||"")):(kt(u===void 0||u instanceof Buffer||u instanceof Uint8Array),kn.fromUint8Array(u||new Uint8Array))}(r,e.targetChange.resumeToken),i=e.targetChange.cause,o=i&&function(l){const u=l.code===void 0?Ge.UNKNOWN:Yy(l.code);return new wt(u,l.message||"")}(i);t=new Qy(n,a,s,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const a=Cc(r,n.document.name),s=Ia(n.document.updateTime),i=n.document.createTime?Ia(n.document.createTime):Dt.min(),o=new fa({mapValue:{fields:n.document.fields}}),c=un.newFoundDocument(a,s,i,o),l=n.targetIds||[],u=n.removedTargetIds||[];t=new uf(l,u,c.key,c)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const a=Cc(r,n.document),s=n.readTime?Ia(n.readTime):Dt.min(),i=un.newNoDocument(a,s),o=n.removedTargetIds||[];t=new uf([],o,i.key,i)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const a=Cc(r,n.document),s=n.removedTargetIds||[];t=new uf([],s,a,null)}else{if(!("filter"in e))return Tt();{e.filter;const n=e.filter;n.targetId;const{count:a=0,unchangedNames:s}=n,i=new MS(a,s),o=n.targetId;t=new Jy(o,i)}}return t}function Tf(r,e){let t;if(e instanceof yu)t={update:gx(r,e.key,e.value)};else if(e instanceof Jh)t={delete:Nf(r,e.key)};else if(e instanceof Gi)t={update:gx(r,e.key,e.data),updateMask:tA(e.fieldMask)};else{if(!(e instanceof Xy))return Tt();t={verify:Nf(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(s,i){const o=i.transform;if(o instanceof Th)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof cu)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof lu)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof kh)return{fieldPath:i.field.canonicalString(),increment:o.Pe};throw Tt()}(0,n))),e.precondition.isNone||(t.currentDocument=function(a,s){return s.updateTime!==void 0?{updateTime:$S(a,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Tt()}(r,e.precondition)),t}function Gm(r,e){const t=e.currentDocument?function(s){return s.updateTime!==void 0?ea.updateTime(Ia(s.updateTime)):s.exists!==void 0?ea.exists(s.exists):ea.none()}(e.currentDocument):ea.none(),n=e.updateTransforms?e.updateTransforms.map(a=>function(i,o){let c=null;if("setToServerValue"in o)kt(o.setToServerValue==="REQUEST_TIME"),c=new Th;else if("appendMissingElements"in o){const u=o.appendMissingElements.values||[];c=new cu(u)}else if("removeAllFromArray"in o){const u=o.removeAllFromArray.values||[];c=new lu(u)}else"increment"in o?c=new kh(i,o.increment):Tt();const l=Qr.fromServerFormat(o.fieldPath);return new RS(l,c)}(r,a)):[];if(e.update){e.update.name;const a=Cc(r,e.update.name),s=new fa({mapValue:{fields:e.update.fields}});if(e.updateMask){const i=function(c){const l=c.fieldPaths||[];return new Ua(l.map(u=>Qr.fromServerFormat(u)))}(e.updateMask);return new Gi(a,s,i,t,n)}return new yu(a,s,t,n)}if(e.delete){const a=Cc(r,e.delete);return new Jh(a,t)}if(e.verify){const a=Cc(r,e.verify);return new Xy(a,t)}return Tt()}function YS(r,e){return r&&r.length>0?(kt(e!==void 0),r.map(t=>function(a,s){let i=a.updateTime?Ia(a.updateTime):Ia(s);return i.isEqual(Dt.min())&&(i=Ia(s)),new LS(i,a.transformResults||[])}(t,e))):[]}function a5(r,e){return{documents:[t5(r,e.path)]}}function s5(r,e){const t={structuredQuery:{}},n=e.path;let a;e.collectionGroup!==null?(a=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=t5(r,a);const s=function(l){if(l.length!==0)return c5(Dr.create(l,"and"))}(e.filters);s&&(t.structuredQuery.where=s);const i=function(l){if(l.length!==0)return l.map(u=>function(g){return{field:Vl(g.field),direction:QS(g.dir)}}(u))}(e.orderBy);i&&(t.structuredQuery.orderBy=i);const o=zm(r,e.limit);return o!==null&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{_t:t,parent:a}}function i5(r){let e=r5(r.parent);const t=r.structuredQuery,n=t.from?t.from.length:0;let a=null;if(n>0){kt(n===1);const u=t.from[0];u.allDescendants?a=u.collectionId:e=e.child(u.collectionId)}let s=[];t.where&&(s=function(d){const g=o5(d);return g instanceof Dr&&Mp(g)?g.getFilters():[g]}(t.where));let i=[];t.orderBy&&(i=function(d){return d.map(g=>function(y){return new Ef(Ul(y.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(g))}(t.orderBy));let o=null;t.limit&&(o=function(d){let g;return g=typeof d=="object"?d.value:d,Zf(g)?null:g}(t.limit));let c=null;t.startAt&&(c=function(d){const g=!!d.before,p=d.values||[];return new iu(p,g)}(t.startAt));let l=null;return t.endAt&&(l=function(d){const g=!d.before,p=d.values||[];return new iu(p,g)}(t.endAt)),wS(e,a,i,s,o,"F",c,l)}function JS(r,e){const t=function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Tt()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function o5(r){return r.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=Ul(t.unaryFilter.field);return or.create(n,"==",{doubleValue:NaN});case"IS_NULL":const a=Ul(t.unaryFilter.field);return or.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Ul(t.unaryFilter.field);return or.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Ul(t.unaryFilter.field);return or.create(i,"!=",{nullValue:"NULL_VALUE"});default:return Tt()}}(r):r.fieldFilter!==void 0?function(t){return or.create(Ul(t.fieldFilter.field),function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Tt()}}(t.fieldFilter.op),t.fieldFilter.value)}(r):r.compositeFilter!==void 0?function(t){return Dr.create(t.compositeFilter.filters.map(n=>o5(n)),function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return Tt()}}(t.compositeFilter.op))}(r):Tt()}function QS(r){return zS[r]}function ZS(r){return WS[r]}function eA(r){return HS[r]}function Vl(r){return{fieldPath:r.canonicalString()}}function Ul(r){return Qr.fromServerFormat(r.fieldPath)}function c5(r){return r instanceof or?function(t){if(t.op==="=="){if(Zg(t.value))return{unaryFilter:{field:Vl(t.field),op:"IS_NAN"}};if(Qg(t.value))return{unaryFilter:{field:Vl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Zg(t.value))return{unaryFilter:{field:Vl(t.field),op:"IS_NOT_NAN"}};if(Qg(t.value))return{unaryFilter:{field:Vl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Vl(t.field),op:ZS(t.op),value:t.value}}}(r):r instanceof Dr?function(t){const n=t.getFilters().map(a=>c5(a));return n.length===1?n[0]:{compositeFilter:{op:eA(t.op),filters:n}}}(r):Tt()}function tA(r){const e=[];return r.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function l5(r){return r.length>=4&&r.get(0)==="projects"&&r.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oi{constructor(e,t,n,a,s=Dt.min(),i=Dt.min(),o=kn.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=a,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=i,this.resumeToken=o,this.expectedCount=c}withSequenceNumber(e){return new Oi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Oi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Oi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Oi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u5{constructor(e){this.ct=e}}function rA(r,e){let t;if(e.document)t=KS(r.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const n=vt.fromSegments(e.noDocument.path),a=zc(e.noDocument.readTime);t=un.newNoDocument(n,a),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Tt();{const n=vt.fromSegments(e.unknownDocument.path),a=zc(e.unknownDocument.version);t=un.newUnknownDocument(n,a)}}return e.readTime&&t.setReadTime(function(a){const s=new tn(a[0],a[1]);return Dt.fromTimestamp(s)}(e.readTime)),t}function xx(r,e){const t=e.key,n={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:kf(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=function(s,i){return{name:Nf(s,i.key),fields:i.data.value.mapValue.fields,updateTime:uu(s,i.version.toTimestamp()),createTime:uu(s,i.createTime.toTimestamp())}}(r.ct,e);else if(e.isNoDocument())n.noDocument={path:t.path.toArray(),readTime:qc(e.version)};else{if(!e.isUnknownDocument())return Tt();n.unknownDocument={path:t.path.toArray(),version:qc(e.version)}}return n}function kf(r){const e=r.toTimestamp();return[e.seconds,e.nanoseconds]}function qc(r){const e=r.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function zc(r){const e=new tn(r.seconds,r.nanoseconds);return Dt.fromTimestamp(e)}function Ec(r,e){const t=(e.baseMutations||[]).map(s=>Gm(r.ct,s));for(let s=0;s<e.mutations.length-1;++s){const i=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const o=e.mutations[s+1];i.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const n=e.mutations.map(s=>Gm(r.ct,s)),a=tn.fromMillis(e.localWriteTimeMs);return new Vp(e.batchId,a,t,n)}function eh(r){const e=zc(r.readTime),t=r.lastLimboFreeSnapshotVersion!==void 0?zc(r.lastLimboFreeSnapshotVersion):Dt.min();let n;return n=function(s){return s.documents!==void 0}(r.query)?function(s){return kt(s.documents.length===1),As(rd(r5(s.documents[0])))}(r.query):function(s){return As(i5(s))}(r.query),new Oi(n,r.targetId,"TargetPurposeListen",r.lastListenSequenceNumber,e,t,kn.fromBase64String(r.resumeToken))}function h5(r,e){const t=qc(e.snapshotVersion),n=qc(e.lastLimboFreeSnapshotVersion);let a;a=Sf(e.target)?a5(r.ct,e.target):s5(r.ct,e.target)._t;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Uc(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:a}}function f5(r){const e=i5({parent:r.parent,structuredQuery:r.structuredQuery});return r.limitType==="LAST"?qm(e,e.limit,"L"):e}function Zd(r,e){return new qp(e.largestBatchId,Gm(r.ct,e.overlayMutation))}function vx(r,e){const t=e.path.lastSegment();return[r,ka(e.path.popLast()),t]}function yx(r,e,t,n){return{indexId:r,uid:e,sequenceNumber:t,readTime:qc(n.readTime),documentKey:ka(n.documentKey.path),largestBatchId:n.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nA{getBundleMetadata(e,t){return wx(e).get(t).next(n=>{if(n)return function(s){return{id:s.bundleId,createTime:zc(s.createTime),version:s.version}}(n)})}saveBundleMetadata(e,t){return wx(e).put(function(a){return{bundleId:a.id,createTime:qc(Ia(a.createTime)),version:a.version}}(t))}getNamedQuery(e,t){return _x(e).get(t).next(n=>{if(n)return function(s){return{name:s.name,query:f5(s.bundledQuery),readTime:zc(s.readTime)}}(n)})}saveNamedQuery(e,t){return _x(e).put(function(a){return{name:a.name,readTime:qc(Ia(a.readTime)),bundledQuery:a.bundledQuery}}(t))}}function wx(r){return Dn(r,"bundles")}function _x(r){return Dn(r,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class od{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){const n=t.uid||"";return new od(e,n)}getOverlay(e,t){return qu(e).get(vx(this.userId,t)).next(n=>n?Zd(this.serializer,n):null)}getOverlays(e,t){const n=ui();return De.forEach(t,a=>this.getOverlay(e,a).next(s=>{s!==null&&n.set(a,s)})).next(()=>n)}saveOverlays(e,t,n){const a=[];return n.forEach((s,i)=>{const o=new qp(t,i);a.push(this.ht(e,o))}),De.waitFor(a)}removeOverlaysForBatchId(e,t,n){const a=new Set;t.forEach(i=>a.add(ka(i.getCollectionPath())));const s=[];return a.forEach(i=>{const o=IDBKeyRange.bound([this.userId,i,n],[this.userId,i,n+1],!1,!0);s.push(qu(e).j("collectionPathOverlayIndex",o))}),De.waitFor(s)}getOverlaysForCollection(e,t,n){const a=ui(),s=ka(t),i=IDBKeyRange.bound([this.userId,s,n],[this.userId,s,Number.POSITIVE_INFINITY],!0);return qu(e).U("collectionPathOverlayIndex",i).next(o=>{for(const c of o){const l=Zd(this.serializer,c);a.set(l.getKey(),l)}return a})}getOverlaysForCollectionGroup(e,t,n,a){const s=ui();let i;const o=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return qu(e).J({index:"collectionGroupOverlayIndex",range:o},(c,l,u)=>{const d=Zd(this.serializer,l);s.size()<a||d.largestBatchId===i?(s.set(d.getKey(),d),i=d.largestBatchId):u.done()}).next(()=>s)}ht(e,t){return qu(e).put(function(a,s,i){const[o,c,l]=vx(s,i.mutation.key);return{userId:s,collectionPath:c,documentId:l,collectionGroup:i.mutation.key.getCollectionGroup(),largestBatchId:i.largestBatchId,overlayMutation:Tf(a.ct,i.mutation)}}(this.serializer,this.userId,t))}}function qu(r){return Dn(r,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aA{Pt(e){return Dn(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(t=>{const n=t==null?void 0:t.value;return n?kn.fromUint8Array(n):kn.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sc{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(Xr(e.integerValue));else if("doubleValue"in e){const n=Xr(e.doubleValue);isNaN(n)?this.dt(t,13):(this.dt(t,15),Eh(n)?t.At(0):t.At(n))}else if("timestampValue"in e){let n=e.timestampValue;this.dt(t,20),typeof n=="string"&&(n=Wi(n)),t.Rt(`${n.seconds||""}`),t.At(n.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Vo(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.dt(t,45),t.At(n.latitude||0),t.At(n.longitude||0)}else"mapValue"in e?Ty(e)?this.dt(t,Number.MAX_SAFE_INTEGER):ed(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):Tt()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const n=e.fields||{};this.dt(t,55);for(const a of Object.keys(n))this.Vt(a,t),this.Tt(n[a],t)}wt(e,t){var n,a;const s=e.fields||{};this.dt(t,53);const i="value",o=((a=(n=s[i].arrayValue)===null||n===void 0?void 0:n.values)===null||a===void 0?void 0:a.length)||0;this.dt(t,15),t.At(Xr(o)),this.Vt(i,t),this.Tt(s[i],t)}bt(e,t){const n=e.values||[];this.dt(t,50);for(const a of n)this.Tt(a,t)}yt(e,t){this.dt(t,37),vt.fromName(e).path.forEach(n=>{this.dt(t,60),this.Dt(n,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}}Sc.vt=new Sc;function sA(r){if(r===0)return 8;let e=0;return!(r>>4)&&(e+=4,r<<=4),!(r>>6)&&(e+=2,r<<=2),!(r>>7)&&(e+=1),e}function bx(r){const e=64-function(n){let a=0;for(let s=0;s<8;++s){const i=sA(255&n[s]);if(a+=i,i!==8)break}return a}(r);return Math.ceil(e/8)}class iA{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Ft(n.value),n=t.next();this.Mt()}xt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Ot(n.value),n=t.next();this.Nt()}Lt(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.Ft(n);else if(n<2048)this.Ft(960|n>>>6),this.Ft(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|n>>>12),this.Ft(128|63&n>>>6),this.Ft(128|63&n);else{const a=t.codePointAt(0);this.Ft(240|a>>>18),this.Ft(128|63&a>>>12),this.Ft(128|63&a>>>6),this.Ft(128|63&a)}}this.Mt()}Bt(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.Ot(n);else if(n<2048)this.Ot(960|n>>>6),this.Ot(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Ot(480|n>>>12),this.Ot(128|63&n>>>6),this.Ot(128|63&n);else{const a=t.codePointAt(0);this.Ot(240|a>>>18),this.Ot(128|63&a>>>12),this.Ot(128|63&a>>>6),this.Ot(128|63&a)}}this.Nt()}kt(e){const t=this.qt(e),n=bx(t);this.Qt(1+n),this.buffer[this.position++]=255&n;for(let a=t.length-n;a<t.length;++a)this.buffer[this.position++]=255&t[a]}Kt(e){const t=this.qt(e),n=bx(t);this.Qt(1+n),this.buffer[this.position++]=~(255&n);for(let a=t.length-n;a<t.length;++a)this.buffer[this.position++]=~(255&t[a])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const t=function(s){const i=new DataView(new ArrayBuffer(8));return i.setFloat64(0,s,!1),new Uint8Array(i.buffer)}(e),n=(128&t[0])!=0;t[0]^=n?255:128;for(let a=1;a<t.length;++a)t[a]^=n?255:0;return t}Ft(e){const t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){const t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const a=new Uint8Array(n);a.set(this.buffer),this.buffer=a}}class oA{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class cA{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class zu{constructor(){this.jt=new iA,this.Ht=new oA(this.jt),this.Jt=new cA(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ac{constructor(e,t,n,a){this.indexId=e,this.documentKey=t,this.arrayValue=n,this.directionalValue=a}Zt(){const e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,n=new Uint8Array(t);return n.set(this.directionalValue,0),t!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new Ac(this.indexId,this.documentKey,this.arrayValue,n)}}function So(r,e){let t=r.indexId-e.indexId;return t!==0?t:(t=Ex(r.arrayValue,e.arrayValue),t!==0?t:(t=Ex(r.directionalValue,e.directionalValue),t!==0?t:vt.comparator(r.documentKey,e.documentKey)))}function Ex(r,e){for(let t=0;t<r.length&&t<e.length;++t){const n=r[t]-e[t];if(n!==0)return n}return r.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sx{constructor(e){this.Xt=new jr((t,n)=>Qr.comparator(t.field,n.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const t of e.filters){const n=t;n.isInequality()?this.Xt=this.Xt.add(n):this.tn.push(n)}}get nn(){return this.Xt.size>1}rn(e){if(kt(e.collectionGroup===this.collectionId),this.nn)return!1;const t=Lm(e);if(t!==void 0&&!this.sn(t))return!1;const n=wc(e);let a=new Set,s=0,i=0;for(;s<n.length&&this.sn(n[s]);++s)a=a.add(n[s].fieldPath.canonicalString());if(s===n.length)return!0;if(this.Xt.size>0){const o=this.Xt.getIterator().getNext();if(!a.has(o.field.canonicalString())){const c=n[s];if(!this.on(o,c)||!this._n(this.en[i++],c))return!1}++s}for(;s<n.length;++s){const o=n[s];if(i>=this.en.length||!this._n(this.en[i++],o))return!1}return!0}an(){if(this.nn)return null;let e=new jr(Qr.comparator);const t=[];for(const n of this.tn)if(!n.field.isKeyField())if(n.op==="array-contains"||n.op==="array-contains-any")t.push(new af(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new af(n.field,0))}for(const n of this.en)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new af(n.field,n.dir==="asc"?0:1)));return new bf(bf.UNKNOWN_ID,this.collectionId,t,bh.empty())}sn(e){for(const t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const n=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===n}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d5(r){var e,t;if(kt(r instanceof or||r instanceof Dr),r instanceof or){if(r instanceof jy){const a=((t=(e=r.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>or.create(r.field,"==",s)))||[];return Dr.create(a,"or")}return r}const n=r.filters.map(a=>d5(a));return Dr.create(n,r.op)}function lA(r){if(r.getFilters().length===0)return[];const e=Xm(d5(r));return kt(m5(e)),$m(e)||Km(e)?[e]:e.getFilters()}function $m(r){return r instanceof or}function Km(r){return r instanceof Dr&&Mp(r)}function m5(r){return $m(r)||Km(r)||function(t){if(t instanceof Dr&&Bm(t)){for(const n of t.getFilters())if(!$m(n)&&!Km(n))return!1;return!0}return!1}(r)}function Xm(r){if(kt(r instanceof or||r instanceof Dr),r instanceof or)return r;if(r.filters.length===1)return Xm(r.filters[0]);const e=r.filters.map(n=>Xm(n));let t=Dr.create(e,r.op);return t=If(t),m5(t)?t:(kt(t instanceof Dr),kt(ou(t)),kt(t.filters.length>1),t.filters.reduce((n,a)=>Hp(n,a)))}function Hp(r,e){let t;return kt(r instanceof or||r instanceof Dr),kt(e instanceof or||e instanceof Dr),t=r instanceof or?e instanceof or?function(a,s){return Dr.create([a,s],"and")}(r,e):Ax(r,e):e instanceof or?Ax(e,r):function(a,s){if(kt(a.filters.length>0&&s.filters.length>0),ou(a)&&ou(s))return Ry(a,s.getFilters());const i=Bm(a)?a:s,o=Bm(a)?s:a,c=i.filters.map(l=>Hp(l,o));return Dr.create(c,"or")}(r,e),If(t)}function Ax(r,e){if(ou(e))return Ry(e,r.getFilters());{const t=e.filters.map(n=>Hp(r,n));return Dr.create(t,"or")}}function If(r){if(kt(r instanceof or||r instanceof Dr),r instanceof or)return r;const e=r.getFilters();if(e.length===1)return If(e[0]);if(Py(r))return r;const t=e.map(a=>If(a)),n=[];return t.forEach(a=>{a instanceof or?n.push(a):a instanceof Dr&&(a.op===r.op?n.push(...a.filters):n.push(a))}),n.length===1?n[0]:Dr.create(n,r.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uA{constructor(){this.un=new Gp}addToCollectionParentIndex(e,t){return this.un.add(t),De.resolve()}getCollectionParents(e,t){return De.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return De.resolve()}deleteFieldIndex(e,t){return De.resolve()}deleteAllFieldIndexes(e){return De.resolve()}createTargetIndexes(e,t){return De.resolve()}getDocumentsMatchingTarget(e,t){return De.resolve(null)}getIndexType(e,t){return De.resolve(0)}getFieldIndexes(e,t){return De.resolve([])}getNextCollectionGroupToUpdate(e){return De.resolve(null)}getMinOffset(e,t){return De.resolve(os.min())}getMinOffsetFromCollectionGroup(e,t){return De.resolve(os.min())}updateCollectionGroup(e,t,n){return De.resolve()}updateIndexEntries(e,t){return De.resolve()}}class Gp{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),a=this.index[t]||new jr(Nr.comparator),s=!a.has(n);return this.index[t]=a.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),a=this.index[t];return a&&a.has(n)}getEntries(e){return(this.index[e]||new jr(Nr.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j0=new Uint8Array(0);class hA{constructor(e,t){this.databaseId=t,this.cn=new Gp,this.ln=new Yo(n=>Uc(n),(n,a)=>Xh(n,a)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){const n=t.lastSegment(),a=t.popLast();e.addOnCommittedListener(()=>{this.cn.add(t)});const s={collectionId:n,parent:ka(a)};return Nx(e).put(s)}return De.resolve()}getCollectionParents(e,t){const n=[],a=IDBKeyRange.bound([t,""],[gy(t),""],!1,!0);return Nx(e).U(a).next(s=>{for(const i of s){if(i.collectionId!==t)break;n.push(li(i.parent))}return n})}addFieldIndex(e,t){const n=Wu(e),a=function(o){return{indexId:o.indexId,collectionGroup:o.collectionGroup,fields:o.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(t);delete a.indexId;const s=n.add(a);if(t.indexState){const i=Pl(e);return s.next(o=>{i.put(yx(o,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){const n=Wu(e),a=Pl(e),s=Cl(e);return n.delete(t.indexId).next(()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=Wu(e),n=Cl(e),a=Pl(e);return t.j().next(()=>n.j()).next(()=>a.j())}createTargetIndexes(e,t){return De.forEach(this.hn(t),n=>this.getIndexType(e,n).next(a=>{if(a===0||a===1){const s=new Sx(n).an();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){const n=Cl(e);let a=!0;const s=new Map;return De.forEach(this.hn(t),i=>this.Pn(e,i).next(o=>{a&&(a=!!o),s.set(i,o)})).next(()=>{if(a){let i=er();const o=[];return De.forEach(s,(c,l)=>{at("IndexedDbIndexManager",`Using index ${function(P){return`id=${P.indexId}|cg=${P.collectionGroup}|f=${P.fields.map(q=>`${q.fieldPath}:${q.kind}`).join(",")}`}(c)} to execute ${Uc(t)}`);const u=function(P,q){const z=Lm(q);if(z===void 0)return null;for(const K of Af(P,z.fieldPath))switch(K.op){case"array-contains-any":return K.value.arrayValue.values||[];case"array-contains":return[K.value]}return null}(l,c),d=function(P,q){const z=new Map;for(const K of wc(q))for(const I of Af(P,K.fieldPath))switch(I.op){case"==":case"in":z.set(K.fieldPath.canonicalString(),I.value);break;case"not-in":case"!=":return z.set(K.fieldPath.canonicalString(),I.value),Array.from(z.values())}return null}(l,c),g=function(P,q){const z=[];let K=!0;for(const I of wc(q)){const N=I.kind===0?ax(P,I.fieldPath,P.startAt):sx(P,I.fieldPath,P.startAt);z.push(N.value),K&&(K=N.inclusive)}return new iu(z,K)}(l,c),p=function(P,q){const z=[];let K=!0;for(const I of wc(q)){const N=I.kind===0?sx(P,I.fieldPath,P.endAt):ax(P,I.fieldPath,P.endAt);z.push(N.value),K&&(K=N.inclusive)}return new iu(z,K)}(l,c),y=this.In(c,l,g),v=this.In(c,l,p),w=this.Tn(c,l,d),E=this.En(c.indexId,u,y,g.inclusive,v,p.inclusive,w);return De.forEach(E,R=>n.G(R,t.limit).next(P=>{P.forEach(q=>{const z=vt.fromSegments(q.documentKey);i.has(z)||(i=i.add(z),o.push(z))})}))}).next(()=>o)}return De.resolve(null)})}hn(e){let t=this.ln.get(e);return t||(e.filters.length===0?t=[e]:t=lA(Dr.create(e.filters,"and")).map(n=>Um(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,t),t)}En(e,t,n,a,s,i,o){const c=(t!=null?t.length:1)*Math.max(n.length,s.length),l=c/(t!=null?t.length:1),u=[];for(let d=0;d<c;++d){const g=t?this.dn(t[d/l]):j0,p=this.An(e,g,n[d%l],a),y=this.Rn(e,g,s[d%l],i),v=o.map(w=>this.An(e,g,w,!0));u.push(...this.createRange(p,y,v))}return u}An(e,t,n,a){const s=new Ac(e,vt.empty(),t,n);return a?s:s.Zt()}Rn(e,t,n,a){const s=new Ac(e,vt.empty(),t,n);return a?s.Zt():s}Pn(e,t){const n=new Sx(t),a=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,a).next(s=>{let i=null;for(const o of s)n.rn(o)&&(!i||o.fields.length>i.fields.length)&&(i=o);return i})}getIndexType(e,t){let n=2;const a=this.hn(t);return De.forEach(a,s=>this.Pn(e,s).next(i=>{i?n!==0&&i.fields.length<function(c){let l=new jr(Qr.comparator),u=!1;for(const d of c.filters)for(const g of d.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?u=!0:l=l.add(g.field));for(const d of c.orderBy)d.field.isKeyField()||(l=l.add(d.field));return l.size+(u?1:0)}(s)&&(n=1):n=0})).next(()=>function(i){return i.limit!==null}(t)&&a.length>1&&n===2?1:n)}Vn(e,t){const n=new zu;for(const a of wc(e)){const s=t.data.field(a.fieldPath);if(s==null)return null;const i=n.Yt(a.kind);Sc.vt.It(s,i)}return n.zt()}dn(e){const t=new zu;return Sc.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){const n=new zu;return Sc.vt.It(Op(this.databaseId,t),n.Yt(function(s){const i=wc(s);return i.length===0?0:i[i.length-1].kind}(e))),n.zt()}Tn(e,t,n){if(n===null)return[];let a=[];a.push(new zu);let s=0;for(const i of wc(e)){const o=n[s++];for(const c of a)if(this.fn(t,i.fieldPath)&&Nh(o))a=this.gn(a,i,o);else{const l=c.Yt(i.kind);Sc.vt.It(o,l)}}return this.pn(a)}In(e,t,n){return this.Tn(e,t,n.position)}pn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].zt();return t}gn(e,t,n){const a=[...e],s=[];for(const i of n.arrayValue.values||[])for(const o of a){const c=new zu;c.seed(o.zt()),Sc.vt.It(i,c.Yt(t.kind)),s.push(c)}return s}fn(e,t){return!!e.filters.find(n=>n instanceof or&&n.field.isEqual(t)&&(n.op==="in"||n.op==="not-in"))}getFieldIndexes(e,t){const n=Wu(e),a=Pl(e);return(t?n.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):n.U()).next(s=>{const i=[];return De.forEach(s,o=>a.get([o.indexId,this.uid]).next(c=>{i.push(function(u,d){const g=d?new bh(d.sequenceNumber,new os(zc(d.readTime),new vt(li(d.documentKey)),d.largestBatchId)):bh.empty(),p=u.fields.map(([y,v])=>new af(Qr.fromServerFormat(y),v));return new bf(u.indexId,u.collectionGroup,p,g)}(o,c))})).next(()=>i)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((n,a)=>{const s=n.indexState.sequenceNumber-a.indexState.sequenceNumber;return s!==0?s:Xt(n.collectionGroup,a.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,n){const a=Wu(e),s=Pl(e);return this.yn(e).next(i=>a.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(o=>De.forEach(o,c=>s.put(yx(c.indexId,this.uid,i,n)))))}updateIndexEntries(e,t){const n=new Map;return De.forEach(t,(a,s)=>{const i=n.get(a.collectionGroup);return(i?De.resolve(i):this.getFieldIndexes(e,a.collectionGroup)).next(o=>(n.set(a.collectionGroup,o),De.forEach(o,c=>this.wn(e,a,c).next(l=>{const u=this.Sn(s,c);return l.isEqual(u)?De.resolve():this.bn(e,s,c,l,u)}))))})}Dn(e,t,n,a){return Cl(e).put({indexId:a.indexId,uid:this.uid,arrayValue:a.arrayValue,directionalValue:a.directionalValue,orderedDocumentKey:this.mn(n,t.key),documentKey:t.key.path.toArray()})}vn(e,t,n,a){return Cl(e).delete([a.indexId,this.uid,a.arrayValue,a.directionalValue,this.mn(n,t.key),t.key.path.toArray()])}wn(e,t,n){const a=Cl(e);let s=new jr(So);return a.J({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.mn(n,t)])},(i,o)=>{s=s.add(new Ac(n.indexId,t,o.arrayValue,o.directionalValue))}).next(()=>s)}Sn(e,t){let n=new jr(So);const a=this.Vn(t,e);if(a==null)return n;const s=Lm(t);if(s!=null){const i=e.data.field(s.fieldPath);if(Nh(i))for(const o of i.arrayValue.values||[])n=n.add(new Ac(t.indexId,e.key,this.dn(o),a))}else n=n.add(new Ac(t.indexId,e.key,j0,a));return n}bn(e,t,n,a,s){at("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const i=[];return function(c,l,u,d,g){const p=c.getIterator(),y=l.getIterator();let v=Il(p),w=Il(y);for(;v||w;){let E=!1,R=!1;if(v&&w){const P=u(v,w);P<0?R=!0:P>0&&(E=!0)}else v!=null?R=!0:E=!0;E?(d(w),w=Il(y)):R?(g(v),v=Il(p)):(v=Il(p),w=Il(y))}}(a,s,So,o=>{i.push(this.Dn(e,t,n,o))},o=>{i.push(this.vn(e,t,n,o))}),De.waitFor(i)}yn(e){let t=1;return Pl(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(n,a,s)=>{s.done(),t=a.sequenceNumber+1}).next(()=>t)}createRange(e,t,n){n=n.sort((i,o)=>So(i,o)).filter((i,o,c)=>!o||So(i,c[o-1])!==0);const a=[];a.push(e);for(const i of n){const o=So(i,e),c=So(i,t);if(o===0)a[0]=e.Zt();else if(o>0&&c<0)a.push(i),a.push(i.Zt());else if(c>0)break}a.push(t);const s=[];for(let i=0;i<a.length;i+=2){if(this.Cn(a[i],a[i+1]))return[];const o=[a[i].indexId,this.uid,a[i].arrayValue,a[i].directionalValue,j0,[]],c=[a[i+1].indexId,this.uid,a[i+1].arrayValue,a[i+1].directionalValue,j0,[]];s.push(IDBKeyRange.bound(o,c))}return s}Cn(e,t){return So(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Tx)}getMinOffset(e,t){return De.mapArray(this.hn(t),n=>this.Pn(e,n).next(a=>a||Tt())).next(Tx)}}function Nx(r){return Dn(r,"collectionParents")}function Cl(r){return Dn(r,"indexEntries")}function Wu(r){return Dn(r,"indexConfiguration")}function Pl(r){return Dn(r,"indexState")}function Tx(r){kt(r.length!==0);let e=r[0].indexState.offset,t=e.largestBatchId;for(let n=1;n<r.length;n++){const a=r[n].indexState.offset;Fp(a,e)<0&&(e=a),t<a.largestBatchId&&(t=a.largestBatchId)}return new os(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kx={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Va{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new Va(e,Va.DEFAULT_COLLECTION_PERCENTILE,Va.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p5(r,e,t){const n=r.store("mutations"),a=r.store("documentMutations"),s=[],i=IDBKeyRange.only(t.batchId);let o=0;const c=n.J({range:i},(u,d,g)=>(o++,g.delete()));s.push(c.next(()=>{kt(o===1)}));const l=[];for(const u of t.mutations){const d=_y(e,u.key.path,t.batchId);s.push(a.delete(d)),l.push(u.key)}return De.waitFor(s).next(()=>l)}function Cf(r){if(!r)return 0;let e;if(r.document)e=r.document;else if(r.unknownDocument)e=r.unknownDocument;else{if(!r.noDocument)throw Tt();e=r.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Va.DEFAULT_COLLECTION_PERCENTILE=10,Va.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Va.DEFAULT=new Va(41943040,Va.DEFAULT_COLLECTION_PERCENTILE,Va.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Va.DISABLED=new Va(-1,0,0);class cd{constructor(e,t,n,a){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=a,this.Fn={}}static lt(e,t,n,a){kt(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new cd(s,t,n,a)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ao(e).J({index:"userMutationsIndex",range:n},(a,s,i)=>{t=!1,i.done()}).next(()=>t)}addMutationBatch(e,t,n,a){const s=ql(e),i=Ao(e);return i.add({}).next(o=>{kt(typeof o=="number");const c=new Vp(o,t,n,a),l=function(p,y,v){const w=v.baseMutations.map(R=>Tf(p.ct,R)),E=v.mutations.map(R=>Tf(p.ct,R));return{userId:y,batchId:v.batchId,localWriteTimeMs:v.localWriteTime.toMillis(),baseMutations:w,mutations:E}}(this.serializer,this.userId,c),u=[];let d=new jr((g,p)=>Xt(g.canonicalString(),p.canonicalString()));for(const g of a){const p=_y(this.userId,g.key.path,o);d=d.add(g.key.path.popLast()),u.push(i.put(l)),u.push(s.put(p,WE))}return d.forEach(g=>{u.push(this.indexManager.addToCollectionParentIndex(e,g))}),e.addOnCommittedListener(()=>{this.Fn[o]=c.keys()}),De.waitFor(u).next(()=>c)})}lookupMutationBatch(e,t){return Ao(e).get(t).next(n=>n?(kt(n.userId===this.userId),Ec(this.serializer,n)):null)}Mn(e,t){return this.Fn[t]?De.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next(n=>{if(n){const a=n.keys();return this.Fn[t]=a,a}return null})}getNextMutationBatchAfterBatchId(e,t){const n=t+1,a=IDBKeyRange.lowerBound([this.userId,n]);let s=null;return Ao(e).J({index:"userMutationsIndex",range:a},(i,o,c)=>{o.userId===this.userId&&(kt(o.batchId>=n),s=Ec(this.serializer,o)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return Ao(e).J({index:"userMutationsIndex",range:t,reverse:!0},(a,s,i)=>{n=s.batchId,i.done()}).next(()=>n)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ao(e).U("userMutationsIndex",t).next(n=>n.map(a=>Ec(this.serializer,a)))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=sf(this.userId,t.path),a=IDBKeyRange.lowerBound(n),s=[];return ql(e).J({range:a},(i,o,c)=>{const[l,u,d]=i,g=li(u);if(l===this.userId&&t.path.isEqual(g))return Ao(e).get(d).next(p=>{if(!p)throw Tt();kt(p.userId===this.userId),s.push(Ec(this.serializer,p))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new jr(Xt);const a=[];return t.forEach(s=>{const i=sf(this.userId,s.path),o=IDBKeyRange.lowerBound(i),c=ql(e).J({range:o},(l,u,d)=>{const[g,p,y]=l,v=li(p);g===this.userId&&s.path.isEqual(v)?n=n.add(y):d.done()});a.push(c)}),De.waitFor(a).next(()=>this.xn(e,n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,a=n.length+1,s=sf(this.userId,n),i=IDBKeyRange.lowerBound(s);let o=new jr(Xt);return ql(e).J({range:i},(c,l,u)=>{const[d,g,p]=c,y=li(g);d===this.userId&&n.isPrefixOf(y)?y.length===a&&(o=o.add(p)):u.done()}).next(()=>this.xn(e,o))}xn(e,t){const n=[],a=[];return t.forEach(s=>{a.push(Ao(e).get(s).next(i=>{if(i===null)throw Tt();kt(i.userId===this.userId),n.push(Ec(this.serializer,i))}))}),De.waitFor(a).next(()=>n)}removeMutationBatch(e,t){return p5(e._e,this.userId,t).next(n=>(e.addOnCommittedListener(()=>{this.On(t.batchId)}),De.forEach(n,a=>this.referenceDelegate.markPotentiallyOrphaned(e,a))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return De.resolve();const n=IDBKeyRange.lowerBound(function(i){return[i]}(this.userId)),a=[];return ql(e).J({range:n},(s,i,o)=>{if(s[0]===this.userId){const c=li(s[1]);a.push(c)}else o.done()}).next(()=>{kt(a.length===0)})})}containsKey(e,t){return g5(e,this.userId,t)}Nn(e){return x5(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function g5(r,e,t){const n=sf(e,t.path),a=n[1],s=IDBKeyRange.lowerBound(n);let i=!1;return ql(r).J({range:s,H:!0},(o,c,l)=>{const[u,d,g]=o;u===e&&d===a&&(i=!0),l.done()}).next(()=>i)}function Ao(r){return Dn(r,"mutations")}function ql(r){return Dn(r,"documentMutations")}function x5(r){return Dn(r,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wc{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Wc(0)}static kn(){return new Wc(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fA{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next(t=>{const n=new Wc(t.highestTargetId);return t.highestTargetId=n.next(),this.Qn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(t=>Dt.fromTimestamp(new tn(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,n){return this.qn(e).next(a=>(a.highestListenSequenceNumber=t,n&&(a.lastRemoteSnapshotVersion=n.toTimestamp()),t>a.highestListenSequenceNumber&&(a.highestListenSequenceNumber=t),this.Qn(e,a)))}addTargetData(e,t){return this.Kn(e,t).next(()=>this.qn(e).next(n=>(n.targetCount+=1,this.$n(t,n),this.Qn(e,n))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Fl(e).delete(t.targetId)).next(()=>this.qn(e)).next(n=>(kt(n.targetCount>0),n.targetCount-=1,this.Qn(e,n)))}removeTargets(e,t,n){let a=0;const s=[];return Fl(e).J((i,o)=>{const c=eh(o);c.sequenceNumber<=t&&n.get(c.targetId)===null&&(a++,s.push(this.removeTargetData(e,c)))}).next(()=>De.waitFor(s)).next(()=>a)}forEachTarget(e,t){return Fl(e).J((n,a)=>{const s=eh(a);t(s)})}qn(e){return Ix(e).get("targetGlobalKey").next(t=>(kt(t!==null),t))}Qn(e,t){return Ix(e).put("targetGlobalKey",t)}Kn(e,t){return Fl(e).put(h5(this.serializer,t))}$n(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.qn(e).next(t=>t.targetCount)}getTargetData(e,t){const n=Uc(t),a=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let s=null;return Fl(e).J({range:a,index:"queryTargetsIndex"},(i,o,c)=>{const l=eh(o);Xh(t,l.target)&&(s=l,c.done())}).next(()=>s)}addMatchingKeys(e,t,n){const a=[],s=Co(e);return t.forEach(i=>{const o=ka(i.path);a.push(s.put({targetId:n,path:o})),a.push(this.referenceDelegate.addReference(e,n,i))}),De.waitFor(a)}removeMatchingKeys(e,t,n){const a=Co(e);return De.forEach(t,s=>{const i=ka(s.path);return De.waitFor([a.delete([n,i]),this.referenceDelegate.removeReference(e,n,s)])})}removeMatchingKeysForTargetId(e,t){const n=Co(e),a=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(a)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),a=Co(e);let s=er();return a.J({range:n,H:!0},(i,o,c)=>{const l=li(i[1]),u=new vt(l);s=s.add(u)}).next(()=>s)}containsKey(e,t){const n=ka(t.path),a=IDBKeyRange.bound([n],[gy(n)],!1,!0);let s=0;return Co(e).J({index:"documentTargetsIndex",H:!0,range:a},([i,o],c,l)=>{i!==0&&(s++,l.done())}).next(()=>s>0)}ot(e,t){return Fl(e).get(t).next(n=>n?eh(n):null)}}function Fl(r){return Dn(r,"targets")}function Ix(r){return Dn(r,"targetGlobal")}function Co(r){return Dn(r,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cx([r,e],[t,n]){const a=Xt(r,t);return a===0?Xt(e,n):a}class dA{constructor(e){this.Un=e,this.buffer=new jr(Cx),this.Wn=0}Gn(){return++this.Wn}zn(e){const t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();Cx(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class mA{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){at("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Xo(t)?at("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):await Jc(t)}await this.Hn(3e5)})}}class pA{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next(n=>Math.floor(t/100*n))}nthSequenceNumber(e,t){if(t===0)return De.resolve(Ss.oe);const n=new dA(t);return this.Jn.forEachTarget(e,a=>n.zn(a.sequenceNumber)).next(()=>this.Jn.Zn(e,a=>n.zn(a))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.Jn.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(at("LruGarbageCollector","Garbage collection skipped; disabled"),De.resolve(kx)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(at("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),kx):this.Xn(e,t))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let n,a,s,i,o,c,l;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(at("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),a=this.params.maximumSequenceNumbersToCollect):a=d,i=Date.now(),this.nthSequenceNumber(e,a))).next(d=>(n=d,o=Date.now(),this.removeTargets(e,n,t))).next(d=>(s=d,c=Date.now(),this.removeOrphanedDocuments(e,n))).next(d=>(l=Date.now(),Ml()<=fr.DEBUG&&at("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${i-u}ms
	Determined least recently used ${a} in `+(o-i)+`ms
	Removed ${s} targets in `+(c-o)+`ms
	Removed ${d} documents in `+(l-c)+`ms
Total Duration: ${l-u}ms`),De.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:s,documentsRemoved:d})))}}function gA(r,e){return new pA(r,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xA{constructor(e,t){this.db=e,this.garbageCollector=gA(this,t)}Yn(e){const t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(n=>t.next(a=>n+a))}er(e){let t=0;return this.Zn(e,n=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,(n,a)=>t(a))}addReference(e,t,n){return O0(e,n)}removeReference(e,t,n){return O0(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return O0(e,t)}nr(e,t){return function(a,s){let i=!1;return x5(a).Y(o=>g5(a,o,s).next(c=>(c&&(i=!0),De.resolve(!c)))).next(()=>i)}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),a=[];let s=0;return this.tr(e,(i,o)=>{if(o<=t){const c=this.nr(e,i).next(l=>{if(!l)return s++,n.getEntry(e,i).next(()=>(n.removeEntry(i,Dt.min()),Co(e).delete(function(d){return[0,ka(d.path)]}(i))))});a.push(c)}}).next(()=>De.waitFor(a)).next(()=>n.apply(e)).next(()=>s)}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return O0(e,t)}tr(e,t){const n=Co(e);let a,s=Ss.oe;return n.J({index:"documentTargetsIndex"},([i,o],{path:c,sequenceNumber:l})=>{i===0?(s!==Ss.oe&&t(new vt(li(a)),s),s=l,a=c):s=Ss.oe}).next(()=>{s!==Ss.oe&&t(new vt(li(a)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function O0(r,e){return Co(r).put(function(n,a){return{targetId:0,path:ka(n.path),sequenceNumber:a}}(e,r.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v5{constructor(){this.changes=new Yo(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,un.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?De.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vA{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return vc(e).put(n)}removeEntry(e,t,n){return vc(e).delete(function(s,i){const o=s.path.toArray();return[o.slice(0,o.length-2),o[o.length-2],kf(i),o[o.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next(n=>(n.byteSize+=t,this.rr(e,n)))}getEntry(e,t){let n=un.newInvalidDocument(t);return vc(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Hu(t))},(a,s)=>{n=this.ir(t,s)}).next(()=>n)}sr(e,t){let n={size:0,document:un.newInvalidDocument(t)};return vc(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Hu(t))},(a,s)=>{n={document:this.ir(t,s),size:Cf(s)}}).next(()=>n)}getEntries(e,t){let n=as();return this._r(e,t,(a,s)=>{const i=this.ir(a,s);n=n.insert(a,i)}).next(()=>n)}ar(e,t){let n=as(),a=new Yr(vt.comparator);return this._r(e,t,(s,i)=>{const o=this.ir(s,i);n=n.insert(s,o),a=a.insert(s,Cf(i))}).next(()=>({documents:n,ur:a}))}_r(e,t,n){if(t.isEmpty())return De.resolve();let a=new jr(Rx);t.forEach(c=>a=a.add(c));const s=IDBKeyRange.bound(Hu(a.first()),Hu(a.last())),i=a.getIterator();let o=i.getNext();return vc(e).J({index:"documentKeyIndex",range:s},(c,l,u)=>{const d=vt.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;o&&Rx(o,d)<0;)n(o,null),o=i.getNext();o&&o.isEqual(d)&&(n(o,l),o=i.hasNext()?i.getNext():null),o?u.$(Hu(o)):u.done()}).next(()=>{for(;o;)n(o,null),o=i.hasNext()?i.getNext():null})}getDocumentsMatchingQuery(e,t,n,a,s){const i=t.path,o=[i.popLast().toArray(),i.lastSegment(),kf(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],c=[i.popLast().toArray(),i.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return vc(e).U(IDBKeyRange.bound(o,c,!0)).next(l=>{s==null||s.incrementDocumentReadCount(l.length);let u=as();for(const d of l){const g=this.ir(vt.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);g.isFoundDocument()&&(Yh(t,g)||a.has(g.key))&&(u=u.insert(g.key,g))}return u})}getAllFromCollectionGroup(e,t,n,a){let s=as();const i=Fx(t,n),o=Fx(t,os.max());return vc(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(i,o,!0)},(c,l,u)=>{const d=this.ir(vt.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);s=s.insert(d.key,d),s.size===a&&u.done()}).next(()=>s)}newChangeBuffer(e){return new yA(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return Px(e).get("remoteDocumentGlobalKey").next(t=>(kt(!!t),t))}rr(e,t){return Px(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){const n=rA(this.serializer,t);if(!(n.isNoDocument()&&n.version.isEqual(Dt.min())))return n}return un.newInvalidDocument(e)}}function y5(r){return new vA(r)}class yA extends v5{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new Yo(n=>n.toString(),(n,a)=>n.isEqual(a))}applyChanges(e){const t=[];let n=0,a=new jr((s,i)=>Xt(s.canonicalString(),i.canonicalString()));return this.changes.forEach((s,i)=>{const o=this.lr.get(s);if(t.push(this.cr.removeEntry(e,s,o.readTime)),i.isValidDocument()){const c=xx(this.cr.serializer,i);a=a.add(s.path.popLast());const l=Cf(c);n+=l-o.size,t.push(this.cr.addEntry(e,s,c))}else if(n-=o.size,this.trackRemovals){const c=xx(this.cr.serializer,i.convertToNoDocument(Dt.min()));t.push(this.cr.addEntry(e,s,c))}}),a.forEach(s=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.cr.updateMetadata(e,n)),De.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next(n=>(this.lr.set(t,{size:n.size,readTime:n.document.readTime}),n.document))}getAllFromCache(e,t){return this.cr.ar(e,t).next(({documents:n,ur:a})=>(a.forEach((s,i)=>{this.lr.set(s,{size:i,readTime:n.get(s).readTime})}),n))}}function Px(r){return Dn(r,"remoteDocumentGlobal")}function vc(r){return Dn(r,"remoteDocumentsV14")}function Hu(r){const e=r.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Fx(r,e){const t=e.documentKey.path.toArray();return[r,kf(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function Rx(r,e){const t=r.path.toArray(),n=e.path.toArray();let a=0;for(let s=0;s<t.length-2&&s<n.length-2;++s)if(a=Xt(t[s],n[s]),a)return a;return a=Xt(t.length,n.length),a||(a=Xt(t[t.length-2],n[n.length-2]),a||Xt(t[t.length-1],n[n.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wA{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w5{constructor(e,t,n,a){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=a}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(a=>(n=a,this.remoteDocumentCache.getEntry(e,t))).next(a=>(n!==null&&lh(n.mutation,a,Ua.empty(),tn.now()),a))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,er()).next(()=>n))}getLocalViewOfDocuments(e,t,n=er()){const a=ui();return this.populateOverlays(e,a,t).next(()=>this.computeViews(e,t,a,n).next(s=>{let i=Qu();return s.forEach((o,c)=>{i=i.insert(o,c.overlayedDocument)}),i}))}getOverlayedDocuments(e,t){const n=ui();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,er()))}populateOverlays(e,t,n){const a=[];return n.forEach(s=>{t.has(s)||a.push(s)}),this.documentOverlayCache.getOverlays(e,a).next(s=>{s.forEach((i,o)=>{t.set(i,o)})})}computeViews(e,t,n,a){let s=as();const i=ch(),o=function(){return ch()}();return t.forEach((c,l)=>{const u=n.get(l.key);a.has(l.key)&&(u===void 0||u.mutation instanceof Gi)?s=s.insert(l.key,l):u!==void 0?(i.set(l.key,u.mutation.getFieldMask()),lh(u.mutation,l,u.mutation.getFieldMask(),tn.now())):i.set(l.key,Ua.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((l,u)=>i.set(l,u)),t.forEach((l,u)=>{var d;return o.set(l,new wA(u,(d=i.get(l))!==null&&d!==void 0?d:null))}),o))}recalculateAndSaveOverlays(e,t){const n=ch();let a=new Yr((i,o)=>i-o),s=er();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(i=>{for(const o of i)o.keys().forEach(c=>{const l=t.get(c);if(l===null)return;let u=n.get(c)||Ua.empty();u=o.applyToLocalView(l,u),n.set(c,u);const d=(a.get(o.batchId)||er()).add(c);a=a.insert(o.batchId,d)})}).next(()=>{const i=[],o=a.getReverseIterator();for(;o.hasNext();){const c=o.getNext(),l=c.key,u=c.value,d=Uy();u.forEach(g=>{if(!s.has(g)){const p=$y(t.get(g),n.get(g));p!==null&&d.set(g,p),s=s.add(g)}}),i.push(this.documentOverlayCache.saveOverlays(e,l,d))}return De.waitFor(i)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n,a){return function(i){return vt.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):_S(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,a):this.getDocumentsMatchingCollectionQuery(e,t,n,a)}getNextDocuments(e,t,n,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,a).next(s=>{const i=a-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,a-s.size):De.resolve(ui());let o=-1,c=s;return i.next(l=>De.forEach(l,(u,d)=>(o<d.largestBatchId&&(o=d.largestBatchId),s.get(u)?De.resolve():this.remoteDocumentCache.getEntry(e,u).next(g=>{c=c.insert(u,g)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,c,l,er())).next(u=>({batchId:o,changes:Vy(u)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new vt(t)).next(n=>{let a=Qu();return n.isFoundDocument()&&(a=a.insert(n.key,n)),a})}getDocumentsMatchingCollectionGroupQuery(e,t,n,a){const s=t.collectionGroup;let i=Qu();return this.indexManager.getCollectionParents(e,s).next(o=>De.forEach(o,c=>{const l=function(d,g){return new td(g,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,n,a).next(u=>{u.forEach((d,g)=>{i=i.insert(d,g)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,t,n,a){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(i=>(s=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,s,a))).next(i=>{s.forEach((c,l)=>{const u=l.getKey();i.get(u)===null&&(i=i.insert(u,un.newInvalidDocument(u)))});let o=Qu();return i.forEach((c,l)=>{const u=s.get(c);u!==void 0&&lh(u.mutation,l,Ua.empty(),tn.now()),Yh(t,l)&&(o=o.insert(c,l))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _A{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return De.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(a){return{id:a.id,version:a.version,createTime:Ia(a.createTime)}}(t)),De.resolve()}getNamedQuery(e,t){return De.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(a){return{name:a.name,query:f5(a.bundledQuery),readTime:Ia(a.readTime)}}(t)),De.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bA{constructor(){this.overlays=new Yr(vt.comparator),this.Ir=new Map}getOverlay(e,t){return De.resolve(this.overlays.get(t))}getOverlays(e,t){const n=ui();return De.forEach(t,a=>this.getOverlay(e,a).next(s=>{s!==null&&n.set(a,s)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((a,s)=>{this.ht(e,t,s)}),De.resolve()}removeOverlaysForBatchId(e,t,n){const a=this.Ir.get(n);return a!==void 0&&(a.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(n)),De.resolve()}getOverlaysForCollection(e,t,n){const a=ui(),s=t.length+1,i=new vt(t.child("")),o=this.overlays.getIteratorFrom(i);for(;o.hasNext();){const c=o.getNext().value,l=c.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>n&&a.set(c.getKey(),c)}return De.resolve(a)}getOverlaysForCollectionGroup(e,t,n,a){let s=new Yr((l,u)=>l-u);const i=this.overlays.getIterator();for(;i.hasNext();){const l=i.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>n){let u=s.get(l.largestBatchId);u===null&&(u=ui(),s=s.insert(l.largestBatchId,u)),u.set(l.getKey(),l)}}const o=ui(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,u)=>o.set(l,u)),!(o.size()>=a)););return De.resolve(o)}ht(e,t,n){const a=this.overlays.get(n.key);if(a!==null){const i=this.Ir.get(a.largestBatchId).delete(n.key);this.Ir.set(a.largestBatchId,i)}this.overlays=this.overlays.insert(n.key,new qp(t,n));let s=this.Ir.get(t);s===void 0&&(s=er(),this.Ir.set(t,s)),this.Ir.set(t,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EA{constructor(){this.sessionToken=kn.EMPTY_BYTE_STRING}getSessionToken(e){return De.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,De.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $p{constructor(){this.Tr=new jr(Mn.Er),this.dr=new jr(Mn.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const n=new Mn(e,t);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.Vr(new Mn(e,t))}mr(e,t){e.forEach(n=>this.removeReference(n,t))}gr(e){const t=new vt(new Nr([])),n=new Mn(t,e),a=new Mn(t,e+1),s=[];return this.dr.forEachInRange([n,a],i=>{this.Vr(i),s.push(i.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new vt(new Nr([])),n=new Mn(t,e),a=new Mn(t,e+1);let s=er();return this.dr.forEachInRange([n,a],i=>{s=s.add(i.key)}),s}containsKey(e){const t=new Mn(e,0),n=this.Tr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class Mn{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return vt.comparator(e.key,t.key)||Xt(e.wr,t.wr)}static Ar(e,t){return Xt(e.wr,t.wr)||vt.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SA{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new jr(Mn.Er)}checkEmpty(e){return De.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,a){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const i=new Vp(s,t,n,a);this.mutationQueue.push(i);for(const o of a)this.br=this.br.add(new Mn(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return De.resolve(i)}lookupMutationBatch(e,t){return De.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,a=this.vr(n),s=a<0?0:a;return De.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return De.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return De.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Mn(t,0),a=new Mn(t,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([n,a],i=>{const o=this.Dr(i.wr);s.push(o)}),De.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new jr(Xt);return t.forEach(a=>{const s=new Mn(a,0),i=new Mn(a,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,i],o=>{n=n.add(o.wr)})}),De.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,a=n.length+1;let s=n;vt.isDocumentKey(s)||(s=s.child(""));const i=new Mn(new vt(s),0);let o=new jr(Xt);return this.br.forEachWhile(c=>{const l=c.key.path;return!!n.isPrefixOf(l)&&(l.length===a&&(o=o.add(c.wr)),!0)},i),De.resolve(this.Cr(o))}Cr(e){const t=[];return e.forEach(n=>{const a=this.Dr(n);a!==null&&t.push(a)}),t}removeMutationBatch(e,t){kt(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return De.forEach(t.mutations,a=>{const s=new Mn(a.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,t){const n=new Mn(t,0),a=this.br.firstAfterOrEqual(n);return De.resolve(t.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,De.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AA{constructor(e){this.Mr=e,this.docs=function(){return new Yr(vt.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,a=this.docs.get(n),s=a?a.size:0,i=this.Mr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:i}),this.size+=i-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return De.resolve(n?n.document.mutableCopy():un.newInvalidDocument(t))}getEntries(e,t){let n=as();return t.forEach(a=>{const s=this.docs.get(a);n=n.insert(a,s?s.document.mutableCopy():un.newInvalidDocument(a))}),De.resolve(n)}getDocumentsMatchingQuery(e,t,n,a){let s=as();const i=t.path,o=new vt(i.child("")),c=this.docs.getIteratorFrom(o);for(;c.hasNext();){const{key:l,value:{document:u}}=c.getNext();if(!i.isPrefixOf(l.path))break;l.path.length>i.length+1||Fp(xy(u),n)<=0||(a.has(u.key)||Yh(t,u))&&(s=s.insert(u.key,u.mutableCopy()))}return De.resolve(s)}getAllFromCollectionGroup(e,t,n,a){Tt()}Or(e,t){return De.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new NA(this)}getSize(e){return De.resolve(this.size)}}class NA extends v5{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach((n,a)=>{a.isValidDocument()?t.push(this.cr.addEntry(e,a)):this.cr.removeEntry(n)}),De.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TA{constructor(e){this.persistence=e,this.Nr=new Yo(t=>Uc(t),Xh),this.lastRemoteSnapshotVersion=Dt.min(),this.highestTargetId=0,this.Lr=0,this.Br=new $p,this.targetCount=0,this.kr=Wc.Bn()}forEachTarget(e,t){return this.Nr.forEach((n,a)=>t(a)),De.resolve()}getLastRemoteSnapshotVersion(e){return De.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return De.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),De.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Lr&&(this.Lr=t),De.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new Wc(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,De.resolve()}updateTargetData(e,t){return this.Kn(t),De.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,De.resolve()}removeTargets(e,t,n){let a=0;const s=[];return this.Nr.forEach((i,o)=>{o.sequenceNumber<=t&&n.get(o.targetId)===null&&(this.Nr.delete(i),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),a++)}),De.waitFor(s).next(()=>a)}getTargetCount(e){return De.resolve(this.targetCount)}getTargetData(e,t){const n=this.Nr.get(t)||null;return De.resolve(n)}addMatchingKeys(e,t,n){return this.Br.Rr(t,n),De.resolve()}removeMatchingKeys(e,t,n){this.Br.mr(t,n);const a=this.persistence.referenceDelegate,s=[];return a&&t.forEach(i=>{s.push(a.markPotentiallyOrphaned(e,i))}),De.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),De.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Br.yr(t);return De.resolve(n)}containsKey(e,t){return De.resolve(this.Br.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _5{constructor(e,t){this.qr={},this.overlays={},this.Qr=new Ss(0),this.Kr=!1,this.Kr=!0,this.$r=new EA,this.referenceDelegate=e(this),this.Ur=new TA(this),this.indexManager=new uA,this.remoteDocumentCache=function(a){return new AA(a)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new u5(t),this.Gr=new _A(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new bA,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.qr[e.toKey()];return n||(n=new SA(t,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,n){at("MemoryPersistence","Starting transaction:",e);const a=new kA(this.Qr.next());return this.referenceDelegate.zr(),n(a).next(s=>this.referenceDelegate.jr(a).next(()=>s)).toPromise().then(s=>(a.raiseOnCommittedEvent(),s))}Hr(e,t){return De.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,t)))}}class kA extends yy{constructor(e){super(),this.currentSequenceNumber=e}}class ld{constructor(e){this.persistence=e,this.Jr=new $p,this.Yr=null}static Zr(e){return new ld(e)}get Xr(){if(this.Yr)return this.Yr;throw Tt()}addReference(e,t,n){return this.Jr.addReference(n,t),this.Xr.delete(n.toString()),De.resolve()}removeReference(e,t,n){return this.Jr.removeReference(n,t),this.Xr.add(n.toString()),De.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),De.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(a=>this.Xr.add(a.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(a=>{a.forEach(s=>this.Xr.add(s.toString()))}).next(()=>n.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return De.forEach(this.Xr,n=>{const a=vt.fromPath(n);return this.ei(e,a).next(s=>{s||t.removeEntry(a,Dt.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(n=>{n?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return De.or([()=>De.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IA{constructor(e){this.serializer=e}O(e,t,n,a){const s=new Qf("createOrUpgrade",t);n<1&&a>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",$g,{unique:!0}),c.createObjectStore("documentMutations")}(e),Dx(e),function(c){c.createObjectStore("remoteDocuments")}(e));let i=De.resolve();return n<3&&a>=3&&(n!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),Dx(e)),i=i.next(()=>function(c){const l=c.store("targetGlobal"),u={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Dt.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",u)}(s))),n<4&&a>=4&&(n!==0&&(i=i.next(()=>function(c,l){return l.store("mutations").U().next(u=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",$g,{unique:!0});const d=l.store("mutations"),g=u.map(p=>d.put(p));return De.waitFor(g)})}(e,s))),i=i.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),n<5&&a>=5&&(i=i.next(()=>this.ni(s))),n<6&&a>=6&&(i=i.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ri(s)))),n<7&&a>=7&&(i=i.next(()=>this.ii(s))),n<8&&a>=8&&(i=i.next(()=>this.si(e,s))),n<9&&a>=9&&(i=i.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),n<10&&a>=10&&(i=i.next(()=>this.oi(s))),n<11&&a>=11&&(i=i.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),n<12&&a>=12&&(i=i.next(()=>{(function(c){const l=c.createObjectStore("documentOverlays",{keyPath:rS});l.createIndex("collectionPathOverlayIndex",nS,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",aS,{unique:!1})})(e)})),n<13&&a>=13&&(i=i.next(()=>function(c){const l=c.createObjectStore("remoteDocumentsV14",{keyPath:HE});l.createIndex("documentKeyIndex",GE),l.createIndex("collectionGroupIndex",$E)}(e)).next(()=>this._i(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),n<14&&a>=14&&(i=i.next(()=>this.ai(e,s))),n<15&&a>=15&&(i=i.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:QE}).createIndex("sequenceNumberIndex",ZE,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:eS}).createIndex("documentKeyIndex",tS,{unique:!1})}(e))),n<16&&a>=16&&(i=i.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),n<17&&a>=17&&(i=i.next(()=>{(function(c){c.createObjectStore("globals",{keyPath:"name"})})(e)})),i}ri(e){let t=0;return e.store("remoteDocuments").J((n,a)=>{t+=Cf(a)}).next(()=>{const n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)})}ni(e){const t=e.store("mutationQueues"),n=e.store("mutations");return t.U().next(a=>De.forEach(a,s=>{const i=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return n.U("userMutationsIndex",i).next(o=>De.forEach(o,c=>{kt(c.userId===s.userId);const l=Ec(this.serializer,c);return p5(e,s.userId,l).next(()=>{})}))}))}ii(e){const t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(a=>{const s=[];return n.J((i,o)=>{const c=new Nr(i),l=function(d){return[0,ka(d)]}(c);s.push(t.get(l).next(u=>u?De.resolve():(d=>t.put({targetId:0,path:ka(d),sequenceNumber:a.highestListenSequenceNumber}))(c)))}).next(()=>De.waitFor(s))})}si(e,t){e.createObjectStore("collectionParents",{keyPath:JE});const n=t.store("collectionParents"),a=new Gp,s=i=>{if(a.add(i)){const o=i.lastSegment(),c=i.popLast();return n.put({collectionId:o,parent:ka(c)})}};return t.store("remoteDocuments").J({H:!0},(i,o)=>{const c=new Nr(i);return s(c.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([i,o,c],l)=>{const u=li(o);return s(u.popLast())}))}oi(e){const t=e.store("targets");return t.J((n,a)=>{const s=eh(a),i=h5(this.serializer,s);return t.put(i)})}_i(e,t){const n=t.store("remoteDocuments"),a=[];return n.J((s,i)=>{const o=t.store("remoteDocumentsV14"),c=function(d){return d.document?new vt(Nr.fromString(d.document.name).popFirst(5)):d.noDocument?vt.fromSegments(d.noDocument.path):d.unknownDocument?vt.fromSegments(d.unknownDocument.path):Tt()}(i).path.toArray(),l={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:i.readTime||[0,0],unknownDocument:i.unknownDocument,noDocument:i.noDocument,document:i.document,hasCommittedMutations:!!i.hasCommittedMutations};a.push(o.put(l))}).next(()=>De.waitFor(a))}ai(e,t){const n=t.store("mutations"),a=y5(this.serializer),s=new _5(ld.Zr,this.serializer.ct);return n.U().next(i=>{const o=new Map;return i.forEach(c=>{var l;let u=(l=o.get(c.userId))!==null&&l!==void 0?l:er();Ec(this.serializer,c).keys().forEach(d=>u=u.add(d)),o.set(c.userId,u)}),De.forEach(o,(c,l)=>{const u=new Yn(l),d=od.lt(this.serializer,u),g=s.getIndexManager(u),p=cd.lt(u,this.serializer,g,s.referenceDelegate);return new w5(a,p,d,g).recalculateAndSaveOverlaysForDocumentKeys(new jm(t,Ss.oe),c).next()})})}}function Dx(r){r.createObjectStore("targetDocuments",{keyPath:XE}).createIndex("documentTargetsIndex",YE,{unique:!0}),r.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",KE,{unique:!0}),r.createObjectStore("targetGlobal")}const em="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Kp{constructor(e,t,n,a,s,i,o,c,l,u,d=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.ui=s,this.window=i,this.document=o,this.ci=l,this.li=u,this.hi=d,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=g=>Promise.resolve(),!Kp.D())throw new wt(Ge.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new xA(this,a),this.Ai=t+"main",this.serializer=new u5(c),this.Ri=new Mo(this.Ai,this.hi,new IA(this.serializer)),this.$r=new aA,this.Ur=new fA(this.referenceDelegate,this.serializer),this.remoteDocumentCache=y5(this.serializer),this.Gr=new nA,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,u===!1&&Ta("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new wt(Ge.FAILED_PRECONDITION,em);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new Ss(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>M0(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(t=>{t||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(t=>this.isPrimary&&!t?this.bi(e).next(()=>!1):!!t&&this.Di(e).next(()=>!0))).catch(e=>{if(Xo(e))return at("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return at("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return Gu(e).get("owner").next(t=>De.resolve(this.vi(t)))}Ci(e){return M0(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const n=Dn(t,"clientMetadata");return n.U().next(a=>{const s=this.xi(a,18e5),i=a.filter(o=>s.indexOf(o)===-1);return De.forEach(i,o=>n.delete(o.clientId)).next(()=>i)})}).catch(()=>[]);if(this.Vi)for(const t of e)this.Vi.removeItem(this.Oi(t.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?De.resolve(!0):Gu(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new wt(Ge.FAILED_PRECONDITION,em);return!1}}return!(!this.networkEnabled||!this.inForeground)||M0(e).U().next(n=>this.xi(n,5e3).find(a=>{if(this.clientId!==a.clientId){const s=!this.networkEnabled&&a.networkEnabled,i=!this.inForeground&&a.inForeground,o=this.networkEnabled===a.networkEnabled;if(s||i&&o)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&at("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const t=new jm(e,Ss.oe);return this.bi(t).next(()=>this.Ci(t))}),this.Ri.close(),this.qi()}xi(e,t){return e.filter(n=>this.Mi(n.updateTimeMs,t)&&!this.Ni(n.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>M0(e).U().next(t=>this.xi(t,18e5).map(n=>n.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return cd.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new hA(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return od.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,n){at("IndexedDbPersistence","Starting transaction:",e);const a=t==="readonly"?"readonly":"readwrite",s=function(c){return c===17?oS:c===16?iS:c===15?Dp:c===14?Sy:c===13?Ey:c===12?sS:c===11?by:void Tt()}(this.hi);let i;return this.Ri.runTransaction(e,a,s,o=>(i=new jm(o,this.Qr?this.Qr.next():Ss.oe),t==="readwrite-primary"?this.wi(i).next(c=>!!c||this.Si(i)).next(c=>{if(!c)throw Ta(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new wt(Ge.FAILED_PRECONDITION,vy);return n(i)}).next(c=>this.Di(i).next(()=>c)):this.Ki(i).next(()=>n(i)))).then(o=>(i.raiseOnCommittedEvent(),o))}Ki(e){return Gu(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)&&!this.vi(t)&&!(this.li||this.allowTabSynchronization&&t.allowTabSynchronization))throw new wt(Ge.FAILED_PRECONDITION,em)})}Di(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Gu(e).put("owner",t)}static D(){return Mo.D()}bi(e){const t=Gu(e);return t.get("owner").next(n=>this.vi(n)?(at("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):De.resolve())}Mi(e,t){const n=Date.now();return!(e<n-t)&&(!(e>n)||(Ta(`Detected an update time that is in the future: ${e} > ${n}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const t=/(?:Version|Mobile)\/1[456]/;Zv()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{const n=((t=this.Vi)===null||t===void 0?void 0:t.getItem(this.Oi(e)))!==null;return at("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return Ta("IndexedDbPersistence","Failed to get zombied client id.",n),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){Ta("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Gu(r){return Dn(r,"owner")}function M0(r){return Dn(r,"clientMetadata")}function CA(r,e){let t=r.projectId;return r.isDefaultDatabase||(t+="."+r.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xp{constructor(e,t,n,a){this.targetId=e,this.fromCache=t,this.$i=n,this.Ui=a}static Wi(e,t){let n=er(),a=er();for(const s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:a=a.add(s.doc.key)}return new Xp(e,t.fromCache,n,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PA{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b5{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return Zv()?8:wy(yf())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,n,a){const s={result:null};return this.Yi(e,t).next(i=>{s.result=i}).next(()=>{if(!s.result)return this.Zi(e,t,a,n).next(i=>{s.result=i})}).next(()=>{if(s.result)return;const i=new PA;return this.Xi(e,t,i).next(o=>{if(s.result=o,this.zi)return this.es(e,t,i,o.size)})}).next(()=>s.result)}es(e,t,n,a){return n.documentReadCount<this.ji?(Ml()<=fr.DEBUG&&at("QueryEngine","SDK will not create cache indexes for query:",Bl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),De.resolve()):(Ml()<=fr.DEBUG&&at("QueryEngine","Query:",Bl(t),"scans",n.documentReadCount,"local documents and returns",a,"documents as results."),n.documentReadCount>this.Hi*a?(Ml()<=fr.DEBUG&&at("QueryEngine","The SDK decides to create cache indexes for query:",Bl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,As(t))):De.resolve())}Yi(e,t){if(ix(t))return De.resolve(null);let n=As(t);return this.indexManager.getIndexType(e,n).next(a=>a===0?null:(t.limit!==null&&a===1&&(t=qm(t,null,"F"),n=As(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const i=er(...s);return this.Ji.getDocuments(e,i).next(o=>this.indexManager.getMinOffset(e,n).next(c=>{const l=this.ts(t,o);return this.ns(t,l,i,c.readTime)?this.Yi(e,qm(t,null,"F")):this.rs(e,l,t,c)}))})))}Zi(e,t,n,a){return ix(t)||a.isEqual(Dt.min())?De.resolve(null):this.Ji.getDocuments(e,n).next(s=>{const i=this.ts(t,s);return this.ns(t,i,n,a)?De.resolve(null):(Ml()<=fr.DEBUG&&at("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),Bl(t)),this.rs(e,i,t,OE(a,-1)).next(o=>o))})}ts(e,t){let n=new jr(My(e));return t.forEach((a,s)=>{Yh(e,s)&&(n=n.add(s))}),n}ns(e,t,n,a){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(a)>0)}Xi(e,t,n){return Ml()<=fr.DEBUG&&at("QueryEngine","Using full collection scan to execute query:",Bl(t)),this.Ji.getDocumentsMatchingQuery(e,t,os.min(),n)}rs(e,t,n,a){return this.Ji.getDocumentsMatchingQuery(e,n,a).next(s=>(t.forEach(i=>{s=s.insert(i.key,i)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FA{constructor(e,t,n,a){this.persistence=e,this.ss=t,this.serializer=a,this.os=new Yr(Xt),this._s=new Yo(s=>Uc(s),Xh),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new w5(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}}function E5(r,e,t,n){return new FA(r,e,t,n)}async function S5(r,e){const t=Ht(r);return await t.persistence.runTransaction("Handle user change","readonly",n=>{let a;return t.mutationQueue.getAllMutationBatches(n).next(s=>(a=s,t.ls(e),t.mutationQueue.getAllMutationBatches(n))).next(s=>{const i=[],o=[];let c=er();for(const l of a){i.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}for(const l of s){o.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}return t.localDocuments.getDocuments(n,c).next(l=>({hs:l,removedBatchIds:i,addedBatchIds:o}))})})}function RA(r,e){const t=Ht(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const a=e.batch.keys(),s=t.cs.newChangeBuffer({trackRemovals:!0});return function(o,c,l,u){const d=l.batch,g=d.keys();let p=De.resolve();return g.forEach(y=>{p=p.next(()=>u.getEntry(c,y)).next(v=>{const w=l.docVersions.get(y);kt(w!==null),v.version.compareTo(w)<0&&(d.applyToRemoteDocument(v,l),v.isValidDocument()&&(v.setReadTime(l.commitVersion),u.addEntry(v)))})}),p.next(()=>o.mutationQueue.removeMutationBatch(c,d))}(t,n,e,s).next(()=>s.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,a,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let c=er();for(let l=0;l<o.mutationResults.length;++l)o.mutationResults[l].transformResults.length>0&&(c=c.add(o.batch.mutations[l].key));return c}(e))).next(()=>t.localDocuments.getDocuments(n,a))})}function A5(r){const e=Ht(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function DA(r,e){const t=Ht(r),n=e.snapshotVersion;let a=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const i=t.cs.newChangeBuffer({trackRemovals:!0});a=t.os;const o=[];e.targetChanges.forEach((u,d)=>{const g=a.get(d);if(!g)return;o.push(t.Ur.removeMatchingKeys(s,u.removedDocuments,d).next(()=>t.Ur.addMatchingKeys(s,u.addedDocuments,d)));let p=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(d)!==null?p=p.withResumeToken(kn.EMPTY_BYTE_STRING,Dt.min()).withLastLimboFreeSnapshotVersion(Dt.min()):u.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(u.resumeToken,n)),a=a.insert(d,p),function(v,w,E){return v.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=3e8?!0:E.addedDocuments.size+E.modifiedDocuments.size+E.removedDocuments.size>0}(g,p,u)&&o.push(t.Ur.updateTargetData(s,p))});let c=as(),l=er();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&o.push(t.persistence.referenceDelegate.updateLimboDocument(s,u))}),o.push(LA(s,i,e.documentUpdates).next(u=>{c=u.Ps,l=u.Is})),!n.isEqual(Dt.min())){const u=t.Ur.getLastRemoteSnapshotVersion(s).next(d=>t.Ur.setTargetsMetadata(s,s.currentSequenceNumber,n));o.push(u)}return De.waitFor(o).next(()=>i.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(t.os=a,s))}function LA(r,e,t){let n=er(),a=er();return t.forEach(s=>n=n.add(s)),e.getEntries(r,n).next(s=>{let i=as();return t.forEach((o,c)=>{const l=s.get(o);c.isFoundDocument()!==l.isFoundDocument()&&(a=a.add(o)),c.isNoDocument()&&c.version.isEqual(Dt.min())?(e.removeEntry(o,c.readTime),i=i.insert(o,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),i=i.insert(o,c)):at("LocalStore","Ignoring outdated watch update for ",o,". Current version:",l.version," Watch version:",c.version)}),{Ps:i,Is:a}})}function jA(r,e){const t=Ht(r);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function OA(r,e){const t=Ht(r);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let a;return t.Ur.getTargetData(n,e).next(s=>s?(a=s,De.resolve(a)):t.Ur.allocateTargetId(n).next(i=>(a=new Oi(e,i,"TargetPurposeListen",n.currentSequenceNumber),t.Ur.addTargetData(n,a).next(()=>a))))}).then(n=>{const a=t.os.get(n.targetId);return(a===null||n.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(t.os=t.os.insert(n.targetId,n),t._s.set(e,n.targetId)),n})}async function Ym(r,e,t){const n=Ht(r),a=n.os.get(e),s=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",s,i=>n.persistence.referenceDelegate.removeTarget(i,a))}catch(i){if(!Xo(i))throw i;at("LocalStore",`Failed to update sequence numbers for target ${e}: ${i}`)}n.os=n.os.remove(e),n._s.delete(a.target)}function Lx(r,e,t){const n=Ht(r);let a=Dt.min(),s=er();return n.persistence.runTransaction("Execute query","readwrite",i=>function(c,l,u){const d=Ht(c),g=d._s.get(u);return g!==void 0?De.resolve(d.os.get(g)):d.Ur.getTargetData(l,u)}(n,i,As(e)).next(o=>{if(o)return a=o.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(i,o.targetId).next(c=>{s=c})}).next(()=>n.ss.getDocumentsMatchingQuery(i,e,t?a:Dt.min(),t?s:er())).next(o=>(MA(n,ES(e),o),{documents:o,Ts:s})))}function MA(r,e,t){let n=r.us.get(e)||Dt.min();t.forEach((a,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),r.us.set(e,n)}class jx{constructor(){this.activeTargetIds=IS()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class N5{constructor(){this.so=new jx,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,n){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new jx,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BA{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ox{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){at("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){at("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let B0=null;function tm(){return B0===null?B0=function(){return 268435456+Math.round(2147483648*Math.random())}():B0++,"0x"+B0.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VA={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UA{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const na="WebChannelConnection";class qA extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const n=t.ssl?"https":"http",a=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+t.host,this.vo=`projects/${a}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${a}`:`project_id=${a}&database_id=${s}`}get Fo(){return!1}Mo(t,n,a,s,i){const o=tm(),c=this.xo(t,n.toUriEncodedString());at("RestConnection",`Sending RPC '${t}' ${o}:`,c,a);const l={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(l,s,i),this.No(t,c,l,a).then(u=>(at("RestConnection",`Received RPC '${t}' ${o}: `,u),u),u=>{throw Mc("RestConnection",`RPC '${t}' ${o} failed with error: `,u,"url: ",c,"request:",a),u})}Lo(t,n,a,s,i,o){return this.Mo(t,n,a,s,i)}Oo(t,n,a){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+vu}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>t[i]=s),a&&a.headers.forEach((s,i)=>t[i]=s)}xo(t,n){const a=VA[t];return`${this.Do}/v1/${n}:${a}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,n,a){const s=tm();return new Promise((i,o)=>{const c=new ly;c.setWithCredentials(!0),c.listenOnce(uy.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case nf.NO_ERROR:const u=c.getResponseJson();at(na,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(u)),i(u);break;case nf.TIMEOUT:at(na,`RPC '${e}' ${s} timed out`),o(new wt(Ge.DEADLINE_EXCEEDED,"Request time out"));break;case nf.HTTP_ERROR:const d=c.getStatus();if(at(na,`RPC '${e}' ${s} failed with status:`,d,"response text:",c.getResponseText()),d>0){let g=c.getResponseJson();Array.isArray(g)&&(g=g[0]);const p=g==null?void 0:g.error;if(p&&p.status&&p.message){const y=function(w){const E=w.toLowerCase().replace(/_/g,"-");return Object.values(Ge).indexOf(E)>=0?E:Ge.UNKNOWN}(p.status);o(new wt(y,p.message))}else o(new wt(Ge.UNKNOWN,"Server responded with status "+c.getStatus()))}else o(new wt(Ge.UNAVAILABLE,"Connection failed."));break;default:Tt()}}finally{at(na,`RPC '${e}' ${s} completed.`)}});const l=JSON.stringify(a);at(na,`RPC '${e}' ${s} sending request:`,a),c.send(t,"POST",l,n,15)})}Bo(e,t,n){const a=tm(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=dy(),o=fy(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,t,n),c.encodeInitMessageHeaders=!0;const u=s.join("");at(na,`Creating RPC '${e}' stream ${a}: ${u}`,c);const d=i.createWebChannel(u,c);let g=!1,p=!1;const y=new UA({Io:w=>{p?at(na,`Not sending because RPC '${e}' stream ${a} is closed:`,w):(g||(at(na,`Opening RPC '${e}' stream ${a} transport.`),d.open(),g=!0),at(na,`RPC '${e}' stream ${a} sending:`,w),d.send(w))},To:()=>d.close()}),v=(w,E,R)=>{w.listen(E,P=>{try{R(P)}catch(q){setTimeout(()=>{throw q},0)}})};return v(d,Ju.EventType.OPEN,()=>{p||(at(na,`RPC '${e}' stream ${a} transport opened.`),y.yo())}),v(d,Ju.EventType.CLOSE,()=>{p||(p=!0,at(na,`RPC '${e}' stream ${a} transport closed`),y.So())}),v(d,Ju.EventType.ERROR,w=>{p||(p=!0,Mc(na,`RPC '${e}' stream ${a} transport errored:`,w),y.So(new wt(Ge.UNAVAILABLE,"The operation could not be completed")))}),v(d,Ju.EventType.MESSAGE,w=>{var E;if(!p){const R=w.data[0];kt(!!R);const P=R,q=P.error||((E=P[0])===null||E===void 0?void 0:E.error);if(q){at(na,`RPC '${e}' stream ${a} received error:`,q);const z=q.status;let K=function(F){const j=An[F];if(j!==void 0)return Yy(j)}(z),I=q.message;K===void 0&&(K=Ge.INTERNAL,I="Unknown error status: "+z+" with message "+q.message),p=!0,y.So(new wt(K,I)),d.close()}else at(na,`RPC '${e}' stream ${a} received:`,R),y.bo(R)}}),v(o,hy.STAT_EVENT,w=>{w.stat===Dm.PROXY?at(na,`RPC '${e}' stream ${a} detected buffering proxy`):w.stat===Dm.NOPROXY&&at(na,`RPC '${e}' stream ${a} detected no buffering proxy`)}),setTimeout(()=>{y.wo()},0),y}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zA(){return typeof window<"u"?window:null}function hf(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ud(r){return new GS(r,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T5{constructor(e,t,n=1e3,a=1.5,s=6e4){this.ui=e,this.timerId=t,this.ko=n,this.qo=a,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),a=Math.max(0,t-n);a>0&&at("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,a,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k5{constructor(e,t,n,a,s,i,o,c){this.ui=e,this.Ho=n,this.Jo=a,this.connection=s,this.authCredentialsProvider=i,this.appCheckCredentialsProvider=o,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new T5(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===Ge.RESOURCE_EXHAUSTED?(Ta(t.toString()),Ta("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===Ge.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,a])=>{this.Yo===t&&this.P_(n,a)},n=>{e(()=>{const a=new wt(Ge.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(a)})})}P_(e,t){const n=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(a=>{n(()=>this.I_(a))}),this.stream.onMessage(a=>{n(()=>++this.e_==1?this.E_(a):this.onNext(a))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return at("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(at("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class WA extends k5{constructor(e,t,n,a,s,i){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,a,i),this.serializer=s}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=XS(this.serializer,e),n=function(s){if(!("targetChange"in s))return Dt.min();const i=s.targetChange;return i.targetIds&&i.targetIds.length?Dt.min():i.readTime?Ia(i.readTime):Dt.min()}(e);return this.listener.d_(t,n)}A_(e){const t={};t.database=Hm(this.serializer),t.addTarget=function(s,i){let o;const c=i.target;if(o=Sf(c)?{documents:a5(s,c)}:{query:s5(s,c)._t},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0){o.resumeToken=Zy(s,i.resumeToken);const l=zm(s,i.expectedCount);l!==null&&(o.expectedCount=l)}else if(i.snapshotVersion.compareTo(Dt.min())>0){o.readTime=uu(s,i.snapshotVersion.toTimestamp());const l=zm(s,i.expectedCount);l!==null&&(o.expectedCount=l)}return o}(this.serializer,e);const n=JS(this.serializer,e);n&&(t.labels=n),this.a_(t)}R_(e){const t={};t.database=Hm(this.serializer),t.removeTarget=e,this.a_(t)}}class HA extends k5{constructor(e,t,n,a,s,i){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,a,i),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return kt(!!e.streamToken),this.lastStreamToken=e.streamToken,kt(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){kt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=YS(e.writeResults,e.commitTime),n=Ia(e.commitTime);return this.listener.g_(n,t)}p_(){const e={};e.database=Hm(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map(n=>Tf(this.serializer,n))};this.a_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GA extends class{}{constructor(e,t,n,a){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=a,this.y_=!1}w_(){if(this.y_)throw new wt(Ge.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,n,a){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,i])=>this.connection.Mo(e,Wm(t,n),a,s,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Ge.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new wt(Ge.UNKNOWN,s.toString())})}Lo(e,t,n,a,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Lo(e,Wm(t,n),a,i,o,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===Ge.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new wt(Ge.UNKNOWN,i.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class $A{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Ta(t),this.D_=!1):at("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KA{constructor(e,t,n,a,s){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(i=>{n.enqueueAndForget(async()=>{Zc(this)&&(at("RemoteStore","Restarting streams for network reachability change."),await async function(c){const l=Ht(c);l.L_.add(4),await Zh(l),l.q_.set("Unknown"),l.L_.delete(4),await hd(l)}(this))})}),this.q_=new $A(n,a)}}async function hd(r){if(Zc(r))for(const e of r.B_)await e(!0)}async function Zh(r){for(const e of r.B_)await e(!1)}function I5(r,e){const t=Ht(r);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),Zp(t)?Qp(t):wu(t).r_()&&Jp(t,e))}function Yp(r,e){const t=Ht(r),n=wu(t);t.N_.delete(e),n.r_()&&C5(t,e),t.N_.size===0&&(n.r_()?n.o_():Zc(t)&&t.q_.set("Unknown"))}function Jp(r,e){if(r.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Dt.min())>0){const t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}wu(r).A_(e)}function C5(r,e){r.Q_.xe(e),wu(r).R_(e)}function Qp(r){r.Q_=new qS({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>r.N_.get(e)||null,tt:()=>r.datastore.serializer.databaseId}),wu(r).start(),r.q_.v_()}function Zp(r){return Zc(r)&&!wu(r).n_()&&r.N_.size>0}function Zc(r){return Ht(r).L_.size===0}function P5(r){r.Q_=void 0}async function XA(r){r.q_.set("Online")}async function YA(r){r.N_.forEach((e,t)=>{Jp(r,e)})}async function JA(r,e){P5(r),Zp(r)?(r.q_.M_(e),Qp(r)):r.q_.set("Unknown")}async function QA(r,e,t){if(r.q_.set("Online"),e instanceof Qy&&e.state===2&&e.cause)try{await async function(a,s){const i=s.cause;for(const o of s.targetIds)a.N_.has(o)&&(await a.remoteSyncer.rejectListen(o,i),a.N_.delete(o),a.Q_.removeTarget(o))}(r,e)}catch(n){at("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Pf(r,n)}else if(e instanceof uf?r.Q_.Ke(e):e instanceof Jy?r.Q_.He(e):r.Q_.We(e),!t.isEqual(Dt.min()))try{const n=await A5(r.localStore);t.compareTo(n)>=0&&await function(s,i){const o=s.Q_.rt(i);return o.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){const u=s.N_.get(l);u&&s.N_.set(l,u.withResumeToken(c.resumeToken,i))}}),o.targetMismatches.forEach((c,l)=>{const u=s.N_.get(c);if(!u)return;s.N_.set(c,u.withResumeToken(kn.EMPTY_BYTE_STRING,u.snapshotVersion)),C5(s,c);const d=new Oi(u.target,c,l,u.sequenceNumber);Jp(s,d)}),s.remoteSyncer.applyRemoteEvent(o)}(r,t)}catch(n){at("RemoteStore","Failed to raise snapshot:",n),await Pf(r,n)}}async function Pf(r,e,t){if(!Xo(e))throw e;r.L_.add(1),await Zh(r),r.q_.set("Offline"),t||(t=()=>A5(r.localStore)),r.asyncQueue.enqueueRetryable(async()=>{at("RemoteStore","Retrying IndexedDB access"),await t(),r.L_.delete(1),await hd(r)})}function F5(r,e){return e().catch(t=>Pf(r,t,e))}async function e0(r){const e=Ht(r),t=qo(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;ZA(e);)try{const a=await jA(e.localStore,n);if(a===null){e.O_.length===0&&t.o_();break}n=a.batchId,eN(e,a)}catch(a){await Pf(e,a)}R5(e)&&D5(e)}function ZA(r){return Zc(r)&&r.O_.length<10}function eN(r,e){r.O_.push(e);const t=qo(r);t.r_()&&t.V_&&t.m_(e.mutations)}function R5(r){return Zc(r)&&!qo(r).n_()&&r.O_.length>0}function D5(r){qo(r).start()}async function tN(r){qo(r).p_()}async function rN(r){const e=qo(r);for(const t of r.O_)e.m_(t.mutations)}async function nN(r,e,t){const n=r.O_.shift(),a=Up.from(n,e,t);await F5(r,()=>r.remoteSyncer.applySuccessfulWrite(a)),await e0(r)}async function aN(r,e){e&&qo(r).V_&&await async function(n,a){if(function(i){return BS(i)&&i!==Ge.ABORTED}(a.code)){const s=n.O_.shift();qo(n).s_(),await F5(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,a)),await e0(n)}}(r,e),R5(r)&&D5(r)}async function Mx(r,e){const t=Ht(r);t.asyncQueue.verifyOperationInProgress(),at("RemoteStore","RemoteStore received new credentials");const n=Zc(t);t.L_.add(3),await Zh(t),n&&t.q_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),await hd(t)}async function sN(r,e){const t=Ht(r);e?(t.L_.delete(2),await hd(t)):e||(t.L_.add(2),await Zh(t),t.q_.set("Unknown"))}function wu(r){return r.K_||(r.K_=function(t,n,a){const s=Ht(t);return s.w_(),new WA(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,a)}(r.datastore,r.asyncQueue,{Eo:XA.bind(null,r),Ro:YA.bind(null,r),mo:JA.bind(null,r),d_:QA.bind(null,r)}),r.B_.push(async e=>{e?(r.K_.s_(),Zp(r)?Qp(r):r.q_.set("Unknown")):(await r.K_.stop(),P5(r))})),r.K_}function qo(r){return r.U_||(r.U_=function(t,n,a){const s=Ht(t);return s.w_(),new HA(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,a)}(r.datastore,r.asyncQueue,{Eo:()=>Promise.resolve(),Ro:tN.bind(null,r),mo:aN.bind(null,r),f_:rN.bind(null,r),g_:nN.bind(null,r)}),r.B_.push(async e=>{e?(r.U_.s_(),await e0(r)):(await r.U_.stop(),r.O_.length>0&&(at("RemoteStore",`Stopping write stream with ${r.O_.length} pending writes`),r.O_=[]))})),r.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e1{constructor(e,t,n,a,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=a,this.removalCallback=s,this.deferred=new di,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(i=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,a,s){const i=Date.now()+n,o=new e1(e,t,i,a,s);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new wt(Ge.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function t1(r,e){if(Ta("AsyncQueue",`${e}: ${r}`),Xo(r))return new wt(Ge.UNAVAILABLE,`${e}: ${r}`);throw r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xl{constructor(e){this.comparator=e?(t,n)=>e(t,n)||vt.comparator(t.key,n.key):(t,n)=>vt.comparator(t.key,n.key),this.keyedMap=Qu(),this.sortedSet=new Yr(this.comparator)}static emptySet(e){return new Xl(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Xl)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const a=t.getNext().key,s=n.getNext().key;if(!a.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new Xl;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bx{constructor(){this.W_=new Yr(vt.comparator)}track(e){const t=e.doc.key,n=this.W_.get(t);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(t,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(t):e.type===1&&n.type===2?this.W_=this.W_.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):Tt():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal((t,n)=>{e.push(n)}),e}}class hu{constructor(e,t,n,a,s,i,o,c,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=a,this.mutatedKeys=s,this.fromCache=i,this.syncStateChanged=o,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,a,s){const i=[];return t.forEach(o=>{i.push({type:0,doc:o})}),new hu(e,t,Xl.emptySet(t),i,n,a,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&nd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let a=0;a<t.length;a++)if(t[a].type!==n[a].type||!t[a].doc.isEqual(n[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iN{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class oN{constructor(){this.queries=Vx(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,n){const a=Ht(t),s=a.queries;a.queries=Vx(),s.forEach((i,o)=>{for(const c of o.j_)c.onError(n)})})(this,new wt(Ge.ABORTED,"Firestore shutting down"))}}function Vx(){return new Yo(r=>Oy(r),nd)}async function L5(r,e){const t=Ht(r);let n=3;const a=e.query;let s=t.queries.get(a);s?!s.H_()&&e.J_()&&(n=2):(s=new iN,n=e.J_()?0:1);try{switch(n){case 0:s.z_=await t.onListen(a,!0);break;case 1:s.z_=await t.onListen(a,!1);break;case 2:await t.onFirstRemoteStoreListen(a)}}catch(i){const o=t1(i,`Initialization of query '${Bl(e.query)}' failed`);return void e.onError(o)}t.queries.set(a,s),s.j_.push(e),e.Z_(t.onlineState),s.z_&&e.X_(s.z_)&&r1(t)}async function j5(r,e){const t=Ht(r),n=e.query;let a=3;const s=t.queries.get(n);if(s){const i=s.j_.indexOf(e);i>=0&&(s.j_.splice(i,1),s.j_.length===0?a=e.J_()?0:1:!s.H_()&&e.J_()&&(a=2))}switch(a){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function cN(r,e){const t=Ht(r);let n=!1;for(const a of e){const s=a.query,i=t.queries.get(s);if(i){for(const o of i.j_)o.X_(a)&&(n=!0);i.z_=a}}n&&r1(t)}function lN(r,e,t){const n=Ht(r),a=n.queries.get(e);if(a)for(const s of a.j_)s.onError(t);n.queries.delete(e)}function r1(r){r.Y_.forEach(e=>{e.next()})}var Jm,Ux;(Ux=Jm||(Jm={})).ea="default",Ux.Cache="cache";class O5{constructor(e,t,n){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const a of e.docChanges)a.type!==3&&n.push(a);e=new hu(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;const n=t!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=hu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Jm.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M5{constructor(e){this.key=e}}class B5{constructor(e){this.key=e}}class uN{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=er(),this.mutatedKeys=er(),this.Aa=My(e),this.Ra=new Xl(this.Aa)}get Va(){return this.Ta}ma(e,t){const n=t?t.fa:new Bx,a=t?t.Ra:this.Ra;let s=t?t.mutatedKeys:this.mutatedKeys,i=a,o=!1;const c=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,l=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal((u,d)=>{const g=a.get(u),p=Yh(this.query,d)?d:null,y=!!g&&this.mutatedKeys.has(g.key),v=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let w=!1;g&&p?g.data.isEqual(p.data)?y!==v&&(n.track({type:3,doc:p}),w=!0):this.ga(g,p)||(n.track({type:2,doc:p}),w=!0,(c&&this.Aa(p,c)>0||l&&this.Aa(p,l)<0)&&(o=!0)):!g&&p?(n.track({type:0,doc:p}),w=!0):g&&!p&&(n.track({type:1,doc:g}),w=!0,(c||l)&&(o=!0)),w&&(p?(i=i.add(p),s=v?s.add(u):s.delete(u)):(i=i.delete(u),s=s.delete(u)))}),this.query.limit!==null)for(;i.size>this.query.limit;){const u=this.query.limitType==="F"?i.last():i.first();i=i.delete(u.key),s=s.delete(u.key),n.track({type:1,doc:u})}return{Ra:i,fa:n,ns:o,mutatedKeys:s}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,a){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const i=e.fa.G_();i.sort((u,d)=>function(p,y){const v=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Tt()}};return v(p)-v(y)}(u.type,d.type)||this.Aa(u.doc,d.doc)),this.pa(n),a=a!=null&&a;const o=t&&!a?this.ya():[],c=this.da.size===0&&this.current&&!a?1:0,l=c!==this.Ea;return this.Ea=c,i.length!==0||l?{snapshot:new hu(this.query,e.Ra,s,i,e.mutatedKeys,c===0,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Bx,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=er(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const t=[];return e.forEach(n=>{this.da.has(n)||t.push(new B5(n))}),this.da.forEach(n=>{e.has(n)||t.push(new M5(n))}),t}ba(e){this.Ta=e.Ts,this.da=er();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return hu.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class hN{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class fN{constructor(e){this.key=e,this.va=!1}}class dN{constructor(e,t,n,a,s,i){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=a,this.currentUser=s,this.maxConcurrentLimboResolutions=i,this.Ca={},this.Fa=new Yo(o=>Oy(o),nd),this.Ma=new Map,this.xa=new Set,this.Oa=new Yr(vt.comparator),this.Na=new Map,this.La=new $p,this.Ba={},this.ka=new Map,this.qa=Wc.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function mN(r,e,t=!0){const n=H5(r);let a;const s=n.Fa.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),a=s.view.Da()):a=await V5(n,e,t,!0),a}async function pN(r,e){const t=H5(r);await V5(t,e,!0,!1)}async function V5(r,e,t,n){const a=await OA(r.localStore,As(e)),s=a.targetId,i=r.sharedClientState.addLocalQueryTarget(s,t);let o;return n&&(o=await gN(r,e,s,i==="current",a.resumeToken)),r.isPrimaryClient&&t&&I5(r.remoteStore,a),o}async function gN(r,e,t,n,a){r.Ka=(d,g,p)=>async function(v,w,E,R){let P=w.view.ma(E);P.ns&&(P=await Lx(v.localStore,w.query,!1).then(({documents:I})=>w.view.ma(I,P)));const q=R&&R.targetChanges.get(w.targetId),z=R&&R.targetMismatches.get(w.targetId)!=null,K=w.view.applyChanges(P,v.isPrimaryClient,q,z);return zx(v,w.targetId,K.wa),K.snapshot}(r,d,g,p);const s=await Lx(r.localStore,e,!0),i=new uN(e,s.Ts),o=i.ma(s.documents),c=Qh.createSynthesizedTargetChangeForCurrentChange(t,n&&r.onlineState!=="Offline",a),l=i.applyChanges(o,r.isPrimaryClient,c);zx(r,t,l.wa);const u=new hN(e,t,i);return r.Fa.set(e,u),r.Ma.has(t)?r.Ma.get(t).push(e):r.Ma.set(t,[e]),l.snapshot}async function xN(r,e,t){const n=Ht(r),a=n.Fa.get(e),s=n.Ma.get(a.targetId);if(s.length>1)return n.Ma.set(a.targetId,s.filter(i=>!nd(i,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(a.targetId),n.sharedClientState.isActiveQueryTarget(a.targetId)||await Ym(n.localStore,a.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(a.targetId),t&&Yp(n.remoteStore,a.targetId),Qm(n,a.targetId)}).catch(Jc)):(Qm(n,a.targetId),await Ym(n.localStore,a.targetId,!0))}async function vN(r,e){const t=Ht(r),n=t.Fa.get(e),a=t.Ma.get(n.targetId);t.isPrimaryClient&&a.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),Yp(t.remoteStore,n.targetId))}async function yN(r,e,t){const n=G5(r);try{const a=await function(i,o){const c=Ht(i),l=tn.now(),u=o.reduce((p,y)=>p.add(y.key),er());let d,g;return c.persistence.runTransaction("Locally write mutations","readwrite",p=>{let y=as(),v=er();return c.cs.getEntries(p,u).next(w=>{y=w,y.forEach((E,R)=>{R.isValidDocument()||(v=v.add(E))})}).next(()=>c.localDocuments.getOverlayedDocuments(p,y)).next(w=>{d=w;const E=[];for(const R of o){const P=OS(R,d.get(R.key).overlayedDocument);P!=null&&E.push(new Gi(R.key,P,Iy(P.value.mapValue),ea.exists(!0)))}return c.mutationQueue.addMutationBatch(p,l,E,o)}).next(w=>{g=w;const E=w.applyToLocalDocumentSet(d,v);return c.documentOverlayCache.saveOverlays(p,w.batchId,E)})}).then(()=>({batchId:g.batchId,changes:Vy(d)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(a.batchId),function(i,o,c){let l=i.Ba[i.currentUser.toKey()];l||(l=new Yr(Xt)),l=l.insert(o,c),i.Ba[i.currentUser.toKey()]=l}(n,a.batchId,t),await t0(n,a.changes),await e0(n.remoteStore)}catch(a){const s=t1(a,"Failed to persist write");t.reject(s)}}async function U5(r,e){const t=Ht(r);try{const n=await DA(t.localStore,e);e.targetChanges.forEach((a,s)=>{const i=t.Na.get(s);i&&(kt(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1),a.addedDocuments.size>0?i.va=!0:a.modifiedDocuments.size>0?kt(i.va):a.removedDocuments.size>0&&(kt(i.va),i.va=!1))}),await t0(t,n,e)}catch(n){await Jc(n)}}function qx(r,e,t){const n=Ht(r);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const a=[];n.Fa.forEach((s,i)=>{const o=i.view.Z_(e);o.snapshot&&a.push(o.snapshot)}),function(i,o){const c=Ht(i);c.onlineState=o;let l=!1;c.queries.forEach((u,d)=>{for(const g of d.j_)g.Z_(o)&&(l=!0)}),l&&r1(c)}(n.eventManager,e),a.length&&n.Ca.d_(a),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function wN(r,e,t){const n=Ht(r);n.sharedClientState.updateQueryState(e,"rejected",t);const a=n.Na.get(e),s=a&&a.key;if(s){let i=new Yr(vt.comparator);i=i.insert(s,un.newNoDocument(s,Dt.min()));const o=er().add(s),c=new id(Dt.min(),new Map,new Yr(Xt),i,o);await U5(n,c),n.Oa=n.Oa.remove(s),n.Na.delete(e),n1(n)}else await Ym(n.localStore,e,!1).then(()=>Qm(n,e,t)).catch(Jc)}async function _N(r,e){const t=Ht(r),n=e.batch.batchId;try{const a=await RA(t.localStore,e);z5(t,n,null),q5(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await t0(t,a)}catch(a){await Jc(a)}}async function bN(r,e,t){const n=Ht(r);try{const a=await function(i,o){const c=Ht(i);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let u;return c.mutationQueue.lookupMutationBatch(l,o).next(d=>(kt(d!==null),u=d.keys(),c.mutationQueue.removeMutationBatch(l,d))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,u,o)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,u)).next(()=>c.localDocuments.getDocuments(l,u))})}(n.localStore,e);z5(n,e,t),q5(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await t0(n,a)}catch(a){await Jc(a)}}function q5(r,e){(r.ka.get(e)||[]).forEach(t=>{t.resolve()}),r.ka.delete(e)}function z5(r,e,t){const n=Ht(r);let a=n.Ba[n.currentUser.toKey()];if(a){const s=a.get(e);s&&(t?s.reject(t):s.resolve(),a=a.remove(e)),n.Ba[n.currentUser.toKey()]=a}}function Qm(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(const n of r.Ma.get(e))r.Fa.delete(n),t&&r.Ca.$a(n,t);r.Ma.delete(e),r.isPrimaryClient&&r.La.gr(e).forEach(n=>{r.La.containsKey(n)||W5(r,n)})}function W5(r,e){r.xa.delete(e.path.canonicalString());const t=r.Oa.get(e);t!==null&&(Yp(r.remoteStore,t),r.Oa=r.Oa.remove(e),r.Na.delete(t),n1(r))}function zx(r,e,t){for(const n of t)n instanceof M5?(r.La.addReference(n.key,e),EN(r,n)):n instanceof B5?(at("SyncEngine","Document no longer in limbo: "+n.key),r.La.removeReference(n.key,e),r.La.containsKey(n.key)||W5(r,n.key)):Tt()}function EN(r,e){const t=e.key,n=t.path.canonicalString();r.Oa.get(t)||r.xa.has(n)||(at("SyncEngine","New document in limbo: "+t),r.xa.add(n),n1(r))}function n1(r){for(;r.xa.size>0&&r.Oa.size<r.maxConcurrentLimboResolutions;){const e=r.xa.values().next().value;r.xa.delete(e);const t=new vt(Nr.fromString(e)),n=r.qa.next();r.Na.set(n,new fN(t)),r.Oa=r.Oa.insert(t,n),I5(r.remoteStore,new Oi(As(rd(t.path)),n,"TargetPurposeLimboResolution",Ss.oe))}}async function t0(r,e,t){const n=Ht(r),a=[],s=[],i=[];n.Fa.isEmpty()||(n.Fa.forEach((o,c)=>{i.push(n.Ka(c,e,t).then(l=>{var u;if((l||t)&&n.isPrimaryClient){const d=l?!l.fromCache:(u=t==null?void 0:t.targetChanges.get(c.targetId))===null||u===void 0?void 0:u.current;n.sharedClientState.updateQueryState(c.targetId,d?"current":"not-current")}if(l){a.push(l);const d=Xp.Wi(c.targetId,l);s.push(d)}}))}),await Promise.all(i),n.Ca.d_(a),await async function(c,l){const u=Ht(c);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>De.forEach(l,g=>De.forEach(g.$i,p=>u.persistence.referenceDelegate.addReference(d,g.targetId,p)).next(()=>De.forEach(g.Ui,p=>u.persistence.referenceDelegate.removeReference(d,g.targetId,p)))))}catch(d){if(!Xo(d))throw d;at("LocalStore","Failed to update sequence numbers: "+d)}for(const d of l){const g=d.targetId;if(!d.fromCache){const p=u.os.get(g),y=p.snapshotVersion,v=p.withLastLimboFreeSnapshotVersion(y);u.os=u.os.insert(g,v)}}}(n.localStore,s))}async function SN(r,e){const t=Ht(r);if(!t.currentUser.isEqual(e)){at("SyncEngine","User change. New user:",e.toKey());const n=await S5(t.localStore,e);t.currentUser=e,function(s,i){s.ka.forEach(o=>{o.forEach(c=>{c.reject(new wt(Ge.CANCELLED,i))})}),s.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await t0(t,n.hs)}}function AN(r,e){const t=Ht(r),n=t.Na.get(e);if(n&&n.va)return er().add(n.key);{let a=er();const s=t.Ma.get(e);if(!s)return a;for(const i of s){const o=t.Fa.get(i);a=a.unionWith(o.view.Va)}return a}}function H5(r){const e=Ht(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=U5.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=AN.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=wN.bind(null,e),e.Ca.d_=cN.bind(null,e.eventManager),e.Ca.$a=lN.bind(null,e.eventManager),e}function G5(r){const e=Ht(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=_N.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=bN.bind(null,e),e}class Ih{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ud(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return E5(this.persistence,new b5,e.initialUser,this.serializer)}Ga(e){return new _5(ld.Zr,this.serializer)}Wa(e){return new N5}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ih.provider={build:()=>new Ih};class NN extends Ih{constructor(e,t,n){super(),this.Ja=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await G5(this.Ja.syncEngine),await e0(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return E5(this.persistence,new b5,e.initialUser,this.serializer)}ja(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new mA(n,e.asyncQueue,t)}Ha(e,t){const n=new UE(t,this.persistence);return new VE(e.asyncQueue,n)}Ga(e){const t=CA(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?Va.withCacheSize(this.cacheSizeBytes):Va.DEFAULT;return new Kp(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,zA(),hf(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new N5}}class Ff{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>qx(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=SN.bind(null,this.syncEngine),await sN(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new oN}()}createDatastore(e){const t=ud(e.databaseInfo.databaseId),n=function(s){return new qA(s)}(e.databaseInfo);return function(s,i,o,c){return new GA(s,i,o,c)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(n,a,s,i,o){return new KA(n,a,s,i,o)}(this.localStore,this.datastore,e.asyncQueue,t=>qx(this.syncEngine,t,0),function(){return Ox.D()?new Ox:new BA}())}createSyncEngine(e,t){return function(a,s,i,o,c,l,u){const d=new dN(a,s,i,o,c,l);return u&&(d.Qa=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(a){const s=Ht(a);at("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await Zh(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Ff.provider={build:()=>new Ff};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $5{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Ta("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TN{constructor(e,t,n,a,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=a,this.user=Yn.UNAUTHENTICATED,this.clientId=py.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async i=>{at("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(n,i=>(at("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new di;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=t1(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function rm(r,e){r.asyncQueue.verifyOperationInProgress(),at("FirestoreClient","Initializing OfflineComponentProvider");const t=r.configuration;await e.initialize(t);let n=t.initialUser;r.setCredentialChangeListener(async a=>{n.isEqual(a)||(await S5(e.localStore,a),n=a)}),e.persistence.setDatabaseDeletedListener(()=>r.terminate()),r._offlineComponents=e}async function Wx(r,e){r.asyncQueue.verifyOperationInProgress();const t=await kN(r);at("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,r.configuration),r.setCredentialChangeListener(n=>Mx(e.remoteStore,n)),r.setAppCheckTokenChangeListener((n,a)=>Mx(e.remoteStore,a)),r._onlineComponents=e}async function kN(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){at("FirestoreClient","Using user provided OfflineComponentProvider");try{await rm(r,r._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(a){return a.name==="FirebaseError"?a.code===Ge.FAILED_PRECONDITION||a.code===Ge.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11}(t))throw t;Mc("Error using user provided cache. Falling back to memory cache: "+t),await rm(r,new Ih)}}else at("FirestoreClient","Using default OfflineComponentProvider"),await rm(r,new Ih);return r._offlineComponents}async function K5(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(at("FirestoreClient","Using user provided OnlineComponentProvider"),await Wx(r,r._uninitializedComponentsProvider._online)):(at("FirestoreClient","Using default OnlineComponentProvider"),await Wx(r,new Ff))),r._onlineComponents}function IN(r){return K5(r).then(e=>e.syncEngine)}async function X5(r){const e=await K5(r),t=e.eventManager;return t.onListen=mN.bind(null,e.syncEngine),t.onUnlisten=xN.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=pN.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=vN.bind(null,e.syncEngine),t}function CN(r,e,t={}){const n=new di;return r.asyncQueue.enqueueAndForget(async()=>function(s,i,o,c,l){const u=new $5({next:g=>{u.Za(),i.enqueueAndForget(()=>j5(s,d));const p=g.docs.has(o);!p&&g.fromCache?l.reject(new wt(Ge.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&g.fromCache&&c&&c.source==="server"?l.reject(new wt(Ge.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(g)},error:g=>l.reject(g)}),d=new O5(rd(o.path),u,{includeMetadataChanges:!0,_a:!0});return L5(s,d)}(await X5(r),r.asyncQueue,e,t,n)),n.promise}function PN(r,e,t={}){const n=new di;return r.asyncQueue.enqueueAndForget(async()=>function(s,i,o,c,l){const u=new $5({next:g=>{u.Za(),i.enqueueAndForget(()=>j5(s,d)),g.fromCache&&c.source==="server"?l.reject(new wt(Ge.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(g)},error:g=>l.reject(g)}),d=new O5(o,u,{includeMetadataChanges:!0,_a:!0});return L5(s,d)}(await X5(r),r.asyncQueue,e,t,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y5(r){const e={};return r.timeoutSeconds!==void 0&&(e.timeoutSeconds=r.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hx=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J5(r,e,t){if(!t)throw new wt(Ge.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function FN(r,e,t,n){if(e===!0&&n===!0)throw new wt(Ge.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)}function Gx(r){if(!vt.isDocumentKey(r))throw new wt(Ge.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function $x(r){if(vt.isDocumentKey(r))throw new wt(Ge.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function a1(r){if(r===void 0)return"undefined";if(r===null)return"null";if(typeof r=="string")return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if(typeof r=="number"||typeof r=="boolean")return""+r;if(typeof r=="object"){if(r instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(r);return e?`a custom ${e} object`:"an object"}}return typeof r=="function"?"a function":Tt()}function xi(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new wt(Ge.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=a1(r);throw new wt(Ge.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kx{constructor(e){var t,n;if(e.host===void 0){if(e.ssl!==void 0)throw new wt(Ge.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new wt(Ge.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}FN("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Y5((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new wt(Ge.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new wt(Ge.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new wt(Ge.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,a){return n.timeoutSeconds===a.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class fd{constructor(e,t,n,a){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Kx({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new wt(Ge.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new wt(Ge.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Kx(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new kE;switch(n.type){case"firstParty":return new FE(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new wt(Ge.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const n=Hx.get(t);n&&(at("ComponentProvider","Removing Datastore"),Hx.delete(t),n.terminate())}(this),Promise.resolve()}}function RN(r,e,t,n={}){var a;const s=(r=xi(r,fd))._getSettings(),i=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==i&&Mc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),r._setSettings(Object.assign(Object.assign({},s),{host:i,ssl:!1})),n.mockUserToken){let o,c;if(typeof n.mockUserToken=="string")o=n.mockUserToken,c=Yn.MOCK_USER;else{o=f3(n.mockUserToken,(a=r._app)===null||a===void 0?void 0:a.options.projectId);const l=n.mockUserToken.sub||n.mockUserToken.user_id;if(!l)throw new wt(Ge.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Yn(l)}r._authCredentials=new IE(new my(o,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dd{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new dd(this.firestore,e,this._query)}}class is{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Bo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new is(this.firestore,e,this._key)}}class Bo extends dd{constructor(e,t,n){super(e,t,rd(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new is(this.firestore,null,new vt(e))}withConverter(e){return new Bo(this.firestore,e,this._path)}}function Zm(r,e,...t){if(r=qi(r),J5("collection","path",e),r instanceof fd){const n=Nr.fromString(e,...t);return $x(n),new Bo(r,null,n)}{if(!(r instanceof is||r instanceof Bo))throw new wt(Ge.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(Nr.fromString(e,...t));return $x(n),new Bo(r.firestore,null,n)}}function Ch(r,e,...t){if(r=qi(r),arguments.length===1&&(e=py.newId()),J5("doc","path",e),r instanceof fd){const n=Nr.fromString(e,...t);return Gx(n),new is(r,null,new vt(n))}{if(!(r instanceof is||r instanceof Bo))throw new wt(Ge.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(Nr.fromString(e,...t));return Gx(n),new is(r.firestore,r instanceof Bo?r.converter:null,new vt(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xx{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new T5(this,"async_queue_retry"),this.Vu=()=>{const n=hf();n&&at("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const t=hf();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=hf();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const t=new di;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Xo(e))throw e;at("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const t=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const a=function(i){let o=i.message||"";return i.stack&&(o=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),o}(n);throw Ta("INTERNAL UNHANDLED ERROR: ",a),n}).then(n=>(this.du=!1,n))));return this.mu=t,t}enqueueAfterDelay(e,t,n){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const a=e1.createAndSchedule(this,e,t,n,s=>this.yu(s));return this.Tu.push(a),a}fu(){this.Eu&&Tt()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(const t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}class el extends fd{constructor(e,t,n,a){super(e,t,n,a),this.type="firestore",this._queue=new Xx,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Xx(e),this._firestoreClient=void 0,await e}}}function DN(r,e){const t=typeof r=="object"?r:vE(),n=typeof r=="string"?r:"(default)",a=mE(t,"firestore").getImmediate({identifier:n});if(!a._initialized){const s=u3("firestore");s&&RN(a,...s)}return a}function md(r){if(r._terminated)throw new wt(Ge.FAILED_PRECONDITION,"The client has already been terminated.");return r._firestoreClient||Q5(r),r._firestoreClient}function Q5(r){var e,t,n;const a=r._freezeSettings(),s=function(o,c,l,u){return new lS(o,c,l,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,Y5(u.experimentalLongPollingOptions),u.useFetchStreams)}(r._databaseId,((e=r._app)===null||e===void 0?void 0:e.options.appId)||"",r._persistenceKey,a);r._componentsProvider||!((t=a.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((n=a.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(r._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),r._firestoreClient=new TN(r._authCredentials,r._appCheckCredentials,r._queue,s,r._componentsProvider&&function(o){const c=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(c),_online:c}}(r._componentsProvider))}function LN(r,e){Mc("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=r._freezeSettings();return jN(r,Ff.provider,{build:n=>new NN(n,t.cacheSizeBytes,void 0)}),Promise.resolve()}function jN(r,e,t){if((r=xi(r,el))._firestoreClient||r._terminated)throw new wt(Ge.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(r._componentsProvider||r._getSettings().localCache)throw new wt(Ge.FAILED_PRECONDITION,"SDK cache is already specified.");r._componentsProvider={_online:e,_offline:t},Q5(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fu{constructor(e){this._byteString=e}static fromBase64String(e){try{return new fu(kn.fromBase64String(e))}catch(t){throw new wt(Ge.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new fu(kn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pd{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new wt(Ge.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Qr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s1{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i1{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new wt(Ge.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new wt(Ge.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Xt(this._lat,e._lat)||Xt(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o1{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,a){if(n.length!==a.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==a[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ON=/^__.*__$/;class MN{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new Gi(e,this.data,this.fieldMask,t,this.fieldTransforms):new yu(e,this.data,t,this.fieldTransforms)}}class Z5{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Gi(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function ew(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Tt()}}class c1{constructor(e,t,n,a,s,i){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=a,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=i||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new c1(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const n=(t=this.path)===null||t===void 0?void 0:t.child(e),a=this.Fu({path:n,xu:!1});return a.Ou(e),a}Nu(e){var t;const n=(t=this.path)===null||t===void 0?void 0:t.child(e),a=this.Fu({path:n,xu:!1});return a.vu(),a}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Rf(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(ew(this.Cu)&&ON.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class BN{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||ud(e)}Qu(e,t,n,a=!1){return new c1({Cu:e,methodName:t,qu:n,path:Qr.emptyPath(),xu:!1,ku:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function tw(r){const e=r._freezeSettings(),t=ud(r._databaseId);return new BN(r._databaseId,!!e.ignoreUndefinedProperties,t)}function rw(r,e,t,n,a,s={}){const i=r.Qu(s.merge||s.mergeFields?2:0,e,t,a);l1("Data must be an object, but it was:",i,n);const o=nw(n,i);let c,l;if(s.merge)c=new Ua(i.fieldMask),l=i.fieldTransforms;else if(s.mergeFields){const u=[];for(const d of s.mergeFields){const g=ep(e,d,t);if(!i.contains(g))throw new wt(Ge.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);sw(u,g)||u.push(g)}c=new Ua(u),l=i.fieldTransforms.filter(d=>c.covers(d.field))}else c=null,l=i.fieldTransforms;return new MN(new fa(o),c,l)}class gd extends s1{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof gd}}function VN(r,e,t,n){const a=r.Qu(1,e,t);l1("Data must be an object, but it was:",a,n);const s=[],i=fa.empty();Qc(n,(c,l)=>{const u=u1(e,c,t);l=qi(l);const d=a.Nu(u);if(l instanceof gd)s.push(u);else{const g=xd(l,d);g!=null&&(s.push(u),i.set(u,g))}});const o=new Ua(s);return new Z5(i,o,a.fieldTransforms)}function UN(r,e,t,n,a,s){const i=r.Qu(1,e,t),o=[ep(e,n,t)],c=[a];if(s.length%2!=0)throw new wt(Ge.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<s.length;g+=2)o.push(ep(e,s[g])),c.push(s[g+1]);const l=[],u=fa.empty();for(let g=o.length-1;g>=0;--g)if(!sw(l,o[g])){const p=o[g];let y=c[g];y=qi(y);const v=i.Nu(p);if(y instanceof gd)l.push(p);else{const w=xd(y,v);w!=null&&(l.push(p),u.set(p,w))}}const d=new Ua(l);return new Z5(u,d,i.fieldTransforms)}function xd(r,e){if(aw(r=qi(r)))return l1("Unsupported field value:",e,r),nw(r,e);if(r instanceof s1)return function(n,a){if(!ew(a.Cu))throw a.Bu(`${n._methodName}() can only be used with update() and set()`);if(!a.path)throw a.Bu(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(a);s&&a.fieldTransforms.push(s)}(r,e),null;if(r===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),r instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,a){const s=[];let i=0;for(const o of n){let c=xd(o,a.Lu(i));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),i++}return{arrayValue:{values:s}}}(r,e)}return function(n,a){if((n=qi(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return CS(a.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=tn.fromDate(n);return{timestampValue:uu(a.serializer,s)}}if(n instanceof tn){const s=new tn(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:uu(a.serializer,s)}}if(n instanceof i1)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof fu)return{bytesValue:Zy(a.serializer,n._byteString)};if(n instanceof is){const s=a.databaseId,i=n.firestore._databaseId;if(!i.isEqual(s))throw a.Bu(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Wp(n.firestore._databaseId||a.databaseId,n._key.path)}}if(n instanceof o1)return function(i,o){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:i.toArray().map(c=>{if(typeof c!="number")throw o.Bu("VectorValues must only contain numeric values.");return Bp(o.serializer,c)})}}}}}}(n,a);throw a.Bu(`Unsupported field value: ${a1(n)}`)}(r,e)}function nw(r,e){const t={};return Ay(r)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Qc(r,(n,a)=>{const s=xd(a,e.Mu(n));s!=null&&(t[n]=s)}),{mapValue:{fields:t}}}function aw(r){return!(typeof r!="object"||r===null||r instanceof Array||r instanceof Date||r instanceof tn||r instanceof i1||r instanceof fu||r instanceof is||r instanceof s1||r instanceof o1)}function l1(r,e,t){if(!aw(t)||!function(a){return typeof a=="object"&&a!==null&&(Object.getPrototypeOf(a)===Object.prototype||Object.getPrototypeOf(a)===null)}(t)){const n=a1(t);throw n==="an object"?e.Bu(r+" a custom object"):e.Bu(r+" "+n)}}function ep(r,e,t){if((e=qi(e))instanceof pd)return e._internalPath;if(typeof e=="string")return u1(r,e);throw Rf("Field path arguments must be of type string or ",r,!1,void 0,t)}const qN=new RegExp("[~\\*/\\[\\]]");function u1(r,e,t){if(e.search(qN)>=0)throw Rf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,t);try{return new pd(...e.split("."))._internalPath}catch{throw Rf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,t)}}function Rf(r,e,t,n,a){const s=n&&!n.isEmpty(),i=a!==void 0;let o=`Function ${e}() called with invalid data`;t&&(o+=" (via `toFirestore()`)"),o+=". ";let c="";return(s||i)&&(c+=" (found",s&&(c+=` in field ${n}`),i&&(c+=` in document ${a}`),c+=")"),new wt(Ge.INVALID_ARGUMENT,o+r+c)}function sw(r,e){return r.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iw{constructor(e,t,n,a,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=a,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new is(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new zN(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(ow("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class zN extends iw{data(){return super.data()}}function ow(r,e){return typeof e=="string"?u1(r,e):e instanceof pd?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WN(r){if(r.limitType==="L"&&r.explicitOrderBy.length===0)throw new wt(Ge.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class HN{convertValue(e,t="none"){switch(Vc(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Xr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Vo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Tt()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return Qc(e,(a,s)=>{n[a]=this.convertValue(s,t)}),n}convertVectorValue(e){var t,n,a;const s=(a=(n=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||n===void 0?void 0:n.values)===null||a===void 0?void 0:a.map(i=>Xr(i.doubleValue));return new o1(s)}convertGeoPoint(e){return new i1(Xr(e.latitude),Xr(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=jp(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Sh(e));default:return null}}convertTimestamp(e){const t=Wi(e);return new tn(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Nr.fromString(e);kt(l5(n));const a=new Bc(n.get(1),n.get(3)),s=new vt(n.popFirst(5));return a.isEqual(t)||Ta(`Document ${s} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cw(r,e,t){let n;return n=r?t&&(t.merge||t.mergeFields)?r.toFirestore(e,t):r.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class th{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class lw extends iw{constructor(e,t,n,a,s,i){super(e,t,n,a,i),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new ff(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(ow("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class ff extends lw{data(e={}){return super.data(e)}}class GN{constructor(e,t,n,a){this._firestore=e,this._userDataWriter=t,this._snapshot=a,this.metadata=new th(a.hasPendingWrites,a.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new ff(this._firestore,this._userDataWriter,n.key,n,new th(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new wt(Ge.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(a,s){if(a._snapshot.oldDocs.isEmpty()){let i=0;return a._snapshot.docChanges.map(o=>{const c=new ff(a._firestore,a._userDataWriter,o.doc.key,o.doc,new th(a._snapshot.mutatedKeys.has(o.doc.key),a._snapshot.fromCache),a.query.converter);return o.doc,{type:"added",doc:c,oldIndex:-1,newIndex:i++}})}{let i=a._snapshot.oldDocs;return a._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const c=new ff(a._firestore,a._userDataWriter,o.doc.key,o.doc,new th(a._snapshot.mutatedKeys.has(o.doc.key),a._snapshot.fromCache),a.query.converter);let l=-1,u=-1;return o.type!==0&&(l=i.indexOf(o.doc.key),i=i.delete(o.doc.key)),o.type!==1&&(i=i.add(o.doc),u=i.indexOf(o.doc.key)),{type:$N(o.type),doc:c,oldIndex:l,newIndex:u}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function $N(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Tt()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KN(r){r=xi(r,is);const e=xi(r.firestore,el);return CN(md(e),r._key).then(t=>JN(e,r,t))}class uw extends HN{constructor(e){super(),this.firestore=e}convertBytes(e){return new fu(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new is(this.firestore,null,t)}}function tp(r){r=xi(r,dd);const e=xi(r.firestore,el),t=md(e),n=new uw(e);return WN(r._query),PN(t,r._query).then(a=>new GN(e,n,r,a))}function XN(r,e,t){r=xi(r,is);const n=xi(r.firestore,el),a=cw(r.converter,e,t);return h1(n,[rw(tw(n),"setDoc",r._key,a,r.converter!==null,t).toMutation(r._key,ea.none())])}function YN(r){return h1(xi(r.firestore,el),[new Jh(r._key,ea.none())])}function h1(r,e){return function(n,a){const s=new di;return n.asyncQueue.enqueueAndForget(async()=>yN(await IN(n),a,s)),s.promise}(md(r),e)}function JN(r,e,t){const n=t.docs.get(e._key),a=new uw(r);return new lw(r,a,e._key,n,new th(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QN{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=tw(e)}set(e,t,n){this._verifyNotCommitted();const a=nm(e,this._firestore),s=cw(a.converter,t,n),i=rw(this._dataReader,"WriteBatch.set",a._key,s,a.converter!==null,n);return this._mutations.push(i.toMutation(a._key,ea.none())),this}update(e,t,n,...a){this._verifyNotCommitted();const s=nm(e,this._firestore);let i;return i=typeof(t=qi(t))=="string"||t instanceof pd?UN(this._dataReader,"WriteBatch.update",s._key,t,n,a):VN(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(i.toMutation(s._key,ea.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=nm(e,this._firestore);return this._mutations=this._mutations.concat(new Jh(t._key,ea.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new wt(Ge.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function nm(r,e){if((r=qi(r)).firestore!==e)throw new wt(Ge.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yx(r){return md(r=xi(r,el)),new QN(r,e=>h1(r,e))}(function(e,t=!0){(function(a){vu=a})(xE),_f(new yh("firestore",(n,{instanceIdentifier:a,options:s})=>{const i=n.getProvider("app").getImmediate(),o=new el(new CE(n.getProvider("auth-internal")),new DE(n.getProvider("app-check-internal")),function(l,u){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new wt(Ge.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Bc(l.options.projectId,u)}(i,a),i);return s=Object.assign({useFetchStreams:t},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),Kl(Wg,"4.7.3",e),Kl(Wg,"4.7.3","esm2017")})();var ZN="firebase",eT="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Kl(ZN,eT,"app");const No={apiKey:"AIzaSyD-yyoJqi8AYcVVAb9btqmhhNCS8cqOILY",authDomain:"alvarosalon25.firebaseapp.com",projectId:"alvarosalon25",storageBucket:"alvarosalon25.firebasestorage.app",messagingSenderId:"845724066967",appId:"1:845724066967:web:9989feba852e6cbf00b5d2"},hw=r=>Object.values(r).every(e=>e.trim()!==""),tT=async r=>{try{const e=sy(r),t=DN(e);try{await LN(t),console.log("Offline persistence enabled")}catch(n){n.code==="failed-precondition"?console.warn("Multiple tabs open, persistence enabled in first tab only"):n.code==="unimplemented"&&console.warn("Browser doesn't support persistence")}return t}catch(e){return console.error("Error initializing Firebase:",e),null}},rT=r=>{localStorage.setItem("firebaseConfig",JSON.stringify(r)),window.location.reload()},fw=()=>{try{const r=localStorage.getItem("firebaseConfig");if(!r)return No;const e=JSON.parse(r);return{apiKey:e.apiKey??No.apiKey,authDomain:e.authDomain??No.authDomain,projectId:e.projectId??No.projectId,storageBucket:e.storageBucket??No.storageBucket,messagingSenderId:e.messagingSenderId??No.messagingSenderId,appId:e.appId??No.appId}}catch(r){return console.error("Error loading Firebase config:",r),No}};let Un=null;const nT=async()=>{const r=fw();return hw(r)?(Un=await tT(r),Un):(console.warn("Invalid Firebase configuration"),null)};nT().catch(console.error);const aT={products:"products",categories:"categories",clients:"clients",staff:"staff",sales:"sales",appointments:"appointments",expenses:"expenses",credits:"credits",cashMovements:"cashMovements",cashRegister:"cashRegister"},f1=async(r,e=3)=>{for(let t=0;t<e;t++)try{return await r()}catch(n){if(t===e-1)throw n;await new Promise(a=>setTimeout(a,Math.pow(2,t)*1e3))}return null},sT=async(r,e,t=3)=>{if(!Un)return!1;if(!aT[r])return console.error(`Invalid collection name: ${r}`),!1;if(e.length===0)try{const s=Zm(Un,r),i=await tp(s);if(i.size>0){const o=Yx(Un);i.docs.forEach(c=>{o.delete(c.ref)}),await o.commit()}return!0}catch(s){return console.error(`Error clearing collection ${r}:`,s),!1}return await f1(async()=>{const s=Yx(Un),i=Zm(Un,r),c=(await tp(i)).docs.map(u=>u.id),l=e.map(u=>u.id);return c.forEach(u=>{if(!l.includes(u)){const d=Ch(Un,r,u);s.delete(d)}}),e.forEach(u=>{const d=Ch(Un,r,u.id);s.set(d,{...u})}),await s.commit(),!0},t)??!1},iT=async(r,e,t=3)=>Un?f1(async()=>{const a=Ch(Un,r,e.id);return await XN(a,{...e}),!0},t)??!1:!1,oT=async(r,e,t=3)=>Un?f1(async()=>{const a=Ch(Un,r,e);return await YN(a),!0},t)??!1:!1,cT=async r=>{if(!Un)return[];try{const e=Zm(Un,r);return(await tp(e)).docs.map(n=>({...n.data(),id:n.id}))}catch(e){return console.error(`Error loading ${r}:`,e),[]}},lT=async(r,e)=>{if(!Un)return null;try{const t=Ch(Un,r,e),n=await KN(t);return n.exists()?{...n.data(),id:n.id}:null}catch(t){return console.error(`Error loading document from ${r}:`,t),null}},Jx={id:"current",amount:0,lastModified:new Date().toISOString()},Li=r=>({save:async e=>{try{if(e==null)return console.error("Invalid data format: expected array"),!1;const t=Array.isArray(e)?e:[];return await sT(r,e,3)}catch(t){return console.error(`Error saving ${r}:`,t),!1}},load:async()=>{try{const e=await cT(r);return Array.isArray(e)?e:[]}catch(e){return console.error(`Error loading ${r}:`,e),[]}},delete:async e=>{try{const t=await oT(r,e,3);return t&&console.log(`Successfully deleted document ${e} from ${r}`),t}catch(t){return console.error(`Error deleting from ${r}:`,t),!1}}}),Bt={products:Li("products"),categories:Li("categories"),clients:Li("clients"),staff:Li("staff"),sales:Li("sales"),appointments:Li("appointments"),expenses:Li("expenses"),credits:Li("credits"),cashMovements:Li("cashMovements"),cashRegister:{save:async r=>{try{return await iT("cashRegister",{...r,id:"current",lastModified:new Date().toISOString()})}catch(e){return console.error("Error saving cash register:",e),!1}},load:async()=>{try{return await lT("cashRegister","current")||Jx}catch(r){return console.error("Error loading cash register:",r),Jx}}}},uT=async()=>{try{return await Promise.all([Bt.appointments.save([]),Bt.clients.save([]),Bt.expenses.save([]),Bt.credits.save([])]),console.log("Records cleared successfully"),!0}catch(r){return console.error("Error clearing records:",r),!1}};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Df={};Df.version="0.18.5";var dw=1252,hT=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],d1={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},m1=function(r){hT.indexOf(r)!=-1&&(dw=d1[0]=r)};function fT(){m1(1252)}var Hs=function(r){m1(r)};function p1(){Hs(1200),fT()}function Qx(r){for(var e=[],t=0,n=r.length;t<n;++t)e[t]=r.charCodeAt(t);return e}function dT(r){for(var e=[],t=0;t<r.length>>1;++t)e[t]=String.fromCharCode(r.charCodeAt(2*t)+(r.charCodeAt(2*t+1)<<8));return e.join("")}function mw(r){for(var e=[],t=0;t<r.length>>1;++t)e[t]=String.fromCharCode(r.charCodeAt(2*t+1)+(r.charCodeAt(2*t)<<8));return e.join("")}var rh=function(r){var e=r.charCodeAt(0),t=r.charCodeAt(1);return e==255&&t==254?dT(r.slice(2)):e==254&&t==255?mw(r.slice(2)):e==65279?r.slice(1):r},V0=function(e){return String.fromCharCode(e)},Zx=function(e){return String.fromCharCode(e)},Po,Ro="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ph(r){for(var e="",t=0,n=0,a=0,s=0,i=0,o=0,c=0,l=0;l<r.length;)t=r.charCodeAt(l++),s=t>>2,n=r.charCodeAt(l++),i=(t&3)<<4|n>>4,a=r.charCodeAt(l++),o=(n&15)<<2|a>>6,c=a&63,isNaN(n)?o=c=64:isNaN(a)&&(c=64),e+=Ro.charAt(s)+Ro.charAt(i)+Ro.charAt(o)+Ro.charAt(c);return e}function cs(r){var e="",t=0,n=0,a=0,s=0,i=0,o=0,c=0;r=r.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<r.length;)s=Ro.indexOf(r.charAt(l++)),i=Ro.indexOf(r.charAt(l++)),t=s<<2|i>>4,e+=String.fromCharCode(t),o=Ro.indexOf(r.charAt(l++)),n=(i&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),c=Ro.indexOf(r.charAt(l++)),a=(o&3)<<6|c,c!==64&&(e+=String.fromCharCode(a));return e}var Zt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),$i=function(){if(typeof Buffer<"u"){var r=!Buffer.from;if(!r)try{Buffer.from("foo","utf8")}catch{r=!0}return r?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function zo(r){return Zt?Buffer.alloc?Buffer.alloc(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}function e2(r){return Zt?Buffer.allocUnsafe?Buffer.allocUnsafe(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}var rs=function(e){return Zt?$i(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function vd(r){if(typeof ArrayBuffer>"u")return rs(r);for(var e=new ArrayBuffer(r.length),t=new Uint8Array(e),n=0;n!=r.length;++n)t[n]=r.charCodeAt(n)&255;return e}function Jo(r){if(Array.isArray(r))return r.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],t=0;t<r.length;++t)e[t]=String.fromCharCode(r[t]);return e.join("")}function mT(r){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(r)}function g1(r){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(r instanceof ArrayBuffer)return g1(new Uint8Array(r));for(var e=new Array(r.length),t=0;t<r.length;++t)e[t]=r[t];return e}var qn=Zt?function(r){return Buffer.concat(r.map(function(e){return Buffer.isBuffer(e)?e:$i(e)}))}:function(r){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<r.length;++e)t+=r[e].length;var n=new Uint8Array(t),a=0;for(e=0,t=0;e<r.length;t+=a,++e)if(a=r[e].length,r[e]instanceof Uint8Array)n.set(r[e],t);else{if(typeof r[e]=="string")throw"wtf";n.set(new Uint8Array(r[e]),t)}return n}return[].concat.apply([],r.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function pT(r){for(var e=[],t=0,n=r.length+250,a=zo(r.length+255),s=0;s<r.length;++s){var i=r.charCodeAt(s);if(i<128)a[t++]=i;else if(i<2048)a[t++]=192|i>>6&31,a[t++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=r.charCodeAt(++s)&1023;a[t++]=240|i>>8&7,a[t++]=128|i>>2&63,a[t++]=128|o>>6&15|(i&3)<<4,a[t++]=128|o&63}else a[t++]=224|i>>12&15,a[t++]=128|i>>6&63,a[t++]=128|i&63;t>n&&(e.push(a.slice(0,t)),t=0,a=zo(65535),n=65530)}return e.push(a.slice(0,t)),qn(e)}var Ca=/\u0000/g,nh=/[\u0001-\u0006]/g;function Yl(r){for(var e="",t=r.length-1;t>=0;)e+=r.charAt(t--);return e}function Gs(r,e){var t=""+r;return t.length>=e?t:ln("0",e-t.length)+t}function x1(r,e){var t=""+r;return t.length>=e?t:ln(" ",e-t.length)+t}function Lf(r,e){var t=""+r;return t.length>=e?t:t+ln(" ",e-t.length)}function gT(r,e){var t=""+Math.round(r);return t.length>=e?t:ln("0",e-t.length)+t}function xT(r,e){var t=""+r;return t.length>=e?t:ln("0",e-t.length)+t}var t2=Math.pow(2,32);function Rl(r,e){if(r>t2||r<-t2)return gT(r,e);var t=Math.round(r);return xT(t,e)}function jf(r,e){return e=e||0,r.length>=7+e&&(r.charCodeAt(e)|32)===103&&(r.charCodeAt(e+1)|32)===101&&(r.charCodeAt(e+2)|32)===110&&(r.charCodeAt(e+3)|32)===101&&(r.charCodeAt(e+4)|32)===114&&(r.charCodeAt(e+5)|32)===97&&(r.charCodeAt(e+6)|32)===108}var r2=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],am=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function vT(r){return r||(r={}),r[0]="General",r[1]="0",r[2]="0.00",r[3]="#,##0",r[4]="#,##0.00",r[9]="0%",r[10]="0.00%",r[11]="0.00E+00",r[12]="# ?/?",r[13]="# ??/??",r[14]="m/d/yy",r[15]="d-mmm-yy",r[16]="d-mmm",r[17]="mmm-yy",r[18]="h:mm AM/PM",r[19]="h:mm:ss AM/PM",r[20]="h:mm",r[21]="h:mm:ss",r[22]="m/d/yy h:mm",r[37]="#,##0 ;(#,##0)",r[38]="#,##0 ;[Red](#,##0)",r[39]="#,##0.00;(#,##0.00)",r[40]="#,##0.00;[Red](#,##0.00)",r[45]="mm:ss",r[46]="[h]:mm:ss",r[47]="mmss.0",r[48]="##0.0E+0",r[49]="@",r[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',r}var Mt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},n2={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},yT={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Of(r,e,t){for(var n=r<0?-1:1,a=r*n,s=0,i=1,o=0,c=1,l=0,u=0,d=Math.floor(a);l<e&&(d=Math.floor(a),o=d*i+s,u=d*l+c,!(a-d<5e-8));)a=1/(a-d),s=i,i=o,c=l,l=u;if(u>e&&(l>e?(u=c,o=s):(u=l,o=i)),!t)return[0,n*o,u];var g=Math.floor(n*o/u);return[g,n*o-g*u,u]}function kc(r,e,t){if(r>2958465||r<0)return null;var n=r|0,a=Math.floor(86400*(r-n)),s=0,i=[],o={D:n,T:a,u:86400*(r-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)i=t?[1317,10,29]:[1900,2,29],s=3;else if(n===0)i=t?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),i=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),n<60&&(s=(s+6)%7),t&&(s=AT(c,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=s,o}var pw=new Date(1899,11,31,0,0,0),wT=pw.getTime(),_T=new Date(1900,2,1,0,0,0);function gw(r,e){var t=r.getTime();return e?t-=1461*24*60*60*1e3:r>=_T&&(t+=24*60*60*1e3),(t-(wT+(r.getTimezoneOffset()-pw.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function v1(r){return r.indexOf(".")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function bT(r){return r.indexOf("E")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function ET(r){var e=r<0?12:11,t=v1(r.toFixed(12));return t.length<=e||(t=r.toPrecision(10),t.length<=e)?t:r.toExponential(5)}function ST(r){var e=v1(r.toFixed(11));return e.length>(r<0?12:11)||e==="0"||e==="-0"?r.toPrecision(6):e}function Fh(r){var e=Math.floor(Math.log(Math.abs(r))*Math.LOG10E),t;return e>=-4&&e<=-1?t=r.toPrecision(10+e):Math.abs(e)<=9?t=ET(r):e===10?t=r.toFixed(10).substr(0,12):t=ST(r),v1(bT(t.toUpperCase()))}function Hc(r,e){switch(typeof r){case"string":return r;case"boolean":return r?"TRUE":"FALSE";case"number":return(r|0)===r?r.toString(10):Fh(r);case"undefined":return"";case"object":if(r==null)return"";if(r instanceof Date)return ks(14,gw(r,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+r)}function AT(r,e){e[0]-=581;var t=r.getDay();return r<60&&(t=(t+6)%7),t}function NT(r,e,t,n){var a="",s=0,i=0,o=t.y,c,l=0;switch(r){case 98:o=t.y+543;case 121:switch(e.length){case 1:case 2:c=o%100,l=2;break;default:c=o%1e4,l=4;break}break;case 109:switch(e.length){case 1:case 2:c=t.m,l=e.length;break;case 3:return am[t.m-1][1];case 5:return am[t.m-1][0];default:return am[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:c=t.d,l=e.length;break;case 3:return r2[t.q][0];default:return r2[t.q][1]}break;case 104:switch(e.length){case 1:case 2:c=1+(t.H+11)%12,l=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:c=t.H,l=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:c=t.M,l=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?Gs(t.S,e.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,s=Math.round(i*(t.S+t.u)),s>=60*i&&(s=0),e==="s"?s===0?"0":""+s/i:(a=Gs(s,2+n),e==="ss"?a.substr(0,2):"."+a.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":c=t.D*24+t.H;break;case"[m]":case"[mm]":c=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":c=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}l=e.length===3?1:2;break;case 101:c=o,l=1;break}var u=l>0?Gs(c,l):"";return u}function Do(r){var e=3;if(r.length<=e)return r;for(var t=r.length%e,n=r.substr(0,t);t!=r.length;t+=e)n+=(n.length>0?",":"")+r.substr(t,e);return n}var xw=/%/g;function TT(r,e,t){var n=e.replace(xw,""),a=e.length-n.length;return Bi(r,n,t*Math.pow(10,2*a))+ln("%",a)}function kT(r,e,t){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Bi(r,e.substr(0,n),t/Math.pow(10,3*(e.length-n)))}function vw(r,e){var t,n=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+vw(r,-e);var a=r.indexOf(".");a===-1&&(a=r.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%a;if(s<0&&(s+=a),t=(e/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),t.indexOf("e")===-1){var i=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(i-t.length+s):t+="E+"+(i-s);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,a)+"."+t.substr(2+a),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,u){return c+l+u.substr(0,(a+s)%a)+"."+u.substr(s)+"E"})}else t=e.toExponential(n);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var yw=/# (\?+)( ?)\/( ?)(\d+)/;function IT(r,e,t){var n=parseInt(r[4],10),a=Math.round(e*n),s=Math.floor(a/n),i=a-s*n,o=n;return t+(s===0?"":""+s)+" "+(i===0?ln(" ",r[1].length+1+r[4].length):x1(i,r[1].length)+r[2]+"/"+r[3]+Gs(o,r[4].length))}function CT(r,e,t){return t+(e===0?"":""+e)+ln(" ",r[1].length+2+r[4].length)}var ww=/^#*0*\.([0#]+)/,_w=/\).*[0#]/,bw=/\(###\) ###\\?-####/;function Aa(r){for(var e="",t,n=0;n!=r.length;++n)switch(t=r.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function a2(r,e){var t=Math.pow(10,e);return""+Math.round(r*t)/t}function s2(r,e){var t=r-Math.floor(r),n=Math.pow(10,e);return e<(""+Math.round(t*n)).length?0:Math.round(t*n)}function PT(r,e){return e<(""+Math.round((r-Math.floor(r))*Math.pow(10,e))).length?1:0}function FT(r){return r<2147483647&&r>-2147483648?""+(r>=0?r|0:r-1|0):""+Math.floor(r)}function vs(r,e,t){if(r.charCodeAt(0)===40&&!e.match(_w)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?vs("n",n,t):"("+vs("n",n,-t)+")"}if(e.charCodeAt(e.length-1)===44)return kT(r,e,t);if(e.indexOf("%")!==-1)return TT(r,e,t);if(e.indexOf("E")!==-1)return vw(e,t);if(e.charCodeAt(0)===36)return"$"+vs(r,e.substr(e.charAt(1)==" "?2:1),t);var a,s,i,o,c=Math.abs(t),l=t<0?"-":"";if(e.match(/^00+$/))return l+Rl(c,e.length);if(e.match(/^[#?]+$/))return a=Rl(t,0),a==="0"&&(a=""),a.length>e.length?a:Aa(e.substr(0,e.length-a.length))+a;if(s=e.match(yw))return IT(s,c,l);if(e.match(/^#+0+$/))return l+Rl(c,e.length-e.indexOf("0"));if(s=e.match(ww))return a=a2(t,s[1].length).replace(/^([^\.]+)$/,"$1."+Aa(s[1])).replace(/\.$/,"."+Aa(s[1])).replace(/\.(\d*)$/,function(y,v){return"."+v+ln("0",Aa(s[1]).length-v.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return l+a2(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return l+Do(Rl(c,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+vs(r,e,-t):Do(""+(Math.floor(t)+PT(t,s[1].length)))+"."+Gs(s2(t,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return vs(r,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Yl(vs(r,e.replace(/[\\-]/g,""),t)),i=0,Yl(Yl(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return i<a.length?a.charAt(i++):y==="0"?"0":""}));if(e.match(bw))return a=vs(r,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=Of(c,Math.pow(10,i)-1,!1),a=""+l,u=Bi("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+s[2]+"/"+s[3],u=Lf(o[2],i),u.length<s[4].length&&(u=Aa(s[4].substr(s[4].length-u.length))+u),a+=u,a;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=Of(c,Math.pow(10,i)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?x1(o[1],i)+s[2]+"/"+s[3]+Lf(o[2],i):ln(" ",2*i+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return a=Rl(t,0),e.length<=a.length?a:Aa(e.substr(0,e.length-a.length))+a;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var d=e.indexOf(".")-i,g=e.length-a.length-d;return Aa(e.substr(0,d)+a+e.substr(e.length-g))}if(s=e.match(/^00,000\.([#0]*0)$/))return i=s2(t,s[1].length),t<0?"-"+vs(r,e,-t):Do(FT(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Gs(0,3-y.length):"")+y})+"."+Gs(i,s[1].length);switch(e){case"###,##0.00":return vs(r,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var p=Do(Rl(c,0));return p!=="0"?l+p:"";case"###,###.00":return vs(r,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return vs(r,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function RT(r,e,t){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Bi(r,e.substr(0,n),t/Math.pow(10,3*(e.length-n)))}function DT(r,e,t){var n=e.replace(xw,""),a=e.length-n.length;return Bi(r,n,t*Math.pow(10,2*a))+ln("%",a)}function Ew(r,e){var t,n=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Ew(r,-e);var a=r.indexOf(".");a===-1&&(a=r.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%a;if(s<0&&(s+=a),t=(e/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!t.match(/[Ee]/)){var i=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(i-t.length+s):t+="E+"+(i-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,u){return c+l+u.substr(0,(a+s)%a)+"."+u.substr(s)+"E"})}else t=e.toExponential(n);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function ii(r,e,t){if(r.charCodeAt(0)===40&&!e.match(_w)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?ii("n",n,t):"("+ii("n",n,-t)+")"}if(e.charCodeAt(e.length-1)===44)return RT(r,e,t);if(e.indexOf("%")!==-1)return DT(r,e,t);if(e.indexOf("E")!==-1)return Ew(e,t);if(e.charCodeAt(0)===36)return"$"+ii(r,e.substr(e.charAt(1)==" "?2:1),t);var a,s,i,o,c=Math.abs(t),l=t<0?"-":"";if(e.match(/^00+$/))return l+Gs(c,e.length);if(e.match(/^[#?]+$/))return a=""+t,t===0&&(a=""),a.length>e.length?a:Aa(e.substr(0,e.length-a.length))+a;if(s=e.match(yw))return CT(s,c,l);if(e.match(/^#+0+$/))return l+Gs(c,e.length-e.indexOf("0"));if(s=e.match(ww))return a=(""+t).replace(/^([^\.]+)$/,"$1."+Aa(s[1])).replace(/\.$/,"."+Aa(s[1])),a=a.replace(/\.(\d*)$/,function(y,v){return"."+v+ln("0",Aa(s[1]).length-v.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return l+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return l+Do(""+c);if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+ii(r,e,-t):Do(""+t)+"."+ln("0",s[1].length);if(s=e.match(/^#,#*,#0/))return ii(r,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Yl(ii(r,e.replace(/[\\-]/g,""),t)),i=0,Yl(Yl(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return i<a.length?a.charAt(i++):y==="0"?"0":""}));if(e.match(bw))return a=ii(r,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=Of(c,Math.pow(10,i)-1,!1),a=""+l,u=Bi("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+s[2]+"/"+s[3],u=Lf(o[2],i),u.length<s[4].length&&(u=Aa(s[4].substr(s[4].length-u.length))+u),a+=u,a;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=Of(c,Math.pow(10,i)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?x1(o[1],i)+s[2]+"/"+s[3]+Lf(o[2],i):ln(" ",2*i+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return a=""+t,e.length<=a.length?a:Aa(e.substr(0,e.length-a.length))+a;if(s=e.match(/^([#0]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var d=e.indexOf(".")-i,g=e.length-a.length-d;return Aa(e.substr(0,d)+a+e.substr(e.length-g))}if(s=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+ii(r,e,-t):Do(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Gs(0,3-y.length):"")+y})+"."+Gs(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var p=Do(""+c);return p!=="0"?l+p:"";default:if(e.match(/\.[0#?]*$/))return ii(r,e.slice(0,e.lastIndexOf(".")),t)+Aa(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Bi(r,e,t){return(t|0)===t?ii(r,e,t):vs(r,e,t)}function LT(r){for(var e=[],t=!1,n=0,a=0;n<r.length;++n)switch(r.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=r.substr(a,n-a),a=n+1}if(e[e.length]=r.substr(a),t===!0)throw new Error("Format |"+r+"| unterminated string ");return e}var Sw=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function _u(r){for(var e=0,t="",n="";e<r.length;)switch(t=r.charAt(e)){case"G":jf(r,e)&&(e+=6),e++;break;case'"':for(;r.charCodeAt(++e)!==34&&e<r.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(r.charAt(e+1)==="1"||r.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(r.substr(e,3).toUpperCase()==="A/P"||r.substr(e,5).toUpperCase()==="AM/PM"||r.substr(e,5).toUpperCase()==="上午/下午")return!0;++e;break;case"[":for(n=t;r.charAt(e++)!=="]"&&e<r.length;)n+=r.charAt(e);if(n.match(Sw))return!0;break;case".":case"0":case"#":for(;e<r.length&&("0#?.,E+-%".indexOf(t=r.charAt(++e))>-1||t=="\\"&&r.charAt(e+1)=="-"&&"0#".indexOf(r.charAt(e+2))>-1););break;case"?":for(;r.charAt(++e)===t;);break;case"*":++e,(r.charAt(e)==" "||r.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<r.length&&"0123456789".indexOf(r.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function jT(r,e,t,n){for(var a=[],s="",i=0,o="",c="t",l,u,d,g="H";i<r.length;)switch(o=r.charAt(i)){case"G":if(!jf(r,i))throw new Error("unrecognized character "+o+" in "+r);a[a.length]={t:"G",v:"General"},i+=7;break;case'"':for(s="";(d=r.charCodeAt(++i))!==34&&i<r.length;)s+=String.fromCharCode(d);a[a.length]={t:"t",v:s},++i;break;case"\\":var p=r.charAt(++i),y=p==="("||p===")"?p:"t";a[a.length]={t:y,v:p},++i;break;case"_":a[a.length]={t:"t",v:" "},i+=2;break;case"@":a[a.length]={t:"T",v:e},++i;break;case"B":case"b":if(r.charAt(i+1)==="1"||r.charAt(i+1)==="2"){if(l==null&&(l=kc(e,t,r.charAt(i+1)==="2"),l==null))return"";a[a.length]={t:"X",v:r.substr(i,2)},c=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||l==null&&(l=kc(e,t),l==null))return"";for(s=o;++i<r.length&&r.charAt(i).toLowerCase()===o;)s+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=g),a[a.length]={t:o,v:s},c=o;break;case"A":case"a":case"上":var v={t:o,v:o};if(l==null&&(l=kc(e,t)),r.substr(i,3).toUpperCase()==="A/P"?(l!=null&&(v.v=l.H>=12?"P":"A"),v.t="T",g="h",i+=3):r.substr(i,5).toUpperCase()==="AM/PM"?(l!=null&&(v.v=l.H>=12?"PM":"AM"),v.t="T",i+=5,g="h"):r.substr(i,5).toUpperCase()==="上午/下午"?(l!=null&&(v.v=l.H>=12?"下午":"上午"),v.t="T",i+=5,g="h"):(v.t="t",++i),l==null&&v.t==="T")return"";a[a.length]=v,c=o;break;case"[":for(s=o;r.charAt(i++)!=="]"&&i<r.length;)s+=r.charAt(i);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(Sw)){if(l==null&&(l=kc(e,t),l==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",_u(r)||(a[a.length]={t:"t",v:s}));break;case".":if(l!=null){for(s=o;++i<r.length&&(o=r.charAt(i))==="0";)s+=o;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++i<r.length&&"0#?.,E+-%".indexOf(o=r.charAt(i))>-1;)s+=o;a[a.length]={t:"n",v:s};break;case"?":for(s=o;r.charAt(++i)===o;)s+=o;a[a.length]={t:o,v:s},c=o;break;case"*":++i,(r.charAt(i)==" "||r.charAt(i)=="*")&&++i;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;i<r.length&&"0123456789".indexOf(r.charAt(++i))>-1;)s+=r.charAt(i);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:o,v:o},++i;break;case"$":a[a.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+r);a[a.length]={t:"t",v:o},++i;break}var w=0,E=0,R;for(i=a.length-1,c="t";i>=0;--i)switch(a[i].t){case"h":case"H":a[i].t=g,c="h",w<1&&(w=1);break;case"s":(R=a[i].v.match(/\.0+$/))&&(E=Math.max(E,R[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":c=a[i].t;break;case"m":c==="s"&&(a[i].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&a[i].v.match(/[Hh]/)&&(w=1),w<2&&a[i].v.match(/[Mm]/)&&(w=2),w<3&&a[i].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M),l.M>=60&&(l.M=0,++l.H);break;case 2:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M);break}var P="",q;for(i=0;i<a.length;++i)switch(a[i].t){case"t":case"T":case" ":case"D":break;case"X":a[i].v="",a[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[i].v=NT(a[i].t.charCodeAt(0),a[i].v,l,E),a[i].t="t";break;case"n":case"?":for(q=i+1;a[q]!=null&&((o=a[q].t)==="?"||o==="D"||(o===" "||o==="t")&&a[q+1]!=null&&(a[q+1].t==="?"||a[q+1].t==="t"&&a[q+1].v==="/")||a[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[q].v==="/"||a[q].v===" "&&a[q+1]!=null&&a[q+1].t=="?"));)a[i].v+=a[q].v,a[q]={v:"",t:";"},++q;P+=a[i].v,i=q-1;break;case"G":a[i].t="t",a[i].v=Hc(e,t);break}var z="",K,I;if(P.length>0){P.charCodeAt(0)==40?(K=e<0&&P.charCodeAt(0)===45?-e:e,I=Bi("n",P,K)):(K=e<0&&n>1?-e:e,I=Bi("n",P,K),K<0&&a[0]&&a[0].t=="t"&&(I=I.substr(1),a[0].v="-"+a[0].v)),q=I.length-1;var N=a.length;for(i=0;i<a.length;++i)if(a[i]!=null&&a[i].t!="t"&&a[i].v.indexOf(".")>-1){N=i;break}var F=a.length;if(N===a.length&&I.indexOf("E")===-1){for(i=a.length-1;i>=0;--i)a[i]==null||"n?".indexOf(a[i].t)===-1||(q>=a[i].v.length-1?(q-=a[i].v.length,a[i].v=I.substr(q+1,a[i].v.length)):q<0?a[i].v="":(a[i].v=I.substr(0,q+1),q=-1),a[i].t="t",F=i);q>=0&&F<a.length&&(a[F].v=I.substr(0,q+1)+a[F].v)}else if(N!==a.length&&I.indexOf("E")===-1){for(q=I.indexOf(".")-1,i=N;i>=0;--i)if(!(a[i]==null||"n?".indexOf(a[i].t)===-1)){for(u=a[i].v.indexOf(".")>-1&&i===N?a[i].v.indexOf(".")-1:a[i].v.length-1,z=a[i].v.substr(u+1);u>=0;--u)q>=0&&(a[i].v.charAt(u)==="0"||a[i].v.charAt(u)==="#")&&(z=I.charAt(q--)+z);a[i].v=z,a[i].t="t",F=i}for(q>=0&&F<a.length&&(a[F].v=I.substr(0,q+1)+a[F].v),q=I.indexOf(".")+1,i=N;i<a.length;++i)if(!(a[i]==null||"n?(".indexOf(a[i].t)===-1&&i!==N)){for(u=a[i].v.indexOf(".")>-1&&i===N?a[i].v.indexOf(".")+1:0,z=a[i].v.substr(0,u);u<a[i].v.length;++u)q<I.length&&(z+=I.charAt(q++));a[i].v=z,a[i].t="t",F=i}}}for(i=0;i<a.length;++i)a[i]!=null&&"n?".indexOf(a[i].t)>-1&&(K=n>1&&e<0&&i>0&&a[i-1].v==="-"?-e:e,a[i].v=Bi(a[i].t,a[i].v,K),a[i].t="t");var j="";for(i=0;i!==a.length;++i)a[i]!=null&&(j+=a[i].v);return j}var i2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function o2(r,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(r==t)return!0;break;case">":if(r>t)return!0;break;case"<":if(r<t)return!0;break;case"<>":if(r!=t)return!0;break;case">=":if(r>=t)return!0;break;case"<=":if(r<=t)return!0;break}return!1}function OT(r,e){var t=LT(r),n=t.length,a=t[n-1].indexOf("@");if(n<4&&a>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||a>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=a>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=a>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=a>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var s=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,s];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var i=t[0].match(i2),o=t[1].match(i2);return o2(e,i)?[n,t[0]]:o2(e,o)?[n,t[1]]:[n,t[i!=null&&o!=null?2:1]]}return[n,s]}function ks(r,e,t){t==null&&(t={});var n="";switch(typeof r){case"string":r=="m/d/yy"&&t.dateNF?n=t.dateNF:n=r;break;case"number":r==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:Mt)[r],n==null&&(n=t.table&&t.table[n2[r]]||Mt[n2[r]]),n==null&&(n=yT[r]||"General");break}if(jf(n,0))return Hc(e,t);e instanceof Date&&(e=gw(e,t.date1904));var a=OT(n,e);if(jf(a[1]))return Hc(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return jT(a[1],e,t,a[0])}function Vi(r,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(Mt[t]==null){e<0&&(e=t);continue}if(Mt[t]==r){e=t;break}}e<0&&(e=391)}return Mt[e]=r,e}function yd(r){for(var e=0;e!=392;++e)r[e]!==void 0&&Vi(r[e],e)}function bu(){Mt=vT()}var MT={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Aw=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function BT(r){var e=typeof r=="number"?Mt[r]:r;return e=e.replace(Aw,"(\\d+)"),new RegExp("^"+e+"$")}function VT(r,e,t){var n=-1,a=-1,s=-1,i=-1,o=-1,c=-1;(e.match(Aw)||[]).forEach(function(d,g){var p=parseInt(t[g+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=p;break;case"d":s=p;break;case"h":i=p;break;case"s":c=p;break;case"m":i>=0?o=p:a=p;break}}),c>=0&&o==-1&&a>=0&&(o=a,a=-1);var l=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);l.length==7&&(l="0"+l),l.length==8&&(l="20"+l);var u=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return i==-1&&o==-1&&c==-1?l:n==-1&&a==-1&&s==-1?u:l+"T"+u}var UT=function(){var r={};r.version="1.2.0";function e(){for(var I=0,N=new Array(256),F=0;F!=256;++F)I=F,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,N[F]=I;return typeof Int32Array<"u"?new Int32Array(N):N}var t=e();function n(I){var N=0,F=0,j=0,S=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(j=0;j!=256;++j)S[j]=I[j];for(j=0;j!=256;++j)for(F=I[j],N=256+j;N<4096;N+=256)F=S[N]=F>>>8^I[F&255];var A=[];for(j=1;j!=16;++j)A[j-1]=typeof Int32Array<"u"?S.subarray(j*256,j*256+256):S.slice(j*256,j*256+256);return A}var a=n(t),s=a[0],i=a[1],o=a[2],c=a[3],l=a[4],u=a[5],d=a[6],g=a[7],p=a[8],y=a[9],v=a[10],w=a[11],E=a[12],R=a[13],P=a[14];function q(I,N){for(var F=N^-1,j=0,S=I.length;j<S;)F=F>>>8^t[(F^I.charCodeAt(j++))&255];return~F}function z(I,N){for(var F=N^-1,j=I.length-15,S=0;S<j;)F=P[I[S++]^F&255]^R[I[S++]^F>>8&255]^E[I[S++]^F>>16&255]^w[I[S++]^F>>>24]^v[I[S++]]^y[I[S++]]^p[I[S++]]^g[I[S++]]^d[I[S++]]^u[I[S++]]^l[I[S++]]^c[I[S++]]^o[I[S++]]^i[I[S++]]^s[I[S++]]^t[I[S++]];for(j+=15;S<j;)F=F>>>8^t[(F^I[S++])&255];return~F}function K(I,N){for(var F=N^-1,j=0,S=I.length,A=0,C=0;j<S;)A=I.charCodeAt(j++),A<128?F=F>>>8^t[(F^A)&255]:A<2048?(F=F>>>8^t[(F^(192|A>>6&31))&255],F=F>>>8^t[(F^(128|A&63))&255]):A>=55296&&A<57344?(A=(A&1023)+64,C=I.charCodeAt(j++)&1023,F=F>>>8^t[(F^(240|A>>8&7))&255],F=F>>>8^t[(F^(128|A>>2&63))&255],F=F>>>8^t[(F^(128|C>>6&15|(A&3)<<4))&255],F=F>>>8^t[(F^(128|C&63))&255]):(F=F>>>8^t[(F^(224|A>>12&15))&255],F=F>>>8^t[(F^(128|A>>6&63))&255],F=F>>>8^t[(F^(128|A&63))&255]);return~F}return r.table=t,r.bstr=q,r.buf=z,r.str=K,r}(),Pt=function(){var e={};e.version="1.2.1";function t(W,oe){for(var te=W.split("/"),re=oe.split("/"),ie=0,ce=0,Te=Math.min(te.length,re.length);ie<Te;++ie){if(ce=te[ie].length-re[ie].length)return ce;if(te[ie]!=re[ie])return te[ie]<re[ie]?-1:1}return te.length-re.length}function n(W){if(W.charAt(W.length-1)=="/")return W.slice(0,-1).indexOf("/")===-1?W:n(W.slice(0,-1));var oe=W.lastIndexOf("/");return oe===-1?W:W.slice(0,oe+1)}function a(W){if(W.charAt(W.length-1)=="/")return a(W.slice(0,-1));var oe=W.lastIndexOf("/");return oe===-1?W:W.slice(oe+1)}function s(W,oe){typeof oe=="string"&&(oe=new Date(oe));var te=oe.getHours();te=te<<6|oe.getMinutes(),te=te<<5|oe.getSeconds()>>>1,W.write_shift(2,te);var re=oe.getFullYear()-1980;re=re<<4|oe.getMonth()+1,re=re<<5|oe.getDate(),W.write_shift(2,re)}function i(W){var oe=W.read_shift(2)&65535,te=W.read_shift(2)&65535,re=new Date,ie=te&31;te>>>=5;var ce=te&15;te>>>=4,re.setMilliseconds(0),re.setFullYear(te+1980),re.setMonth(ce-1),re.setDate(ie);var Te=oe&31;oe>>>=5;var je=oe&63;return oe>>>=6,re.setHours(oe),re.setMinutes(je),re.setSeconds(Te<<1),re}function o(W){Qn(W,0);for(var oe={},te=0;W.l<=W.length-4;){var re=W.read_shift(2),ie=W.read_shift(2),ce=W.l+ie,Te={};switch(re){case 21589:te=W.read_shift(1),te&1&&(Te.mtime=W.read_shift(4)),ie>5&&(te&2&&(Te.atime=W.read_shift(4)),te&4&&(Te.ctime=W.read_shift(4))),Te.mtime&&(Te.mt=new Date(Te.mtime*1e3));break}W.l=ce,oe[re]=Te}return oe}var c;function l(){return c||(c={})}function u(W,oe){if(W[0]==80&&W[1]==75)return Pr(W,oe);if((W[0]|32)==109&&(W[1]|32)==105)return ya(W,oe);if(W.length<512)throw new Error("CFB file size "+W.length+" < 512");var te=3,re=512,ie=0,ce=0,Te=0,je=0,ke=0,Ie=[],Le=W.slice(0,512);Qn(Le,0);var Je=d(Le);switch(te=Je[0],te){case 3:re=512;break;case 4:re=4096;break;case 0:if(Je[1]==0)return Pr(W,oe);default:throw new Error("Major Version: Expected 3 or 4 saw "+te)}re!==512&&(Le=W.slice(0,re),Qn(Le,28));var it=W.slice(0,re);g(Le,te);var gt=Le.read_shift(4,"i");if(te===3&&gt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+gt);Le.l+=4,Te=Le.read_shift(4,"i"),Le.l+=4,Le.chk("00100000","Mini Stream Cutoff Size: "),je=Le.read_shift(4,"i"),ie=Le.read_shift(4,"i"),ke=Le.read_shift(4,"i"),ce=Le.read_shift(4,"i");for(var nt=-1,ft=0;ft<109&&(nt=Le.read_shift(4,"i"),!(nt<0));++ft)Ie[ft]=nt;var Ot=p(W,re);w(ke,ce,Ot,re,Ie);var lr=R(Ot,Te,Ie,re);lr[Te].name="!Directory",ie>0&&je!==C&&(lr[je].name="!MiniFAT"),lr[Ie[0]].name="!FAT",lr.fat_addrs=Ie,lr.ssz=re;var ur={},Fr=[],wa=[],Cs=[];P(Te,lr,Ot,Fr,ie,ur,wa,je),y(wa,Cs,Fr),Fr.shift();var Ga={FileIndex:wa,FullPaths:Cs};return oe&&oe.raw&&(Ga.raw={header:it,sectors:Ot}),Ga}function d(W){if(W[W.l]==80&&W[W.l+1]==75)return[0,0];W.chk(J,"Header Signature: "),W.l+=16;var oe=W.read_shift(2,"u");return[W.read_shift(2,"u"),oe]}function g(W,oe){var te=9;switch(W.l+=2,te=W.read_shift(2)){case 9:if(oe!=3)throw new Error("Sector Shift: Expected 9 saw "+te);break;case 12:if(oe!=4)throw new Error("Sector Shift: Expected 12 saw "+te);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+te)}W.chk("0600","Mini Sector Shift: "),W.chk("000000000000","Reserved: ")}function p(W,oe){for(var te=Math.ceil(W.length/oe)-1,re=[],ie=1;ie<te;++ie)re[ie-1]=W.slice(ie*oe,(ie+1)*oe);return re[te-1]=W.slice(te*oe),re}function y(W,oe,te){for(var re=0,ie=0,ce=0,Te=0,je=0,ke=te.length,Ie=[],Le=[];re<ke;++re)Ie[re]=Le[re]=re,oe[re]=te[re];for(;je<Le.length;++je)re=Le[je],ie=W[re].L,ce=W[re].R,Te=W[re].C,Ie[re]===re&&(ie!==-1&&Ie[ie]!==ie&&(Ie[re]=Ie[ie]),ce!==-1&&Ie[ce]!==ce&&(Ie[re]=Ie[ce])),Te!==-1&&(Ie[Te]=re),ie!==-1&&re!=Ie[re]&&(Ie[ie]=Ie[re],Le.lastIndexOf(ie)<je&&Le.push(ie)),ce!==-1&&re!=Ie[re]&&(Ie[ce]=Ie[re],Le.lastIndexOf(ce)<je&&Le.push(ce));for(re=1;re<ke;++re)Ie[re]===re&&(ce!==-1&&Ie[ce]!==ce?Ie[re]=Ie[ce]:ie!==-1&&Ie[ie]!==ie&&(Ie[re]=Ie[ie]));for(re=1;re<ke;++re)if(W[re].type!==0){if(je=re,je!=Ie[je])do je=Ie[je],oe[re]=oe[je]+"/"+oe[re];while(je!==0&&Ie[je]!==-1&&je!=Ie[je]);Ie[re]=-1}for(oe[0]+="/",re=1;re<ke;++re)W[re].type!==2&&(oe[re]+="/")}function v(W,oe,te){for(var re=W.start,ie=W.size,ce=[],Te=re;te&&ie>0&&Te>=0;)ce.push(oe.slice(Te*A,Te*A+A)),ie-=A,Te=Nc(te,Te*4);return ce.length===0?Ue(0):qn(ce).slice(0,W.size)}function w(W,oe,te,re,ie){var ce=C;if(W===C){if(oe!==0)throw new Error("DIFAT chain shorter than expected")}else if(W!==-1){var Te=te[W],je=(re>>>2)-1;if(!Te)return;for(var ke=0;ke<je&&(ce=Nc(Te,ke*4))!==C;++ke)ie.push(ce);w(Nc(Te,re-4),oe-1,te,re,ie)}}function E(W,oe,te,re,ie){var ce=[],Te=[];ie||(ie=[]);var je=re-1,ke=0,Ie=0;for(ke=oe;ke>=0;){ie[ke]=!0,ce[ce.length]=ke,Te.push(W[ke]);var Le=te[Math.floor(ke*4/re)];if(Ie=ke*4&je,re<4+Ie)throw new Error("FAT boundary crossed: "+ke+" 4 "+re);if(!W[Le])break;ke=Nc(W[Le],Ie)}return{nodes:ce,data:y2([Te])}}function R(W,oe,te,re){var ie=W.length,ce=[],Te=[],je=[],ke=[],Ie=re-1,Le=0,Je=0,it=0,gt=0;for(Le=0;Le<ie;++Le)if(je=[],it=Le+oe,it>=ie&&(it-=ie),!Te[it]){ke=[];var nt=[];for(Je=it;Je>=0;){nt[Je]=!0,Te[Je]=!0,je[je.length]=Je,ke.push(W[Je]);var ft=te[Math.floor(Je*4/re)];if(gt=Je*4&Ie,re<4+gt)throw new Error("FAT boundary crossed: "+Je+" 4 "+re);if(!W[ft]||(Je=Nc(W[ft],gt),nt[Je]))break}ce[it]={nodes:je,data:y2([ke])}}return ce}function P(W,oe,te,re,ie,ce,Te,je){for(var ke=0,Ie=re.length?2:0,Le=oe[W].data,Je=0,it=0,gt;Je<Le.length;Je+=128){var nt=Le.slice(Je,Je+128);Qn(nt,64),it=nt.read_shift(2),gt=A1(nt,0,it-Ie),re.push(gt);var ft={name:gt,type:nt.read_shift(1),color:nt.read_shift(1),L:nt.read_shift(4,"i"),R:nt.read_shift(4,"i"),C:nt.read_shift(4,"i"),clsid:nt.read_shift(16),state:nt.read_shift(4,"i"),start:0,size:0},Ot=nt.read_shift(2)+nt.read_shift(2)+nt.read_shift(2)+nt.read_shift(2);Ot!==0&&(ft.ct=q(nt,nt.l-8));var lr=nt.read_shift(2)+nt.read_shift(2)+nt.read_shift(2)+nt.read_shift(2);lr!==0&&(ft.mt=q(nt,nt.l-8)),ft.start=nt.read_shift(4,"i"),ft.size=nt.read_shift(4,"i"),ft.size<0&&ft.start<0&&(ft.size=ft.type=0,ft.start=C,ft.name=""),ft.type===5?(ke=ft.start,ie>0&&ke!==C&&(oe[ke].name="!StreamData")):ft.size>=4096?(ft.storage="fat",oe[ft.start]===void 0&&(oe[ft.start]=E(te,ft.start,oe.fat_addrs,oe.ssz)),oe[ft.start].name=ft.name,ft.content=oe[ft.start].data.slice(0,ft.size)):(ft.storage="minifat",ft.size<0?ft.size=0:ke!==C&&ft.start!==C&&oe[ke]&&(ft.content=v(ft,oe[ke].data,(oe[je]||{}).data))),ft.content&&Qn(ft.content,0),ce[gt]=ft,Te.push(ft)}}function q(W,oe){return new Date((ts(W,oe+4)/1e7*Math.pow(2,32)+ts(W,oe)/1e7-11644473600)*1e3)}function z(W,oe){return l(),u(c.readFileSync(W),oe)}function K(W,oe){var te=oe&&oe.type;switch(te||Zt&&Buffer.isBuffer(W)&&(te="buffer"),te||"base64"){case"file":return z(W,oe);case"base64":return u(rs(cs(W)),oe);case"binary":return u(rs(W),oe)}return u(W,oe)}function I(W,oe){var te=oe||{},re=te.root||"Root Entry";if(W.FullPaths||(W.FullPaths=[]),W.FileIndex||(W.FileIndex=[]),W.FullPaths.length!==W.FileIndex.length)throw new Error("inconsistent CFB structure");W.FullPaths.length===0&&(W.FullPaths[0]=re+"/",W.FileIndex[0]={name:re,type:5}),te.CLSID&&(W.FileIndex[0].clsid=te.CLSID),N(W)}function N(W){var oe="Sh33tJ5";if(!Pt.find(W,"/"+oe)){var te=Ue(4);te[0]=55,te[1]=te[3]=50,te[2]=54,W.FileIndex.push({name:oe,type:2,content:te,size:4,L:69,R:69,C:69}),W.FullPaths.push(W.FullPaths[0]+oe),F(W)}}function F(W,oe){I(W);for(var te=!1,re=!1,ie=W.FullPaths.length-1;ie>=0;--ie){var ce=W.FileIndex[ie];switch(ce.type){case 0:re?te=!0:(W.FileIndex.pop(),W.FullPaths.pop());break;case 1:case 2:case 5:re=!0,isNaN(ce.R*ce.L*ce.C)&&(te=!0),ce.R>-1&&ce.L>-1&&ce.R==ce.L&&(te=!0);break;default:te=!0;break}}if(!(!te&&!oe)){var Te=new Date(1987,1,19),je=0,ke=Object.create?Object.create(null):{},Ie=[];for(ie=0;ie<W.FullPaths.length;++ie)ke[W.FullPaths[ie]]=!0,W.FileIndex[ie].type!==0&&Ie.push([W.FullPaths[ie],W.FileIndex[ie]]);for(ie=0;ie<Ie.length;++ie){var Le=n(Ie[ie][0]);re=ke[Le],re||(Ie.push([Le,{name:a(Le).replace("/",""),type:1,clsid:me,ct:Te,mt:Te,content:null}]),ke[Le]=!0)}for(Ie.sort(function(gt,nt){return t(gt[0],nt[0])}),W.FullPaths=[],W.FileIndex=[],ie=0;ie<Ie.length;++ie)W.FullPaths[ie]=Ie[ie][0],W.FileIndex[ie]=Ie[ie][1];for(ie=0;ie<Ie.length;++ie){var Je=W.FileIndex[ie],it=W.FullPaths[ie];if(Je.name=a(it).replace("/",""),Je.L=Je.R=Je.C=-(Je.color=1),Je.size=Je.content?Je.content.length:0,Je.start=0,Je.clsid=Je.clsid||me,ie===0)Je.C=Ie.length>1?1:-1,Je.size=0,Je.type=5;else if(it.slice(-1)=="/"){for(je=ie+1;je<Ie.length&&n(W.FullPaths[je])!=it;++je);for(Je.C=je>=Ie.length?-1:je,je=ie+1;je<Ie.length&&n(W.FullPaths[je])!=n(it);++je);Je.R=je>=Ie.length?-1:je,Je.type=1}else n(W.FullPaths[ie+1]||"")==n(it)&&(Je.R=ie+1),Je.type=2}}}function j(W,oe){var te=oe||{};if(te.fileType=="mad")return bt(W,te);switch(F(W),te.fileType){case"zip":return va(W,te)}var re=function(gt){for(var nt=0,ft=0,Ot=0;Ot<gt.FileIndex.length;++Ot){var lr=gt.FileIndex[Ot];if(lr.content){var ur=lr.content.length;ur>0&&(ur<4096?nt+=ur+63>>6:ft+=ur+511>>9)}}for(var Fr=gt.FullPaths.length+3>>2,wa=nt+7>>3,Cs=nt+127>>7,Ga=wa+ft+Fr+Cs,Ra=Ga+127>>7,$a=Ra<=109?0:Math.ceil((Ra-109)/127);Ga+Ra+$a+127>>7>Ra;)$a=++Ra<=109?0:Math.ceil((Ra-109)/127);var Wn=[1,$a,Ra,Cs,Fr,ft,nt,0];return gt.FileIndex[0].size=nt<<6,Wn[7]=(gt.FileIndex[0].start=Wn[0]+Wn[1]+Wn[2]+Wn[3]+Wn[4]+Wn[5])+(Wn[6]+7>>3),Wn}(W),ie=Ue(re[7]<<9),ce=0,Te=0;{for(ce=0;ce<8;++ce)ie.write_shift(1,ue[ce]);for(ce=0;ce<8;++ce)ie.write_shift(2,0);for(ie.write_shift(2,62),ie.write_shift(2,3),ie.write_shift(2,65534),ie.write_shift(2,9),ie.write_shift(2,6),ce=0;ce<3;++ce)ie.write_shift(2,0);for(ie.write_shift(4,0),ie.write_shift(4,re[2]),ie.write_shift(4,re[0]+re[1]+re[2]+re[3]-1),ie.write_shift(4,0),ie.write_shift(4,4096),ie.write_shift(4,re[3]?re[0]+re[1]+re[2]-1:C),ie.write_shift(4,re[3]),ie.write_shift(-4,re[1]?re[0]-1:C),ie.write_shift(4,re[1]),ce=0;ce<109;++ce)ie.write_shift(-4,ce<re[2]?re[1]+ce:-1)}if(re[1])for(Te=0;Te<re[1];++Te){for(;ce<236+Te*127;++ce)ie.write_shift(-4,ce<re[2]?re[1]+ce:-1);ie.write_shift(-4,Te===re[1]-1?C:Te+1)}var je=function(gt){for(Te+=gt;ce<Te-1;++ce)ie.write_shift(-4,ce+1);gt&&(++ce,ie.write_shift(-4,C))};for(Te=ce=0,Te+=re[1];ce<Te;++ce)ie.write_shift(-4,pe.DIFSECT);for(Te+=re[2];ce<Te;++ce)ie.write_shift(-4,pe.FATSECT);je(re[3]),je(re[4]);for(var ke=0,Ie=0,Le=W.FileIndex[0];ke<W.FileIndex.length;++ke)Le=W.FileIndex[ke],Le.content&&(Ie=Le.content.length,!(Ie<4096)&&(Le.start=Te,je(Ie+511>>9)));for(je(re[6]+7>>3);ie.l&511;)ie.write_shift(-4,pe.ENDOFCHAIN);for(Te=ce=0,ke=0;ke<W.FileIndex.length;++ke)Le=W.FileIndex[ke],Le.content&&(Ie=Le.content.length,!(!Ie||Ie>=4096)&&(Le.start=Te,je(Ie+63>>6)));for(;ie.l&511;)ie.write_shift(-4,pe.ENDOFCHAIN);for(ce=0;ce<re[4]<<2;++ce){var Je=W.FullPaths[ce];if(!Je||Je.length===0){for(ke=0;ke<17;++ke)ie.write_shift(4,0);for(ke=0;ke<3;++ke)ie.write_shift(4,-1);for(ke=0;ke<12;++ke)ie.write_shift(4,0);continue}Le=W.FileIndex[ce],ce===0&&(Le.start=Le.size?Le.start-1:C);var it=ce===0&&te.root||Le.name;if(Ie=2*(it.length+1),ie.write_shift(64,it,"utf16le"),ie.write_shift(2,Ie),ie.write_shift(1,Le.type),ie.write_shift(1,Le.color),ie.write_shift(-4,Le.L),ie.write_shift(-4,Le.R),ie.write_shift(-4,Le.C),Le.clsid)ie.write_shift(16,Le.clsid,"hex");else for(ke=0;ke<4;++ke)ie.write_shift(4,0);ie.write_shift(4,Le.state||0),ie.write_shift(4,0),ie.write_shift(4,0),ie.write_shift(4,0),ie.write_shift(4,0),ie.write_shift(4,Le.start),ie.write_shift(4,Le.size),ie.write_shift(4,0)}for(ce=1;ce<W.FileIndex.length;++ce)if(Le=W.FileIndex[ce],Le.size>=4096)if(ie.l=Le.start+1<<9,Zt&&Buffer.isBuffer(Le.content))Le.content.copy(ie,ie.l,0,Le.size),ie.l+=Le.size+511&-512;else{for(ke=0;ke<Le.size;++ke)ie.write_shift(1,Le.content[ke]);for(;ke&511;++ke)ie.write_shift(1,0)}for(ce=1;ce<W.FileIndex.length;++ce)if(Le=W.FileIndex[ce],Le.size>0&&Le.size<4096)if(Zt&&Buffer.isBuffer(Le.content))Le.content.copy(ie,ie.l,0,Le.size),ie.l+=Le.size+63&-64;else{for(ke=0;ke<Le.size;++ke)ie.write_shift(1,Le.content[ke]);for(;ke&63;++ke)ie.write_shift(1,0)}if(Zt)ie.l=ie.length;else for(;ie.l<ie.length;)ie.write_shift(1,0);return ie}function S(W,oe){var te=W.FullPaths.map(function(ke){return ke.toUpperCase()}),re=te.map(function(ke){var Ie=ke.split("/");return Ie[Ie.length-(ke.slice(-1)=="/"?2:1)]}),ie=!1;oe.charCodeAt(0)===47?(ie=!0,oe=te[0].slice(0,-1)+oe):ie=oe.indexOf("/")!==-1;var ce=oe.toUpperCase(),Te=ie===!0?te.indexOf(ce):re.indexOf(ce);if(Te!==-1)return W.FileIndex[Te];var je=!ce.match(nh);for(ce=ce.replace(Ca,""),je&&(ce=ce.replace(nh,"!")),Te=0;Te<te.length;++Te)if((je?te[Te].replace(nh,"!"):te[Te]).replace(Ca,"")==ce||(je?re[Te].replace(nh,"!"):re[Te]).replace(Ca,"")==ce)return W.FileIndex[Te];return null}var A=64,C=-2,J="d0cf11e0a1b11ae1",ue=[208,207,17,224,161,177,26,225],me="00000000000000000000000000000000",pe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:C,FREESECT:-1,HEADER_SIGNATURE:J,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:me,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ge(W,oe,te){l();var re=j(W,te);c.writeFileSync(oe,re)}function ne(W){for(var oe=new Array(W.length),te=0;te<W.length;++te)oe[te]=String.fromCharCode(W[te]);return oe.join("")}function we(W,oe){var te=j(W,oe);switch(oe&&oe.type||"buffer"){case"file":return l(),c.writeFileSync(oe.filename,te),te;case"binary":return typeof te=="string"?te:ne(te);case"base64":return Ph(typeof te=="string"?te:ne(te));case"buffer":if(Zt)return Buffer.isBuffer(te)?te:$i(te);case"array":return typeof te=="string"?rs(te):te}return te}var Oe;function k(W){try{var oe=W.InflateRaw,te=new oe;if(te._processChunk(new Uint8Array([3,0]),te._finishFlushFlag),te.bytesRead)Oe=W;else throw new Error("zlib does not expose bytesRead")}catch(re){console.error("cannot use native zlib: "+(re.message||re))}}function O(W,oe){if(!Oe)return rr(W,oe);var te=Oe.InflateRaw,re=new te,ie=re._processChunk(W.slice(W.l),re._finishFlushFlag);return W.l+=re.bytesRead,ie}function M(W){return Oe?Oe.deflateRawSync(W):dt(W)}var U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ee=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],he=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function de(W){var oe=(W<<1|W<<11)&139536|(W<<5|W<<15)&558144;return(oe>>16|oe>>8|oe)&255}for(var fe=typeof Uint8Array<"u",be=fe?new Uint8Array(256):[],Me=0;Me<256;++Me)be[Me]=de(Me);function Z(W,oe){var te=be[W&255];return oe<=8?te>>>8-oe:(te=te<<8|be[W>>8&255],oe<=16?te>>>16-oe:(te=te<<8|be[W>>16&255],te>>>24-oe))}function Xe(W,oe){var te=oe&7,re=oe>>>3;return(W[re]|(te<=6?0:W[re+1]<<8))>>>te&3}function st(W,oe){var te=oe&7,re=oe>>>3;return(W[re]|(te<=5?0:W[re+1]<<8))>>>te&7}function Fe(W,oe){var te=oe&7,re=oe>>>3;return(W[re]|(te<=4?0:W[re+1]<<8))>>>te&15}function se(W,oe){var te=oe&7,re=oe>>>3;return(W[re]|(te<=3?0:W[re+1]<<8))>>>te&31}function qe(W,oe){var te=oe&7,re=oe>>>3;return(W[re]|(te<=1?0:W[re+1]<<8))>>>te&127}function lt(W,oe,te){var re=oe&7,ie=oe>>>3,ce=(1<<te)-1,Te=W[ie]>>>re;return te<8-re||(Te|=W[ie+1]<<8-re,te<16-re)||(Te|=W[ie+2]<<16-re,te<24-re)||(Te|=W[ie+3]<<24-re),Te&ce}function $e(W,oe,te){var re=oe&7,ie=oe>>>3;return re<=5?W[ie]|=(te&7)<<re:(W[ie]|=te<<re&255,W[ie+1]=(te&7)>>8-re),oe+3}function rt(W,oe,te){var re=oe&7,ie=oe>>>3;return te=(te&1)<<re,W[ie]|=te,oe+1}function ot(W,oe,te){var re=oe&7,ie=oe>>>3;return te<<=re,W[ie]|=te&255,te>>>=8,W[ie+1]=te,oe+8}function ht(W,oe,te){var re=oe&7,ie=oe>>>3;return te<<=re,W[ie]|=te&255,te>>>=8,W[ie+1]=te&255,W[ie+2]=te>>>8,oe+16}function _t(W,oe){var te=W.length,re=2*te>oe?2*te:oe+5,ie=0;if(te>=oe)return W;if(Zt){var ce=e2(re);if(W.copy)W.copy(ce);else for(;ie<W.length;++ie)ce[ie]=W[ie];return ce}else if(fe){var Te=new Uint8Array(re);if(Te.set)Te.set(W);else for(;ie<te;++ie)Te[ie]=W[ie];return Te}return W.length=re,W}function At(W){for(var oe=new Array(W),te=0;te<W;++te)oe[te]=0;return oe}function Ft(W,oe,te){var re=1,ie=0,ce=0,Te=0,je=0,ke=W.length,Ie=fe?new Uint16Array(32):At(32);for(ce=0;ce<32;++ce)Ie[ce]=0;for(ce=ke;ce<te;++ce)W[ce]=0;ke=W.length;var Le=fe?new Uint16Array(ke):At(ke);for(ce=0;ce<ke;++ce)Ie[ie=W[ce]]++,re<ie&&(re=ie),Le[ce]=0;for(Ie[0]=0,ce=1;ce<=re;++ce)Ie[ce+16]=je=je+Ie[ce-1]<<1;for(ce=0;ce<ke;++ce)je=W[ce],je!=0&&(Le[ce]=Ie[je+16]++);var Je=0;for(ce=0;ce<ke;++ce)if(Je=W[ce],Je!=0)for(je=Z(Le[ce],re)>>re-Je,Te=(1<<re+4-Je)-1;Te>=0;--Te)oe[je|Te<<Je]=Je&15|ce<<4;return re}var Et=fe?new Uint16Array(512):At(512),It=fe?new Uint16Array(32):At(32);if(!fe){for(var Vt=0;Vt<512;++Vt)Et[Vt]=0;for(Vt=0;Vt<32;++Vt)It[Vt]=0}(function(){for(var W=[],oe=0;oe<32;oe++)W.push(5);Ft(W,It,32);var te=[];for(oe=0;oe<=143;oe++)te.push(8);for(;oe<=255;oe++)te.push(9);for(;oe<=279;oe++)te.push(7);for(;oe<=287;oe++)te.push(8);Ft(te,Et,288)})();var Nt=function(){for(var oe=fe?new Uint8Array(32768):[],te=0,re=0;te<he.length-1;++te)for(;re<he[te+1];++re)oe[re]=te;for(;re<32768;++re)oe[re]=29;var ie=fe?new Uint8Array(259):[];for(te=0,re=0;te<ee.length-1;++te)for(;re<ee[te+1];++re)ie[re]=te;function ce(je,ke){for(var Ie=0;Ie<je.length;){var Le=Math.min(65535,je.length-Ie),Je=Ie+Le==je.length;for(ke.write_shift(1,+Je),ke.write_shift(2,Le),ke.write_shift(2,~Le&65535);Le-- >0;)ke[ke.l++]=je[Ie++]}return ke.l}function Te(je,ke){for(var Ie=0,Le=0,Je=fe?new Uint16Array(32768):[];Le<je.length;){var it=Math.min(65535,je.length-Le);if(it<10){for(Ie=$e(ke,Ie,+(Le+it==je.length)),Ie&7&&(Ie+=8-(Ie&7)),ke.l=Ie/8|0,ke.write_shift(2,it),ke.write_shift(2,~it&65535);it-- >0;)ke[ke.l++]=je[Le++];Ie=ke.l*8;continue}Ie=$e(ke,Ie,+(Le+it==je.length)+2);for(var gt=0;it-- >0;){var nt=je[Le];gt=(gt<<5^nt)&32767;var ft=-1,Ot=0;if((ft=Je[gt])&&(ft|=Le&-32768,ft>Le&&(ft-=32768),ft<Le))for(;je[ft+Ot]==je[Le+Ot]&&Ot<250;)++Ot;if(Ot>2){nt=ie[Ot],nt<=22?Ie=ot(ke,Ie,be[nt+1]>>1)-1:(ot(ke,Ie,3),Ie+=5,ot(ke,Ie,be[nt-23]>>5),Ie+=3);var lr=nt<8?0:nt-4>>2;lr>0&&(ht(ke,Ie,Ot-ee[nt]),Ie+=lr),nt=oe[Le-ft],Ie=ot(ke,Ie,be[nt]>>3),Ie-=3;var ur=nt<4?0:nt-2>>1;ur>0&&(ht(ke,Ie,Le-ft-he[nt]),Ie+=ur);for(var Fr=0;Fr<Ot;++Fr)Je[gt]=Le&32767,gt=(gt<<5^je[Le])&32767,++Le;it-=Ot-1}else nt<=143?nt=nt+48:Ie=rt(ke,Ie,1),Ie=ot(ke,Ie,be[nt]),Je[gt]=Le&32767,++Le}Ie=ot(ke,Ie,0)-1}return ke.l=(Ie+7)/8|0,ke.l}return function(ke,Ie){return ke.length<8?ce(ke,Ie):Te(ke,Ie)}}();function dt(W){var oe=Ue(50+Math.floor(W.length*1.1)),te=Nt(W,oe);return oe.slice(0,te)}var tt=fe?new Uint16Array(32768):At(32768),sr=fe?new Uint16Array(32768):At(32768),Ct=fe?new Uint16Array(128):At(128),rn=1,cr=1;function Cr(W,oe){var te=se(W,oe)+257;oe+=5;var re=se(W,oe)+1;oe+=5;var ie=Fe(W,oe)+4;oe+=4;for(var ce=0,Te=fe?new Uint8Array(19):At(19),je=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ke=1,Ie=fe?new Uint8Array(8):At(8),Le=fe?new Uint8Array(8):At(8),Je=Te.length,it=0;it<ie;++it)Te[U[it]]=ce=st(W,oe),ke<ce&&(ke=ce),Ie[ce]++,oe+=3;var gt=0;for(Ie[0]=0,it=1;it<=ke;++it)Le[it]=gt=gt+Ie[it-1]<<1;for(it=0;it<Je;++it)(gt=Te[it])!=0&&(je[it]=Le[gt]++);var nt=0;for(it=0;it<Je;++it)if(nt=Te[it],nt!=0){gt=be[je[it]]>>8-nt;for(var ft=(1<<7-nt)-1;ft>=0;--ft)Ct[gt|ft<<nt]=nt&7|it<<3}var Ot=[];for(ke=1;Ot.length<te+re;)switch(gt=Ct[qe(W,oe)],oe+=gt&7,gt>>>=3){case 16:for(ce=3+Xe(W,oe),oe+=2,gt=Ot[Ot.length-1];ce-- >0;)Ot.push(gt);break;case 17:for(ce=3+st(W,oe),oe+=3;ce-- >0;)Ot.push(0);break;case 18:for(ce=11+qe(W,oe),oe+=7;ce-- >0;)Ot.push(0);break;default:Ot.push(gt),ke<gt&&(ke=gt);break}var lr=Ot.slice(0,te),ur=Ot.slice(te);for(it=te;it<286;++it)lr[it]=0;for(it=re;it<30;++it)ur[it]=0;return rn=Ft(lr,tt,286),cr=Ft(ur,sr,30),oe}function Pa(W,oe){if(W[0]==3&&!(W[1]&3))return[zo(oe),2];for(var te=0,re=0,ie=e2(oe||1<<18),ce=0,Te=ie.length>>>0,je=0,ke=0;!(re&1);){if(re=st(W,te),te+=3,re>>>1)re>>1==1?(je=9,ke=5):(te=Cr(W,te),je=rn,ke=cr);else{te&7&&(te+=8-(te&7));var Ie=W[te>>>3]|W[(te>>>3)+1]<<8;if(te+=32,Ie>0)for(!oe&&Te<ce+Ie&&(ie=_t(ie,ce+Ie),Te=ie.length);Ie-- >0;)ie[ce++]=W[te>>>3],te+=8;continue}for(;;){!oe&&Te<ce+32767&&(ie=_t(ie,ce+32767),Te=ie.length);var Le=lt(W,te,je),Je=re>>>1==1?Et[Le]:tt[Le];if(te+=Je&15,Je>>>=4,!(Je>>>8&255))ie[ce++]=Je;else{if(Je==256)break;Je-=257;var it=Je<8?0:Je-4>>2;it>5&&(it=0);var gt=ce+ee[Je];it>0&&(gt+=lt(W,te,it),te+=it),Le=lt(W,te,ke),Je=re>>>1==1?It[Le]:sr[Le],te+=Je&15,Je>>>=4;var nt=Je<4?0:Je-2>>1,ft=he[Je];for(nt>0&&(ft+=lt(W,te,nt),te+=nt),!oe&&Te<gt&&(ie=_t(ie,gt+100),Te=ie.length);ce<gt;)ie[ce]=ie[ce-ft],++ce}}}return oe?[ie,te+7>>>3]:[ie.slice(0,ce),te+7>>>3]}function rr(W,oe){var te=W.slice(W.l||0),re=Pa(te,oe);return W.l+=re[1],re[0]}function Ha(W,oe){if(W)typeof console<"u"&&console.error(oe);else throw new Error(oe)}function Pr(W,oe){var te=W;Qn(te,0);var re=[],ie=[],ce={FileIndex:re,FullPaths:ie};I(ce,{root:oe.root});for(var Te=te.length-4;(te[Te]!=80||te[Te+1]!=75||te[Te+2]!=5||te[Te+3]!=6)&&Te>=0;)--Te;te.l=Te+4,te.l+=4;var je=te.read_shift(2);te.l+=6;var ke=te.read_shift(4);for(te.l=ke,Te=0;Te<je;++Te){te.l+=20;var Ie=te.read_shift(4),Le=te.read_shift(4),Je=te.read_shift(2),it=te.read_shift(2),gt=te.read_shift(2);te.l+=8;var nt=te.read_shift(4),ft=o(te.slice(te.l+Je,te.l+Je+it));te.l+=Je+it+gt;var Ot=te.l;te.l=nt+4,In(te,Ie,Le,ce,ft),te.l=Ot}return ce}function In(W,oe,te,re,ie){W.l+=2;var ce=W.read_shift(2),Te=W.read_shift(2),je=i(W);if(ce&8257)throw new Error("Unsupported ZIP encryption");for(var ke=W.read_shift(4),Ie=W.read_shift(4),Le=W.read_shift(4),Je=W.read_shift(2),it=W.read_shift(2),gt="",nt=0;nt<Je;++nt)gt+=String.fromCharCode(W[W.l++]);if(it){var ft=o(W.slice(W.l,W.l+it));(ft[21589]||{}).mt&&(je=ft[21589].mt),((ie||{})[21589]||{}).mt&&(je=ie[21589].mt)}W.l+=it;var Ot=W.slice(W.l,W.l+Ie);switch(Te){case 8:Ot=O(W,Le);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Te)}var lr=!1;ce&8&&(ke=W.read_shift(4),ke==134695760&&(ke=W.read_shift(4),lr=!0),Ie=W.read_shift(4),Le=W.read_shift(4)),Ie!=oe&&Ha(lr,"Bad compressed size: "+oe+" != "+Ie),Le!=te&&Ha(lr,"Bad uncompressed size: "+te+" != "+Le),_n(re,gt,Ot,{unsafe:!0,mt:je})}function va(W,oe){var te=oe||{},re=[],ie=[],ce=Ue(1),Te=te.compression?8:0,je=0,ke=0,Ie=0,Le=0,Je=0,it=W.FullPaths[0],gt=it,nt=W.FileIndex[0],ft=[],Ot=0;for(ke=1;ke<W.FullPaths.length;++ke)if(gt=W.FullPaths[ke].slice(it.length),nt=W.FileIndex[ke],!(!nt.size||!nt.content||gt=="Sh33tJ5")){var lr=Le,ur=Ue(gt.length);for(Ie=0;Ie<gt.length;++Ie)ur.write_shift(1,gt.charCodeAt(Ie)&127);ur=ur.slice(0,ur.l),ft[Je]=UT.buf(nt.content,0);var Fr=nt.content;Te==8&&(Fr=M(Fr)),ce=Ue(30),ce.write_shift(4,67324752),ce.write_shift(2,20),ce.write_shift(2,je),ce.write_shift(2,Te),nt.mt?s(ce,nt.mt):ce.write_shift(4,0),ce.write_shift(-4,ft[Je]),ce.write_shift(4,Fr.length),ce.write_shift(4,nt.content.length),ce.write_shift(2,ur.length),ce.write_shift(2,0),Le+=ce.length,re.push(ce),Le+=ur.length,re.push(ur),Le+=Fr.length,re.push(Fr),ce=Ue(46),ce.write_shift(4,33639248),ce.write_shift(2,0),ce.write_shift(2,20),ce.write_shift(2,je),ce.write_shift(2,Te),ce.write_shift(4,0),ce.write_shift(-4,ft[Je]),ce.write_shift(4,Fr.length),ce.write_shift(4,nt.content.length),ce.write_shift(2,ur.length),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(4,0),ce.write_shift(4,lr),Ot+=ce.l,ie.push(ce),Ot+=ur.length,ie.push(ur),++Je}return ce=Ue(22),ce.write_shift(4,101010256),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(2,Je),ce.write_shift(2,Je),ce.write_shift(4,Ot),ce.write_shift(4,Le),ce.write_shift(2,0),qn([qn(re),qn(ie),ce])}var xr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Rt(W,oe){if(W.ctype)return W.ctype;var te=W.name||"",re=te.match(/\.([^\.]+)$/);return re&&xr[re[1]]||oe&&(re=(te=oe).match(/[\.\\]([^\.\\])+$/),re&&xr[re[1]])?xr[re[1]]:"application/octet-stream"}function ir(W){for(var oe=Ph(W),te=[],re=0;re<oe.length;re+=76)te.push(oe.slice(re,re+76));return te.join(`\r
`)+`\r
`}function Fa(W){var oe=W.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Ie){var Le=Ie.charCodeAt(0).toString(16).toUpperCase();return"="+(Le.length==1?"0"+Le:Le)});oe=oe.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),oe.charAt(0)==`
`&&(oe="=0D"+oe.slice(1)),oe=oe.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var te=[],re=oe.split(`\r
`),ie=0;ie<re.length;++ie){var ce=re[ie];if(ce.length==0){te.push("");continue}for(var Te=0;Te<ce.length;){var je=76,ke=ce.slice(Te,Te+je);ke.charAt(je-1)=="="?je--:ke.charAt(je-2)=="="?je-=2:ke.charAt(je-3)=="="&&(je-=3),ke=ce.slice(Te,Te+je),Te+=je,Te<ce.length&&(ke+="="),te.push(ke)}}return te.join(`\r
`)}function nn(W){for(var oe=[],te=0;te<W.length;++te){for(var re=W[te];te<=W.length&&re.charAt(re.length-1)=="=";)re=re.slice(0,re.length-1)+W[++te];oe.push(re)}for(var ie=0;ie<oe.length;++ie)oe[ie]=oe[ie].replace(/[=][0-9A-Fa-f]{2}/g,function(ce){return String.fromCharCode(parseInt(ce.slice(1),16))});return rs(oe.join(`\r
`))}function Ln(W,oe,te){for(var re="",ie="",ce="",Te,je=0;je<10;++je){var ke=oe[je];if(!ke||ke.match(/^\s*$/))break;var Ie=ke.match(/^(.*?):\s*([^\s].*)$/);if(Ie)switch(Ie[1].toLowerCase()){case"content-location":re=Ie[2].trim();break;case"content-type":ce=Ie[2].trim();break;case"content-transfer-encoding":ie=Ie[2].trim();break}}switch(++je,ie.toLowerCase()){case"base64":Te=rs(cs(oe.slice(je).join("")));break;case"quoted-printable":Te=nn(oe.slice(je));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ie)}var Le=_n(W,re.slice(te.length),Te,{unsafe:!0});ce&&(Le.ctype=ce)}function ya(W,oe){if(ne(W.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var te=oe&&oe.root||"",re=(Zt&&Buffer.isBuffer(W)?W.toString("binary"):ne(W)).split(`\r
`),ie=0,ce="";for(ie=0;ie<re.length;++ie)if(ce=re[ie],!!/^Content-Location:/i.test(ce)&&(ce=ce.slice(ce.indexOf("file")),te||(te=ce.slice(0,ce.lastIndexOf("/")+1)),ce.slice(0,te.length)!=te))for(;te.length>0&&(te=te.slice(0,te.length-1),te=te.slice(0,te.lastIndexOf("/")+1),ce.slice(0,te.length)!=te););var Te=(re[1]||"").match(/boundary="(.*?)"/);if(!Te)throw new Error("MAD cannot find boundary");var je="--"+(Te[1]||""),ke=[],Ie=[],Le={FileIndex:ke,FullPaths:Ie};I(Le);var Je,it=0;for(ie=0;ie<re.length;++ie){var gt=re[ie];gt!==je&&gt!==je+"--"||(it++&&Ln(Le,re.slice(Je,ie),te),Je=ie)}return Le}function bt(W,oe){var te=oe||{},re=te.boundary||"SheetJS";re="------="+re;for(var ie=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+re.slice(2)+'"',"","",""],ce=W.FullPaths[0],Te=ce,je=W.FileIndex[0],ke=1;ke<W.FullPaths.length;++ke)if(Te=W.FullPaths[ke].slice(ce.length),je=W.FileIndex[ke],!(!je.size||!je.content||Te=="Sh33tJ5")){Te=Te.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ot){return"_x"+Ot.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ot){return"_u"+Ot.charCodeAt(0).toString(16)+"_"});for(var Ie=je.content,Le=Zt&&Buffer.isBuffer(Ie)?Ie.toString("binary"):ne(Ie),Je=0,it=Math.min(1024,Le.length),gt=0,nt=0;nt<=it;++nt)(gt=Le.charCodeAt(nt))>=32&&gt<128&&++Je;var ft=Je>=it*4/5;ie.push(re),ie.push("Content-Location: "+(te.root||"file:///C:/SheetJS/")+Te),ie.push("Content-Transfer-Encoding: "+(ft?"quoted-printable":"base64")),ie.push("Content-Type: "+Rt(je,Te)),ie.push(""),ie.push(ft?Fa(Le):ir(Le))}return ie.push(re+`--\r
`),ie.join(`\r
`)}function ta(W){var oe={};return I(oe,W),oe}function _n(W,oe,te,re){var ie=re&&re.unsafe;ie||I(W);var ce=!ie&&Pt.find(W,oe);if(!ce){var Te=W.FullPaths[0];oe.slice(0,Te.length)==Te?Te=oe:(Te.slice(-1)!="/"&&(Te+="/"),Te=(Te+oe).replace("//","/")),ce={name:a(oe),type:2},W.FileIndex.push(ce),W.FullPaths.push(Te),ie||Pt.utils.cfb_gc(W)}return ce.content=te,ce.size=te?te.length:0,re&&(re.CLSID&&(ce.clsid=re.CLSID),re.mt&&(ce.mt=re.mt),re.ct&&(ce.ct=re.ct)),ce}function an(W,oe){I(W);var te=Pt.find(W,oe);if(te){for(var re=0;re<W.FileIndex.length;++re)if(W.FileIndex[re]==te)return W.FileIndex.splice(re,1),W.FullPaths.splice(re,1),!0}return!1}function Jr(W,oe,te){I(W);var re=Pt.find(W,oe);if(re){for(var ie=0;ie<W.FileIndex.length;++ie)if(W.FileIndex[ie]==re)return W.FileIndex[ie].name=a(te),W.FullPaths[ie]=te,!0}return!1}function Kr(W){F(W,!0)}return e.find=S,e.read=K,e.parse=u,e.write=we,e.writeFile=ge,e.utils={cfb_new:ta,cfb_add:_n,cfb_del:an,cfb_mov:Jr,cfb_gc:Kr,ReadShift:uh,CheckField:$w,prep_blob:Qn,bconcat:qn,use_zlib:k,_deflateRaw:dt,_inflateRaw:rr,consts:pe},e}();function qT(r){return typeof r=="string"?vd(r):Array.isArray(r)?mT(r):r}function r0(r,e,t){if(typeof Deno<"u"){if(t&&typeof e=="string")switch(t){case"utf8":e=new TextEncoder(t).encode(e);break;case"binary":e=vd(e);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(r,e)}var n=t=="utf8"?hi(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,r);if(typeof Blob<"u"){var a=new Blob([qT(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,r);if(typeof saveAs<"u")return saveAs(a,r);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:r,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=r,i.href=s,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(r);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=Jo(e)),o.write(e),o.close(),e}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+r)}function zT(r){if(typeof Deno<"u")return Deno.readFileSync(r);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(r);e.open("r"),e.encoding="binary";var t=e.read();return e.close(),t}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+r)}function fn(r){for(var e=Object.keys(r),t=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(r,e[n])&&t.push(e[n]);return t}function c2(r,e){for(var t=[],n=fn(r),a=0;a!==n.length;++a)t[r[n[a]][e]]==null&&(t[r[n[a]][e]]=n[a]);return t}function wd(r){for(var e=[],t=fn(r),n=0;n!==t.length;++n)e[r[t[n]]]=t[n];return e}function _d(r){for(var e=[],t=fn(r),n=0;n!==t.length;++n)e[r[t[n]]]=parseInt(t[n],10);return e}function WT(r){for(var e=[],t=fn(r),n=0;n!==t.length;++n)e[r[t[n]]]==null&&(e[r[t[n]]]=[]),e[r[t[n]]].push(t[n]);return e}var Mf=new Date(1899,11,30,0,0,0);function Rn(r,e){var t=r.getTime(),n=Mf.getTime()+(r.getTimezoneOffset()-Mf.getTimezoneOffset())*6e4;return(t-n)/(24*60*60*1e3)}var Nw=new Date,HT=Mf.getTime()+(Nw.getTimezoneOffset()-Mf.getTimezoneOffset())*6e4,l2=Nw.getTimezoneOffset();function bd(r){var e=new Date;return e.setTime(r*24*60*60*1e3+HT),e.getTimezoneOffset()!==l2&&e.setTime(e.getTime()+(e.getTimezoneOffset()-l2)*6e4),e}function GT(r){var e=0,t=0,n=!1,a=r.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+r+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(t=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":t*=24;case"H":t*=60;case"M":if(n)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=t*parseInt(a[s],10)}return e}var u2=new Date("2017-02-19T19:06:09.000Z"),Tw=isNaN(u2.getFullYear())?new Date("2/19/17"):u2,$T=Tw.getFullYear()==2017;function Gr(r,e){var t=new Date(r);if($T)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(r instanceof Date)return r;if(Tw.getFullYear()==1917&&!isNaN(t.getFullYear())){var n=t.getFullYear();return r.indexOf(""+n)>-1||t.setFullYear(t.getFullYear()+100),t}var a=r.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return r.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Gc(r,e){if(Zt&&Buffer.isBuffer(r)){if(e){if(r[0]==255&&r[1]==254)return hi(r.slice(2).toString("utf16le"));if(r[1]==254&&r[2]==255)return hi(mw(r.slice(2).toString("binary")))}return r.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(r[0]==255&&r[1]==254)return hi(new TextDecoder("utf-16le").decode(r.slice(2)));if(r[0]==254&&r[1]==255)return hi(new TextDecoder("utf-16be").decode(r.slice(2)))}var t={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(r)&&(r=new Uint8Array(r)),new TextDecoder("latin1").decode(r).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return t[s]||s})}catch{}for(var n=[],a=0;a!=r.length;++a)n.push(String.fromCharCode(r[a]));return n.join("")}function $r(r){if(typeof JSON<"u"&&!Array.isArray(r))return JSON.parse(JSON.stringify(r));if(typeof r!="object"||r==null)return r;if(r instanceof Date)return new Date(r.getTime());var e={};for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=$r(r[t]));return e}function ln(r,e){for(var t="";t.length<e;)t+=r;return t}function $s(r){var e=Number(r);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(r))return e;var t=1,n=r.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return t=-t,s}),!isNaN(e=Number(n)))?e/t:e}var KT=["january","february","march","april","may","june","july","august","september","october","november","december"];function du(r){var e=new Date(r),t=new Date(NaN),n=e.getYear(),a=e.getMonth(),s=e.getDate();if(isNaN(s))return t;var i=r.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&KT.indexOf(i)==-1)return t}else if(i.match(/[a-z]/))return t;return n<0||n>8099?t:(a>0||s>1)&&n!=101?e:r.match(/[^-0-9:,\/\\]/)?t:e}var XT=function(){var r="abacaba".split(/(:?b)/i).length==5;return function(t,n,a){if(r||typeof n=="string")return t.split(n);for(var s=t.split(n),i=[s[0]],o=1;o<s.length;++o)i.push(a),i.push(s[o]);return i}}();function kw(r){return r?r.content&&r.type?Gc(r.content,!0):r.data?rh(r.data):r.asNodeBuffer&&Zt?rh(r.asNodeBuffer().toString("binary")):r.asBinary?rh(r.asBinary()):r._data&&r._data.getContent?rh(Gc(Array.prototype.slice.call(r._data.getContent(),0))):null:null}function Iw(r){if(!r)return null;if(r.data)return Qx(r.data);if(r.asNodeBuffer&&Zt)return r.asNodeBuffer();if(r._data&&r._data.getContent){var e=r._data.getContent();return typeof e=="string"?Qx(e):Array.prototype.slice.call(e)}return r.content&&r.type?r.content:null}function YT(r){return r&&r.name.slice(-4)===".bin"?Iw(r):kw(r)}function _s(r,e){for(var t=r.FullPaths||fn(r.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<t.length;++s){var i=t[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||a==i)return r.files?r.files[t[s]]:r.FileIndex[s]}return null}function y1(r,e){var t=_s(r,e);if(t==null)throw new Error("Cannot find file "+e+" in zip");return t}function Nn(r,e,t){if(!t)return YT(y1(r,e));if(!e)return null;try{return Nn(r,e)}catch{return null}}function ns(r,e,t){if(!t)return kw(y1(r,e));if(!e)return null;try{return ns(r,e)}catch{return null}}function JT(r,e,t){return Iw(y1(r,e))}function h2(r){for(var e=r.FullPaths||fn(r.files),t=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&t.push(e[n].replace(/^Root Entry[\/]/,""));return t.sort()}function Qt(r,e,t){if(r.FullPaths){if(typeof t=="string"){var n;return Zt?n=$i(t):n=pT(t),Pt.utils.cfb_add(r,e,n)}Pt.utils.cfb_add(r,e,t)}else r.file(e,t)}function w1(){return Pt.utils.cfb_new()}function Cw(r,e){switch(e.type){case"base64":return Pt.read(r,{type:"base64"});case"binary":return Pt.read(r,{type:"binary"});case"buffer":case"array":return Pt.read(r,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function ah(r,e){if(r.charAt(0)=="/")return r.slice(1);var t=e.split("/");e.slice(-1)!="/"&&t.pop();for(var n=r.split("/");n.length!==0;){var a=n.shift();a===".."?t.pop():a!=="."&&t.push(a)}return t.join("/")}var wn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,QT=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,f2=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,ZT=/<[^>]*>/g,xa=wn.match(f2)?f2:ZT,e6=/<\w*:/,t6=/<(\/?)\w+:/;function Wt(r,e,t){for(var n={},a=0,s=0;a!==r.length&&!((s=r.charCodeAt(a))===32||s===10||s===13);++a);if(e||(n[0]=r.slice(0,a)),a===r.length)return n;var i=r.match(QT),o=0,c="",l=0,u="",d="",g=1;if(i)for(l=0;l!=i.length;++l){for(d=i[l],s=0;s!=d.length&&d.charCodeAt(s)!==61;++s);for(u=d.slice(0,s).trim();d.charCodeAt(s+1)==32;)++s;for(g=(a=d.charCodeAt(s+1))==34||a==39?1:0,c=d.slice(s+1+g,d.length-g),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=c,n[u.toLowerCase()]=c;else{var p=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[p]&&u.slice(o-3,o)=="ext")continue;n[p]=c,n[p.toLowerCase()]=c}}return n}function vi(r){return r.replace(t6,"<$1")}var Pw={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},_1=wd(Pw),mr=function(){var r=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function t(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(r,function(o,c){return Pw[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,c){return String.fromCharCode(parseInt(c,16))});var i=a.indexOf("]]>");return t(a.slice(0,s))+a.slice(s+9,i)+t(a.slice(i+3))}}(),b1=/[&<>'"]/g,r6=/[\u0000-\u0008\u000b-\u001f]/g;function Tr(r){var e=r+"";return e.replace(b1,function(t){return _1[t]}).replace(r6,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function d2(r){return Tr(r).replace(/ /g,"_x0020_")}var Fw=/[\u0000-\u001f]/g;function E1(r){var e=r+"";return e.replace(b1,function(t){return _1[t]}).replace(/\n/g,"<br/>").replace(Fw,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function n6(r){var e=r+"";return e.replace(b1,function(t){return _1[t]}).replace(Fw,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}var m2=function(){var r=/&#(\d+);/g;function e(t,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(r,e)}}();function a6(r){return r.replace(/(\r\n|[\r\n])/g,"&#10;")}function Wr(r){switch(r){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function sm(r){for(var e="",t=0,n=0,a=0,s=0,i=0,o=0;t<r.length;){if(n=r.charCodeAt(t++),n<128){e+=String.fromCharCode(n);continue}if(a=r.charCodeAt(t++),n>191&&n<224){i=(n&31)<<6,i|=a&63,e+=String.fromCharCode(i);continue}if(s=r.charCodeAt(t++),n<240){e+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}i=r.charCodeAt(t++),o=((n&7)<<18|(a&63)<<12|(s&63)<<6|i&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function p2(r){var e=zo(2*r.length),t,n,a=1,s=0,i=0,o;for(n=0;n<r.length;n+=a)a=1,(o=r.charCodeAt(n))<128?t=o:o<224?(t=(o&31)*64+(r.charCodeAt(n+1)&63),a=2):o<240?(t=(o&15)*4096+(r.charCodeAt(n+1)&63)*64+(r.charCodeAt(n+2)&63),a=3):(a=4,t=(o&7)*262144+(r.charCodeAt(n+1)&63)*4096+(r.charCodeAt(n+2)&63)*64+(r.charCodeAt(n+3)&63),t-=65536,i=55296+(t>>>10&1023),t=56320+(t&1023)),i!==0&&(e[s++]=i&255,e[s++]=i>>>8,i=0),e[s++]=t%256,e[s++]=t>>>8;return e.slice(0,s).toString("ucs2")}function g2(r){return $i(r,"binary").toString("utf8")}var U0="foo bar bazâð£",Lr=Zt&&(g2(U0)==sm(U0)&&g2||p2(U0)==sm(U0)&&p2)||sm,hi=Zt?function(r){return $i(r,"utf8").toString("binary")}:function(r){for(var e=[],t=0,n=0,a=0;t<r.length;)switch(n=r.charCodeAt(t++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=r.charCodeAt(t++)-56320+(n<<10),e.push(String.fromCharCode(240+(a>>18&7))),e.push(String.fromCharCode(144+(a>>12&63))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Rh=function(){var r={};return function(t,n){var a=t+"|"+(n||"");return r[a]?r[a]:r[a]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",n||"")}}(),Rw=function(){var r=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<r.length;++a)n=n.replace(r[a][0],r[a][1]);return n}}(),s6=function(){var r={};return function(t){return r[t]!==void 0?r[t]:r[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),i6=/<\/?(?:vt:)?variant>/g,o6=/<(?:vt:)([^>]*)>([\s\S]*)</;function x2(r,e){var t=Wt(r),n=r.match(s6(t.baseType))||[],a=[];if(n.length!=t.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+t.size);return a}return n.forEach(function(s){var i=s.replace(i6,"").match(o6);i&&a.push({v:Lr(i[2]),t:i[1]})}),a}var Dw=/(^\s|\s$|\n)/;function Zn(r,e){return"<"+r+(e.match(Dw)?' xml:space="preserve"':"")+">"+e+"</"+r+">"}function Dh(r){return fn(r).map(function(e){return" "+e+'="'+r[e]+'"'}).join("")}function ct(r,e,t){return"<"+r+(t!=null?Dh(t):"")+(e!=null?(e.match(Dw)?' xml:space="preserve"':"")+">"+e+"</"+r:"/")+">"}function rp(r,e){try{return r.toISOString().replace(/\.\d*/,"")}catch(t){if(e)throw t}return""}function c6(r,e){switch(typeof r){case"string":var t=ct("vt:lpwstr",Tr(r));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return ct((r|0)==r?"vt:i4":"vt:r8",Tr(String(r)));case"boolean":return ct("vt:bool",r?"true":"false")}if(r instanceof Date)return ct("vt:filetime",rp(r));throw new Error("Unable to serialize "+r)}function S1(r){if(Zt&&Buffer.isBuffer(r))return r.toString("utf8");if(typeof r=="string")return r;if(typeof Uint8Array<"u"&&r instanceof Uint8Array)return Lr(Jo(g1(r)));throw new Error("Bad input format: expected Buffer or string")}var Lh=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Fn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},tl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],es={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function l6(r,e){for(var t=1-2*(r[e+7]>>>7),n=((r[e+7]&127)<<4)+(r[e+6]>>>4&15),a=r[e+6]&15,s=5;s>=0;--s)a=a*256+r[e+s];return n==2047?a==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),t*Math.pow(2,n-52)*a)}function u6(r,e,t){var n=(e<0||1/e==-1/0?1:0)<<7,a=0,s=0,i=n?-e:e;isFinite(i)?i==0?a=s=0:(a=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)r[t+o]=s&255;r[t+6]=(a&15)<<4|s&15,r[t+7]=a>>4|n}var v2=function(r){for(var e=[],t=10240,n=0;n<r[0].length;++n)if(r[0][n])for(var a=0,s=r[0][n].length;a<s;a+=t)e.push.apply(e,r[0][n].slice(a,a+t));return e},y2=Zt?function(r){return r[0].length>0&&Buffer.isBuffer(r[0][0])?Buffer.concat(r[0].map(function(e){return Buffer.isBuffer(e)?e:$i(e)})):v2(r)}:v2,w2=function(r,e,t){for(var n=[],a=e;a<t;a+=2)n.push(String.fromCharCode(Mi(r,a)));return n.join("").replace(Ca,"")},A1=Zt?function(r,e,t){return Buffer.isBuffer(r)?r.toString("utf16le",e,t).replace(Ca,""):w2(r,e,t)}:w2,_2=function(r,e,t){for(var n=[],a=e;a<e+t;++a)n.push(("0"+r[a].toString(16)).slice(-2));return n.join("")},Lw=Zt?function(r,e,t){return Buffer.isBuffer(r)?r.toString("hex",e,e+t):_2(r,e,t)}:_2,b2=function(r,e,t){for(var n=[],a=e;a<t;a++)n.push(String.fromCharCode(zl(r,a)));return n.join("")},n0=Zt?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf8",t,n):b2(e,t,n)}:b2,jw=function(r,e){var t=ts(r,e);return t>0?n0(r,e+4,e+4+t-1):""},Ow=jw,Mw=function(r,e){var t=ts(r,e);return t>0?n0(r,e+4,e+4+t-1):""},Bw=Mw,Vw=function(r,e){var t=2*ts(r,e);return t>0?n0(r,e+4,e+4+t-1):""},Uw=Vw,qw=function(e,t){var n=ts(e,t);return n>0?A1(e,t+4,t+4+n):""},zw=qw,Ww=function(r,e){var t=ts(r,e);return t>0?n0(r,e+4,e+4+t):""},Hw=Ww,Gw=function(r,e){return l6(r,e)},Bf=Gw,N1=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Zt&&(Ow=function(e,t){if(!Buffer.isBuffer(e))return jw(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},Bw=function(e,t){if(!Buffer.isBuffer(e))return Mw(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},Uw=function(e,t){if(!Buffer.isBuffer(e))return Vw(e,t);var n=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n-1)},zw=function(e,t){if(!Buffer.isBuffer(e))return qw(e,t);var n=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n)},Hw=function(e,t){if(!Buffer.isBuffer(e))return Ww(e,t);var n=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+n)},Bf=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):Gw(e,t)},N1=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var zl=function(r,e){return r[e]},Mi=function(r,e){return r[e+1]*256+r[e]},h6=function(r,e){var t=r[e+1]*256+r[e];return t<32768?t:(65535-t+1)*-1},ts=function(r,e){return r[e+3]*(1<<24)+(r[e+2]<<16)+(r[e+1]<<8)+r[e]},Nc=function(r,e){return r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e]},f6=function(r,e){return r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]};function uh(r,e){var t="",n,a,s=[],i,o,c,l;switch(e){case"dbcs":if(l=this.l,Zt&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*r).toString("utf16le");else for(c=0;c<r;++c)t+=String.fromCharCode(Mi(this,l)),l+=2;r*=2;break;case"utf8":t=n0(this,this.l,this.l+r);break;case"utf16le":r*=2,t=A1(this,this.l,this.l+r);break;case"wstr":return uh.call(this,r,"dbcs");case"lpstr-ansi":t=Ow(this,this.l),r=4+ts(this,this.l);break;case"lpstr-cp":t=Bw(this,this.l),r=4+ts(this,this.l);break;case"lpwstr":t=Uw(this,this.l),r=4+2*ts(this,this.l);break;case"lpp4":r=4+ts(this,this.l),t=zw(this,this.l),r&2&&(r+=2);break;case"8lpp4":r=4+ts(this,this.l),t=Hw(this,this.l),r&3&&(r+=4-(r&3));break;case"cstr":for(r=0,t="";(i=zl(this,this.l+r++))!==0;)s.push(V0(i));t=s.join("");break;case"_wstr":for(r=0,t="";(i=Mi(this,this.l+r))!==0;)s.push(V0(i)),r+=2;r+=2,t=s.join("");break;case"dbcs-cont":for(t="",l=this.l,c=0;c<r;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return i=zl(this,l),this.l=l+1,o=uh.call(this,r-c,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(V0(Mi(this,l))),l+=2}t=s.join(""),r*=2;break;case"cpstr":case"sbcs-cont":for(t="",l=this.l,c=0;c!=r;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return i=zl(this,l),this.l=l+1,o=uh.call(this,r-c,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(V0(zl(this,l))),l+=1}t=s.join("");break;default:switch(r){case 1:return n=zl(this,this.l),this.l++,n;case 2:return n=(e==="i"?h6:Mi)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(r>0?Nc:f6)(this,this.l),this.l+=4,n):(a=ts(this,this.l),this.l+=4,a);case 8:case-8:if(e==="f")return r==8?a=Bf(this,this.l):a=Bf([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;r=8;case 16:t=Lw(this,this.l,r);break}}return this.l+=r,t}var d6=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255,r[t+2]=e>>>16&255,r[t+3]=e>>>24&255},m6=function(r,e,t){r[t]=e&255,r[t+1]=e>>8&255,r[t+2]=e>>16&255,r[t+3]=e>>24&255},p6=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255};function g6(r,e,t){var n=0,a=0;if(t==="dbcs"){for(a=0;a!=e.length;++a)p6(this,e.charCodeAt(a),this.l+2*a);n=2*e.length}else if(t==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=e.length;++a)this[this.l+a]=e.charCodeAt(a)&255;n=e.length}else if(t==="hex"){for(;a<r;++a)this[this.l++]=parseInt(e.slice(2*a,2*a+2),16)||0;return this}else if(t==="utf16le"){var s=Math.min(this.l+r,this.length);for(a=0;a<Math.min(e.length,r);++a){var i=e.charCodeAt(a);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(r){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,d6(this,e,this.l);break;case 8:if(n=8,t==="f"){u6(this,e,this.l);break}case 16:break;case-4:n=4,m6(this,e,this.l);break}return this.l+=n,this}function $w(r,e){var t=Lw(this,this.l,r.length>>1);if(t!==r)throw new Error(e+"Expected "+r+" saw "+t);this.l+=r.length>>1}function Qn(r,e){r.l=e,r.read_shift=uh,r.chk=$w,r.write_shift=g6}function ga(r,e){r.l+=e}function Ue(r){var e=zo(r);return Qn(e,0),e}function Ki(r,e,t){if(r){var n,a,s;Qn(r,r.l||0);for(var i=r.length,o=0,c=0;r.l<i;){o=r.read_shift(1),o&128&&(o=(o&127)+((r.read_shift(1)&127)<<7));var l=Uh[o]||Uh[65535];for(n=r.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=r.read_shift(1))&127)<<7*a;c=r.l+s;var u=l.f&&l.f(r,s,t);if(r.l=c,e(u,l,o))return}}}function qa(){var r=[],e=Zt?256:2048,t=function(l){var u=Ue(l);return Qn(u,0),u},n=t(e),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&r.push(n),n=null)},s=function(l){return n&&l<n.length-n.l?n:(a(),n=t(Math.max(l+1,e)))},i=function(){return a(),qn(r)},o=function(l){a(),n=l,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:o,end:i,_bufs:r}}function Ke(r,e,t,n){var a=+e,s;if(!isNaN(a)){n||(n=Uh[a].p||(t||[]).length||0),s=1+(a>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var i=r.next(s);a<=127?i.write_shift(1,a):(i.write_shift(1,(a&127)+128),i.write_shift(1,a>>7));for(var o=0;o!=4;++o)if(n>=128)i.write_shift(1,(n&127)+128),n>>=7;else{i.write_shift(1,n);break}n>0&&N1(t)&&r.push(t)}}function hh(r,e,t){var n=$r(r);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function E2(r,e,t){var n=$r(r);return n.s=hh(n.s,e.s,t),n.e=hh(n.e,e.s,t),n}function fh(r,e){if(r.cRel&&r.c<0)for(r=$r(r);r.c<0;)r.c+=e>8?16384:256;if(r.rRel&&r.r<0)for(r=$r(r);r.r<0;)r.r+=e>8?1048576:e>5?65536:16384;var t=qt(r);return!r.cRel&&r.cRel!=null&&(t=y6(t)),!r.rRel&&r.rRel!=null&&(t=x6(t)),t}function im(r,e){return r.s.r==0&&!r.s.rRel&&r.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!r.e.rRel?(r.s.cRel?"":"$")+Zr(r.s.c)+":"+(r.e.cRel?"":"$")+Zr(r.e.c):r.s.c==0&&!r.s.cRel&&r.e.c==(e.biff>=12?16383:255)&&!r.e.cRel?(r.s.rRel?"":"$")+yn(r.s.r)+":"+(r.e.rRel?"":"$")+yn(r.e.r):fh(r.s,e.biff)+":"+fh(r.e,e.biff)}function T1(r){return parseInt(v6(r),10)-1}function yn(r){return""+(r+1)}function x6(r){return r.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function v6(r){return r.replace(/\$(\d+)$/,"$1")}function k1(r){for(var e=w6(r),t=0,n=0;n!==e.length;++n)t=26*t+e.charCodeAt(n)-64;return t-1}function Zr(r){if(r<0)throw new Error("invalid column "+r);var e="";for(++r;r;r=Math.floor((r-1)/26))e=String.fromCharCode((r-1)%26+65)+e;return e}function y6(r){return r.replace(/^([A-Z])/,"$$$1")}function w6(r){return r.replace(/^\$([A-Z])/,"$1")}function _6(r){return r.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function en(r){for(var e=0,t=0,n=0;n<r.length;++n){var a=r.charCodeAt(n);a>=48&&a<=57?e=10*e+(a-48):a>=65&&a<=90&&(t=26*t+(a-64))}return{c:t-1,r:e-1}}function qt(r){for(var e=r.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(r.r+1)}function za(r){var e=r.indexOf(":");return e==-1?{s:en(r),e:en(r)}:{s:en(r.slice(0,e)),e:en(r.slice(e+1))}}function Jt(r,e){return typeof e>"u"||typeof e=="number"?Jt(r.s,r.e):(typeof r!="string"&&(r=qt(r)),typeof e!="string"&&(e=qt(e)),r==e?r:r+":"+e)}function pr(r){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,a=0,s=r.length;for(t=0;n<s&&!((a=r.charCodeAt(n)-64)<1||a>26);++n)t=26*t+a;for(e.s.c=--t,t=0;n<s&&!((a=r.charCodeAt(n)-48)<0||a>9);++n)t=10*t+a;if(e.s.r=--t,n===s||a!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,t=0;n!=s&&!((a=r.charCodeAt(n)-64)<1||a>26);++n)t=26*t+a;for(e.e.c=--t,t=0;n!=s&&!((a=r.charCodeAt(n)-48)<0||a>9);++n)t=10*t+a;return e.e.r=--t,e}function S2(r,e){var t=r.t=="d"&&e instanceof Date;if(r.z!=null)try{return r.w=ks(r.z,t?Rn(e):e)}catch{}try{return r.w=ks((r.XF||{}).numFmtId||(t?14:0),t?Rn(e):e)}catch{return""+e}}function Hi(r,e,t){return r==null||r.t==null||r.t=="z"?"":r.w!==void 0?r.w:(r.t=="d"&&!r.z&&t&&t.dateNF&&(r.z=t.dateNF),r.t=="e"?Xi[r.v]||r.v:e==null?S2(r,r.v):S2(r,e))}function Qo(r,e){var t=e&&e.sheet?e.sheet:"Sheet1",n={};return n[t]=r,{SheetNames:[t],Sheets:n}}function Kw(r,e,t){var n=t||{},a=r?Array.isArray(r):n.dense,s=r||(a?[]:{}),i=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?en(n.origin):n.origin;i=c.r,o=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=pr(s["!ref"]);l.s.c=u.s.c,l.s.r=u.s.r,l.e.c=Math.max(l.e.c,u.e.c),l.e.r=Math.max(l.e.r,u.e.r),i==-1&&(l.e.r=i=u.e.r+1)}for(var d=0;d!=e.length;++d)if(e[d]){if(!Array.isArray(e[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=e[d].length;++g)if(!(typeof e[d][g]>"u")){var p={v:e[d][g]},y=i+d,v=o+g;if(l.s.r>y&&(l.s.r=y),l.s.c>v&&(l.s.c=v),l.e.r<y&&(l.e.r=y),l.e.c<v&&(l.e.c=v),e[d][g]&&typeof e[d][g]=="object"&&!Array.isArray(e[d][g])&&!(e[d][g]instanceof Date))p=e[d][g];else if(Array.isArray(p.v)&&(p.f=e[d][g][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||Mt[14],n.cellDates?(p.t="d",p.w=ks(p.z,Rn(p.v))):(p.t="n",p.v=Rn(p.v),p.w=ks(p.z,p.v))):p.t="s";if(a)s[y]||(s[y]=[]),s[y][v]&&s[y][v].z&&(p.z=s[y][v].z),s[y][v]=p;else{var w=qt({c:v,r:y});s[w]&&s[w].z&&(p.z=s[w].z),s[w]=p}}}return l.s.c<1e7&&(s["!ref"]=Jt(l)),s}function Eu(r,e){return Kw(null,r,e)}function b6(r){return r.read_shift(4,"i")}function Ks(r,e){return e||(e=Ue(4)),e.write_shift(4,r),e}function pa(r){var e=r.read_shift(4);return e===0?"":r.read_shift(e,"dbcs")}function zn(r,e){var t=!1;return e==null&&(t=!0,e=Ue(4+2*r.length)),e.write_shift(4,r.length),r.length>0&&e.write_shift(0,r,"dbcs"),t?e.slice(0,e.l):e}function E6(r){return{ich:r.read_shift(2),ifnt:r.read_shift(2)}}function S6(r,e){return e||(e=Ue(4)),e.write_shift(2,0),e.write_shift(2,0),e}function I1(r,e){var t=r.l,n=r.read_shift(1),a=pa(r),s=[],i={t:a,h:a};if(n&1){for(var o=r.read_shift(4),c=0;c!=o;++c)s.push(E6(r));i.r=s}else i.r=[{ich:0,ifnt:0}];return r.l=t+e,i}function A6(r,e){var t=!1;return e==null&&(t=!0,e=Ue(15+4*r.t.length)),e.write_shift(1,0),zn(r.t,e),t?e.slice(0,e.l):e}var N6=I1;function T6(r,e){var t=!1;return e==null&&(t=!0,e=Ue(23+4*r.t.length)),e.write_shift(1,1),zn(r.t,e),e.write_shift(4,1),S6({ich:0,ifnt:0},e),t?e.slice(0,e.l):e}function Is(r){var e=r.read_shift(4),t=r.read_shift(2);return t+=r.read_shift(1)<<16,r.l++,{c:e,iStyleRef:t}}function rl(r,e){return e==null&&(e=Ue(8)),e.write_shift(-4,r.c),e.write_shift(3,r.iStyleRef||r.s),e.write_shift(1,0),e}function nl(r){var e=r.read_shift(2);return e+=r.read_shift(1)<<16,r.l++,{c:-1,iStyleRef:e}}function al(r,e){return e==null&&(e=Ue(4)),e.write_shift(3,r.iStyleRef||r.s),e.write_shift(1,0),e}var k6=pa,Xw=zn;function C1(r){var e=r.read_shift(4);return e===0||e===4294967295?"":r.read_shift(e,"dbcs")}function Vf(r,e){var t=!1;return e==null&&(t=!0,e=Ue(127)),e.write_shift(4,r.length>0?r.length:4294967295),r.length>0&&e.write_shift(0,r,"dbcs"),t?e.slice(0,e.l):e}var I6=pa,np=C1,P1=Vf;function F1(r){var e=r.slice(r.l,r.l+4),t=e[0]&1,n=e[0]&2;r.l+=4;var a=n===0?Bf([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Nc(e,0)>>2;return t?a/100:a}function Yw(r,e){e==null&&(e=Ue(4));var t=0,n=0,a=r*100;if(r==(r|0)&&r>=-(1<<29)&&r<1<<29?n=1:a==(a|0)&&a>=-(1<<29)&&a<1<<29&&(n=1,t=1),n)e.write_shift(-4,((t?a:r)<<2)+(t+2));else throw new Error("unsupported RkNumber "+r)}function Jw(r){var e={s:{},e:{}};return e.s.r=r.read_shift(4),e.e.r=r.read_shift(4),e.s.c=r.read_shift(4),e.e.c=r.read_shift(4),e}function C6(r,e){return e||(e=Ue(16)),e.write_shift(4,r.s.r),e.write_shift(4,r.e.r),e.write_shift(4,r.s.c),e.write_shift(4,r.e.c),e}var sl=Jw,Su=C6;function da(r){if(r.length-r.l<8)throw"XLS Xnum Buffer underflow";return r.read_shift(8,"f")}function $c(r,e){return(e||Ue(8)).write_shift(8,r,"f")}function P6(r){var e={},t=r.read_shift(1),n=t>>>1,a=r.read_shift(1),s=r.read_shift(2,"i"),i=r.read_shift(1),o=r.read_shift(1),c=r.read_shift(1);switch(r.l++,n){case 0:e.auto=1;break;case 1:e.index=a;var l=Pc[a];l&&(e.rgb=Oh(l));break;case 2:e.rgb=Oh([i,o,c]);break;case 3:e.theme=a;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function Uf(r,e){if(e||(e=Ue(8)),!r||r.auto)return e.write_shift(4,0),e.write_shift(4,0),e;r.index!=null?(e.write_shift(1,2),e.write_shift(1,r.index)):r.theme!=null?(e.write_shift(1,6),e.write_shift(1,r.theme)):(e.write_shift(1,5),e.write_shift(1,0));var t=r.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),e.write_shift(2,t),!r.rgb||r.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=r.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function F6(r){var e=r.read_shift(1);r.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function R6(r,e){e||(e=Ue(2));var t=(r.italic?2:0)|(r.strike?8:0)|(r.outline?16:0)|(r.shadow?32:0)|(r.condense?64:0)|(r.extend?128:0);return e.write_shift(1,t),e.write_shift(1,0),e}function Qw(r,e){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=r.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return t[r.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return r.l-=4,r.read_shift(0,e==1?"lpstr":"lpwstr")}function D6(r){return Qw(r,1)}function L6(r){return Qw(r,2)}var R1=2,Ba=3,q0=11,A2=12,qf=19,z0=64,j6=65,O6=71,M6=4108,B6=4126,Bn=80,Zw=81,V6=[Bn,Zw],ap={1:{n:"CodePage",t:R1},2:{n:"Category",t:Bn},3:{n:"PresentationFormat",t:Bn},4:{n:"ByteCount",t:Ba},5:{n:"LineCount",t:Ba},6:{n:"ParagraphCount",t:Ba},7:{n:"SlideCount",t:Ba},8:{n:"NoteCount",t:Ba},9:{n:"HiddenCount",t:Ba},10:{n:"MultimediaClipCount",t:Ba},11:{n:"ScaleCrop",t:q0},12:{n:"HeadingPairs",t:M6},13:{n:"TitlesOfParts",t:B6},14:{n:"Manager",t:Bn},15:{n:"Company",t:Bn},16:{n:"LinksUpToDate",t:q0},17:{n:"CharacterCount",t:Ba},19:{n:"SharedDoc",t:q0},22:{n:"HyperlinksChanged",t:q0},23:{n:"AppVersion",t:Ba,p:"version"},24:{n:"DigSig",t:j6},26:{n:"ContentType",t:Bn},27:{n:"ContentStatus",t:Bn},28:{n:"Language",t:Bn},29:{n:"Version",t:Bn},255:{},2147483648:{n:"Locale",t:qf},2147483651:{n:"Behavior",t:qf},1919054434:{}},sp={1:{n:"CodePage",t:R1},2:{n:"Title",t:Bn},3:{n:"Subject",t:Bn},4:{n:"Author",t:Bn},5:{n:"Keywords",t:Bn},6:{n:"Comments",t:Bn},7:{n:"Template",t:Bn},8:{n:"LastAuthor",t:Bn},9:{n:"RevNumber",t:Bn},10:{n:"EditTime",t:z0},11:{n:"LastPrinted",t:z0},12:{n:"CreatedDate",t:z0},13:{n:"ModifiedDate",t:z0},14:{n:"PageCount",t:Ba},15:{n:"WordCount",t:Ba},16:{n:"CharCount",t:Ba},17:{n:"Thumbnail",t:O6},18:{n:"Application",t:Bn},19:{n:"DocSecurity",t:Ba},255:{},2147483648:{n:"Locale",t:qf},2147483651:{n:"Behavior",t:qf},1919054434:{}},N2={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},U6=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function q6(r){return r.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var z6=q6([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Pc=$r(z6),Xi={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},e_={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},ip={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},W0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function D1(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function W6(r){var e=D1();if(!r||!r.match)return e;var t={};if((r.match(xa)||[]).forEach(function(n){var a=Wt(n);switch(a[0].replace(e6,"<")){case"<?xml":break;case"<Types":e.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[a.Extension]=a.ContentType;break;case"<Override":e[ip[a.ContentType]]!==void 0&&e[ip[a.ContentType]].push(a.PartName);break}}),e.xmlns!==Fn.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=t,delete e.calcchains,e}function t_(r,e){var t=WT(ip),n=[],a;n[n.length]=wn,n[n.length]=ct("Types",null,{xmlns:Fn.CT,"xmlns:xsd":Fn.xsd,"xmlns:xsi":Fn.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return ct("Default",null,{Extension:c[0],ContentType:c[1]})}));var s=function(c){r[c]&&r[c].length>0&&(a=r[c][0],n[n.length]=ct("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:W0[c][e.bookType]||W0[c].xlsx}))},i=function(c){(r[c]||[]).forEach(function(l){n[n.length]=ct("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:W0[c][e.bookType]||W0[c].xlsx})})},o=function(c){(r[c]||[]).forEach(function(l){n[n.length]=ct("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:t[c][0]})})};return s("workbooks"),i("sheets"),i("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),i("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var tr={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function jh(r){var e=r.lastIndexOf("/");return r.slice(0,e+1)+"_rels/"+r.slice(e+1)+".rels"}function dh(r,e){var t={"!id":{}};if(!r)return t;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(r.match(xa)||[]).forEach(function(a){var s=Wt(a);if(s[0]==="<Relationship"){var i={};i.Type=s.Type,i.Target=s.Target,i.Id=s.Id,s.TargetMode&&(i.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:ah(s.Target,e);t[o]=i,n[s.Id]=i}}),t["!id"]=n,t}function Jl(r){var e=[wn,ct("Relationships",null,{xmlns:Fn.RELS})];return fn(r["!id"]).forEach(function(t){e[e.length]=ct("Relationship",null,r["!id"][t])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Ar(r,e,t,n,a,s){if(a||(a={}),r["!id"]||(r["!id"]={}),r["!idx"]||(r["!idx"]=1),e<0)for(e=r["!idx"];r["!id"]["rId"+e];++e);if(r["!idx"]=e+1,a.Id="rId"+e,a.Type=n,a.Target=t,[tr.HLINK,tr.XPATH,tr.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),r["!id"][a.Id])throw new Error("Cannot rewrite rId "+e);return r["!id"][a.Id]=a,r[("/"+a.Target).replace("//","/")]=a,e}var H6="application/vnd.oasis.opendocument.spreadsheet";function G6(r,e){for(var t=S1(r),n,a;n=Lh.exec(t);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Wt(n[0],!1),a.path=="/"&&a.type!==H6)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function $6(r){var e=[wn];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<r.length;++t)e.push('  <manifest:file-entry manifest:full-path="'+r[t][0]+'" manifest:media-type="'+r[t][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function T2(r,e,t){return['  <rdf:Description rdf:about="'+r+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function K6(r,e){return['  <rdf:Description rdf:about="'+r+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function X6(r){var e=[wn];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=r.length;++t)e.push(T2(r[t][0],r[t][1])),e.push(K6("",r[t][0]));return e.push(T2("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function r_(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Df.version+"</meta:generator></office:meta></office:document-meta>"}var Ns=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Y6=function(){for(var r=new Array(Ns.length),e=0;e<Ns.length;++e){var t=Ns[e],n="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);r[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return r}();function n_(r){var e={};r=Lr(r);for(var t=0;t<Ns.length;++t){var n=Ns[t],a=r.match(Y6[t]);a!=null&&a.length>0&&(e[n[1]]=mr(a[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=Gr(e[n[1]]))}return e}function om(r,e,t,n,a){a[r]!=null||e==null||e===""||(a[r]=e,e=Tr(e),n[n.length]=t?ct(r,e,t):Zn(r,e))}function a_(r,e){var t=e||{},n=[wn,ct("cp:coreProperties",null,{"xmlns:cp":Fn.CORE_PROPS,"xmlns:dc":Fn.dc,"xmlns:dcterms":Fn.dcterms,"xmlns:dcmitype":Fn.dcmitype,"xmlns:xsi":Fn.xsi})],a={};if(!r&&!t.Props)return n.join("");r&&(r.CreatedDate!=null&&om("dcterms:created",typeof r.CreatedDate=="string"?r.CreatedDate:rp(r.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),r.ModifiedDate!=null&&om("dcterms:modified",typeof r.ModifiedDate=="string"?r.ModifiedDate:rp(r.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var s=0;s!=Ns.length;++s){var i=Ns[s],o=t.Props&&t.Props[i[1]]!=null?t.Props[i[1]]:r?r[i[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&om(i[0],o,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Fc=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],s_=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function i_(r,e,t,n){var a=[];if(typeof r=="string")a=x2(r,n);else for(var s=0;s<r.length;++s)a=a.concat(r[s].map(function(u){return{v:u}}));var i=typeof e=="string"?x2(e,n).map(function(u){return u.v}):e,o=0,c=0;if(i.length>0)for(var l=0;l!==a.length;l+=2){switch(c=+a[l+1].v,a[l].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":t.Worksheets=c,t.SheetNames=i.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":t.NamedRanges=c,t.DefinedNames=i.slice(o,o+c);break;case"Charts":case"Diagramme":t.Chartsheets=c,t.ChartNames=i.slice(o,o+c);break}o+=c}}function J6(r,e,t){var n={};return e||(e={}),r=Lr(r),Fc.forEach(function(a){var s=(r.match(Rh(a[0]))||[])[1];switch(a[2]){case"string":s&&(e[a[1]]=mr(s));break;case"bool":e[a[1]]=s==="true";break;case"raw":var i=r.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));i&&i.length>0&&(n[a[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&i_(n.HeadingPairs,n.TitlesOfParts,e,t),e}function o_(r){var e=[],t=ct;return r||(r={}),r.Application="SheetJS",e[e.length]=wn,e[e.length]=ct("Properties",null,{xmlns:Fn.EXT_PROPS,"xmlns:vt":Fn.vt}),Fc.forEach(function(n){if(r[n[1]]!==void 0){var a;switch(n[2]){case"string":a=Tr(String(r[n[1]]));break;case"bool":a=r[n[1]]?"true":"false";break}a!==void 0&&(e[e.length]=t(n[0],a))}}),e[e.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(r.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=t("TitlesOfParts",t("vt:vector",r.SheetNames.map(function(n){return"<vt:lpstr>"+Tr(n)+"</vt:lpstr>"}).join(""),{size:r.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Q6=/<[^>]+>[^<]*/g;function Z6(r,e){var t={},n="",a=r.match(Q6);if(a)for(var s=0;s!=a.length;++s){var i=a[s],o=Wt(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=mr(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var c=i.split(">"),l=c[0].slice(4),u=c[1];switch(l){case"lpstr":case"bstr":case"lpwstr":t[n]=mr(u);break;case"bool":t[n]=Wr(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":t[n]=parseFloat(u);break;case"filetime":case"date":t[n]=Gr(u);break;case"cy":case"error":t[n]=mr(u);break;default:if(l.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",i,l,c)}}else if(i.slice(0,2)!=="</"){if(e.WTF)throw new Error(i)}}}return t}function c_(r){var e=[wn,ct("Properties",null,{xmlns:Fn.CUST_PROPS,"xmlns:vt":Fn.vt})];if(!r)return e.join("");var t=1;return fn(r).forEach(function(a){++t,e[e.length]=ct("property",c6(r[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:Tr(a)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var op={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},cm;function ek(r,e,t){cm||(cm=wd(op)),e=cm[e]||e,r[e]=t}function tk(r,e){var t=[];return fn(op).map(function(n){for(var a=0;a<Ns.length;++a)if(Ns[a][1]==n)return Ns[a];for(a=0;a<Fc.length;++a)if(Fc[a][1]==n)return Fc[a];throw n}).forEach(function(n){if(r[n[1]]!=null){var a=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:r[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),t.push(Zn(op[n[1]]||n[1],a))}}),ct("DocumentProperties",t.join(""),{xmlns:es.o})}function rk(r,e){var t=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return r&&fn(r).forEach(function(s){if(Object.prototype.hasOwnProperty.call(r,s)){for(var i=0;i<Ns.length;++i)if(s==Ns[i][1])return;for(i=0;i<Fc.length;++i)if(s==Fc[i][1])return;for(i=0;i<t.length;++i)if(s==t[i])return;var o=r[s],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),a.push(ct(d2(s),o,{"dt:dt":c}))}}),e&&fn(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(r&&Object.prototype.hasOwnProperty.call(r,s))){var i=e[s],o="string";typeof i=="number"?(o="float",i=String(i)):i===!0||i===!1?(o="boolean",i=i?"1":"0"):i instanceof Date?(o="dateTime.tz",i=i.toISOString()):i=String(i),a.push(ct(d2(s),i,{"dt:dt":o}))}}),"<"+n+' xmlns="'+es.o+'">'+a.join("")+"</"+n+">"}function L1(r){var e=r.read_shift(4),t=r.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function nk(r){var e=typeof r=="string"?new Date(Date.parse(r)):r,t=e.getTime()/1e3+11644473600,n=t%Math.pow(2,32),a=(t-n)/Math.pow(2,32);n*=1e7,a*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),a+=s);var i=Ue(8);return i.write_shift(4,n),i.write_shift(4,a),i}function l_(r,e,t){var n=r.l,a=r.read_shift(0,"lpstr-cp");if(t)for(;r.l-n&3;)++r.l;return a}function u_(r,e,t){var n=r.read_shift(0,"lpwstr");return n}function h_(r,e,t){return e===31?u_(r):l_(r,e,t)}function cp(r,e,t){return h_(r,e,t===!1?0:4)}function ak(r,e){if(!e)throw new Error("VtUnalignedString must have positive length");return h_(r,e,0)}function sk(r){for(var e=r.read_shift(4),t=[],n=0;n!=e;++n){var a=r.l;t[n]=r.read_shift(0,"lpwstr").replace(Ca,""),r.l-a&2&&(r.l+=2)}return t}function ik(r){for(var e=r.read_shift(4),t=[],n=0;n!=e;++n)t[n]=r.read_shift(0,"lpstr-cp").replace(Ca,"");return t}function ok(r){var e=r.l,t=zf(r,Zw);r[r.l]==0&&r[r.l+1]==0&&r.l-e&2&&(r.l+=2);var n=zf(r,Ba);return[t,n]}function ck(r){for(var e=r.read_shift(4),t=[],n=0;n<e/2;++n)t.push(ok(r));return t}function k2(r,e){for(var t=r.read_shift(4),n={},a=0;a!=t;++a){var s=r.read_shift(4),i=r.read_shift(4);n[s]=r.read_shift(i,e===1200?"utf16le":"utf8").replace(Ca,"").replace(nh,"!"),e===1200&&i%2&&(r.l+=2)}return r.l&3&&(r.l=r.l>>3<<2),n}function f_(r){var e=r.read_shift(4),t=r.slice(r.l,r.l+e);return r.l+=e,(e&3)>0&&(r.l+=4-(e&3)&3),t}function lk(r){var e={};return e.Size=r.read_shift(4),r.l+=e.Size+3-(e.Size-1)%4,e}function zf(r,e,t){var n=r.read_shift(2),a,s=t||{};if(r.l+=2,e!==A2&&n!==e&&V6.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===A2?n:e){case 2:return a=r.read_shift(2,"i"),s.raw||(r.l+=2),a;case 3:return a=r.read_shift(4,"i"),a;case 11:return r.read_shift(4)!==0;case 19:return a=r.read_shift(4),a;case 30:return l_(r,n,4).replace(Ca,"");case 31:return u_(r);case 64:return L1(r);case 65:return f_(r);case 71:return lk(r);case 80:return cp(r,n,!s.raw).replace(Ca,"");case 81:return ak(r,n).replace(Ca,"");case 4108:return ck(r);case 4126:case 4127:return n==4127?sk(r):ik(r);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function I2(r,e){var t=Ue(4),n=Ue(4);switch(t.write_shift(4,r==80?31:r),r){case 3:n.write_shift(-4,e);break;case 5:n=Ue(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=nk(e);break;case 31:case 80:for(n=Ue(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+e)}return qn([t,n])}function C2(r,e){var t=r.l,n=r.read_shift(4),a=r.read_shift(4),s=[],i=0,o=0,c=-1,l={};for(i=0;i!=a;++i){var u=r.read_shift(4),d=r.read_shift(4);s[i]=[u,d+t]}s.sort(function(R,P){return R[1]-P[1]});var g={};for(i=0;i!=a;++i){if(r.l!==s[i][1]){var p=!0;if(i>0&&e)switch(e[s[i-1][0]].t){case 2:r.l+2===s[i][1]&&(r.l+=2,p=!1);break;case 80:r.l<=s[i][1]&&(r.l=s[i][1],p=!1);break;case 4108:r.l<=s[i][1]&&(r.l=s[i][1],p=!1);break}if((!e||i==0)&&r.l<=s[i][1]&&(p=!1,r.l=s[i][1]),p)throw new Error("Read Error: Expected address "+s[i][1]+" at "+r.l+" :"+i)}if(e){var y=e[s[i][0]];if(g[y.n]=zf(r,y.t,{raw:!0}),y.p==="version"&&(g[y.n]=String(g[y.n]>>16)+"."+("0000"+String(g[y.n]&65535)).slice(-4)),y.n=="CodePage")switch(g[y.n]){case 0:g[y.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Hs(o=g[y.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+g[y.n])}}else if(s[i][0]===1){if(o=g.CodePage=zf(r,R1),Hs(o),c!==-1){var v=r.l;r.l=s[c][1],l=k2(r,o),r.l=v}}else if(s[i][0]===0){if(o===0){c=i,r.l=s[i+1][1];continue}l=k2(r,o)}else{var w=l[s[i][0]],E;switch(r[r.l]){case 65:r.l+=4,E=f_(r);break;case 30:r.l+=4,E=cp(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 31:r.l+=4,E=cp(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 3:r.l+=4,E=r.read_shift(4,"i");break;case 19:r.l+=4,E=r.read_shift(4);break;case 5:r.l+=4,E=r.read_shift(8,"f");break;case 11:r.l+=4,E=pn(r,4);break;case 64:r.l+=4,E=Gr(L1(r));break;default:throw new Error("unparsed value: "+r[r.l])}g[w]=E}}return r.l=t+n,g}var d_=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function uk(r){switch(typeof r){case"boolean":return 11;case"number":return(r|0)==r?3:5;case"string":return 31;case"object":if(r instanceof Date)return 64;break}return-1}function P2(r,e,t){var n=Ue(8),a=[],s=[],i=8,o=0,c=Ue(8),l=Ue(8);if(c.write_shift(4,2),c.write_shift(4,1200),l.write_shift(4,1),s.push(c),a.push(l),i+=8+c.length,!e){l=Ue(8),l.write_shift(4,0),a.unshift(l);var u=[Ue(4)];for(u[0].write_shift(4,r.length),o=0;o<r.length;++o){var d=r[o][0];for(c=Ue(8+2*(d.length+1)+(d.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,d.length+1),c.write_shift(0,d,"dbcs");c.l!=c.length;)c.write_shift(1,0);u.push(c)}c=qn(u),s.unshift(c),i+=8+c.length}for(o=0;o<r.length;++o)if(!(e&&!e[r[o][0]])&&!(d_.indexOf(r[o][0])>-1||s_.indexOf(r[o][0])>-1)&&r[o][1]!=null){var g=r[o][1],p=0;if(e){p=+e[r[o][0]];var y=t[p];if(y.p=="version"&&typeof g=="string"){var v=g.split(".");g=(+v[0]<<16)+(+v[1]||0)}c=I2(y.t,g)}else{var w=uk(g);w==-1&&(w=31,g=String(g)),c=I2(w,g)}s.push(c),l=Ue(8),l.write_shift(4,e?p:2+o),a.push(l),i+=8+c.length}var E=8*(s.length+1);for(o=0;o<s.length;++o)a[o].write_shift(4,E),E+=s[o].length;return n.write_shift(4,i),n.write_shift(4,s.length),qn([n].concat(a).concat(s))}function F2(r,e,t){var n=r.content;if(!n)return{};Qn(n,0);var a,s,i,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var l=n.read_shift(4),u=n.read_shift(16);if(u!==Pt.utils.consts.HEADER_CLSID&&u!==t)throw new Error("Bad PropertySet CLSID "+u);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),o=n.read_shift(4),a===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);a===2&&(i=n.read_shift(16),c=n.read_shift(4));var d=C2(n,e),g={SystemIdentifier:l};for(var p in d)g[p]=d[p];if(g.FMTID=s,a===1)return g;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var y;try{y=C2(n,null)}catch{}for(p in y)g[p]=y[p];return g.FMTID=[s,i],g}function R2(r,e,t,n,a,s){var i=Ue(a?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,Pt.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,a?2:1),i.write_shift(16,e,"hex"),i.write_shift(4,a?68:48);var c=P2(r,t,n);if(o.push(c),a){var l=P2(a,null,null);i.write_shift(16,s,"hex"),i.write_shift(4,68+c.length),o.push(l)}return qn(o)}function To(r,e){return r.read_shift(e),null}function hk(r,e){e||(e=Ue(r));for(var t=0;t<r;++t)e.write_shift(1,0);return e}function fk(r,e,t){for(var n=[],a=r.l+e;r.l<a;)n.push(t(r,a-r.l));if(a!==r.l)throw new Error("Slurp error");return n}function pn(r,e){return r.read_shift(e)===1}function Na(r,e){return e||(e=Ue(2)),e.write_shift(2,+!!r),e}function Tn(r){return r.read_shift(2,"u")}function Es(r,e){return e||(e=Ue(2)),e.write_shift(2,r),e}function m_(r,e){return fk(r,e,Tn)}function dk(r){var e=r.read_shift(1),t=r.read_shift(1);return t===1?e:e===1}function p_(r,e,t){return t||(t=Ue(2)),t.write_shift(1,e=="e"?+r:+!!r),t.write_shift(1,e=="e"?1:0),t}function a0(r,e,t){var n=r.read_shift(t&&t.biff>=12?2:1),a="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var s=r.read_shift(1);s&&(a="dbcs-cont")}else t.biff==12&&(a="wstr");t.biff>=2&&t.biff<=5&&(a="cpstr");var i=n?r.read_shift(n,a):"";return i}function mk(r){var e=r.read_shift(2),t=r.read_shift(1),n=t&4,a=t&8,s=1+(t&1),i=0,o,c={};a&&(i=r.read_shift(2)),n&&(o=r.read_shift(4));var l=s==2?"dbcs-cont":"sbcs-cont",u=e===0?"":r.read_shift(e,l);return a&&(r.l+=4*i),n&&(r.l+=o),c.t=u,a||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function pk(r){var e=r.t||"",t=Ue(3);t.write_shift(2,e.length),t.write_shift(1,1);var n=Ue(2*e.length);n.write_shift(2*e.length,e,"utf16le");var a=[t,n];return qn(a)}function Kc(r,e,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return r.read_shift(e,"cpstr");if(t.biff>=12)return r.read_shift(e,"dbcs-cont")}var a=r.read_shift(1);return a===0?n=r.read_shift(e,"sbcs-cont"):n=r.read_shift(e,"dbcs-cont"),n}function s0(r,e,t){var n=r.read_shift(t&&t.biff==2?1:2);return n===0?(r.l++,""):Kc(r,n,t)}function il(r,e,t){if(t.biff>5)return s0(r,e,t);var n=r.read_shift(1);return n===0?(r.l++,""):r.read_shift(n,t.biff<=4||!r.lens?"cpstr":"sbcs-cont")}function g_(r,e,t){return t||(t=Ue(3+2*r.length)),t.write_shift(2,r.length),t.write_shift(1,1),t.write_shift(31,r,"utf16le"),t}function gk(r){var e=r.read_shift(1);r.l++;var t=r.read_shift(2);return r.l+=2,[e,t]}function xk(r){var e=r.read_shift(4),t=r.l,n=!1;e>24&&(r.l+=e-24,r.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),r.l=t);var a=r.read_shift((n?e-24:e)>>1,"utf16le").replace(Ca,"");return n&&(r.l+=24),a}function vk(r){for(var e=r.read_shift(2),t="";e-- >0;)t+="../";var n=r.read_shift(0,"lpstr-ansi");if(r.l+=2,r.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=r.read_shift(4);if(a===0)return t+n.replace(/\\/g,"/");var s=r.read_shift(4);if(r.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=r.read_shift(s>>1,"utf16le").replace(Ca,"");return t+i}function yk(r,e){var t=r.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return xk(r);case"0303000000000000c000000000000046":return vk(r);default:throw new Error("Unsupported Moniker "+t)}}function H0(r){var e=r.read_shift(4),t=e>0?r.read_shift(e,"utf16le").replace(Ca,""):"";return t}function D2(r,e){e||(e=Ue(6+r.length*2)),e.write_shift(4,1+r.length);for(var t=0;t<r.length;++t)e.write_shift(2,r.charCodeAt(t));return e.write_shift(2,0),e}function wk(r,e){var t=r.l+e,n=r.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=r.read_shift(2);r.l+=2;var s,i,o,c,l="",u,d;a&16&&(s=H0(r,t-r.l)),a&128&&(i=H0(r,t-r.l)),(a&257)===257&&(o=H0(r,t-r.l)),(a&257)===1&&(c=yk(r,t-r.l)),a&8&&(l=H0(r,t-r.l)),a&32&&(u=r.read_shift(16)),a&64&&(d=L1(r)),r.l=t;var g=i||o||c||"";g&&l&&(g+="#"+l),g||(g="#"+l),a&2&&g.charAt(0)=="/"&&g.charAt(1)!="/"&&(g="file://"+g);var p={Target:g};return u&&(p.guid=u),d&&(p.time=d),s&&(p.Tooltip=s),p}function _k(r){var e=Ue(512),t=0,n=r.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),s=a>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var i=[8,6815827,6619237,4849780,83];for(t=0;t<i.length;++t)e.write_shift(4,i[t]);if(s==28)n=n.slice(1),D2(n,e);else if(s&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<i.length;++t)e.write_shift(1,parseInt(i[t],16));var o=a>-1?n.slice(0,a):n;for(e.write_shift(4,2*(o.length+1)),t=0;t<o.length;++t)e.write_shift(2,o.charCodeAt(t));e.write_shift(2,0),s&8&&D2(a>-1?n.slice(a+1):"",e)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<i.length;++t)e.write_shift(1,parseInt(i[t],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(e.write_shift(2,c),e.write_shift(4,n.length-3*c+1),t=0;t<n.length-3*c;++t)e.write_shift(1,n.charCodeAt(t+3*c)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),t=0;t<6;++t)e.write_shift(4,0)}return e.slice(0,e.l)}function x_(r){var e=r.read_shift(1),t=r.read_shift(1),n=r.read_shift(1),a=r.read_shift(1);return[e,t,n,a]}function v_(r,e){var t=x_(r);return t[3]=0,t}function yi(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2);return{r:e,c:t,ixfe:n}}function Xc(r,e,t,n){return n||(n=Ue(6)),n.write_shift(2,r),n.write_shift(2,e),n.write_shift(2,t||0),n}function bk(r){var e=r.read_shift(2),t=r.read_shift(2);return r.l+=8,{type:e,flags:t}}function Ek(r,e,t){return e===0?"":il(r,e,t)}function Sk(r,e,t){var n=t.biff>8?4:2,a=r.read_shift(n),s=r.read_shift(n,"i"),i=r.read_shift(n,"i");return[a,s,i]}function y_(r){var e=r.read_shift(2),t=F1(r);return[e,t]}function Ak(r,e,t){r.l+=4,e-=4;var n=r.l+e,a=a0(r,e,t),s=r.read_shift(2);if(n-=r.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return r.l+=s,a}function Ed(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2),a=r.read_shift(2);return{s:{c:n,r:e},e:{c:a,r:t}}}function w_(r,e){return e||(e=Ue(8)),e.write_shift(2,r.s.r),e.write_shift(2,r.e.r),e.write_shift(2,r.s.c),e.write_shift(2,r.e.c),e}function __(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(1),a=r.read_shift(1);return{s:{c:n,r:e},e:{c:a,r:t}}}var Nk=__;function b_(r){r.l+=4;var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2);return r.l+=12,[t,e,n]}function Tk(r){var e={};return r.l+=4,r.l+=16,e.fSharedNote=r.read_shift(2),r.l+=4,e}function kk(r){var e={};return r.l+=4,r.cf=r.read_shift(2),e}function aa(r){r.l+=2,r.l+=r.read_shift(2)}var Ik={0:aa,4:aa,5:aa,6:aa,7:kk,8:aa,9:aa,10:aa,11:aa,12:aa,13:Tk,14:aa,15:aa,16:aa,17:aa,18:aa,19:aa,20:aa,21:b_};function Ck(r,e){for(var t=r.l+e,n=[];r.l<t;){var a=r.read_shift(2);r.l-=2;try{n.push(Ik[a](r,t-r.l))}catch{return r.l=t,n}}return r.l!=t&&(r.l=t),n}function G0(r,e){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=r.read_shift(2),e-=2,e>=2&&(t.dt=r.read_shift(2),r.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return r.read_shift(e),t}function j1(r,e,t){var n=1536,a=16;switch(t.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=Ue(a);return s.write_shift(2,n),s.write_shift(2,e),a>4&&s.write_shift(2,29282),a>6&&s.write_shift(2,1997),a>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function Pk(r,e){return e===0||r.read_shift(2),1200}function Fk(r,e,t){if(t.enc)return r.l+=e,"";var n=r.l,a=il(r,0,t);return r.read_shift(e+n-r.l),a}function Rk(r,e){var t=!e||e.biff==8,n=Ue(t?112:54);for(n.write_shift(e.biff==8?2:1,7),t&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(t?0:536870912));n.l<n.length;)n.write_shift(1,t?0:32);return n}function Dk(r,e,t){var n=t&&t.biff==8||e==2?r.read_shift(2):(r.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function Lk(r,e,t){var n=r.read_shift(4),a=r.read_shift(1)&3,s=r.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var i=a0(r,0,t);return i.length===0&&(i="Sheet1"),{pos:n,hs:a,dt:s,name:i}}function jk(r,e){var t=!e||e.biff>=8?2:1,n=Ue(8+t*r.name.length);n.write_shift(4,r.pos),n.write_shift(1,r.hs||0),n.write_shift(1,r.dt),n.write_shift(1,r.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(t*r.name.length,r.name,e.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function Ok(r,e){for(var t=r.l+e,n=r.read_shift(4),a=r.read_shift(4),s=[],i=0;i!=a&&r.l<t;++i)s.push(mk(r));return s.Count=n,s.Unique=a,s}function Mk(r,e){var t=Ue(8);t.write_shift(4,r.Count),t.write_shift(4,r.Unique);for(var n=[],a=0;a<r.length;++a)n[a]=pk(r[a]);var s=qn([t].concat(n));return s.parts=[t.length].concat(n.map(function(i){return i.length})),s}function Bk(r,e){var t={};return t.dsst=r.read_shift(2),r.l+=e-2,t}function Vk(r){var e={};e.r=r.read_shift(2),e.c=r.read_shift(2),e.cnt=r.read_shift(2)-e.c;var t=r.read_shift(2);r.l+=4;var n=r.read_shift(1);return r.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=t/20),e}function Uk(r){var e=bk(r);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var t=r.read_shift(4);return t!==0}function qk(r){return r.read_shift(2),r.read_shift(4)}function L2(r,e,t){var n=0;t&&t.biff==2||(n=r.read_shift(2));var a=r.read_shift(2);t&&t.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function zk(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2),a=r.read_shift(2),s=r.read_shift(2),i=r.read_shift(2),o=r.read_shift(2),c=r.read_shift(2),l=r.read_shift(2);return{Pos:[e,t],Dim:[n,a],Flags:s,CurTab:i,FirstTab:o,Selected:c,TabRatio:l}}function Wk(){var r=Ue(18);return r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,29280),r.write_shift(2,17600),r.write_shift(2,56),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,1),r.write_shift(2,500),r}function Hk(r,e,t){if(t&&t.biff>=2&&t.biff<5)return{};var n=r.read_shift(2);return{RTL:n&64}}function Gk(r){var e=Ue(18),t=1718;return r&&r.RTL&&(t|=64),e.write_shift(2,t),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function $k(){}function Kk(r,e,t){var n={dyHeight:r.read_shift(2),fl:r.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:r.l+=2;break;default:r.l+=10;break}return n.name=a0(r,0,t),n}function Xk(r,e){var t=r.name||"Arial",n=e&&e.biff==5,a=n?15+t.length:16+2*t.length,s=Ue(a);return s.write_shift(2,(r.sz||12)*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,t.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le"),s}function Yk(r){var e=yi(r);return e.isst=r.read_shift(4),e}function Jk(r,e,t,n){var a=Ue(10);return Xc(r,e,n,a),a.write_shift(4,t),a}function Qk(r,e,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=r.l+e,a=yi(r);t.biff==2&&r.l++;var s=s0(r,n-r.l,t);return a.val=s,a}function Zk(r,e,t,n,a){var s=!a||a.biff==8,i=Ue(8+ +s+(1+s)*t.length);return Xc(r,e,n,i),i.write_shift(2,t.length),s&&i.write_shift(1,1),i.write_shift((1+s)*t.length,t,s?"utf16le":"sbcs"),i}function eI(r,e,t){var n=r.read_shift(2),a=il(r,0,t);return[n,a]}function tI(r,e,t,n){var a=t&&t.biff==5;n||(n=Ue(a?3+e.length:5+2*e.length)),n.write_shift(2,r),n.write_shift(a?1:2,e.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*e.length,e,a?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var rI=il;function j2(r,e,t){var n=r.l+e,a=t.biff==8||!t.biff?4:2,s=r.read_shift(a),i=r.read_shift(a),o=r.read_shift(2),c=r.read_shift(2);return r.l=n,{s:{r:s,c:o},e:{r:i,c}}}function nI(r,e){var t=e.biff==8||!e.biff?4:2,n=Ue(2*t+6);return n.write_shift(t,r.s.r),n.write_shift(t,r.e.r+1),n.write_shift(2,r.s.c),n.write_shift(2,r.e.c+1),n.write_shift(2,0),n}function aI(r){var e=r.read_shift(2),t=r.read_shift(2),n=y_(r);return{r:e,c:t,ixfe:n[0],rknum:n[1]}}function sI(r,e){for(var t=r.l+e-2,n=r.read_shift(2),a=r.read_shift(2),s=[];r.l<t;)s.push(y_(r));if(r.l!==t)throw new Error("MulRK read error");var i=r.read_shift(2);if(s.length!=i-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:i,rkrec:s}}function iI(r,e){for(var t=r.l+e-2,n=r.read_shift(2),a=r.read_shift(2),s=[];r.l<t;)s.push(r.read_shift(2));if(r.l!==t)throw new Error("MulBlank read error");var i=r.read_shift(2);if(s.length!=i-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:i,ixfe:s}}function oI(r,e,t,n){var a={},s=r.read_shift(4),i=r.read_shift(4),o=r.read_shift(4),c=r.read_shift(2);return a.patternType=U6[o>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=i&15,a.dgRight=i>>4&15,a.dgTop=i>>8&15,a.dgBottom=i>>12&15,a.icvLeft=i>>16&127,a.icvRight=i>>23&127,a.grbitDiag=i>>30&3,a.icvTop=o&127,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=c&127,a.icvBack=c>>7&127,a.fsxButton=c>>14&1),a}function cI(r,e,t){var n={};return n.ifnt=r.read_shift(2),n.numFmtId=r.read_shift(2),n.flags=r.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=oI(r,e,n.fStyle,t),n}function O2(r,e,t,n){var a=t&&t.biff==5;n||(n=Ue(a?16:20)),n.write_shift(2,0),r.style?(n.write_shift(2,r.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,r.numFmtId||0),n.write_shift(2,e<<4));var s=0;return r.numFmtId>0&&a&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function lI(r){r.l+=4;var e=[r.read_shift(2),r.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function uI(r){var e=Ue(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function M2(r,e,t){var n=yi(r);(t.biff==2||e==9)&&++r.l;var a=dk(r);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function hI(r,e,t,n,a,s){var i=Ue(8);return Xc(r,e,n,i),p_(t,s,i),i}function fI(r,e,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=yi(r),a=da(r);return n.val=a,n}function dI(r,e,t,n){var a=Ue(14);return Xc(r,e,n,a),$c(t,a),a}var B2=Ek;function mI(r,e,t){var n=r.l+e,a=r.read_shift(2),s=r.read_shift(2);if(t.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var i=Kc(r,s),o=[];n>r.l;)o.push(s0(r));return[s,a,i,o]}function V2(r,e,t){var n=r.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return t.sbcch===14849&&(a=Ak(r,e-2,t)),s.body=a||r.read_shift(e-2),typeof a=="string"&&(s.Name=a),s}var pI=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function U2(r,e,t){var n=r.l+e,a=r.read_shift(2),s=r.read_shift(1),i=r.read_shift(1),o=r.read_shift(t&&t.biff==2?1:2),c=0;(!t||t.biff>=5)&&(t.biff!=5&&(r.l+=2),c=r.read_shift(2),t.biff==5&&(r.l+=2),r.l+=4);var l=Kc(r,i,t);a&32&&(l=pI[l.charCodeAt(0)]);var u=n-r.l;t&&t.biff==2&&--u;var d=n==r.l||o===0||!(u>0)?[]:CF(r,u,t,o);return{chKey:s,Name:l,itab:c,rgce:d}}function E_(r,e,t){if(t.biff<8)return gI(r,e,t);for(var n=[],a=r.l+e,s=r.read_shift(t.biff>8?4:2);s--!==0;)n.push(Sk(r,t.biff>8?12:6,t));if(r.l!=a)throw new Error("Bad ExternSheet: "+r.l+" != "+a);return n}function gI(r,e,t){r[r.l+1]==3&&r[r.l]++;var n=a0(r,e,t);return n.charCodeAt(0)==3?n.slice(1):n}function xI(r,e,t){if(t.biff<8){r.l+=e;return}var n=r.read_shift(2),a=r.read_shift(2),s=Kc(r,n,t),i=Kc(r,a,t);return[s,i]}function vI(r,e,t){var n=__(r);r.l++;var a=r.read_shift(1);return e-=8,[PF(r,e,t),a,n]}function q2(r,e,t){var n=Nk(r);switch(t.biff){case 2:r.l++,e-=7;break;case 3:case 4:r.l+=2,e-=8;break;default:r.l+=6,e-=12}return[n,kF(r,e,t)]}function yI(r){var e=r.read_shift(4)!==0,t=r.read_shift(4)!==0,n=r.read_shift(4);return[e,t,n]}function wI(r,e,t){if(!(t.biff<8)){var n=r.read_shift(2),a=r.read_shift(2),s=r.read_shift(2),i=r.read_shift(2),o=il(r,0,t);return t.biff<8&&r.read_shift(1),[{r:n,c:a},o,i,s]}}function _I(r,e,t){return wI(r,e,t)}function bI(r,e){for(var t=[],n=r.read_shift(2);n--;)t.push(Ed(r));return t}function EI(r){var e=Ue(2+r.length*8);e.write_shift(2,r.length);for(var t=0;t<r.length;++t)w_(r[t],e);return e}function SI(r,e,t){if(t&&t.biff<8)return NI(r,e,t);var n=b_(r),a=Ck(r,e-22,n[1]);return{cmo:n,ft:a}}var AI={8:function(r,e){var t=r.l+e;r.l+=10;var n=r.read_shift(2);r.l+=4,r.l+=2,r.l+=2,r.l+=2,r.l+=4;var a=r.read_shift(1);return r.l+=a,r.l=t,{fmt:n}}};function NI(r,e,t){r.l+=4;var n=r.read_shift(2),a=r.read_shift(2),s=r.read_shift(2);r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=6,e-=36;var i=[];return i.push((AI[n]||ga)(r,e,t)),{cmo:[a,n,s],ft:i}}function TI(r,e,t){var n=r.l,a="";try{r.l+=4;var s=(t.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(s)==-1?r.l+=6:i=gk(r,6,t);var o=r.read_shift(2);r.read_shift(2),Tn(r,2);var c=r.read_shift(2);r.l+=c;for(var l=1;l<r.lens.length-1;++l){if(r.l-n!=r.lens[l])throw new Error("TxO: bad continue record");var u=r[r.l],d=Kc(r,r.lens[l+1]-r.lens[l]-1);if(a+=d,a.length>=(u?o:2*o))break}if(a.length!==o&&a.length!==o*2)throw new Error("cchText: "+o+" != "+a.length);return r.l=n+e,{t:a}}catch{return r.l=n+e,{t:a}}}function kI(r,e){var t=Ed(r);r.l+=16;var n=wk(r,e-24);return[t,n]}function II(r){var e=Ue(24),t=en(r[0]);e.write_shift(2,t.r),e.write_shift(2,t.r),e.write_shift(2,t.c),e.write_shift(2,t.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)e.write_shift(1,parseInt(n[a],16));return qn([e,_k(r[1])])}function CI(r,e){r.read_shift(2);var t=Ed(r),n=r.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Ca,""),[t,n]}function PI(r){var e=r[1].Tooltip,t=Ue(10+2*(e.length+1));t.write_shift(2,2048);var n=en(r[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var a=0;a<e.length;++a)t.write_shift(2,e.charCodeAt(a));return t.write_shift(2,0),t}function FI(r){var e=[0,0],t;return t=r.read_shift(2),e[0]=N2[t]||t,t=r.read_shift(2),e[1]=N2[t]||t,e}function RI(r){return r||(r=Ue(4)),r.write_shift(2,1),r.write_shift(2,1),r}function DI(r){for(var e=r.read_shift(2),t=[];e-- >0;)t.push(v_(r));return t}function LI(r){for(var e=r.read_shift(2),t=[];e-- >0;)t.push(v_(r));return t}function jI(r){r.l+=2;var e={cxfs:0,crc:0};return e.cxfs=r.read_shift(2),e.crc=r.read_shift(4),e}function S_(r,e,t){if(!t.cellStyles)return ga(r,e);var n=t&&t.biff>=12?4:2,a=r.read_shift(n),s=r.read_shift(n),i=r.read_shift(n),o=r.read_shift(n),c=r.read_shift(2);n==2&&(r.l+=2);var l={s:a,e:s,w:i,ixfe:o,flags:c};return(t.biff>=5||!t.biff)&&(l.level=c>>8&7),l}function OI(r,e){var t=Ue(12);t.write_shift(2,e),t.write_shift(2,e),t.write_shift(2,r.width*256),t.write_shift(2,0);var n=0;return r.hidden&&(n|=1),t.write_shift(1,n),n=r.level||0,t.write_shift(1,n),t.write_shift(2,0),t}function MI(r,e){var t={};return e<32||(r.l+=16,t.header=da(r),t.footer=da(r),r.l+=2),t}function BI(r,e,t){var n={area:!1};if(t.biff!=5)return r.l+=e,n;var a=r.read_shift(1);return r.l+=3,a&16&&(n.area=!0),n}function VI(r){for(var e=Ue(2*r),t=0;t<r;++t)e.write_shift(2,t+1);return e}var UI=yi,qI=m_,zI=s0;function WI(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(4),a={fmt:e,env:t,len:n,data:r.slice(r.l,r.l+n)};return r.l+=n,a}function HI(r,e,t){t.biffguess&&t.biff==5&&(t.biff=2);var n=yi(r);++r.l;var a=il(r,e-7,t);return n.t="str",n.val=a,n}function GI(r){var e=yi(r);++r.l;var t=da(r);return e.t="n",e.val=t,e}function $I(r,e,t){var n=Ue(15);return l0(n,r,e),n.write_shift(8,t,"f"),n}function KI(r){var e=yi(r);++r.l;var t=r.read_shift(2);return e.t="n",e.val=t,e}function XI(r,e,t){var n=Ue(9);return l0(n,r,e),n.write_shift(2,t),n}function YI(r){var e=r.read_shift(1);return e===0?(r.l++,""):r.read_shift(e,"sbcs-cont")}function JI(r,e){r.l+=6,r.l+=2,r.l+=1,r.l+=3,r.l+=1,r.l+=e-13}function QI(r,e,t){var n=r.l+e,a=yi(r),s=r.read_shift(2),i=Kc(r,s,t);return r.l=n,a.t="str",a.val=i,a}var ZI=[2,3,48,49,131,139,140,245],lp=function(){var r={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=wd({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(o,c){var l=[],u=zo(1);switch(c.type){case"base64":u=rs(cs(o));break;case"binary":u=rs(o);break;case"buffer":case"array":u=o;break}Qn(u,0);var d=u.read_shift(1),g=!!(d&136),p=!1,y=!1;switch(d){case 2:break;case 3:break;case 48:p=!0,g=!0;break;case 49:p=!0,g=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var v=0,w=521;d==2&&(v=u.read_shift(2)),u.l+=3,d!=2&&(v=u.read_shift(4)),v>1048576&&(v=1e6),d!=2&&(w=u.read_shift(2));var E=u.read_shift(2),R=c.codepage||1252;d!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(R=r[u[u.l]]),u.l+=1,u.l+=2),y&&(u.l+=36);for(var P=[],q={},z=Math.min(u.length,d==2?521:w-10-(p?264:0)),K=y?32:11;u.l<z&&u[u.l]!=13;)switch(q={},q.name=Po.utils.decode(R,u.slice(u.l,u.l+K)).replace(/[\u0000\r\n].*$/g,""),u.l+=K,q.type=String.fromCharCode(u.read_shift(1)),d!=2&&!y&&(q.offset=u.read_shift(4)),q.len=u.read_shift(1),d==2&&(q.offset=u.read_shift(2)),q.dec=u.read_shift(1),q.name.length&&P.push(q),d!=2&&(u.l+=y?13:14),q.type){case"B":(!p||q.len!=8)&&c.WTF&&console.log("Skipping "+q.name+":"+q.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+q.name+":"+q.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+q.type)}if(u[u.l]!==13&&(u.l=w-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=w;var I=0,N=0;for(l[0]=[],N=0;N!=P.length;++N)l[0][N]=P[N].name;for(;v-- >0;){if(u[u.l]===42){u.l+=E;continue}for(++u.l,l[++I]=[],N=0,N=0;N!=P.length;++N){var F=u.slice(u.l,u.l+P[N].len);u.l+=P[N].len,Qn(F,0);var j=Po.utils.decode(R,F);switch(P[N].type){case"C":j.trim().length&&(l[I][N]=j.replace(/\s+$/,""));break;case"D":j.length===8?l[I][N]=new Date(+j.slice(0,4),+j.slice(4,6)-1,+j.slice(6,8)):l[I][N]=j;break;case"F":l[I][N]=parseFloat(j.trim());break;case"+":case"I":l[I][N]=y?F.read_shift(-4,"i")^2147483648:F.read_shift(4,"i");break;case"L":switch(j.trim().toUpperCase()){case"Y":case"T":l[I][N]=!0;break;case"N":case"F":l[I][N]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+j+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));l[I][N]="##MEMO##"+(y?parseInt(j.trim(),10):F.read_shift(4));break;case"N":j=j.replace(/\u0000/g,"").trim(),j&&j!="."&&(l[I][N]=+j||0);break;case"@":l[I][N]=new Date(F.read_shift(-8,"f")-621356832e5);break;case"T":l[I][N]=new Date((F.read_shift(4)-2440588)*864e5+F.read_shift(4));break;case"Y":l[I][N]=F.read_shift(4,"i")/1e4+F.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":l[I][N]=-F.read_shift(-8,"f");break;case"B":if(p&&P[N].len==8){l[I][N]=F.read_shift(8,"f");break}case"G":case"P":F.l+=P[N].len;break;case"0":if(P[N].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+P[N].type)}}}if(d!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return c&&c.sheetRows&&(l=l.slice(0,c.sheetRows)),c.DBF=P,l}function n(o,c){var l=c||{};l.dateNF||(l.dateNF="yyyymmdd");var u=Eu(t(o,l),l);return u["!cols"]=l.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete l.DBF,u}function a(o,c){try{return Qo(n(o,c),c)}catch(l){if(c&&c.WTF)throw l}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,c){var l=c||{};if(+l.codepage>=0&&Hs(+l.codepage),l.type=="string")throw new Error("Cannot write DBF to JS string");var u=qa(),d=Gf(o,{header:1,raw:!0,cellDates:!0}),g=d[0],p=d.slice(1),y=o["!cols"]||[],v=0,w=0,E=0,R=1;for(v=0;v<g.length;++v){if(((y[v]||{}).DBF||{}).name){g[v]=y[v].DBF.name,++E;continue}if(g[v]!=null){if(++E,typeof g[v]=="number"&&(g[v]=g[v].toString(10)),typeof g[v]!="string")throw new Error("DBF Invalid column name "+g[v]+" |"+typeof g[v]+"|");if(g.indexOf(g[v])!==v){for(w=0;w<1024;++w)if(g.indexOf(g[v]+"_"+w)==-1){g[v]+="_"+w;break}}}}var P=pr(o["!ref"]),q=[],z=[],K=[];for(v=0;v<=P.e.c-P.s.c;++v){var I="",N="",F=0,j=[];for(w=0;w<p.length;++w)p[w][v]!=null&&j.push(p[w][v]);if(j.length==0||g[v]==null){q[v]="?";continue}for(w=0;w<j.length;++w){switch(typeof j[w]){case"number":N="B";break;case"string":N="C";break;case"boolean":N="L";break;case"object":N=j[w]instanceof Date?"D":"C";break;default:N="C"}F=Math.max(F,String(j[w]).length),I=I&&I!=N?"C":N}F>250&&(F=250),N=((y[v]||{}).DBF||{}).type,N=="C"&&y[v].DBF.len>F&&(F=y[v].DBF.len),I=="B"&&N=="N"&&(I="N",K[v]=y[v].DBF.dec,F=y[v].DBF.len),z[v]=I=="C"||N=="N"?F:s[I]||0,R+=z[v],q[v]=I}var S=u.next(32);for(S.write_shift(4,318902576),S.write_shift(4,p.length),S.write_shift(2,296+32*E),S.write_shift(2,R),v=0;v<4;++v)S.write_shift(4,0);for(S.write_shift(4,0|(+e[dw]||3)<<8),v=0,w=0;v<g.length;++v)if(g[v]!=null){var A=u.next(32),C=(g[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);A.write_shift(1,C,"sbcs"),A.write_shift(1,q[v]=="?"?"C":q[v],"sbcs"),A.write_shift(4,w),A.write_shift(1,z[v]||s[q[v]]||0),A.write_shift(1,K[v]||0),A.write_shift(1,2),A.write_shift(4,0),A.write_shift(1,0),A.write_shift(4,0),A.write_shift(4,0),w+=z[v]||s[q[v]]||0}var J=u.next(264);for(J.write_shift(4,13),v=0;v<65;++v)J.write_shift(4,0);for(v=0;v<p.length;++v){var ue=u.next(R);for(ue.write_shift(1,0),w=0;w<g.length;++w)if(g[w]!=null)switch(q[w]){case"L":ue.write_shift(1,p[v][w]==null?63:p[v][w]?84:70);break;case"B":ue.write_shift(8,p[v][w]||0,"f");break;case"N":var me="0";for(typeof p[v][w]=="number"&&(me=p[v][w].toFixed(K[w]||0)),E=0;E<z[w]-me.length;++E)ue.write_shift(1,32);ue.write_shift(1,me,"sbcs");break;case"D":p[v][w]?(ue.write_shift(4,("0000"+p[v][w].getFullYear()).slice(-4),"sbcs"),ue.write_shift(2,("00"+(p[v][w].getMonth()+1)).slice(-2),"sbcs"),ue.write_shift(2,("00"+p[v][w].getDate()).slice(-2),"sbcs")):ue.write_shift(8,"00000000","sbcs");break;case"C":var pe=String(p[v][w]!=null?p[v][w]:"").slice(0,z[w]);for(ue.write_shift(1,pe,"sbcs"),E=0;E<z[w]-pe.length;++E)ue.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:a,to_sheet:n,from_sheet:i}}(),A_=function(){var r={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+fn(r).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(g,p){var y=r[p];return typeof y=="number"?Zx(y):y},n=function(g,p,y){var v=p.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return v==59?g:Zx(v)};r["|"]=254;function a(g,p){switch(p.type){case"base64":return s(cs(g),p);case"binary":return s(g,p);case"buffer":return s(Zt&&Buffer.isBuffer(g)?g.toString("binary"):Jo(g),p);case"array":return s(Gc(g),p)}throw new Error("Unrecognized type "+p.type)}function s(g,p){var y=g.split(/[\n\r]+/),v=-1,w=-1,E=0,R=0,P=[],q=[],z=null,K={},I=[],N=[],F=[],j=0,S;for(+p.codepage>=0&&Hs(+p.codepage);E!==y.length;++E){j=0;var A=y[E].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,t),C=A.replace(/;;/g,"\0").split(";").map(function(U){return U.replace(/\u0000/g,";")}),J=C[0],ue;if(A.length>0)switch(J){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":C[1].charAt(0)=="P"&&q.push(A.slice(3).replace(/;;/g,";"));break;case"C":var me=!1,pe=!1,ge=!1,ne=!1,we=-1,Oe=-1;for(R=1;R<C.length;++R)switch(C[R].charAt(0)){case"A":break;case"X":w=parseInt(C[R].slice(1))-1,pe=!0;break;case"Y":for(v=parseInt(C[R].slice(1))-1,pe||(w=0),S=P.length;S<=v;++S)P[S]=[];break;case"K":ue=C[R].slice(1),ue.charAt(0)==='"'?ue=ue.slice(1,ue.length-1):ue==="TRUE"?ue=!0:ue==="FALSE"?ue=!1:isNaN($s(ue))?isNaN(du(ue).getDate())||(ue=Gr(ue)):(ue=$s(ue),z!==null&&_u(z)&&(ue=bd(ue))),me=!0;break;case"E":ne=!0;var k=Ql(C[R].slice(1),{r:v,c:w});P[v][w]=[P[v][w],k];break;case"S":ge=!0,P[v][w]=[P[v][w],"S5S"];break;case"G":break;case"R":we=parseInt(C[R].slice(1))-1;break;case"C":Oe=parseInt(C[R].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+A)}if(me&&(P[v][w]&&P[v][w].length==2?P[v][w][0]=ue:P[v][w]=ue,z=null),ge){if(ne)throw new Error("SYLK shared formula cannot have own formula");var O=we>-1&&P[we][Oe];if(!O||!O[1])throw new Error("SYLK shared formula cannot find base");P[v][w][1]=z_(O[1],{r:v-we,c:w-Oe})}break;case"F":var M=0;for(R=1;R<C.length;++R)switch(C[R].charAt(0)){case"X":w=parseInt(C[R].slice(1))-1,++M;break;case"Y":for(v=parseInt(C[R].slice(1))-1,S=P.length;S<=v;++S)P[S]=[];break;case"M":j=parseInt(C[R].slice(1))/20;break;case"F":break;case"G":break;case"P":z=q[parseInt(C[R].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(F=C[R].slice(1).split(" "),S=parseInt(F[0],10);S<=parseInt(F[1],10);++S)j=parseInt(F[2],10),N[S-1]=j===0?{hidden:!0}:{wch:j},Wo(N[S-1]);break;case"C":w=parseInt(C[R].slice(1))-1,N[w]||(N[w]={});break;case"R":v=parseInt(C[R].slice(1))-1,I[v]||(I[v]={}),j>0?(I[v].hpt=j,I[v].hpx=pu(j)):j===0&&(I[v].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+A)}M<1&&(z=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+A)}}return I.length>0&&(K["!rows"]=I),N.length>0&&(K["!cols"]=N),p&&p.sheetRows&&(P=P.slice(0,p.sheetRows)),[P,K]}function i(g,p){var y=a(g,p),v=y[0],w=y[1],E=Eu(v,p);return fn(w).forEach(function(R){E[R]=w[R]}),E}function o(g,p){return Qo(i(g,p),p)}function c(g,p,y,v){var w="C;Y"+(y+1)+";X"+(v+1)+";K";switch(g.t){case"n":w+=g.v||0,g.f&&!g.F&&(w+=";E"+q1(g.f,{r:y,c:v}));break;case"b":w+=g.v?"TRUE":"FALSE";break;case"e":w+=g.w||g.v;break;case"d":w+='"'+(g.w||g.v)+'"';break;case"s":w+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function l(g,p){p.forEach(function(y,v){var w="F;W"+(v+1)+" "+(v+1)+" ";y.hidden?w+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=Mh(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=Bh(y.wpx)),typeof y.wch=="number"&&(w+=Math.round(y.wch))),w.charAt(w.length-1)!=" "&&g.push(w)})}function u(g,p){p.forEach(function(y,v){var w="F;";y.hidden?w+="M0;":y.hpt?w+="M"+20*y.hpt+";":y.hpx&&(w+="M"+20*Vh(y.hpx)+";"),w.length>2&&g.push(w+"R"+(v+1))})}function d(g,p){var y=["ID;PWXL;N;E"],v=[],w=pr(g["!ref"]),E,R=Array.isArray(g),P=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),g["!cols"]&&l(y,g["!cols"]),g["!rows"]&&u(y,g["!rows"]),y.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var q=w.s.r;q<=w.e.r;++q)for(var z=w.s.c;z<=w.e.c;++z){var K=qt({r:q,c:z});E=R?(g[q]||[])[z]:g[K],!(!E||E.v==null&&(!E.f||E.F))&&v.push(c(E,g,q,z))}return y.join(P)+P+v.join(P)+P+"E"+P}return{to_workbook:o,to_sheet:i,from_sheet:d}}(),N_=function(){function r(s,i){switch(i.type){case"base64":return e(cs(s),i);case"binary":return e(s,i);case"buffer":return e(Zt&&Buffer.isBuffer(s)?s.toString("binary"):Jo(s),i);case"array":return e(Gc(s),i)}throw new Error("Unrecognized type "+i.type)}function e(s,i){for(var o=s.split(`
`),c=-1,l=-1,u=0,d=[];u!==o.length;++u){if(o[u].trim()==="BOT"){d[++c]=[],l=0;continue}if(!(c<0)){var g=o[u].trim().split(","),p=g[0],y=g[1];++u;for(var v=o[u]||"";(v.match(/["]/g)||[]).length&1&&u<o.length-1;)v+=`
`+o[++u];switch(v=v.trim(),+p){case-1:if(v==="BOT"){d[++c]=[],l=0;continue}else if(v!=="EOD")throw new Error("Unrecognized DIF special command "+v);break;case 0:v==="TRUE"?d[c][l]=!0:v==="FALSE"?d[c][l]=!1:isNaN($s(y))?isNaN(du(y).getDate())?d[c][l]=y:d[c][l]=Gr(y):d[c][l]=$s(y),++l;break;case 1:v=v.slice(1,v.length-1),v=v.replace(/""/g,'"'),v&&v.match(/^=".*"$/)&&(v=v.slice(2,-1)),d[c][l++]=v!==""?v:null;break}if(v==="EOD")break}}return i&&i.sheetRows&&(d=d.slice(0,i.sheetRows)),d}function t(s,i){return Eu(r(s,i),i)}function n(s,i){return Qo(t(s,i),i)}var a=function(){var s=function(c,l,u,d,g){c.push(l),c.push(u+","+d),c.push('"'+g.replace(/"/g,'""')+'"')},i=function(c,l,u,d){c.push(l+","+u),c.push(l==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(c){var l=[],u=pr(c["!ref"]),d,g=Array.isArray(c);s(l,"TABLE",0,1,"sheetjs"),s(l,"VECTORS",0,u.e.r-u.s.r+1,""),s(l,"TUPLES",0,u.e.c-u.s.c+1,""),s(l,"DATA",0,0,"");for(var p=u.s.r;p<=u.e.r;++p){i(l,-1,0,"BOT");for(var y=u.s.c;y<=u.e.c;++y){var v=qt({r:p,c:y});if(d=g?(c[p]||[])[y]:c[v],!d){i(l,1,0,"");continue}switch(d.t){case"n":var w=d.w;!w&&d.v!=null&&(w=d.v),w==null?d.f&&!d.F?i(l,1,0,"="+d.f):i(l,1,0,""):i(l,0,w,"V");break;case"b":i(l,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":i(l,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=ks(d.z||Mt[14],Rn(Gr(d.v)))),i(l,0,d.w,"V");break;default:i(l,1,0,"")}}}i(l,-1,0,"EOD");var E=`\r
`,R=l.join(E);return R}}();return{to_workbook:n,to_sheet:t,from_sheet:a}}(),T_=function(){function r(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(d,g){for(var p=d.split(`
`),y=-1,v=-1,w=0,E=[];w!==p.length;++w){var R=p[w].trim().split(":");if(R[0]==="cell"){var P=en(R[1]);if(E.length<=P.r)for(y=E.length;y<=P.r;++y)E[y]||(E[y]=[]);switch(y=P.r,v=P.c,R[2]){case"t":E[y][v]=r(R[3]);break;case"v":E[y][v]=+R[3];break;case"vtf":var q=R[R.length-1];case"vtc":switch(R[3]){case"nl":E[y][v]=!!+R[4];break;default:E[y][v]=+R[4];break}R[2]=="vtf"&&(E[y][v]=[E[y][v],q])}}}return g&&g.sheetRows&&(E=E.slice(0,g.sheetRows)),E}function n(d,g){return Eu(t(d,g),g)}function a(d,g){return Qo(n(d,g),g)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function l(d){if(!d||!d["!ref"])return"";for(var g=[],p=[],y,v="",w=za(d["!ref"]),E=Array.isArray(d),R=w.s.r;R<=w.e.r;++R)for(var P=w.s.c;P<=w.e.c;++P)if(v=qt({r:R,c:P}),y=E?(d[R]||[])[P]:d[v],!(!y||y.v==null||y.t==="z")){switch(p=["cell",v,"t"],y.t){case"s":case"str":p.push(e(y.v));break;case"n":y.f?(p[2]="vtf",p[3]="n",p[4]=y.v,p[5]=e(y.f)):(p[2]="v",p[3]=y.v);break;case"b":p[2]="vt"+(y.f?"f":"c"),p[3]="nl",p[4]=y.v?"1":"0",p[5]=e(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var q=Rn(Gr(y.v));p[2]="vtc",p[3]="nd",p[4]=""+q,p[5]=y.w||ks(y.z||Mt[14],q);break;case"e":continue}g.push(p.join(":"))}return g.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function u(d){return[s,i,o,i,l(d),c].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:u}}(),mu=function(){function r(u,d,g,p,y){y.raw?d[g][p]=u:u===""||(u==="TRUE"?d[g][p]=!0:u==="FALSE"?d[g][p]=!1:isNaN($s(u))?isNaN(du(u).getDate())?d[g][p]=u:d[g][p]=Gr(u):d[g][p]=$s(u))}function e(u,d){var g=d||{},p=[];if(!u||u.length===0)return p;for(var y=u.split(/[\r\n]/),v=y.length-1;v>=0&&y[v].length===0;)--v;for(var w=10,E=0,R=0;R<=v;++R)E=y[R].indexOf(" "),E==-1?E=y[R].length:E++,w=Math.max(w,E);for(R=0;R<=v;++R){p[R]=[];var P=0;for(r(y[R].slice(0,w).trim(),p,R,P,g),P=1;P<=(y[R].length-w)/10+1;++P)r(y[R].slice(w+(P-1)*10,w+P*10).trim(),p,R,P,g)}return g.sheetRows&&(p=p.slice(0,g.sheetRows)),p}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(u){for(var d={},g=!1,p=0,y=0;p<u.length;++p)(y=u.charCodeAt(p))==34?g=!g:!g&&y in t&&(d[y]=(d[y]||0)+1);y=[];for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&y.push([d[p],p]);if(!y.length){d=n;for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&y.push([d[p],p])}return y.sort(function(v,w){return v[0]-w[0]||n[v[1]]-n[w[1]]}),t[y.pop()[1]]||44}function s(u,d){var g=d||{},p="",y=g.dense?[]:{},v={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(p=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(p=u.charAt(4),u=u.slice(6)):p=a(u.slice(0,1024)):g&&g.FS?p=g.FS:p=a(u.slice(0,1024));var w=0,E=0,R=0,P=0,q=0,z=p.charCodeAt(0),K=!1,I=0,N=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var F=g.dateNF!=null?BT(g.dateNF):null;function j(){var S=u.slice(P,q),A={};if(S.charAt(0)=='"'&&S.charAt(S.length-1)=='"'&&(S=S.slice(1,-1).replace(/""/g,'"')),S.length===0)A.t="z";else if(g.raw)A.t="s",A.v=S;else if(S.trim().length===0)A.t="s",A.v=S;else if(S.charCodeAt(0)==61)S.charCodeAt(1)==34&&S.charCodeAt(S.length-1)==34?(A.t="s",A.v=S.slice(2,-1).replace(/""/g,'"')):mP(S)?(A.t="n",A.f=S.slice(1)):(A.t="s",A.v=S);else if(S=="TRUE")A.t="b",A.v=!0;else if(S=="FALSE")A.t="b",A.v=!1;else if(!isNaN(R=$s(S)))A.t="n",g.cellText!==!1&&(A.w=S),A.v=R;else if(!isNaN(du(S).getDate())||F&&S.match(F)){A.z=g.dateNF||Mt[14];var C=0;F&&S.match(F)&&(S=VT(S,g.dateNF,S.match(F)||[]),C=1),g.cellDates?(A.t="d",A.v=Gr(S,C)):(A.t="n",A.v=Rn(Gr(S,C))),g.cellText!==!1&&(A.w=ks(A.z,A.v instanceof Date?Rn(A.v):A.v)),g.cellNF||delete A.z}else A.t="s",A.v=S;if(A.t=="z"||(g.dense?(y[w]||(y[w]=[]),y[w][E]=A):y[qt({c:E,r:w})]=A),P=q+1,N=u.charCodeAt(P),v.e.c<E&&(v.e.c=E),v.e.r<w&&(v.e.r=w),I==z)++E;else if(E=0,++w,g.sheetRows&&g.sheetRows<=w)return!0}e:for(;q<u.length;++q)switch(I=u.charCodeAt(q)){case 34:N===34&&(K=!K);break;case z:case 10:case 13:if(!K&&j())break e;break}return q-P>0&&j(),y["!ref"]=Jt(v),y}function i(u,d){return!(d&&d.PRN)||d.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,d):Eu(e(u,d),d)}function o(u,d){var g="",p=d.type=="string"?[0,0,0,0]:Y1(u,d);switch(d.type){case"base64":g=cs(u);break;case"binary":g=u;break;case"buffer":d.codepage==65001?g=u.toString("utf8"):d.codepage&&typeof Po<"u"?g=Po.utils.decode(d.codepage,u):g=Zt&&Buffer.isBuffer(u)?u.toString("binary"):Jo(u);break;case"array":g=Gc(u);break;case"string":g=u;break;default:throw new Error("Unrecognized type "+d.type)}return p[0]==239&&p[1]==187&&p[2]==191?g=Lr(g.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?g=Lr(g):d.type=="binary"&&typeof Po<"u"&&d.codepage&&(g=Po.utils.decode(d.codepage,Po.utils.encode(28591,g))),g.slice(0,19)=="socialcalc:version:"?T_.to_sheet(d.type=="string"?g:Lr(g),d):i(g,d)}function c(u,d){return Qo(o(u,d),d)}function l(u){for(var d=[],g=pr(u["!ref"]),p,y=Array.isArray(u),v=g.s.r;v<=g.e.r;++v){for(var w=[],E=g.s.c;E<=g.e.c;++E){var R=qt({r:v,c:E});if(p=y?(u[v]||[])[E]:u[R],!p||p.v==null){w.push("          ");continue}for(var P=(p.w||(Hi(p),p.w)||"").slice(0,10);P.length<10;)P+=" ";w.push(P+(E===0?" ":""))}d.push(w.join(""))}return d.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:l}}();function eC(r,e){var t=e||{},n=!!t.WTF;t.WTF=!0;try{var a=A_.to_workbook(r,t);return t.WTF=n,a}catch(s){if(t.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return mu.to_workbook(r,e)}}var Rc=function(){function r(k,O,M){if(k){Qn(k,k.l||0);for(var U=M.Enum||we;k.l<k.length;){var ee=k.read_shift(2),he=U[ee]||U[65535],de=k.read_shift(2),fe=k.l+de,be=he.f&&he.f(k,de,M);if(k.l=fe,O(be,he,ee))return}}}function e(k,O){switch(O.type){case"base64":return t(rs(cs(k)),O);case"binary":return t(rs(k),O);case"buffer":case"array":return t(k,O)}throw"Unsupported type "+O.type}function t(k,O){if(!k)return k;var M=O||{},U=M.dense?[]:{},ee="Sheet1",he="",de=0,fe={},be=[],Me=[],Z={s:{r:0,c:0},e:{r:0,c:0}},Xe=M.sheetRows||0;if(k[2]==0&&(k[3]==8||k[3]==9)&&k.length>=16&&k[14]==5&&k[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(k[2]==2)M.Enum=we,r(k,function(qe,lt,$e){switch($e){case 0:M.vers=qe,qe>=4096&&(M.qpro=!0);break;case 6:Z=qe;break;case 204:qe&&(he=qe);break;case 222:he=qe;break;case 15:case 51:M.qpro||(qe[1].v=qe[1].v.slice(1));case 13:case 14:case 16:$e==14&&(qe[2]&112)==112&&(qe[2]&15)>1&&(qe[2]&15)<15&&(qe[1].z=M.dateNF||Mt[14],M.cellDates&&(qe[1].t="d",qe[1].v=bd(qe[1].v))),M.qpro&&qe[3]>de&&(U["!ref"]=Jt(Z),fe[ee]=U,be.push(ee),U=M.dense?[]:{},Z={s:{r:0,c:0},e:{r:0,c:0}},de=qe[3],ee=he||"Sheet"+(de+1),he="");var rt=M.dense?(U[qe[0].r]||[])[qe[0].c]:U[qt(qe[0])];if(rt){rt.t=qe[1].t,rt.v=qe[1].v,qe[1].z!=null&&(rt.z=qe[1].z),qe[1].f!=null&&(rt.f=qe[1].f);break}M.dense?(U[qe[0].r]||(U[qe[0].r]=[]),U[qe[0].r][qe[0].c]=qe[1]):U[qt(qe[0])]=qe[1];break}},M);else if(k[2]==26||k[2]==14)M.Enum=Oe,k[2]==14&&(M.qpro=!0,k.l=0),r(k,function(qe,lt,$e){switch($e){case 204:ee=qe;break;case 22:qe[1].v=qe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(qe[3]>de&&(U["!ref"]=Jt(Z),fe[ee]=U,be.push(ee),U=M.dense?[]:{},Z={s:{r:0,c:0},e:{r:0,c:0}},de=qe[3],ee="Sheet"+(de+1)),Xe>0&&qe[0].r>=Xe)break;M.dense?(U[qe[0].r]||(U[qe[0].r]=[]),U[qe[0].r][qe[0].c]=qe[1]):U[qt(qe[0])]=qe[1],Z.e.c<qe[0].c&&(Z.e.c=qe[0].c),Z.e.r<qe[0].r&&(Z.e.r=qe[0].r);break;case 27:qe[14e3]&&(Me[qe[14e3][0]]=qe[14e3][1]);break;case 1537:Me[qe[0]]=qe[1],qe[0]==de&&(ee=qe[1]);break}},M);else throw new Error("Unrecognized LOTUS BOF "+k[2]);if(U["!ref"]=Jt(Z),fe[he||ee]=U,be.push(he||ee),!Me.length)return{SheetNames:be,Sheets:fe};for(var st={},Fe=[],se=0;se<Me.length;++se)fe[be[se]]?(Fe.push(Me[se]||be[se]),st[Me[se]]=fe[Me[se]]||fe[be[se]]):(Fe.push(Me[se]),st[Me[se]]={"!ref":"A1"});return{SheetNames:Fe,Sheets:st}}function n(k,O){var M=O||{};if(+M.codepage>=0&&Hs(+M.codepage),M.type=="string")throw new Error("Cannot write WK1 to JS string");var U=qa(),ee=pr(k["!ref"]),he=Array.isArray(k),de=[];ut(U,0,s(1030)),ut(U,6,c(ee));for(var fe=Math.min(ee.e.r,8191),be=ee.s.r;be<=fe;++be)for(var Me=yn(be),Z=ee.s.c;Z<=ee.e.c;++Z){be===ee.s.r&&(de[Z]=Zr(Z));var Xe=de[Z]+Me,st=he?(k[be]||[])[Z]:k[Xe];if(!(!st||st.t=="z"))if(st.t=="n")(st.v|0)==st.v&&st.v>=-32768&&st.v<=32767?ut(U,13,p(be,Z,st.v)):ut(U,14,v(be,Z,st.v));else{var Fe=Hi(st);ut(U,15,d(be,Z,Fe.slice(0,239)))}}return ut(U,1),U.end()}function a(k,O){var M=O||{};if(+M.codepage>=0&&Hs(+M.codepage),M.type=="string")throw new Error("Cannot write WK3 to JS string");var U=qa();ut(U,0,i(k));for(var ee=0,he=0;ee<k.SheetNames.length;++ee)(k.Sheets[k.SheetNames[ee]]||{})["!ref"]&&ut(U,27,ne(k.SheetNames[ee],he++));var de=0;for(ee=0;ee<k.SheetNames.length;++ee){var fe=k.Sheets[k.SheetNames[ee]];if(!(!fe||!fe["!ref"])){for(var be=pr(fe["!ref"]),Me=Array.isArray(fe),Z=[],Xe=Math.min(be.e.r,8191),st=be.s.r;st<=Xe;++st)for(var Fe=yn(st),se=be.s.c;se<=be.e.c;++se){st===be.s.r&&(Z[se]=Zr(se));var qe=Z[se]+Fe,lt=Me?(fe[st]||[])[se]:fe[qe];if(!(!lt||lt.t=="z"))if(lt.t=="n")ut(U,23,j(st,se,de,lt.v));else{var $e=Hi(lt);ut(U,22,I(st,se,de,$e.slice(0,239)))}}++de}}return ut(U,1),U.end()}function s(k){var O=Ue(2);return O.write_shift(2,k),O}function i(k){var O=Ue(26);O.write_shift(2,4096),O.write_shift(2,4),O.write_shift(4,0);for(var M=0,U=0,ee=0,he=0;he<k.SheetNames.length;++he){var de=k.SheetNames[he],fe=k.Sheets[de];if(!(!fe||!fe["!ref"])){++ee;var be=za(fe["!ref"]);M<be.e.r&&(M=be.e.r),U<be.e.c&&(U=be.e.c)}}return M>8191&&(M=8191),O.write_shift(2,M),O.write_shift(1,ee),O.write_shift(1,U),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(1,1),O.write_shift(1,2),O.write_shift(4,0),O.write_shift(4,0),O}function o(k,O,M){var U={s:{c:0,r:0},e:{c:0,r:0}};return O==8&&M.qpro?(U.s.c=k.read_shift(1),k.l++,U.s.r=k.read_shift(2),U.e.c=k.read_shift(1),k.l++,U.e.r=k.read_shift(2),U):(U.s.c=k.read_shift(2),U.s.r=k.read_shift(2),O==12&&M.qpro&&(k.l+=2),U.e.c=k.read_shift(2),U.e.r=k.read_shift(2),O==12&&M.qpro&&(k.l+=2),U.s.c==65535&&(U.s.c=U.e.c=U.s.r=U.e.r=0),U)}function c(k){var O=Ue(8);return O.write_shift(2,k.s.c),O.write_shift(2,k.s.r),O.write_shift(2,k.e.c),O.write_shift(2,k.e.r),O}function l(k,O,M){var U=[{c:0,r:0},{t:"n",v:0},0,0];return M.qpro&&M.vers!=20768?(U[0].c=k.read_shift(1),U[3]=k.read_shift(1),U[0].r=k.read_shift(2),k.l+=2):(U[2]=k.read_shift(1),U[0].c=k.read_shift(2),U[0].r=k.read_shift(2)),U}function u(k,O,M){var U=k.l+O,ee=l(k,O,M);if(ee[1].t="s",M.vers==20768){k.l++;var he=k.read_shift(1);return ee[1].v=k.read_shift(he,"utf8"),ee}return M.qpro&&k.l++,ee[1].v=k.read_shift(U-k.l,"cstr"),ee}function d(k,O,M){var U=Ue(7+M.length);U.write_shift(1,255),U.write_shift(2,O),U.write_shift(2,k),U.write_shift(1,39);for(var ee=0;ee<U.length;++ee){var he=M.charCodeAt(ee);U.write_shift(1,he>=128?95:he)}return U.write_shift(1,0),U}function g(k,O,M){var U=l(k,O,M);return U[1].v=k.read_shift(2,"i"),U}function p(k,O,M){var U=Ue(7);return U.write_shift(1,255),U.write_shift(2,O),U.write_shift(2,k),U.write_shift(2,M,"i"),U}function y(k,O,M){var U=l(k,O,M);return U[1].v=k.read_shift(8,"f"),U}function v(k,O,M){var U=Ue(13);return U.write_shift(1,255),U.write_shift(2,O),U.write_shift(2,k),U.write_shift(8,M,"f"),U}function w(k,O,M){var U=k.l+O,ee=l(k,O,M);if(ee[1].v=k.read_shift(8,"f"),M.qpro)k.l=U;else{var he=k.read_shift(2);q(k.slice(k.l,k.l+he),ee),k.l+=he}return ee}function E(k,O,M){var U=O&32768;return O&=-32769,O=(U?k:0)+(O>=8192?O-16384:O),(U?"":"$")+(M?Zr(O):yn(O))}var R={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},P=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function q(k,O){Qn(k,0);for(var M=[],U=0,ee="",he="",de="",fe="";k.l<k.length;){var be=k[k.l++];switch(be){case 0:M.push(k.read_shift(8,"f"));break;case 1:he=E(O[0].c,k.read_shift(2),!0),ee=E(O[0].r,k.read_shift(2),!1),M.push(he+ee);break;case 2:{var Me=E(O[0].c,k.read_shift(2),!0),Z=E(O[0].r,k.read_shift(2),!1);he=E(O[0].c,k.read_shift(2),!0),ee=E(O[0].r,k.read_shift(2),!1),M.push(Me+Z+":"+he+ee)}break;case 3:if(k.l<k.length){console.error("WK1 premature formula end");return}break;case 4:M.push("("+M.pop()+")");break;case 5:M.push(k.read_shift(2));break;case 6:{for(var Xe="";be=k[k.l++];)Xe+=String.fromCharCode(be);M.push('"'+Xe.replace(/"/g,'""')+'"')}break;case 8:M.push("-"+M.pop());break;case 23:M.push("+"+M.pop());break;case 22:M.push("NOT("+M.pop()+")");break;case 20:case 21:fe=M.pop(),de=M.pop(),M.push(["AND","OR"][be-20]+"("+de+","+fe+")");break;default:if(be<32&&P[be])fe=M.pop(),de=M.pop(),M.push(de+P[be]+fe);else if(R[be]){if(U=R[be][1],U==69&&(U=k[k.l++]),U>M.length){console.error("WK1 bad formula parse 0x"+be.toString(16)+":|"+M.join("|")+"|");return}var st=M.slice(-U);M.length-=U,M.push(R[be][0]+"("+st.join(",")+")")}else return be<=7?console.error("WK1 invalid opcode "+be.toString(16)):be<=24?console.error("WK1 unsupported op "+be.toString(16)):be<=30?console.error("WK1 invalid opcode "+be.toString(16)):be<=115?console.error("WK1 unsupported function opcode "+be.toString(16)):console.error("WK1 unrecognized opcode "+be.toString(16))}}M.length==1?O[1].f=""+M[0]:console.error("WK1 bad formula parse |"+M.join("|")+"|")}function z(k){var O=[{c:0,r:0},{t:"n",v:0},0];return O[0].r=k.read_shift(2),O[3]=k[k.l++],O[0].c=k[k.l++],O}function K(k,O){var M=z(k);return M[1].t="s",M[1].v=k.read_shift(O-4,"cstr"),M}function I(k,O,M,U){var ee=Ue(6+U.length);ee.write_shift(2,k),ee.write_shift(1,M),ee.write_shift(1,O),ee.write_shift(1,39);for(var he=0;he<U.length;++he){var de=U.charCodeAt(he);ee.write_shift(1,de>=128?95:de)}return ee.write_shift(1,0),ee}function N(k,O){var M=z(k);M[1].v=k.read_shift(2);var U=M[1].v>>1;if(M[1].v&1)switch(U&7){case 0:U=(U>>3)*5e3;break;case 1:U=(U>>3)*500;break;case 2:U=(U>>3)/20;break;case 3:U=(U>>3)/200;break;case 4:U=(U>>3)/2e3;break;case 5:U=(U>>3)/2e4;break;case 6:U=(U>>3)/16;break;case 7:U=(U>>3)/64;break}return M[1].v=U,M}function F(k,O){var M=z(k),U=k.read_shift(4),ee=k.read_shift(4),he=k.read_shift(2);if(he==65535)return U===0&&ee===3221225472?(M[1].t="e",M[1].v=15):U===0&&ee===3489660928?(M[1].t="e",M[1].v=42):M[1].v=0,M;var de=he&32768;return he=(he&32767)-16446,M[1].v=(1-de*2)*(ee*Math.pow(2,he+32)+U*Math.pow(2,he)),M}function j(k,O,M,U){var ee=Ue(14);if(ee.write_shift(2,k),ee.write_shift(1,M),ee.write_shift(1,O),U==0)return ee.write_shift(4,0),ee.write_shift(4,0),ee.write_shift(2,65535),ee;var he=0,de=0,fe=0,be=0;return U<0&&(he=1,U=-U),de=Math.log2(U)|0,U/=Math.pow(2,de-31),be=U>>>0,be&2147483648||(U/=2,++de,be=U>>>0),U-=be,be|=2147483648,be>>>=0,U*=Math.pow(2,32),fe=U>>>0,ee.write_shift(4,fe),ee.write_shift(4,be),de+=16383+(he?32768:0),ee.write_shift(2,de),ee}function S(k,O){var M=F(k);return k.l+=O-14,M}function A(k,O){var M=z(k),U=k.read_shift(4);return M[1].v=U>>6,M}function C(k,O){var M=z(k),U=k.read_shift(8,"f");return M[1].v=U,M}function J(k,O){var M=C(k);return k.l+=O-10,M}function ue(k,O){return k[k.l+O-1]==0?k.read_shift(O,"cstr"):""}function me(k,O){var M=k[k.l++];M>O-1&&(M=O-1);for(var U="";U.length<M;)U+=String.fromCharCode(k[k.l++]);return U}function pe(k,O,M){if(!(!M.qpro||O<21)){var U=k.read_shift(1);k.l+=17,k.l+=1,k.l+=2;var ee=k.read_shift(O-21,"cstr");return[U,ee]}}function ge(k,O){for(var M={},U=k.l+O;k.l<U;){var ee=k.read_shift(2);if(ee==14e3){for(M[ee]=[0,""],M[ee][0]=k.read_shift(2);k[k.l];)M[ee][1]+=String.fromCharCode(k[k.l]),k.l++;k.l++}}return M}function ne(k,O){var M=Ue(5+k.length);M.write_shift(2,14e3),M.write_shift(2,O);for(var U=0;U<k.length;++U){var ee=k.charCodeAt(U);M[M.l++]=ee>127?95:ee}return M[M.l++]=0,M}var we={0:{n:"BOF",f:Tn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:y},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ue},222:{n:"SHEETNAMELP",f:me},65535:{n:""}},Oe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:K},23:{n:"NUMBER17",f:F},24:{n:"NUMBER18",f:N},25:{n:"FORMULA19",f:S},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ge},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:A},38:{n:"??"},39:{n:"NUMBER27",f:C},40:{n:"FORMULA28",f:J},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ue},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:pe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:e}}();function tC(r){var e={},t=r.match(xa),n=0,a=!1;if(t)for(;n!=t.length;++n){var s=Wt(t[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=d1[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return e}var rC=function(){var r=Rh("t"),e=Rh("rPr");function t(s){var i=s.match(r);if(!i)return{t:"s",v:""};var o={t:"s",v:mr(i[1])},c=s.match(e);return c&&(o.s=tC(c[1])),o}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(a).map(t).filter(function(o){return o.v})}}(),nC=function(){var e=/(\r\n|\n)/g;function t(a,s,i){var o=[];a.u&&o.push("text-decoration: underline;"),a.uval&&o.push("text-underline-style:"+a.uval+";"),a.sz&&o.push("font-size:"+a.sz+"pt;"),a.outline&&o.push("text-effect: outline;"),a.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),a.b&&(s.push("<b>"),i.push("</b>")),a.i&&(s.push("<i>"),i.push("</i>")),a.strike&&(s.push("<s>"),i.push("</s>"));var c=a.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(s.push("<"+c+">"),i.push("</"+c+">")),i.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&t(a.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),aC=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,sC=/<(?:\w+:)?r>/,iC=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function O1(r,e){var t=e?e.cellHTML:!0,n={};return r?(r.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=mr(Lr(r.slice(r.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Lr(r),t&&(n.h=E1(n.t))):r.match(sC)&&(n.r=Lr(r),n.t=mr(Lr((r.replace(iC,"").match(aC)||[]).join("").replace(xa,""))),t&&(n.h=nC(rC(n.r)))),n):{t:""}}var oC=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,cC=/<(?:\w+:)?(?:si|sstItem)>/g,lC=/<\/(?:\w+:)?(?:si|sstItem)>/;function uC(r,e){var t=[],n="";if(!r)return t;var a=r.match(oC);if(a){n=a[2].replace(cC,"").split(lC);for(var s=0;s!=n.length;++s){var i=O1(n[s].trim(),e);i!=null&&(t[t.length]=i)}a=Wt(a[1]),t.Count=a.count,t.Unique=a.uniqueCount}return t}var hC=/^\s|\s$|[\t\n\r]/;function k_(r,e){if(!e.bookSST)return"";var t=[wn];t[t.length]=ct("sst",null,{xmlns:tl[0],count:r.Count,uniqueCount:r.Unique});for(var n=0;n!=r.length;++n)if(r[n]!=null){var a=r[n],s="<si>";a.r?s+=a.r:(s+="<t",a.t||(a.t=""),a.t.match(hC)&&(s+=' xml:space="preserve"'),s+=">"+Tr(a.t)+"</t>"),s+="</si>",t[t.length]=s}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function fC(r){return[r.read_shift(4),r.read_shift(4)]}function dC(r,e){var t=[],n=!1;return Ki(r,function(s,i,o){switch(o){case 159:t.Count=s[0],t.Unique=s[1];break;case 19:t.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),t}function mC(r,e){return e||(e=Ue(8)),e.write_shift(4,r.Count),e.write_shift(4,r.Unique),e}var pC=A6;function gC(r){var e=qa();Ke(e,159,mC(r));for(var t=0;t<r.length;++t)Ke(e,19,pC(r[t]));return Ke(e,160),e.end()}function I_(r){for(var e=[],t=r.split(""),n=0;n<t.length;++n)e[n]=t[n].charCodeAt(0);return e}function Ui(r,e){var t={};return t.Major=r.read_shift(2),t.Minor=r.read_shift(2),e>=4&&(r.l+=e-4),t}function xC(r){var e={};return e.id=r.read_shift(0,"lpp4"),e.R=Ui(r,4),e.U=Ui(r,4),e.W=Ui(r,4),e}function vC(r){for(var e=r.read_shift(4),t=r.l+e-4,n={},a=r.read_shift(4),s=[];a-- >0;)s.push({t:r.read_shift(4),v:r.read_shift(0,"lpp4")});if(n.name=r.read_shift(0,"lpp4"),n.comps=s,r.l!=t)throw new Error("Bad DataSpaceMapEntry: "+r.l+" != "+t);return n}function yC(r){var e=[];r.l+=4;for(var t=r.read_shift(4);t-- >0;)e.push(vC(r));return e}function wC(r){var e=[];r.l+=4;for(var t=r.read_shift(4);t-- >0;)e.push(r.read_shift(0,"lpp4"));return e}function _C(r){var e={};return r.read_shift(4),r.l+=4,e.id=r.read_shift(0,"lpp4"),e.name=r.read_shift(0,"lpp4"),e.R=Ui(r,4),e.U=Ui(r,4),e.W=Ui(r,4),e}function bC(r){var e=_C(r);if(e.ename=r.read_shift(0,"8lpp4"),e.blksz=r.read_shift(4),e.cmode=r.read_shift(4),r.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function C_(r,e){var t=r.l+e,n={};n.Flags=r.read_shift(4)&63,r.l+=4,n.AlgID=r.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=r.read_shift(4),n.KeySize=r.read_shift(4),n.ProviderType=r.read_shift(4),r.l+=8,n.CSPName=r.read_shift(t-r.l>>1,"utf16le"),r.l=t,n}function P_(r,e){var t={},n=r.l+e;return r.l+=4,t.Salt=r.slice(r.l,r.l+16),r.l+=16,t.Verifier=r.slice(r.l,r.l+16),r.l+=16,r.read_shift(4),t.VerifierHash=r.slice(r.l,n),r.l=n,t}function EC(r){var e=Ui(r);switch(e.Minor){case 2:return[e.Minor,SC(r)];case 3:return[e.Minor,AC()];case 4:return[e.Minor,NC(r)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function SC(r){var e=r.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var t=r.read_shift(4),n=C_(r,t),a=P_(r,r.length-r.l);return{t:"Std",h:n,v:a}}function AC(){throw new Error("File is password-protected: ECMA-376 Extensible")}function NC(r){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];r.l+=4;var t=r.read_shift(r.length-r.l,"utf8"),n={};return t.replace(xa,function(s){var i=Wt(s);switch(vi(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function TC(r,e){var t={},n=t.EncryptionVersionInfo=Ui(r,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);t.Flags=r.read_shift(4),e-=4;var a=r.read_shift(4);return e-=4,t.EncryptionHeader=C_(r,a),e-=a,t.EncryptionVerifier=P_(r,e),t}function kC(r){var e={},t=e.EncryptionVersionInfo=Ui(r,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return e.Salt=r.read_shift(16),e.EncryptedVerifier=r.read_shift(16),e.EncryptedVerifierHash=r.read_shift(16),e}function M1(r){var e=0,t,n=I_(r),a=n.length+1,s,i,o,c,l;for(t=zo(a),t[0]=n.length,s=1;s!=a;++s)t[s]=n[s-1];for(s=a-1;s>=0;--s)i=t[s],o=e&16384?1:0,c=e<<1&32767,l=o|c,e=l^i;return e^52811}var F_=function(){var r=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},a=function(i,o){return n(i^o)},s=function(i){for(var o=e[i.length-1],c=104,l=i.length-1;l>=0;--l)for(var u=i[l],d=0;d!=7;++d)u&64&&(o^=t[c]),u*=2,--c;return o};return function(i){for(var o=I_(i),c=s(o),l=o.length,u=zo(16),d=0;d!=16;++d)u[d]=0;var g,p,y;for((l&1)===1&&(g=c>>8,u[l]=a(r[0],g),--l,g=c&255,p=o[o.length-1],u[l]=a(p,g));l>0;)--l,g=c>>8,u[l]=a(o[l],g),--l,g=c&255,u[l]=a(o[l],g);for(l=15,y=15-o.length;y>0;)g=c>>8,u[l]=a(r[y],g),--l,--y,g=c&255,u[l]=a(o[l],g),--l,--y;return u}}(),IC=function(r,e,t,n,a){a||(a=e),n||(n=F_(r));var s,i;for(s=0;s!=e.length;++s)i=e[s],i^=n[t],i=(i>>5|i<<3)&255,a[s]=i,++t;return[a,t,n]},CC=function(r){var e=0,t=F_(r);return function(n){var a=IC("",n,e,t);return e=a[1],a[0]}};function PC(r,e,t,n){var a={key:Tn(r),verificationBytes:Tn(r)};return t.password&&(a.verifier=M1(t.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=CC(t.password)),a}function FC(r,e,t){var n=t||{};return n.Info=r.read_shift(2),r.l-=2,n.Info===1?n.Data=kC(r):n.Data=TC(r,e),n}function RC(r,e,t){var n={Type:t.biff>=8?r.read_shift(2):0};return n.Type?FC(r,e-2,n):PC(r,t.biff>=8?e:e-2,t,n),n}var R_=function(){function r(a,s){switch(s.type){case"base64":return e(cs(a),s);case"binary":return e(a,s);case"buffer":return e(Zt&&Buffer.isBuffer(a)?a.toString("binary"):Jo(a),s);case"array":return e(Gc(a),s)}throw new Error("Unrecognized type "+s.type)}function e(a,s){var i=s||{},o=i.dense?[]:{},c=a.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var l={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(u,d){Array.isArray(o)&&(o[d]=[]);for(var g=/\\\w+\b/g,p=0,y,v=-1;y=g.exec(u);){switch(y[0]){case"\\cell":var w=u.slice(p,g.lastIndex-y[0].length);if(w[0]==" "&&(w=w.slice(1)),++v,w.length){var E={v:w,t:"s"};Array.isArray(o)?o[d][v]=E:o[qt({r:d,c:v})]=E}break}p=g.lastIndex}v>l.e.c&&(l.e.c=v)}),o["!ref"]=Jt(l),o}function t(a,s){return Qo(r(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],i=pr(a["!ref"]),o,c=Array.isArray(a),l=i.s.r;l<=i.e.r;++l){s.push("\\trowd\\trautofit1");for(var u=i.s.c;u<=i.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=i.s.c;u<=i.e.c;++u){var d=qt({r:l,c:u});o=c?(a[l]||[])[u]:a[d],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(Hi(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:t,to_sheet:r,from_sheet:n}}();function DC(r){var e=r.slice(r[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function Oh(r){for(var e=0,t=1;e!=3;++e)t=t*256+(r[e]>255?255:r[e]<0?0:r[e]);return t.toString(16).toUpperCase().slice(1)}function LC(r){var e=r[0]/255,t=r[1]/255,n=r[2]/255,a=Math.max(e,t,n),s=Math.min(e,t,n),i=a-s;if(i===0)return[0,0,e];var o=0,c=0,l=a+s;switch(c=i/(l>1?2-l:l),a){case e:o=((t-n)/i+6)%6;break;case t:o=(n-e)/i+2;break;case n:o=(e-t)/i+4;break}return[o/6,c,l/2]}function jC(r){var e=r[0],t=r[1],n=r[2],a=t*2*(n<.5?n:1-n),s=n-a/2,i=[s,s,s],o=6*e,c;if(t!==0)switch(o|0){case 0:case 6:c=a*o,i[0]+=a,i[1]+=c;break;case 1:c=a*(2-o),i[0]+=c,i[1]+=a;break;case 2:c=a*(o-2),i[1]+=a,i[2]+=c;break;case 3:c=a*(4-o),i[1]+=c,i[2]+=a;break;case 4:c=a*(o-4),i[2]+=a,i[0]+=c;break;case 5:c=a*(6-o),i[2]+=c,i[0]+=a;break}for(var l=0;l!=3;++l)i[l]=Math.round(i[l]*255);return i}function Wf(r,e){if(e===0)return r;var t=LC(DC(r));return e<0?t[2]=t[2]*(1+e):t[2]=1-(1-t[2])*(1-e),Oh(jC(t))}var D_=6,OC=15,MC=1,ha=D_;function Mh(r){return Math.floor((r+Math.round(128/ha)/256)*ha)}function Bh(r){return Math.floor((r-5)/ha*100+.5)/100}function Hf(r){return Math.round((r*ha+5)/ha*256)/256}function lm(r){return Hf(Bh(Mh(r)))}function B1(r){var e=Math.abs(r-lm(r)),t=ha;if(e>.005)for(ha=MC;ha<OC;++ha)Math.abs(r-lm(r))<=e&&(e=Math.abs(r-lm(r)),t=ha);ha=t}function Wo(r){r.width?(r.wpx=Mh(r.width),r.wch=Bh(r.wpx),r.MDW=ha):r.wpx?(r.wch=Bh(r.wpx),r.width=Hf(r.wch),r.MDW=ha):typeof r.wch=="number"&&(r.width=Hf(r.wch),r.wpx=Mh(r.width),r.MDW=ha),r.customWidth&&delete r.customWidth}var BC=96,L_=BC;function Vh(r){return r*96/L_}function pu(r){return r*L_/96}var VC={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function UC(r,e,t,n){e.Borders=[];var a={},s=!1;(r[0].match(xa)||[]).forEach(function(i){var o=Wt(i);switch(vi(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},o.diagonalUp&&(a.diagonalUp=Wr(o.diagonalUp)),o.diagonalDown&&(a.diagonalDown=Wr(o.diagonalDown)),e.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function qC(r,e,t,n){e.Fills=[];var a={},s=!1;(r[0].match(xa)||[]).forEach(function(i){var o=Wt(i);switch(vi(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},e.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":o.patternType&&(a.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),o.indexed&&(a.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(a.bgColor.theme=parseInt(o.theme,10)),o.tint&&(a.bgColor.tint=parseFloat(o.tint)),o.rgb&&(a.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),o.theme&&(a.fgColor.theme=parseInt(o.theme,10)),o.tint&&(a.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(a.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function zC(r,e,t,n){e.Fonts=[];var a={},s=!1;(r[0].match(xa)||[]).forEach(function(i){var o=Wt(i);switch(vi(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=Lr(o.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=o.val?Wr(o.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=o.val?Wr(o.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=o.val?Wr(o.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=o.val?Wr(o.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=o.val?Wr(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=o.val?Wr(o.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=o.val?Wr(o.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":o.val&&(a.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=d1[parseInt(o.val,10)];break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=Wr(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var c=Pc[a.color.index];a.color.index==81&&(c=Pc[1]),c||(c=Pc[1]),a.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&t.themeElements&&t.themeElements.clrScheme&&(a.color.rgb=Wf(t.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function WC(r,e,t){e.NumberFmt=[];for(var n=fn(Mt),a=0;a<n.length;++a)e.NumberFmt[n[a]]=Mt[n[a]];var s=r[0].match(xa);if(s)for(a=0;a<s.length;++a){var i=Wt(s[a]);switch(vi(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=mr(Lr(i.formatCode)),c=parseInt(i.numFmtId,10);if(e.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&e.NumberFmt[c]!=null;--c);e.NumberFmt[c]=o}Vi(o,c)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function HC(r){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var n=t[0];n<=t[1];++n)r[n]!=null&&(e[e.length]=ct("numFmt",null,{numFmtId:n,formatCode:Tr(r[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=ct("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var $0=["numFmtId","fillId","fontId","borderId","xfId"],K0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function GC(r,e,t){e.CellXf=[];var n,a=!1;(r[0].match(xa)||[]).forEach(function(s){var i=Wt(s),o=0;switch(vi(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<$0.length;++o)n[$0[o]]&&(n[$0[o]]=parseInt(n[$0[o]],10));for(o=0;o<K0.length;++o)n[K0[o]]&&(n[K0[o]]=Wr(n[K0[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};i.vertical&&(c.vertical=i.vertical),i.horizontal&&(c.horizontal=i.horizontal),i.textRotation!=null&&(c.textRotation=i.textRotation),i.indent&&(c.indent=i.indent),i.wrapText&&(c.wrapText=Wr(i.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(t&&t.WTF&&!a)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function $C(r){var e=[];return e[e.length]=ct("cellXfs",null),r.forEach(function(t){e[e.length]=ct("xf",null,t)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=ct("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var KC=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,l){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=o.match(e))&&WC(d,u,l),(d=o.match(a))&&zC(d,u,c,l),(d=o.match(n))&&qC(d,u,c,l),(d=o.match(s))&&UC(d,u,c,l),(d=o.match(t))&&GC(d,u,l),u}}();function j_(r,e){var t=[wn,ct("styleSheet",null,{xmlns:tl[0],"xmlns:vt":Fn.vt})],n;return r.SSF&&(n=HC(r.SSF))!=null&&(t[t.length]=n),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=$C(e.cellXfs))&&(t[t.length]=n),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function XC(r,e){var t=r.read_shift(2),n=pa(r);return[t,n]}function YC(r,e,t){t||(t=Ue(6+4*e.length)),t.write_shift(2,r),zn(e,t);var n=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),n}function JC(r,e,t){var n={};n.sz=r.read_shift(2)/20;var a=F6(r);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=r.read_shift(2);switch(s===700&&(n.bold=1),r.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=r.read_shift(1);i!=0&&(n.underline=i);var o=r.read_shift(1);o>0&&(n.family=o);var c=r.read_shift(1);switch(c>0&&(n.charset=c),r.l++,n.color=P6(r),r.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=pa(r),n}function QC(r,e){e||(e=Ue(25+4*32)),e.write_shift(2,r.sz*20),R6(r,e),e.write_shift(2,r.bold?700:400);var t=0;r.vertAlign=="superscript"?t=1:r.vertAlign=="subscript"&&(t=2),e.write_shift(2,t),e.write_shift(1,r.underline||0),e.write_shift(1,r.family||0),e.write_shift(1,r.charset||0),e.write_shift(1,0),Uf(r.color,e);var n=0;return r.scheme=="major"&&(n=1),r.scheme=="minor"&&(n=2),e.write_shift(1,n),zn(r.name,e),e.length>e.l?e.slice(0,e.l):e}var ZC=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],um,e8=ga;function z2(r,e){e||(e=Ue(4*3+8*7+16*1)),um||(um=wd(ZC));var t=um[r.patternType];t==null&&(t=40),e.write_shift(4,t);var n=0;if(t!=40)for(Uf({auto:1},e),Uf({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function t8(r,e){var t=r.l+e,n=r.read_shift(2),a=r.read_shift(2);return r.l=t,{ixfe:n,numFmtId:a}}function O_(r,e,t){t||(t=Ue(16)),t.write_shift(2,e||0),t.write_shift(2,r.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var n=0;return t.write_shift(1,n),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function $u(r,e){return e||(e=Ue(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var r8=ga;function n8(r,e){return e||(e=Ue(51)),e.write_shift(1,0),$u(null,e),$u(null,e),$u(null,e),$u(null,e),$u(null,e),e.length>e.l?e.slice(0,e.l):e}function a8(r,e){return e||(e=Ue(12+4*10)),e.write_shift(4,r.xfId),e.write_shift(2,1),e.write_shift(1,+r.builtinId),e.write_shift(1,0),Vf(r.name||"",e),e.length>e.l?e.slice(0,e.l):e}function s8(r,e,t){var n=Ue(2052);return n.write_shift(4,r),Vf(e,n),Vf(t,n),n.length>n.l?n.slice(0,n.l):n}function i8(r,e,t){var n={};n.NumberFmt=[];for(var a in Mt)n.NumberFmt[a]=Mt[a];n.CellXf=[],n.Fonts=[];var s=[],i=!1;return Ki(r,function(c,l,u){switch(u){case 44:n.NumberFmt[c[0]]=c[1],Vi(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(c.color.rgb=Wf(e.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:s.push(u),i=!0;break;case 38:s.pop(),i=!1;break;default:if(l.T>0)s.push(u);else if(l.T<0)s.pop();else if(!i||t.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function o8(r,e){if(e){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&++t}),t!=0&&(Ke(r,615,Ks(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&Ke(r,44,YC(a,e[a]))}),Ke(r,616))}}function c8(r){var e=1;Ke(r,611,Ks(e)),Ke(r,43,QC({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),Ke(r,612)}function l8(r){var e=2;Ke(r,603,Ks(e)),Ke(r,45,z2({patternType:"none"})),Ke(r,45,z2({patternType:"gray125"})),Ke(r,604)}function u8(r){var e=1;Ke(r,613,Ks(e)),Ke(r,46,n8()),Ke(r,614)}function h8(r){var e=1;Ke(r,626,Ks(e)),Ke(r,47,O_({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),Ke(r,627)}function f8(r,e){Ke(r,617,Ks(e.length)),e.forEach(function(t){Ke(r,47,O_(t,0))}),Ke(r,618)}function d8(r){var e=1;Ke(r,619,Ks(e)),Ke(r,48,a8({xfId:0,builtinId:0,name:"Normal"})),Ke(r,620)}function m8(r){var e=0;Ke(r,505,Ks(e)),Ke(r,506)}function p8(r){var e=0;Ke(r,508,s8(e,"TableStyleMedium9","PivotStyleMedium4")),Ke(r,509)}function g8(r,e){var t=qa();return Ke(t,278),o8(t,r.SSF),c8(t),l8(t),u8(t),h8(t),f8(t,e.cellXfs),d8(t),m8(t),p8(t),Ke(t,279),t.end()}var x8=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function v8(r,e,t){e.themeElements.clrScheme=[];var n={};(r[0].match(xa)||[]).forEach(function(a){var s=Wt(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[x8.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function y8(){}function w8(){}var _8=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,b8=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,E8=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function S8(r,e,t){e.themeElements={};var n;[["clrScheme",_8,v8],["fontScheme",b8,y8],["fmtScheme",E8,w8]].forEach(function(a){if(!(n=r.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,e,t)})}var A8=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function M_(r,e){(!r||r.length===0)&&(r=V1());var t,n={};if(!(t=r.match(A8)))throw new Error("themeElements not found in theme");return S8(t[0],n,e),n.raw=r,n}function V1(r,e){if(e&&e.themeXLSX)return e.themeXLSX;if(r&&typeof r.raw=="string")return r.raw;var t=[wn];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function N8(r,e,t){var n=r.l+e,a=r.read_shift(4);if(a!==124226){if(!t.cellStyles){r.l=n;return}var s=r.slice(r.l);r.l=n;var i;try{i=Cw(s,{type:"array"})}catch{return}var o=ns(i,"theme/theme/theme1.xml",!0);if(o)return M_(o,t)}}function T8(r){return r.read_shift(4)}function k8(r){var e={};switch(e.xclrType=r.read_shift(2),e.nTintShade=r.read_shift(2),e.xclrType){case 0:r.l+=4;break;case 1:e.xclrValue=I8(r,4);break;case 2:e.xclrValue=x_(r);break;case 3:e.xclrValue=T8(r);break;case 4:r.l+=4;break}return r.l+=8,e}function I8(r,e){return ga(r,e)}function C8(r,e){return ga(r,e)}function P8(r){var e=r.read_shift(2),t=r.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=k8(r);break;case 6:n[1]=C8(r,t);break;case 14:case 15:n[1]=r.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+t)}return n}function F8(r,e){var t=r.l+e;r.l+=2;var n=r.read_shift(2);r.l+=2;for(var a=r.read_shift(2),s=[];a-- >0;)s.push(P8(r,t-r.l));return{ixfe:n,ext:s}}function R8(r,e){e.forEach(function(t){switch(t[0]){}})}function D8(r,e){return{flags:r.read_shift(4),version:r.read_shift(4),name:pa(r)}}function L8(r){var e=Ue(12+2*r.name.length);return e.write_shift(4,r.flags),e.write_shift(4,r.version),zn(r.name,e),e.slice(0,e.l)}function j8(r){for(var e=[],t=r.read_shift(4);t-- >0;)e.push([r.read_shift(4),r.read_shift(4)]);return e}function O8(r){var e=Ue(4+8*r.length);e.write_shift(4,r.length);for(var t=0;t<r.length;++t)e.write_shift(4,r[t][0]),e.write_shift(4,r[t][1]);return e}function M8(r,e){var t=Ue(8+2*e.length);return t.write_shift(4,r),zn(e,t),t.slice(0,t.l)}function B8(r){return r.l+=4,r.read_shift(4)!=0}function V8(r,e){var t=Ue(8);return t.write_shift(4,r),t.write_shift(4,1),t}function U8(r,e,t){var n={Types:[],Cell:[],Value:[]},a=t||{},s=[],i=!1,o=2;return Ki(r,function(c,l,u){switch(u){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(d){o==1?n.Cell.push({type:n.Types[d[0]-1].name,index:d[1]}):o==0&&n.Value.push({type:n.Types[d[0]-1].name,index:d[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:s.push(u),i=!0;break;case 36:s.pop(),i=!1;break;default:if(!l.T){if(!i||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function q8(){var r=qa();return Ke(r,332),Ke(r,334,Ks(1)),Ke(r,335,L8({name:"XLDAPR",version:12e4,flags:3496657072})),Ke(r,336),Ke(r,339,M8(1,"XLDAPR")),Ke(r,52),Ke(r,35,Ks(514)),Ke(r,4096,Ks(0)),Ke(r,4097,Es(1)),Ke(r,36),Ke(r,53),Ke(r,340),Ke(r,337,V8(1)),Ke(r,51,O8([[1,0]])),Ke(r,338),Ke(r,333),r.end()}function z8(r,e,t){var n={Types:[],Cell:[],Value:[]};if(!r)return n;var a=!1,s=2,i;return r.replace(xa,function(o){var c=Wt(o);switch(vi(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var l=0;l<n.Types.length;++l)n.Types[l].name==c.name&&(i=n.Types[l]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):s==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+c.i);break;default:if(!a&&t.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function B_(){var r=[wn];return r.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),r.join("")}function W8(r){var e=[];if(!r)return e;var t=1;return(r.match(xa)||[]).forEach(function(n){var a=Wt(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?t=a.i:a.i=t,e.push(a);break}}),e}function H8(r){var e={};e.i=r.read_shift(4);var t={};t.r=r.read_shift(4),t.c=r.read_shift(4),e.r=qt(t);var n=r.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function G8(r,e,t){var n=[];return Ki(r,function(s,i,o){switch(o){case 63:n.push(s);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function $8(r,e,t,n){if(!r)return r;var a=n||{},s=!1;Ki(r,function(o,c,l){switch(l){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!c.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}},a)}function K8(r,e){if(!r)return"??";var t=(r.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][t].Target}var Gl=1024;function V_(r,e){for(var t=[21600,21600],n=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),a=[ct("xml",null,{"xmlns:v":es.v,"xmlns:o":es.o,"xmlns:x":es.x,"xmlns:mv":es.mv}).replace(/\/>/,">"),ct("o:shapelayout",ct("o:idmap",null,{"v:ext":"edit",data:r}),{"v:ext":"edit"}),ct("v:shapetype",[ct("v:stroke",null,{joinstyle:"miter"}),ct("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:n})];Gl<r*1e3;)Gl+=1e3;return e.forEach(function(s){var i=en(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?ct("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,l=ct("v:fill",c,o),u={on:"t",obscured:"t"};++Gl,a=a.concat(["<v:shape"+Dh({id:"_x0000_s"+Gl,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",l,ct("v:shadow",null,u),ct("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Zn("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),Zn("x:AutoFill","False"),Zn("x:Row",String(i.r)),Zn("x:Column",String(i.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function W2(r,e,t,n){var a=Array.isArray(r),s;e.forEach(function(i){var o=en(i.ref);if(a?(r[o.r]||(r[o.r]=[]),s=r[o.r][o.c]):s=r[i.ref],!s){s={t:"z"},a?r[o.r][o.c]=s:r[i.ref]=s;var c=pr(r["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var l=Jt(c);l!==r["!ref"]&&(r["!ref"]=l)}s.c||(s.c=[]);var u={a:i.author,t:i.t,r:i.r,T:t};i.h&&(u.h=i.h);for(var d=s.c.length-1;d>=0;--d){if(!t&&s.c[d].T)return;t&&!s.c[d].T&&s.c.splice(d,1)}if(t&&n){for(d=0;d<n.length;++d)if(u.a==n[d].id){u.a=n[d].name||u.a;break}}s.c.push(u)})}function X8(r,e){if(r.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],n=[],a=r.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&t.push(o[1])}});var s=r.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=Wt(o[0]),l={author:c.authorId&&t[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},u=en(c.ref);if(!(e.sheetRows&&e.sheetRows<=u.r)){var d=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),g=!!d&&!!d[1]&&O1(d[1])||{r:"",t:"",h:""};l.r=g.r,g.r=="<t></t>"&&(g.t=g.h=""),l.t=(g.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(l.h=g.h),n.push(l)}}}}),n}function U_(r){var e=[wn,ct("comments",null,{xmlns:tl[0]})],t=[];return e.push("<authors>"),r.forEach(function(n){n[1].forEach(function(a){var s=Tr(a.a);t.indexOf(s)==-1&&(t.push(s),e.push("<author>"+s+"</author>")),a.T&&a.ID&&t.indexOf("tc="+a.ID)==-1&&(t.push("tc="+a.ID),e.push("<author>tc="+a.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),r.forEach(function(n){var a=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=t.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(a=t.indexOf(Tr(c.a))),s.push(c.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),s.length<=1)e.push(Zn("t",Tr(s[0]||"")));else{for(var i=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)i+=`Reply:
    `+s[o]+`
`;e.push(Zn("t",Tr(i)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function Y8(r,e){var t=[],n=!1,a={},s=0;return r.replace(xa,function(o,c){var l=Wt(o);switch(vi(l[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":a.t!=null&&t.push(a);break;case"<text>":case"<text":s=c+o.length;break;case"</text>":a.t=r.slice(s,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),t}function J8(r,e,t){var n=[wn,ct("ThreadedComments",null,{xmlns:Fn.TCMNT}).replace(/[\/]>/,">")];return r.forEach(function(a){var s="";(a[1]||[]).forEach(function(i,o){if(!i.T){delete i.ID;return}i.a&&e.indexOf(i.a)==-1&&e.push(i.a);var c={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};o==0?s=c.id:c.parentId=s,i.ID=c.id,i.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(i.a)).slice(-12)+"}"),n.push(ct("threadedComment",Zn("text",i.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function Q8(r,e){var t=[],n=!1;return r.replace(xa,function(s){var i=Wt(s);switch(vi(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return s}),t}function Z8(r){var e=[wn,ct("personList",null,{xmlns:Fn.TCMNT,"xmlns:x":tl[0]}).replace(/[\/]>/,">")];return r.forEach(function(t,n){e.push(ct("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:t,providerId:"None"}))}),e.push("</personList>"),e.join("")}function eP(r){var e={};e.iauthor=r.read_shift(4);var t=sl(r);return e.rfx=t.s,e.ref=qt(t.s),r.l+=16,e}function tP(r,e){return e==null&&(e=Ue(36)),e.write_shift(4,r[1].iauthor),Su(r[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var rP=pa;function nP(r){return zn(r.slice(0,54))}function aP(r,e){var t=[],n=[],a={},s=!1;return Ki(r,function(o,c,l){switch(l){case 632:n.push(o);break;case 635:a=o;break;case 637:a.t=o.t,a.h=o.h,a.r=o.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,e.sheetRows&&a.rfx&&e.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,t.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}}),t}function sP(r){var e=qa(),t=[];return Ke(e,628),Ke(e,630),r.forEach(function(n){n[1].forEach(function(a){t.indexOf(a.a)>-1||(t.push(a.a.slice(0,54)),Ke(e,632,nP(a.a)))})}),Ke(e,631),Ke(e,633),r.forEach(function(n){n[1].forEach(function(a){a.iauthor=t.indexOf(a.a);var s={s:en(n[0]),e:en(n[0])};Ke(e,635,tP([s,a])),a.t&&a.t.length>0&&Ke(e,637,T6(a)),Ke(e,636),delete a.iauthor})}),Ke(e,634),Ke(e,629),e.end()}var iP="application/vnd.ms-office.vbaProject";function oP(r){var e=Pt.utils.cfb_new({root:"R"});return r.FullPaths.forEach(function(t,n){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var a=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Pt.utils.cfb_add(e,a,r.FileIndex[n].content)}}),Pt.write(e)}function cP(r,e){e.FullPaths.forEach(function(t,n){if(n!=0){var a=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&Pt.utils.cfb_add(r,a,e.FileIndex[n].content)}})}var q_=["xlsb","xlsm","xlam","biff8","xla"];function lP(){return{"!type":"dialog"}}function uP(){return{"!type":"dialog"}}function hP(){return{"!type":"macro"}}function fP(){return{"!type":"macro"}}var Ql=function(){var r=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(n,a,s,i){var o=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var l=s.length>0?parseInt(s,10)|0:0,u=i.length>0?parseInt(i,10)|0:0;return o?u+=e.c:--u,c?l+=e.r:--l,a+(o?"":"$")+Zr(u)+(c?"":"$")+yn(l)}return function(a,s){return e=s,a.replace(r,t)}}(),U1=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,q1=function(){return function(e,t){return e.replace(U1,function(n,a,s,i,o,c){var l=k1(i)-(s?0:t.c),u=T1(c)-(o?0:t.r),d=u==0?"":o?u+1:"["+u+"]",g=l==0?"":s?l+1:"["+l+"]";return a+"R"+d+"C"+g})}}();function z_(r,e){return r.replace(U1,function(t,n,a,s,i,o){return n+(a=="$"?a+s:Zr(k1(s)+e.c))+(i=="$"?i+o:yn(T1(o)+e.r))})}function dP(r,e,t){var n=za(e),a=n.s,s=en(t),i={r:s.r-a.r,c:s.c-a.c};return z_(r,i)}function mP(r){return r.length!=1}function H2(r){return r.replace(/_xlfn\./g,"")}function Sn(r){r.l+=1}function Ho(r,e){var t=r.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function W_(r,e,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return H_(r);t.biff==12&&(n=4)}var a=r.read_shift(n),s=r.read_shift(n),i=Ho(r),o=Ho(r);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function H_(r){var e=Ho(r),t=Ho(r),n=r.read_shift(1),a=r.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:t[0],c:a,cRel:t[1],rRel:t[2]}}}function pP(r,e,t){if(t.biff<8)return H_(r);var n=r.read_shift(t.biff==12?4:2),a=r.read_shift(t.biff==12?4:2),s=Ho(r),i=Ho(r);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:i[0],cRel:i[1],rRel:i[2]}}}function G_(r,e,t){if(t&&t.biff>=2&&t.biff<=5)return gP(r);var n=r.read_shift(t&&t.biff==12?4:2),a=Ho(r);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function gP(r){var e=Ho(r),t=r.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function xP(r){var e=r.read_shift(2),t=r.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function vP(r,e,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return yP(r);var a=r.read_shift(n>=12?4:2),s=r.read_shift(2),i=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;a>524287;)a-=1048576;if(i==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:i,rRel:o}}function yP(r){var e=r.read_shift(2),t=r.read_shift(1),n=(e&32768)>>15,a=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),a==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:a,rRel:n}}function wP(r,e,t){var n=(r[r.l++]&96)>>5,a=W_(r,t.biff>=2&&t.biff<=5?6:8,t);return[n,a]}function _P(r,e,t){var n=(r[r.l++]&96)>>5,a=r.read_shift(2,"i"),s=8;if(t)switch(t.biff){case 5:r.l+=12,s=6;break;case 12:s=12;break}var i=W_(r,s,t);return[n,a,i]}function bP(r,e,t){var n=(r[r.l++]&96)>>5;return r.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function EP(r,e,t){var n=(r[r.l++]&96)>>5,a=r.read_shift(2),s=8;if(t)switch(t.biff){case 5:r.l+=12,s=6;break;case 12:s=12;break}return r.l+=s,[n,a]}function SP(r,e,t){var n=(r[r.l++]&96)>>5,a=pP(r,e-1,t);return[n,a]}function AP(r,e,t){var n=(r[r.l++]&96)>>5;return r.l+=t.biff==2?6:t.biff==12?14:7,[n]}function G2(r){var e=r[r.l+1]&1,t=1;return r.l+=4,[e,t]}function NP(r,e,t){r.l+=2;for(var n=r.read_shift(t&&t.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(r.read_shift(t&&t.biff==2?1:2));return a}function TP(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=2,[n,r.read_shift(t&&t.biff==2?1:2)]}function kP(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=2,[n,r.read_shift(t&&t.biff==2?1:2)]}function IP(r){var e=r[r.l+1]&255?1:0;return r.l+=2,[e,r.read_shift(2)]}function CP(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=t&&t.biff==2?3:4,[n]}function $_(r){var e=r.read_shift(1),t=r.read_shift(1);return[e,t]}function PP(r){return r.read_shift(2),$_(r)}function FP(r){return r.read_shift(2),$_(r)}function RP(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var a=G_(r,0,t);return[n,a]}function DP(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var a=vP(r,0,t);return[n,a]}function LP(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var a=r.read_shift(2);t&&t.biff==5&&(r.l+=12);var s=G_(r,0,t);return[n,a,s]}function jP(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var a=r.read_shift(t&&t.biff<=3?1:2);return[BF[a],Y_[a],n]}function OP(r,e,t){var n=r[r.l++],a=r.read_shift(1),s=t&&t.biff<=3?[n==88?-1:0,r.read_shift(1)]:MP(r);return[a,(s[0]===0?Y_:MF)[s[1]]]}function MP(r){return[r[r.l+1]>>7,r.read_shift(2)&32767]}function BP(r,e,t){r.l+=t&&t.biff==2?3:4}function VP(r,e,t){if(r.l++,t&&t.biff==12)return[r.read_shift(4,"i"),0];var n=r.read_shift(2),a=r.read_shift(t&&t.biff==2?1:2);return[n,a]}function UP(r){return r.l++,Xi[r.read_shift(1)]}function qP(r){return r.l++,r.read_shift(2)}function zP(r){return r.l++,r.read_shift(1)!==0}function WP(r){return r.l++,da(r)}function HP(r,e,t){return r.l++,a0(r,e-1,t)}function GP(r,e){var t=[r.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=pn(r,1)?"TRUE":"FALSE",e!=12&&(r.l+=7);break;case 37:case 16:t[1]=Xi[r[r.l]],r.l+=e==12?4:8;break;case 0:r.l+=8;break;case 1:t[1]=da(r);break;case 2:t[1]=il(r,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function $P(r,e,t){for(var n=r.read_shift(t.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((t.biff==12?sl:Ed)(r));return a}function KP(r,e,t){var n=0,a=0;t.biff==12?(n=r.read_shift(4),a=r.read_shift(4)):(a=1+r.read_shift(1),n=1+r.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--a==0&&(a=256));for(var s=0,i=[];s!=n&&(i[s]=[]);++s)for(var o=0;o!=a;++o)i[s][o]=GP(r,t.biff);return i}function XP(r,e,t){var n=r.read_shift(1)>>>5&3,a=!t||t.biff>=8?4:2,s=r.read_shift(a);switch(t.biff){case 2:r.l+=5;break;case 3:case 4:r.l+=8;break;case 5:r.l+=12;break}return[n,0,s]}function YP(r,e,t){if(t.biff==5)return JP(r);var n=r.read_shift(1)>>>5&3,a=r.read_shift(2),s=r.read_shift(4);return[n,a,s]}function JP(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2,"i");r.l+=8;var n=r.read_shift(2);return r.l+=12,[e,t,n]}function QP(r,e,t){var n=r.read_shift(1)>>>5&3;r.l+=t&&t.biff==2?3:4;var a=r.read_shift(t&&t.biff==2?1:2);return[n,a]}function ZP(r,e,t){var n=r.read_shift(1)>>>5&3,a=r.read_shift(t&&t.biff==2?1:2);return[n,a]}function eF(r,e,t){var n=r.read_shift(1)>>>5&3;return r.l+=4,t.biff<8&&r.l--,t.biff==12&&(r.l+=2),[n]}function tF(r,e,t){var n=(r[r.l++]&96)>>5,a=r.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6;break}return r.l+=s,[n,a]}var rF=ga,nF=ga,aF=ga;function i0(r,e,t){return r.l+=2,[xP(r)]}function z1(r){return r.l+=6,[]}var sF=i0,iF=z1,oF=z1,cF=i0;function K_(r){return r.l+=2,[Tn(r),r.read_shift(2)&1]}var lF=i0,uF=K_,hF=z1,fF=i0,dF=i0,mF=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function pF(r){r.l+=2;var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(4),a=r.read_shift(2),s=r.read_shift(2),i=mF[t>>2&31];return{ixti:e,coltype:t&3,rt:i,idx:n,c:a,C:s}}function gF(r){return r.l+=2,[r.read_shift(4)]}function xF(r,e,t){return r.l+=5,r.l+=2,r.l+=t.biff==2?1:4,["PTGSHEET"]}function vF(r,e,t){return r.l+=t.biff==2?4:5,["PTGENDSHEET"]}function yF(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function wF(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function _F(r){return r.l+=4,[0,0]}var $2={1:{n:"PtgExp",f:VP},2:{n:"PtgTbl",f:aF},3:{n:"PtgAdd",f:Sn},4:{n:"PtgSub",f:Sn},5:{n:"PtgMul",f:Sn},6:{n:"PtgDiv",f:Sn},7:{n:"PtgPower",f:Sn},8:{n:"PtgConcat",f:Sn},9:{n:"PtgLt",f:Sn},10:{n:"PtgLe",f:Sn},11:{n:"PtgEq",f:Sn},12:{n:"PtgGe",f:Sn},13:{n:"PtgGt",f:Sn},14:{n:"PtgNe",f:Sn},15:{n:"PtgIsect",f:Sn},16:{n:"PtgUnion",f:Sn},17:{n:"PtgRange",f:Sn},18:{n:"PtgUplus",f:Sn},19:{n:"PtgUminus",f:Sn},20:{n:"PtgPercent",f:Sn},21:{n:"PtgParen",f:Sn},22:{n:"PtgMissArg",f:Sn},23:{n:"PtgStr",f:HP},26:{n:"PtgSheet",f:xF},27:{n:"PtgEndSheet",f:vF},28:{n:"PtgErr",f:UP},29:{n:"PtgBool",f:zP},30:{n:"PtgInt",f:qP},31:{n:"PtgNum",f:WP},32:{n:"PtgArray",f:AP},33:{n:"PtgFunc",f:jP},34:{n:"PtgFuncVar",f:OP},35:{n:"PtgName",f:XP},36:{n:"PtgRef",f:RP},37:{n:"PtgArea",f:wP},38:{n:"PtgMemArea",f:QP},39:{n:"PtgMemErr",f:rF},40:{n:"PtgMemNoMem",f:nF},41:{n:"PtgMemFunc",f:ZP},42:{n:"PtgRefErr",f:eF},43:{n:"PtgAreaErr",f:bP},44:{n:"PtgRefN",f:DP},45:{n:"PtgAreaN",f:SP},46:{n:"PtgMemAreaN",f:yF},47:{n:"PtgMemNoMemN",f:wF},57:{n:"PtgNameX",f:YP},58:{n:"PtgRef3d",f:LP},59:{n:"PtgArea3d",f:_P},60:{n:"PtgRefErr3d",f:tF},61:{n:"PtgAreaErr3d",f:EP},255:{}},bF={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},EF={1:{n:"PtgElfLel",f:K_},2:{n:"PtgElfRw",f:fF},3:{n:"PtgElfCol",f:sF},6:{n:"PtgElfRwV",f:dF},7:{n:"PtgElfColV",f:cF},10:{n:"PtgElfRadical",f:lF},11:{n:"PtgElfRadicalS",f:hF},13:{n:"PtgElfColS",f:iF},15:{n:"PtgElfColSV",f:oF},16:{n:"PtgElfRadicalLel",f:uF},25:{n:"PtgList",f:pF},29:{n:"PtgSxName",f:gF},255:{}},SF={0:{n:"PtgAttrNoop",f:_F},1:{n:"PtgAttrSemi",f:CP},2:{n:"PtgAttrIf",f:kP},4:{n:"PtgAttrChoose",f:NP},8:{n:"PtgAttrGoto",f:TP},16:{n:"PtgAttrSum",f:BP},32:{n:"PtgAttrBaxcel",f:G2},33:{n:"PtgAttrBaxcel",f:G2},64:{n:"PtgAttrSpace",f:PP},65:{n:"PtgAttrSpaceSemi",f:FP},128:{n:"PtgAttrIfError",f:IP},255:{}};function o0(r,e,t,n){if(n.biff<8)return ga(r,e);for(var a=r.l+e,s=[],i=0;i!==t.length;++i)switch(t[i][0]){case"PtgArray":t[i][1]=KP(r,0,n),s.push(t[i][1]);break;case"PtgMemArea":t[i][2]=$P(r,t[i][1],n),s.push(t[i][2]);break;case"PtgExp":n&&n.biff==12&&(t[i][1][1]=r.read_shift(4),s.push(t[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[i][0]}return e=a-r.l,e!==0&&s.push(ga(r,e)),s}function c0(r,e,t){for(var n=r.l+e,a,s,i=[];n!=r.l;)e=n-r.l,s=r[r.l],a=$2[s]||$2[bF[s]],(s===24||s===25)&&(a=(s===24?EF:SF)[r[r.l+1]]),!a||!a.f?ga(r,e):i.push([a.n,a.f(r,e,t)]);return i}function AF(r){for(var e=[],t=0;t<r.length;++t){for(var n=r[t],a=[],s=0;s<n.length;++s){var i=n[s];if(i)switch(i[0]){case 2:a.push('"'+i[1].replace(/"/g,'""')+'"');break;default:a.push(i[1])}else a.push("")}e.push(a.join(","))}return e.join(";")}var NF={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function TF(r,e){if(!r&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(r)?"'"+r+"'":r}function X_(r,e,t){if(!r)return"SH33TJSERR0";if(t.biff>8&&(!r.XTI||!r.XTI[e]))return r.SheetNames[e];if(!r.XTI)return"SH33TJSERR6";var n=r.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":r.XTI[e-1];if(!n)return"SH33TJSERR1";var a="";if(t.biff>8)switch(r[n[0]][0]){case 357:return a=n[1]==-1?"#REF":r.SheetNames[n[1]],n[1]==n[2]?a:a+":"+r.SheetNames[n[2]];case 358:return t.SID!=null?r.SheetNames[t.SID]:"SH33TJSSAME"+r[n[0]][0];case 355:default:return"SH33TJSSRC"+r[n[0]][0]}switch(r[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":r.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+r.SheetNames[n[2]];case 14849:return r[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return r[n[0]][0][3]?(a=n[1]==-1?"#REF":r[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+r[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function K2(r,e,t){var n=X_(r,e,t);return n=="#REF"?n:TF(n,t)}function ua(r,e,t,n,a){var s=a&&a.biff||8,i={s:{c:0,r:0},e:{c:0,r:0}},o=[],c,l,u,d=0,g=0,p,y="";if(!r[0]||!r[0][0])return"";for(var v=-1,w="",E=0,R=r[0].length;E<R;++E){var P=r[0][E];switch(P[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),l=o.pop(),v>=0){switch(r[0][v][1][0]){case 0:w=ln(" ",r[0][v][1][1]);break;case 1:w=ln("\r",r[0][v][1][1]);break;default:if(w="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][v][1][0])}l=l+w,v=-1}o.push(l+NF[P[0]]+c);break;case"PtgIsect":c=o.pop(),l=o.pop(),o.push(l+" "+c);break;case"PtgUnion":c=o.pop(),l=o.pop(),o.push(l+","+c);break;case"PtgRange":c=o.pop(),l=o.pop(),o.push(l+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=hh(P[1][1],i,a),o.push(fh(u,s));break;case"PtgRefN":u=t?hh(P[1][1],t,a):P[1][1],o.push(fh(u,s));break;case"PtgRef3d":d=P[1][1],u=hh(P[1][2],i,a),y=K2(n,d,a),o.push(y+"!"+fh(u,s));break;case"PtgFunc":case"PtgFuncVar":var q=P[1][0],z=P[1][1];q||(q=0),q&=127;var K=q==0?[]:o.slice(-q);o.length-=q,z==="User"&&(z=K.shift()),o.push(z+"("+K.join(",")+")");break;case"PtgBool":o.push(P[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(P[1]);break;case"PtgNum":o.push(String(P[1]));break;case"PtgStr":o.push('"'+P[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(P[1]);break;case"PtgAreaN":p=E2(P[1][1],t?{s:t}:i,a),o.push(im(p,a));break;case"PtgArea":p=E2(P[1][1],i,a),o.push(im(p,a));break;case"PtgArea3d":d=P[1][1],p=P[1][2],y=K2(n,d,a),o.push(y+"!"+im(p,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=P[1][2];var I=(n.names||[])[g-1]||(n[0]||[])[g],N=I?I.Name:"SH33TJSNAME"+String(g);N&&N.slice(0,6)=="_xlfn."&&!a.xlfn&&(N=N.slice(6)),o.push(N);break;case"PtgNameX":var F=P[1][1];g=P[1][2];var j;if(a.biff<=5)F<0&&(F=-F),n[F]&&(j=n[F][g]);else{var S="";if(((n[F]||[])[0]||[])[0]==14849||(((n[F]||[])[0]||[])[0]==1025?n[F][g]&&n[F][g].itab>0&&(S=n.SheetNames[n[F][g].itab-1]+"!"):S=n.SheetNames[g-1]+"!"),n[F]&&n[F][g])S+=n[F][g].Name;else if(n[0]&&n[0][g])S+=n[0][g].Name;else{var A=(X_(n,F,a)||"").split(";;");A[g-1]?S=A[g-1]:S+="SH33TJSERRX"}o.push(S);break}j||(j={Name:"SH33TJSERRY"}),o.push(j.Name);break;case"PtgParen":var C="(",J=")";if(v>=0){switch(w="",r[0][v][1][0]){case 2:C=ln(" ",r[0][v][1][1])+C;break;case 3:C=ln("\r",r[0][v][1][1])+C;break;case 4:J=ln(" ",r[0][v][1][1])+J;break;case 5:J=ln("\r",r[0][v][1][1])+J;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][v][1][0])}v=-1}o.push(C+o.pop()+J);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:P[1][1],r:P[1][0]};var ue={c:t.c,r:t.r};if(n.sharedf[qt(u)]){var me=n.sharedf[qt(u)];o.push(ua(me,i,ue,n,a))}else{var pe=!1;for(c=0;c!=n.arrayf.length;++c)if(l=n.arrayf[c],!(u.c<l[0].s.c||u.c>l[0].e.c)&&!(u.r<l[0].s.r||u.r>l[0].e.r)){o.push(ua(l[1],i,ue,n,a)),pe=!0;break}pe||o.push(P[1])}break;case"PtgArray":o.push("{"+AF(P[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=E;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+P[1].idx+"[#"+P[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(P));default:throw new Error("Unrecognized Formula Token: "+String(P))}var ge=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&v>=0&&ge.indexOf(r[0][E][0])==-1){P=r[0][v];var ne=!0;switch(P[1][0]){case 4:ne=!1;case 0:w=ln(" ",P[1][1]);break;case 5:ne=!1;case 1:w=ln("\r",P[1][1]);break;default:if(w="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+P[1][0])}o.push((ne?w:"")+o.pop()+(ne?"":w)),v=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function kF(r,e,t){var n=r.l+e,a=t.biff==2?1:2,s,i=r.read_shift(a);if(i==65535)return[[],ga(r,e-2)];var o=c0(r,i,t);return e!==i+a&&(s=o0(r,e-i-a,o,t)),r.l=n,[o,s]}function IF(r,e,t){var n=r.l+e,a=t.biff==2?1:2,s,i=r.read_shift(a);if(i==65535)return[[],ga(r,e-2)];var o=c0(r,i,t);return e!==i+a&&(s=o0(r,e-i-a,o,t)),r.l=n,[o,s]}function CF(r,e,t,n){var a=r.l+e,s=c0(r,n,t),i;return a!==r.l&&(i=o0(r,a-r.l,s,t)),[s,i]}function PF(r,e,t){var n=r.l+e,a,s=r.read_shift(2),i=c0(r,s,t);return s==65535?[[],ga(r,e-2)]:(e!==s+2&&(a=o0(r,n-s-2,i,t)),[i,a])}function FF(r){var e;if(Mi(r,r.l+6)!==65535)return[da(r),"n"];switch(r[r.l]){case 0:return r.l+=8,["String","s"];case 1:return e=r[r.l+2]===1,r.l+=8,[e,"b"];case 2:return e=r[r.l+2],r.l+=8,[e,"e"];case 3:return r.l+=8,["","s"]}return[]}function RF(r){if(r==null){var e=Ue(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof r=="number")return $c(r);return $c(0)}function hm(r,e,t){var n=r.l+e,a=yi(r);t.biff==2&&++r.l;var s=FF(r),i=r.read_shift(1);t.biff!=2&&(r.read_shift(1),t.biff>=5&&r.read_shift(4));var o=IF(r,n-r.l,t);return{cell:a,val:s[0],formula:o,shared:i>>3&1,tt:s[1]}}function DF(r,e,t,n,a){var s=Xc(e,t,a),i=RF(r.v),o=Ue(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var l=Ue(r.bf.length),u=0;u<r.bf.length;++u)l[u]=r.bf[u];var d=qn([s,i,o,l]);return d}function Sd(r,e,t){var n=r.read_shift(4),a=c0(r,n,t),s=r.read_shift(4),i=s>0?o0(r,s,a,t):null;return[a,i]}var LF=Sd,Ad=Sd,jF=Sd,OF=Sd,MF={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Y_={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},BF={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function X2(r){return r.slice(0,3)=="of:"&&(r=r.slice(3)),r.charCodeAt(0)==61&&(r=r.slice(1),r.charCodeAt(0)==61&&(r=r.slice(1))),r=r.replace(/COM\.MICROSOFT\./g,""),r=r.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,t){return t.replace(/\./g,"")}),r=r.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),r.replace(/[;~]/g,",").replace(/\|/g,";")}function VF(r){var e="of:="+r.replace(U1,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function fm(r){var e=r.split(":"),t=e[0].split(".")[0];return[t,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function UF(r){return r.replace(/\./,"!")}var mh={},Zl={},ph=typeof Map<"u";function W1(r,e,t){var n=0,a=r.length;if(t){if(ph?t.has(e):Object.prototype.hasOwnProperty.call(t,e)){for(var s=ph?t.get(e):t[e];n<s.length;++n)if(r[s[n]].t===e)return r.Count++,s[n]}}else for(;n<a;++n)if(r[n].t===e)return r.Count++,n;return r[a]={t:e},r.Count++,r.Unique++,t&&(ph?(t.has(e)||t.set(e,[]),t.get(e).push(a)):(Object.prototype.hasOwnProperty.call(t,e)||(t[e]=[]),t[e].push(a))),a}function Nd(r,e){var t={min:r+1,max:r+1},n=-1;return e.MDW&&(ha=e.MDW),e.width!=null?t.customWidth=1:e.wpx!=null?n=Bh(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(t.width=Hf(n),t.customWidth=1):e.width!=null&&(t.width=e.width),e.hidden&&(t.hidden=!0),e.level!=null&&(t.outlineLevel=t.level=e.level),t}function Dc(r,e){if(r){var t=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(t=[1,1,1,1,.5,.5]),r.left==null&&(r.left=t[0]),r.right==null&&(r.right=t[1]),r.top==null&&(r.top=t[2]),r.bottom==null&&(r.bottom=t[3]),r.header==null&&(r.header=t[4]),r.footer==null&&(r.footer=t[5])}}function Zo(r,e,t){var n=t.revssf[e.z!=null?e.z:"General"],a=60,s=r.length;if(n==null&&t.ssf){for(;a<392;++a)if(t.ssf[a]==null){Vi(e.z,a),t.ssf[a]=e.z,t.revssf[e.z]=n=a;break}}for(a=0;a!=s;++a)if(r[a].numFmtId===n)return a;return r[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function J_(r,e,t,n,a,s){try{n.cellNF&&(r.z=Mt[e])}catch(o){if(n.WTF)throw o}if(!(r.t==="z"&&!n.cellStyles)){if(r.t==="d"&&typeof r.v=="string"&&(r.v=Gr(r.v)),(!n||n.cellText!==!1)&&r.t!=="z")try{if(Mt[e]==null&&Vi(MT[e]||"General",e),r.t==="e")r.w=r.w||Xi[r.v];else if(e===0)if(r.t==="n")(r.v|0)===r.v?r.w=r.v.toString(10):r.w=Fh(r.v);else if(r.t==="d"){var i=Rn(r.v);(i|0)===i?r.w=i.toString(10):r.w=Fh(i)}else{if(r.v===void 0)return"";r.w=Hc(r.v,Zl)}else r.t==="d"?r.w=ks(e,Rn(r.v),Zl):r.w=ks(e,r.v,Zl)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&t!=null)try{r.s=s.Fills[t],r.s.fgColor&&r.s.fgColor.theme&&!r.s.fgColor.rgb&&(r.s.fgColor.rgb=Wf(a.themeElements.clrScheme[r.s.fgColor.theme].rgb,r.s.fgColor.tint||0),n.WTF&&(r.s.fgColor.raw_rgb=a.themeElements.clrScheme[r.s.fgColor.theme].rgb)),r.s.bgColor&&r.s.bgColor.theme&&(r.s.bgColor.rgb=Wf(a.themeElements.clrScheme[r.s.bgColor.theme].rgb,r.s.bgColor.tint||0),n.WTF&&(r.s.bgColor.raw_rgb=a.themeElements.clrScheme[r.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function qF(r,e,t){if(r&&r["!ref"]){var n=pr(r["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+t+"): "+r["!ref"])}}function zF(r,e){var t=pr(e);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(r["!ref"]=Jt(t))}var WF=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,HF=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,GF=/<(?:\w:)?hyperlink [^>]*>/mg,$F=/"(\w*:\w*)"/,KF=/<(?:\w:)?col\b[^>]*[\/]?>/g,XF=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,YF=/<(?:\w:)?pageMargins[^>]*\/>/g,Q_=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,JF=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,QF=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function ZF(r,e,t,n,a,s,i){if(!r)return r;n||(n={"!id":{}});var o=e.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},l="",u="",d=r.match(HF);d?(l=r.slice(0,d.index),u=r.slice(d.index+d[0].length)):l=u=r;var g=l.match(Q_);g?H1(g[0],o,a,t):(g=l.match(JF))&&t7(g[0],g[1]||"",o,a,t);var p=(l.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var y=l.slice(p,p+50).match($F);y&&zF(o,y[1])}var v=l.match(QF);v&&v[1]&&m7(v[1],a);var w=[];if(e.cellStyles){var E=l.match(KF);E&&l7(w,E)}d&&x7(d[1],o,e,c,s,i);var R=u.match(XF);R&&(o["!autofilter"]=h7(R[0]));var P=[],q=u.match(WF);if(q)for(p=0;p!=q.length;++p)P[p]=pr(q[p].slice(q[p].indexOf('"')+1));var z=u.match(GF);z&&i7(o,z,n);var K=u.match(YF);if(K&&(o["!margins"]=o7(Wt(K[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=Jt(c)),e.sheetRows>0&&o["!ref"]){var I=pr(o["!ref"]);e.sheetRows<=+I.e.r&&(I.e.r=e.sheetRows-1,I.e.r>c.e.r&&(I.e.r=c.e.r),I.e.r<I.s.r&&(I.s.r=I.e.r),I.e.c>c.e.c&&(I.e.c=c.e.c),I.e.c<I.s.c&&(I.s.c=I.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Jt(I))}return w.length>0&&(o["!cols"]=w),P.length>0&&(o["!merges"]=P),o}function e7(r){if(r.length===0)return"";for(var e='<mergeCells count="'+r.length+'">',t=0;t!=r.length;++t)e+='<mergeCell ref="'+Jt(r[t])+'"/>';return e+"</mergeCells>"}function H1(r,e,t,n){var a=Wt(r);t.Sheets[n]||(t.Sheets[n]={}),a.codeName&&(t.Sheets[n].CodeName=mr(Lr(a.codeName)))}function t7(r,e,t,n,a){H1(r.slice(0,r.indexOf(">")),t,n,a)}function r7(r,e,t,n,a){var s=!1,i={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var c=e.SheetNames[t];try{e.Workbook&&(c=e.Workbook.Sheets[t].CodeName||c)}catch{}s=!0,i.codeName=hi(Tr(c))}if(r&&r["!outline"]){var l={summaryBelow:1,summaryRight:1};r["!outline"].above&&(l.summaryBelow=0),r["!outline"].left&&(l.summaryRight=0),o=(o||"")+ct("outlinePr",null,l)}!s&&!o||(a[a.length]=ct("sheetPr",o,i))}var n7=["objects","scenarios","selectLockedCells","selectUnlockedCells"],a7=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function s7(r){var e={sheet:1};return n7.forEach(function(t){r[t]!=null&&r[t]&&(e[t]="1")}),a7.forEach(function(t){r[t]!=null&&!r[t]&&(e[t]="0")}),r.password&&(e.password=M1(r.password).toString(16).toUpperCase()),ct("sheetProtection",null,e)}function i7(r,e,t){for(var n=Array.isArray(r),a=0;a!=e.length;++a){var s=Wt(Lr(e[a]),!0);if(!s.ref)return;var i=((t||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+mr(s.location))):(s.Target="#"+mr(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=pr(s.ref),c=o.s.r;c<=o.e.r;++c)for(var l=o.s.c;l<=o.e.c;++l){var u=qt({c:l,r:c});n?(r[c]||(r[c]=[]),r[c][l]||(r[c][l]={t:"z",v:void 0}),r[c][l].l=s):(r[u]||(r[u]={t:"z",v:void 0}),r[u].l=s)}}}function o7(r){var e={};return["left","right","top","bottom","header","footer"].forEach(function(t){r[t]&&(e[t]=parseFloat(r[t]))}),e}function c7(r){return Dc(r),ct("pageMargins",null,r)}function l7(r,e){for(var t=!1,n=0;n!=e.length;++n){var a=Wt(e[n],!0);a.hidden&&(a.hidden=Wr(a.hidden));var s=parseInt(a.min,10)-1,i=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!t&&a.width&&(t=!0,B1(a.width)),Wo(a);s<=i;)r[s++]=$r(a)}}function u7(r,e){for(var t=["<cols>"],n,a=0;a!=e.length;++a)(n=e[a])&&(t[t.length]=ct("col",null,Nd(a,n)));return t[t.length]="</cols>",t.join("")}function h7(r){var e={ref:(r.match(/ref="([^"]*)"/)||[])[1]};return e}function f7(r,e,t,n){var a=typeof r.ref=="string"?r.ref:Jt(r.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var s=t.Workbook.Names,i=za(a);i.s.r==i.e.r&&(i.e.r=za(e["!ref"]).e.r,a=Jt(i));for(var o=0;o<s.length;++o){var c=s[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+t.SheetNames[n]+"'!"+a;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+a}),ct("autoFilter",null,{ref:a})}var d7=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function m7(r,e){e.Views||(e.Views=[{}]),(r.match(d7)||[]).forEach(function(t,n){var a=Wt(t);e.Views[n]||(e.Views[n]={}),+a.zoomScale&&(e.Views[n].zoom=+a.zoomScale),Wr(a.rightToLeft)&&(e.Views[n].RTL=!0)})}function p7(r,e,t,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),ct("sheetViews",ct("sheetView",null,a),{})}function g7(r,e,t,n){if(r.c&&t["!comments"].push([e,r.c]),r.v===void 0&&typeof r.f!="string"||r.t==="z"&&!r.f)return"";var a="",s=r.t,i=r.v;if(r.t!=="z")switch(r.t){case"b":a=r.v?"1":"0";break;case"n":a=""+r.v;break;case"e":a=Xi[r.v];break;case"d":n&&n.cellDates?a=Gr(r.v,-1).toISOString():(r=$r(r),r.t="n",a=""+(r.v=Rn(Gr(r.v)))),typeof r.z>"u"&&(r.z=Mt[14]);break;default:a=r.v;break}var o=Zn("v",Tr(a)),c={r:e},l=Zo(n.cellXfs,r,n);switch(l!==0&&(c.s=l),r.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(r.v==null){delete r.t;break}if(r.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Zn("v",""+W1(n.Strings,r.v,n.revStrings)),c.t="s";break}c.t="str";break}if(r.t!=s&&(r.t=s,r.v=i),typeof r.f=="string"&&r.f){var u=r.F&&r.F.slice(0,e.length)==e?{t:"array",ref:r.F}:null;o=ct("f",Tr(r.f),u)+(r.v!=null?o:"")}return r.l&&t["!links"].push([e,r.l]),r.D&&(c.cm=1),ct("c",o,c)}var x7=function(){var r=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=Rh("v"),i=Rh("f");return function(c,l,u,d,g,p){for(var y=0,v="",w=[],E=[],R=0,P=0,q=0,z="",K,I,N=0,F=0,j,S,A=0,C=0,J=Array.isArray(p.CellXf),ue,me=[],pe=[],ge=Array.isArray(l),ne=[],we={},Oe=!1,k=!!u.sheetStubs,O=c.split(e),M=0,U=O.length;M!=U;++M){v=O[M].trim();var ee=v.length;if(ee!==0){var he=0;e:for(y=0;y<ee;++y)switch(v[y]){case">":if(v[y-1]!="/"){++y;break e}if(u&&u.cellStyles){if(I=Wt(v.slice(he,y),!0),N=I.r!=null?parseInt(I.r,10):N+1,F=-1,u.sheetRows&&u.sheetRows<N)continue;we={},Oe=!1,I.ht&&(Oe=!0,we.hpt=parseFloat(I.ht),we.hpx=pu(we.hpt)),I.hidden=="1"&&(Oe=!0,we.hidden=!0),I.outlineLevel!=null&&(Oe=!0,we.level=+I.outlineLevel),Oe&&(ne[N-1]=we)}break;case"<":he=y;break}if(he>=y)break;if(I=Wt(v.slice(he,y),!0),N=I.r!=null?parseInt(I.r,10):N+1,F=-1,!(u.sheetRows&&u.sheetRows<N)){d.s.r>N-1&&(d.s.r=N-1),d.e.r<N-1&&(d.e.r=N-1),u&&u.cellStyles&&(we={},Oe=!1,I.ht&&(Oe=!0,we.hpt=parseFloat(I.ht),we.hpx=pu(we.hpt)),I.hidden=="1"&&(Oe=!0,we.hidden=!0),I.outlineLevel!=null&&(Oe=!0,we.level=+I.outlineLevel),Oe&&(ne[N-1]=we)),w=v.slice(y).split(r);for(var de=0;de!=w.length&&w[de].trim().charAt(0)=="<";++de);for(w=w.slice(de),y=0;y!=w.length;++y)if(v=w[y].trim(),v.length!==0){if(E=v.match(t),R=y,P=0,q=0,v="<c "+(v.slice(0,1)=="<"?">":"")+v,E!=null&&E.length===2){for(R=0,z=E[1],P=0;P!=z.length&&!((q=z.charCodeAt(P)-64)<1||q>26);++P)R=26*R+q;--R,F=R}else++F;for(P=0;P!=v.length&&v.charCodeAt(P)!==62;++P);if(++P,I=Wt(v.slice(0,P),!0),I.r||(I.r=qt({r:N-1,c:F})),z=v.slice(P),K={t:""},(E=z.match(s))!=null&&E[1]!==""&&(K.v=mr(E[1])),u.cellFormula){if((E=z.match(i))!=null&&E[1]!==""){if(K.f=mr(Lr(E[1])).replace(/\r\n/g,`
`),u.xlfn||(K.f=H2(K.f)),E[0].indexOf('t="array"')>-1)K.F=(z.match(a)||[])[1],K.F.indexOf(":")>-1&&me.push([pr(K.F),K.F]);else if(E[0].indexOf('t="shared"')>-1){S=Wt(E[0]);var fe=mr(Lr(E[1]));u.xlfn||(fe=H2(fe)),pe[parseInt(S.si,10)]=[S,fe,I.r]}}else(E=z.match(/<f[^>]*\/>/))&&(S=Wt(E[0]),pe[S.si]&&(K.f=dP(pe[S.si][1],pe[S.si][2],I.r)));var be=en(I.r);for(P=0;P<me.length;++P)be.r>=me[P][0].s.r&&be.r<=me[P][0].e.r&&be.c>=me[P][0].s.c&&be.c<=me[P][0].e.c&&(K.F=me[P][1])}if(I.t==null&&K.v===void 0)if(K.f||K.F)K.v=0,K.t="n";else if(k)K.t="z";else continue;else K.t=I.t||"n";switch(d.s.c>F&&(d.s.c=F),d.e.c<F&&(d.e.c=F),K.t){case"n":if(K.v==""||K.v==null){if(!k)continue;K.t="z"}else K.v=parseFloat(K.v);break;case"s":if(typeof K.v>"u"){if(!k)continue;K.t="z"}else j=mh[parseInt(K.v,10)],K.v=j.t,K.r=j.r,u.cellHTML&&(K.h=j.h);break;case"str":K.t="s",K.v=K.v!=null?Lr(K.v):"",u.cellHTML&&(K.h=E1(K.v));break;case"inlineStr":E=z.match(n),K.t="s",E!=null&&(j=O1(E[1]))?(K.v=j.t,u.cellHTML&&(K.h=j.h)):K.v="";break;case"b":K.v=Wr(K.v);break;case"d":u.cellDates?K.v=Gr(K.v,1):(K.v=Rn(Gr(K.v,1)),K.t="n");break;case"e":(!u||u.cellText!==!1)&&(K.w=K.v),K.v=e_[K.v];break}if(A=C=0,ue=null,J&&I.s!==void 0&&(ue=p.CellXf[I.s],ue!=null&&(ue.numFmtId!=null&&(A=ue.numFmtId),u.cellStyles&&ue.fillId!=null&&(C=ue.fillId))),J_(K,A,C,u,g,p),u.cellDates&&J&&K.t=="n"&&_u(Mt[A])&&(K.t="d",K.v=bd(K.v)),I.cm&&u.xlmeta){var Me=(u.xlmeta.Cell||[])[+I.cm-1];Me&&Me.type=="XLDAPR"&&(K.D=!0)}if(ge){var Z=en(I.r);l[Z.r]||(l[Z.r]=[]),l[Z.r][Z.c]=K}else l[I.r]=K}}}}ne.length>0&&(l["!rows"]=ne)}}();function v7(r,e,t,n){var a=[],s=[],i=pr(r["!ref"]),o="",c,l="",u=[],d=0,g=0,p=r["!rows"],y=Array.isArray(r),v={r:l},w,E=-1;for(g=i.s.c;g<=i.e.c;++g)u[g]=Zr(g);for(d=i.s.r;d<=i.e.r;++d){for(s=[],l=yn(d),g=i.s.c;g<=i.e.c;++g){c=u[g]+l;var R=y?(r[d]||[])[g]:r[c];R!==void 0&&(o=g7(R,c,r,e))!=null&&s.push(o)}(s.length>0||p&&p[d])&&(v={r:l},p&&p[d]&&(w=p[d],w.hidden&&(v.hidden=1),E=-1,w.hpx?E=Vh(w.hpx):w.hpt&&(E=w.hpt),E>-1&&(v.ht=E,v.customHeight=1),w.level&&(v.outlineLevel=w.level)),a[a.length]=ct("row",s.join(""),v))}if(p)for(;d<p.length;++d)p&&p[d]&&(v={r:d+1},w=p[d],w.hidden&&(v.hidden=1),E=-1,w.hpx?E=Vh(w.hpx):w.hpt&&(E=w.hpt),E>-1&&(v.ht=E,v.customHeight=1),w.level&&(v.outlineLevel=w.level),a[a.length]=ct("row","",v));return a.join("")}function Z_(r,e,t,n){var a=[wn,ct("worksheet",null,{xmlns:tl[0],"xmlns:r":Fn.r})],s=t.SheetNames[r],i=0,o="",c=t.Sheets[s];c==null&&(c={});var l=c["!ref"]||"A1",u=pr(l);if(u.e.c>16383||u.e.r>1048575){if(e.WTF)throw new Error("Range "+l+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),l=Jt(u)}n||(n={}),c["!comments"]=[];var d=[];r7(c,t,r,e,a),a[a.length]=ct("dimension",null,{ref:l}),a[a.length]=p7(c,e,r,t),e.sheetFormat&&(a[a.length]=ct("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(a[a.length]=u7(c,c["!cols"])),a[i=a.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=v7(c,e),o.length>0&&(a[a.length]=o)),a.length>i+1&&(a[a.length]="</sheetData>",a[i]=a[i].replace("/>",">")),c["!protect"]&&(a[a.length]=s7(c["!protect"])),c["!autofilter"]!=null&&(a[a.length]=f7(c["!autofilter"],c,t,r)),c["!merges"]!=null&&c["!merges"].length>0&&(a[a.length]=e7(c["!merges"]));var g=-1,p,y=-1;return c["!links"].length>0&&(a[a.length]="<hyperlinks>",c["!links"].forEach(function(v){v[1].Target&&(p={ref:v[0]},v[1].Target.charAt(0)!="#"&&(y=Ar(n,-1,Tr(v[1].Target).replace(/#.*$/,""),tr.HLINK),p["r:id"]="rId"+y),(g=v[1].Target.indexOf("#"))>-1&&(p.location=Tr(v[1].Target.slice(g+1))),v[1].Tooltip&&(p.tooltip=Tr(v[1].Tooltip)),a[a.length]=ct("hyperlink",null,p))}),a[a.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(a[a.length]=c7(c["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(a[a.length]=Zn("ignoredErrors",ct("ignoredError",null,{numberStoredAsText:1,sqref:l}))),d.length>0&&(y=Ar(n,-1,"../drawings/drawing"+(r+1)+".xml",tr.DRAW),a[a.length]=ct("drawing",null,{"r:id":"rId"+y}),c["!drawing"]=d),c["!comments"].length>0&&(y=Ar(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",tr.VML),a[a.length]=ct("legacyDrawing",null,{"r:id":"rId"+y}),c["!legacy"]=y),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function y7(r,e){var t={},n=r.l+e;t.r=r.read_shift(4),r.l+=4;var a=r.read_shift(2);r.l+=1;var s=r.read_shift(1);return r.l=n,s&7&&(t.level=s&7),s&16&&(t.hidden=!0),s&32&&(t.hpt=a/20),t}function w7(r,e,t){var n=Ue(145),a=(t["!rows"]||[])[r]||{};n.write_shift(4,r),n.write_shift(4,0);var s=320;a.hpx?s=Vh(a.hpx)*20:a.hpt&&(s=a.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var i=0;a.level&&(i|=a.level),a.hidden&&(i|=16),(a.hpx||a.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var l={r,c:0},u=0;u<16;++u)if(!(e.s.c>u+1<<10||e.e.c<u<<10)){for(var d=-1,g=-1,p=u<<10;p<u+1<<10;++p){l.c=p;var y=Array.isArray(t)?(t[l.r]||[])[l.c]:t[qt(l)];y&&(d<0&&(d=p),g=p)}d<0||(++o,n.write_shift(4,d),n.write_shift(4,g))}var v=n.l;return n.l=c,n.write_shift(4,o),n.l=v,n.length>n.l?n.slice(0,n.l):n}function _7(r,e,t,n){var a=w7(n,t,e);(a.length>17||(e["!rows"]||[])[n])&&Ke(r,0,a)}var b7=sl,E7=Su;function S7(){}function A7(r,e){var t={},n=r[r.l];return++r.l,t.above=!(n&64),t.left=!(n&128),r.l+=18,t.name=k6(r),t}function N7(r,e,t){t==null&&(t=Ue(84+4*r.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),t.write_shift(1,n);for(var a=1;a<3;++a)t.write_shift(1,0);return Uf({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),Xw(r,t),t.slice(0,t.l)}function T7(r){var e=Is(r);return[e]}function k7(r,e,t){return t==null&&(t=Ue(8)),rl(e,t)}function I7(r){var e=nl(r);return[e]}function C7(r,e,t){return t==null&&(t=Ue(4)),al(e,t)}function P7(r){var e=Is(r),t=r.read_shift(1);return[e,t,"b"]}function F7(r,e,t){return t==null&&(t=Ue(9)),rl(e,t),t.write_shift(1,r.v?1:0),t}function R7(r){var e=nl(r),t=r.read_shift(1);return[e,t,"b"]}function D7(r,e,t){return t==null&&(t=Ue(5)),al(e,t),t.write_shift(1,r.v?1:0),t}function L7(r){var e=Is(r),t=r.read_shift(1);return[e,t,"e"]}function j7(r,e,t){return t==null&&(t=Ue(9)),rl(e,t),t.write_shift(1,r.v),t}function O7(r){var e=nl(r),t=r.read_shift(1);return[e,t,"e"]}function M7(r,e,t){return t==null&&(t=Ue(8)),al(e,t),t.write_shift(1,r.v),t.write_shift(2,0),t.write_shift(1,0),t}function B7(r){var e=Is(r),t=r.read_shift(4);return[e,t,"s"]}function V7(r,e,t){return t==null&&(t=Ue(12)),rl(e,t),t.write_shift(4,e.v),t}function U7(r){var e=nl(r),t=r.read_shift(4);return[e,t,"s"]}function q7(r,e,t){return t==null&&(t=Ue(8)),al(e,t),t.write_shift(4,e.v),t}function z7(r){var e=Is(r),t=da(r);return[e,t,"n"]}function W7(r,e,t){return t==null&&(t=Ue(16)),rl(e,t),$c(r.v,t),t}function eb(r){var e=nl(r),t=da(r);return[e,t,"n"]}function H7(r,e,t){return t==null&&(t=Ue(12)),al(e,t),$c(r.v,t),t}function G7(r){var e=Is(r),t=F1(r);return[e,t,"n"]}function $7(r,e,t){return t==null&&(t=Ue(12)),rl(e,t),Yw(r.v,t),t}function K7(r){var e=nl(r),t=F1(r);return[e,t,"n"]}function X7(r,e,t){return t==null&&(t=Ue(8)),al(e,t),Yw(r.v,t),t}function Y7(r){var e=Is(r),t=I1(r);return[e,t,"is"]}function J7(r){var e=Is(r),t=pa(r);return[e,t,"str"]}function Q7(r,e,t){return t==null&&(t=Ue(12+4*r.v.length)),rl(e,t),zn(r.v,t),t.length>t.l?t.slice(0,t.l):t}function Z7(r){var e=nl(r),t=pa(r);return[e,t,"str"]}function eR(r,e,t){return t==null&&(t=Ue(8+4*r.v.length)),al(e,t),zn(r.v,t),t.length>t.l?t.slice(0,t.l):t}function tR(r,e,t){var n=r.l+e,a=Is(r);a.r=t["!row"];var s=r.read_shift(1),i=[a,s,"b"];if(t.cellFormula){r.l+=2;var o=Ad(r,n-r.l,t);i[3]=ua(o,null,a,t.supbooks,t)}else r.l=n;return i}function rR(r,e,t){var n=r.l+e,a=Is(r);a.r=t["!row"];var s=r.read_shift(1),i=[a,s,"e"];if(t.cellFormula){r.l+=2;var o=Ad(r,n-r.l,t);i[3]=ua(o,null,a,t.supbooks,t)}else r.l=n;return i}function nR(r,e,t){var n=r.l+e,a=Is(r);a.r=t["!row"];var s=da(r),i=[a,s,"n"];if(t.cellFormula){r.l+=2;var o=Ad(r,n-r.l,t);i[3]=ua(o,null,a,t.supbooks,t)}else r.l=n;return i}function aR(r,e,t){var n=r.l+e,a=Is(r);a.r=t["!row"];var s=pa(r),i=[a,s,"str"];if(t.cellFormula){r.l+=2;var o=Ad(r,n-r.l,t);i[3]=ua(o,null,a,t.supbooks,t)}else r.l=n;return i}var sR=sl,iR=Su;function oR(r,e){return e==null&&(e=Ue(4)),e.write_shift(4,r),e}function cR(r,e){var t=r.l+e,n=sl(r),a=C1(r),s=pa(r),i=pa(r),o=pa(r);r.l=t;var c={rfx:n,relId:a,loc:s,display:o};return i&&(c.Tooltip=i),c}function lR(r,e){var t=Ue(50+4*(r[1].Target.length+(r[1].Tooltip||"").length));Su({s:en(r[0]),e:en(r[0])},t),P1("rId"+e,t);var n=r[1].Target.indexOf("#"),a=n==-1?"":r[1].Target.slice(n+1);return zn(a||"",t),zn(r[1].Tooltip||"",t),zn("",t),t.slice(0,t.l)}function uR(){}function hR(r,e,t){var n=r.l+e,a=Jw(r),s=r.read_shift(1),i=[a];if(i[2]=s,t.cellFormula){var o=LF(r,n-r.l,t);i[1]=o}else r.l=n;return i}function fR(r,e,t){var n=r.l+e,a=sl(r),s=[a];if(t.cellFormula){var i=OF(r,n-r.l,t);s[1]=i,r.l=n}else r.l=n;return s}function dR(r,e,t){t==null&&(t=Ue(18));var n=Nd(r,e);t.write_shift(-4,r),t.write_shift(-4,r),t.write_shift(4,(n.width||10)*256),t.write_shift(4,0);var a=0;return e.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),e.level&&(a|=e.level<<8),t.write_shift(2,a),t}var tb=["left","right","top","bottom","header","footer"];function mR(r){var e={};return tb.forEach(function(t){e[t]=da(r)}),e}function pR(r,e){return e==null&&(e=Ue(6*8)),Dc(r),tb.forEach(function(t){$c(r[t],e)}),e}function gR(r){var e=r.read_shift(2);return r.l+=28,{RTL:e&32}}function xR(r,e,t){t==null&&(t=Ue(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function vR(r){var e=Ue(24);return e.write_shift(4,4),e.write_shift(4,1),Su(r,e),e}function yR(r,e){return e==null&&(e=Ue(16*4+2)),e.write_shift(2,r.password?M1(r.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?e.write_shift(4,r[t[0]]!=null&&!r[t[0]]?1:0):e.write_shift(4,r[t[0]]!=null&&r[t[0]]?0:1)}),e}function wR(){}function _R(){}function bR(r,e,t,n,a,s,i){if(!r)return r;var o=e||{};n||(n={"!id":{}});var c=o.dense?[]:{},l,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=!1,g=!1,p,y,v,w,E,R,P,q,z,K=[];o.biff=12,o["!row"]=0;var I=0,N=!1,F=[],j={},S=o.supbooks||a.supbooks||[[]];if(S.sharedf=j,S.arrayf=F,S.SheetNames=a.SheetNames||a.Sheets.map(function(ge){return ge.name}),!o.supbooks&&(o.supbooks=S,a.Names))for(var A=0;A<a.Names.length;++A)S[0][A+1]=a.Names[A];var C=[],J=[],ue=!1;Uh[16]={n:"BrtShortReal",f:eb};var me;if(Ki(r,function(ne,we,Oe){if(!g)switch(Oe){case 148:l=ne;break;case 0:p=ne,o.sheetRows&&o.sheetRows<=p.r&&(g=!0),q=yn(w=p.r),o["!row"]=p.r,(ne.hidden||ne.hpt||ne.level!=null)&&(ne.hpt&&(ne.hpx=pu(ne.hpt)),J[ne.r]=ne);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(y={t:ne[2]},ne[2]){case"n":y.v=ne[1];break;case"s":P=mh[ne[1]],y.v=P.t,y.r=P.r;break;case"b":y.v=!!ne[1];break;case"e":y.v=ne[1],o.cellText!==!1&&(y.w=Xi[y.v]);break;case"str":y.t="s",y.v=ne[1];break;case"is":y.t="s",y.v=ne[1].t;break}if((v=i.CellXf[ne[0].iStyleRef])&&J_(y,v.numFmtId,null,o,s,i),E=ne[0].c==-1?E+1:ne[0].c,o.dense?(c[w]||(c[w]=[]),c[w][E]=y):c[Zr(E)+q]=y,o.cellFormula){for(N=!1,I=0;I<F.length;++I){var k=F[I];p.r>=k[0].s.r&&p.r<=k[0].e.r&&E>=k[0].s.c&&E<=k[0].e.c&&(y.F=Jt(k[0]),N=!0)}!N&&ne.length>3&&(y.f=ne[3])}if(u.s.r>p.r&&(u.s.r=p.r),u.s.c>E&&(u.s.c=E),u.e.r<p.r&&(u.e.r=p.r),u.e.c<E&&(u.e.c=E),o.cellDates&&v&&y.t=="n"&&_u(Mt[v.numFmtId])){var O=kc(y.v);O&&(y.t="d",y.v=new Date(O.y,O.m-1,O.d,O.H,O.M,O.S,O.u))}me&&(me.type=="XLDAPR"&&(y.D=!0),me=void 0);break;case 1:case 12:if(!o.sheetStubs||d)break;y={t:"z",v:void 0},E=ne[0].c==-1?E+1:ne[0].c,o.dense?(c[w]||(c[w]=[]),c[w][E]=y):c[Zr(E)+q]=y,u.s.r>p.r&&(u.s.r=p.r),u.s.c>E&&(u.s.c=E),u.e.r<p.r&&(u.e.r=p.r),u.e.c<E&&(u.e.c=E),me&&(me.type=="XLDAPR"&&(y.D=!0),me=void 0);break;case 176:K.push(ne);break;case 49:me=((o.xlmeta||{}).Cell||[])[ne-1];break;case 494:var M=n["!id"][ne.relId];for(M?(ne.Target=M.Target,ne.loc&&(ne.Target+="#"+ne.loc),ne.Rel=M):ne.relId==""&&(ne.Target="#"+ne.loc),w=ne.rfx.s.r;w<=ne.rfx.e.r;++w)for(E=ne.rfx.s.c;E<=ne.rfx.e.c;++E)o.dense?(c[w]||(c[w]=[]),c[w][E]||(c[w][E]={t:"z",v:void 0}),c[w][E].l=ne):(R=qt({c:E,r:w}),c[R]||(c[R]={t:"z",v:void 0}),c[R].l=ne);break;case 426:if(!o.cellFormula)break;F.push(ne),z=o.dense?c[w][E]:c[Zr(E)+q],z.f=ua(ne[1],u,{r:p.r,c:E},S,o),z.F=Jt(ne[0]);break;case 427:if(!o.cellFormula)break;j[qt(ne[0].s)]=ne[1],z=o.dense?c[w][E]:c[Zr(E)+q],z.f=ua(ne[1],u,{r:p.r,c:E},S,o);break;case 60:if(!o.cellStyles)break;for(;ne.e>=ne.s;)C[ne.e--]={width:ne.w/256,hidden:!!(ne.flags&1),level:ne.level},ue||(ue=!0,B1(ne.w/256)),Wo(C[ne.e+1]);break;case 161:c["!autofilter"]={ref:Jt(ne)};break;case 476:c["!margins"]=ne;break;case 147:a.Sheets[t]||(a.Sheets[t]={}),ne.name&&(a.Sheets[t].CodeName=ne.name),(ne.above||ne.left)&&(c["!outline"]={above:ne.above,left:ne.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),ne.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:d=!0;break;case 38:d=!1;break;default:if(!we.T){if(!d||o.WTF)throw new Error("Unexpected record 0x"+Oe.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(u.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(c["!ref"]=Jt(l||u)),o.sheetRows&&c["!ref"]){var pe=pr(c["!ref"]);o.sheetRows<=+pe.e.r&&(pe.e.r=o.sheetRows-1,pe.e.r>u.e.r&&(pe.e.r=u.e.r),pe.e.r<pe.s.r&&(pe.s.r=pe.e.r),pe.e.c>u.e.c&&(pe.e.c=u.e.c),pe.e.c<pe.s.c&&(pe.s.c=pe.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Jt(pe))}return K.length>0&&(c["!merges"]=K),C.length>0&&(c["!cols"]=C),J.length>0&&(c["!rows"]=J),c}function ER(r,e,t,n,a,s,i){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=$r(e),e.z=e.z||Mt[14],e.v=Rn(Gr(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var c={r:t,c:n};switch(c.s=Zo(a.cellXfs,e,a),e.l&&s["!links"].push([qt(c),e.l]),e.c&&s["!comments"].push([qt(c),e.c]),e.t){case"s":case"str":return a.bookSST?(o=W1(a.Strings,e.v,a.revStrings),c.t="s",c.v=o,i?Ke(r,18,q7(e,c)):Ke(r,7,V7(e,c))):(c.t="str",i?Ke(r,17,eR(e,c)):Ke(r,6,Q7(e,c))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?i?Ke(r,13,X7(e,c)):Ke(r,2,$7(e,c)):i?Ke(r,16,H7(e,c)):Ke(r,5,W7(e,c)),!0;case"b":return c.t="b",i?Ke(r,15,D7(e,c)):Ke(r,4,F7(e,c)),!0;case"e":return c.t="e",i?Ke(r,14,M7(e,c)):Ke(r,3,j7(e,c)),!0}return i?Ke(r,12,C7(e,c)):Ke(r,1,k7(e,c)),!0}function SR(r,e,t,n){var a=pr(e["!ref"]||"A1"),s,i="",o=[];Ke(r,145);var c=Array.isArray(e),l=a.e.r;e["!rows"]&&(l=Math.max(a.e.r,e["!rows"].length-1));for(var u=a.s.r;u<=l;++u){i=yn(u),_7(r,e,a,u);var d=!1;if(u<=a.e.r)for(var g=a.s.c;g<=a.e.c;++g){u===a.s.r&&(o[g]=Zr(g)),s=o[g]+i;var p=c?(e[u]||[])[g]:e[s];if(!p){d=!1;continue}d=ER(r,p,u,g,n,e,d)}}Ke(r,146)}function AR(r,e){!e||!e["!merges"]||(Ke(r,177,oR(e["!merges"].length)),e["!merges"].forEach(function(t){Ke(r,176,iR(t))}),Ke(r,178))}function NR(r,e){!e||!e["!cols"]||(Ke(r,390),e["!cols"].forEach(function(t,n){t&&Ke(r,60,dR(n,t))}),Ke(r,391))}function TR(r,e){!e||!e["!ref"]||(Ke(r,648),Ke(r,649,vR(pr(e["!ref"]))),Ke(r,650))}function kR(r,e,t){e["!links"].forEach(function(n){if(n[1].Target){var a=Ar(t,-1,n[1].Target.replace(/#.*$/,""),tr.HLINK);Ke(r,494,lR(n,a))}}),delete e["!links"]}function IR(r,e,t,n){if(e["!comments"].length>0){var a=Ar(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",tr.VML);Ke(r,551,P1("rId"+a)),e["!legacy"]=a}}function CR(r,e,t,n){if(e["!autofilter"]){var a=e["!autofilter"],s=typeof a.ref=="string"?a.ref:Jt(a.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var i=t.Workbook.Names,o=za(s);o.s.r==o.e.r&&(o.e.r=za(e["!ref"]).e.r,s=Jt(o));for(var c=0;c<i.length;++c){var l=i[c];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+t.SheetNames[n]+"'!"+s;break}}c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+s}),Ke(r,161,Su(pr(s))),Ke(r,162)}}function PR(r,e,t){Ke(r,133),Ke(r,137,xR(e,t)),Ke(r,138),Ke(r,134)}function FR(r,e){e["!protect"]&&Ke(r,535,yR(e["!protect"]))}function RR(r,e,t,n){var a=qa(),s=t.SheetNames[r],i=t.Sheets[s]||{},o=s;try{t&&t.Workbook&&(o=t.Workbook.Sheets[r].CodeName||o)}catch{}var c=pr(i["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(e.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],Ke(a,129),(t.vbaraw||i["!outline"])&&Ke(a,147,N7(o,i["!outline"])),Ke(a,148,E7(c)),PR(a,i,t.Workbook),NR(a,i),SR(a,i,r,e),FR(a,i),CR(a,i,t,r),AR(a,i),kR(a,i,n),i["!margins"]&&Ke(a,476,pR(i["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&TR(a,i),IR(a,i,r,n),Ke(a,130),a.end()}function DR(r){var e=[],t=r.match(/^<c:numCache>/),n;(r.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var i=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(e[+i[1]]=t?+i[2]:i[2])});var a=mr((r.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(r.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,a,n]}function LR(r,e,t,n,a,s){var i=s||{"!type":"chart"};if(!r)return s;var o=0,c=0,l="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(r.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var g=DR(d);u.s.r=u.s.c=0,u.e.c=o,l=Zr(o),g[0].forEach(function(p,y){i[l+yn(y)]={t:"n",v:p,z:g[1]},c=y}),u.e.r<c&&(u.e.r=c),++o}),o>0&&(i["!ref"]=Jt(u)),i}function jR(r,e,t,n,a){if(!r)return r;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i,o=r.match(Q_);return o&&H1(o[0],s,a,t),(i=r.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=i[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function OR(r,e){r.l+=10;var t=pa(r);return{name:t}}function MR(r,e,t,n,a){if(!r)return r;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i=!1;return Ki(r,function(c,l,u){switch(u){case 550:s["!rel"]=c;break;case 651:a.Sheets[t]||(a.Sheets[t]={}),c.name&&(a.Sheets[t].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(l.T>0)){if(!(l.T<0)){if(!i||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var G1=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],BR=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],VR=[],UR=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Y2(r,e){for(var t=0;t!=r.length;++t)for(var n=r[t],a=0;a!=e.length;++a){var s=e[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=Wr(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function J2(r,e){for(var t=0;t!=e.length;++t){var n=e[t];if(r[n[0]]==null)r[n[0]]=n[1];else switch(n[2]){case"bool":typeof r[n[0]]=="string"&&(r[n[0]]=Wr(r[n[0]]));break;case"int":typeof r[n[0]]=="string"&&(r[n[0]]=parseInt(r[n[0]],10));break}}}function rb(r){J2(r.WBProps,G1),J2(r.CalcPr,UR),Y2(r.WBView,BR),Y2(r.Sheets,VR),Zl.date1904=Wr(r.WBProps.date1904)}function qR(r){return!r.Workbook||!r.Workbook.WBProps?"false":Wr(r.Workbook.WBProps.date1904)?"true":"false"}var zR="][*?/\\".split("");function nb(r,e){if(r.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return zR.forEach(function(n){if(r.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function WR(r,e,t){r.forEach(function(n,a){nb(n);for(var s=0;s<a;++s)if(n==r[s])throw new Error("Duplicate Sheet Name: "+n);if(t){var i=e&&e[a]&&e[a].CodeName||n;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function HR(r){if(!r||!r.SheetNames||!r.Sheets)throw new Error("Invalid Workbook");if(!r.SheetNames.length)throw new Error("Workbook is empty");var e=r.Workbook&&r.Workbook.Sheets||[];WR(r.SheetNames,e,!!r.vbaraw);for(var t=0;t<r.SheetNames.length;++t)qF(r.Sheets[r.SheetNames[t]],r.SheetNames[t],t)}var GR=/<\w+:workbook/;function $R(r,e){if(!r)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},i=0;if(r.replace(xa,function(c,l){var u=Wt(c);switch(vi(u[0])){case"<?xml":break;case"<workbook":c.match(GR)&&(a="xmlns"+c.match(/<(\w+):/)[1]),t.xmlns=u[a];break;case"</workbook>":break;case"<fileVersion":delete u[0],t.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":G1.forEach(function(d){if(u[d[0]]!=null)switch(d[2]){case"bool":t.WBProps[d[0]]=Wr(u[d[0]]);break;case"int":t.WBProps[d[0]]=parseInt(u[d[0]],10);break;default:t.WBProps[d[0]]=u[d[0]]}}),u.codeName&&(t.WBProps.CodeName=Lr(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],t.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=mr(Lr(u.name)),delete u[0],t.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=Lr(u.name),u.comment&&(s.Comment=u.comment),u.localSheetId&&(s.Sheet=+u.localSheetId),Wr(u.hidden||"0")&&(s.Hidden=!0),i=l+c.length;break;case"</definedName>":s.Ref=mr(Lr(r.slice(i,l))),t.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete u[0],t.CalcPr=u;break;case"<calcPr/>":delete u[0],t.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return c}),tl.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return rb(t),t}function ab(r){var e=[wn];e[e.length]=ct("workbook",null,{xmlns:tl[0],"xmlns:r":Fn.r});var t=r.Workbook&&(r.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};r.Workbook&&r.Workbook.WBProps&&(G1.forEach(function(o){r.Workbook.WBProps[o[0]]!=null&&r.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=r.Workbook.WBProps[o[0]])}),r.Workbook.WBProps.CodeName&&(n.codeName=r.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=ct("workbookPr",null,n);var a=r.Workbook&&r.Workbook.Sheets||[],s=0;if(a&&a[0]&&a[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=r.SheetNames.length&&!(!a[s]||!a[s].Hidden);++s);s==r.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=r.SheetNames.length;++s){var i={name:Tr(r.SheetNames[s].slice(0,31))};if(i.sheetId=""+(s+1),i["r:id"]="rId"+(s+1),a[s])switch(a[s].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}e[e.length]=ct("sheet",null,i)}return e[e.length]="</sheets>",t&&(e[e.length]="<definedNames>",r.Workbook&&r.Workbook.Names&&r.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(e[e.length]=ct("definedName",Tr(o.Ref),c))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function KR(r,e){var t={};return t.Hidden=r.read_shift(4),t.iTabID=r.read_shift(4),t.strRelID=np(r),t.name=pa(r),t}function XR(r,e){return e||(e=Ue(127)),e.write_shift(4,r.Hidden),e.write_shift(4,r.iTabID),P1(r.strRelID,e),zn(r.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function YR(r,e){var t={},n=r.read_shift(4);t.defaultThemeVersion=r.read_shift(4);var a=e>8?pa(r):"";return a.length>0&&(t.CodeName=a),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function JR(r,e){e||(e=Ue(72));var t=0;return r&&r.filterPrivacy&&(t|=8),e.write_shift(4,t),e.write_shift(4,0),Xw(r&&r.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function QR(r,e){var t={};return r.read_shift(4),t.ArchID=r.read_shift(4),r.l+=e-8,t}function ZR(r,e,t){var n=r.l+e;r.l+=4,r.l+=1;var a=r.read_shift(4),s=I6(r),i=jF(r,0,t),o=C1(r);r.l=n;var c={Name:s,Ptg:i};return a<268435455&&(c.Sheet=a),o&&(c.Comment=o),c}function eD(r,e){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;e||(e={}),e.biff=12;var s=[],i=[[]];return i.SheetNames=[],i.XTI=[],Uh[16]={n:"BrtFRTArchID$",f:QR},Ki(r,function(c,l,u){switch(u){case 156:i.SheetNames.push(c.name),t.Sheets.push(c);break;case 153:t.WBProps=c;break;case 39:c.Sheet!=null&&(e.SID=c.Sheet),c.Ref=ua(c.Ptg,null,null,i,e),delete e.SID,delete c.Ptg,s.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([u,c]):i[0]=[u,c],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(c),i.XTI=i.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(u),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!l.T){if(!a||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},e),rb(t),t.Names=s,t.supbooks=i,t}function tD(r,e){Ke(r,143);for(var t=0;t!=e.SheetNames.length;++t){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[t]&&e.Workbook.Sheets[t].Hidden||0,a={Hidden:n,iTabID:t+1,strRelID:"rId"+(t+1),name:e.SheetNames[t]};Ke(r,156,XR(a))}Ke(r,144)}function rD(r,e){e||(e=Ue(127));for(var t=0;t!=4;++t)e.write_shift(4,0);return zn("SheetJS",e),zn(Df.version,e),zn(Df.version,e),zn("7262",e),e.length>e.l?e.slice(0,e.l):e}function nD(r,e){e||(e=Ue(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,r),e.write_shift(4,r);var t=120;return e.write_shift(1,t),e.length>e.l?e.slice(0,e.l):e}function aD(r,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var t=e.Workbook.Sheets,n=0,a=-1,s=-1;n<t.length;++n)!t[n]||!t[n].Hidden&&a==-1?a=n:t[n].Hidden==1&&s==-1&&(s=n);s>a||(Ke(r,135),Ke(r,158,nD(a)),Ke(r,136))}}function sD(r,e){var t=qa();return Ke(t,131),Ke(t,128,rD()),Ke(t,153,JR(r.Workbook&&r.Workbook.WBProps||null)),aD(t,r),tD(t,r),Ke(t,132),t.end()}function iD(r,e,t){return e.slice(-4)===".bin"?eD(r,t):$R(r,t)}function oD(r,e,t,n,a,s,i,o){return e.slice(-4)===".bin"?bR(r,n,t,a,s,i,o):ZF(r,n,t,a,s,i,o)}function cD(r,e,t,n,a,s,i,o){return e.slice(-4)===".bin"?MR(r,n,t,a,s):jR(r,n,t,a,s)}function lD(r,e,t,n,a,s,i,o){return e.slice(-4)===".bin"?hP():fP()}function uD(r,e,t,n,a,s,i,o){return e.slice(-4)===".bin"?lP():uP()}function hD(r,e,t,n){return e.slice(-4)===".bin"?i8(r,t,n):KC(r,t,n)}function fD(r,e,t){return M_(r,t)}function dD(r,e,t){return e.slice(-4)===".bin"?dC(r,t):uC(r,t)}function mD(r,e,t){return e.slice(-4)===".bin"?aP(r,t):X8(r,t)}function pD(r,e,t){return e.slice(-4)===".bin"?G8(r):W8(r)}function gD(r,e,t,n){return t.slice(-4)===".bin"?$8(r,e,t,n):void 0}function xD(r,e,t){return e.slice(-4)===".bin"?U8(r,e,t):z8(r,e,t)}function vD(r,e,t){return(e.slice(-4)===".bin"?sD:ab)(r)}function yD(r,e,t,n,a){return(e.slice(-4)===".bin"?RR:Z_)(r,t,n,a)}function wD(r,e,t){return(e.slice(-4)===".bin"?g8:j_)(r,t)}function _D(r,e,t){return(e.slice(-4)===".bin"?gC:k_)(r,t)}function bD(r,e,t){return(e.slice(-4)===".bin"?sP:U_)(r)}function ED(r){return(r.slice(-4)===".bin"?q8:B_)()}var sb=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,ib=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Vs(r,e){var t=r.split(/\s+/),n=[];if(n[0]=t[0],t.length===1)return n;var a=r.match(sb),s,i,o,c;if(a)for(c=0;c!=a.length;++c)s=a[c].match(ib),(i=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(i+1),n[o]=s[2].slice(1,s[2].length-1));return n}function SD(r){var e=r.split(/\s+/),t={};if(e.length===1)return t;var n=r.match(sb),a,s,i,o;if(n)for(o=0;o!=n.length;++o)a=n[o].match(ib),(s=a[1].indexOf(":"))===-1?t[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?i="xmlns"+a[1].slice(6):i=a[1].slice(s+1),t[i]=a[2].slice(1,a[2].length-1));return t}var gh;function AD(r,e){var t=gh[r]||mr(r);return t==="General"?Hc(e):ks(t,e)}function ND(r,e,t,n){var a=n;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Wr(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=Gr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}r[mr(e)]=a}function TD(r,e,t){if(r.t!=="z"){if(!t||t.cellText!==!1)try{r.t==="e"?r.w=r.w||Xi[r.v]:e==="General"?r.t==="n"?(r.v|0)===r.v?r.w=r.v.toString(10):r.w=Fh(r.v):r.w=Hc(r.v):r.w=AD(e||"General",r.v)}catch(s){if(t.WTF)throw s}try{var n=gh[e]||e||"General";if(t.cellNF&&(r.z=n),t.cellDates&&r.t=="n"&&_u(n)){var a=kc(r.v);a&&(r.t="d",r.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(t.WTF)throw s}}}function kD(r,e,t){if(t.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=VC[n.Pattern]||n.Pattern)}r[e.ID]=e}function ID(r,e,t,n,a,s,i,o,c,l){var u="General",d=n.StyleID,g={};l=l||{};var p=[],y=0;for(d===void 0&&o&&(d=o.StyleID),d===void 0&&i&&(d=i.StyleID);s[d]!==void 0&&(s[d].nf&&(u=s[d].nf),s[d].Interior&&p.push(s[d].Interior),!!s[d].Parent);)d=s[d].Parent;switch(t.Type){case"Boolean":n.t="b",n.v=Wr(r);break;case"String":n.t="s",n.r=m2(mr(r)),n.v=r.indexOf("<")>-1?mr(e||r).replace(/<.*?>/g,""):n.r;break;case"DateTime":r.slice(-1)!="Z"&&(r+="Z"),n.v=(Gr(r)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=mr(r):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+r),n.t||(n.t="n");break;case"Error":n.t="e",n.v=e_[r],l.cellText!==!1&&(n.w=r);break;default:r==""&&e==""?n.t="z":(n.t="s",n.v=m2(e||r));break}if(TD(n,u,l),l.cellFormula!==!1)if(n.Formula){var v=mr(n.Formula);v.charCodeAt(0)==61&&(v=v.slice(1)),n.f=Ql(v,a),delete n.Formula,n.ArrayRange=="RC"?n.F=Ql("RC:RC",a):n.ArrayRange&&(n.F=Ql(n.ArrayRange,a),c.push([pr(n.F),n.F]))}else for(y=0;y<c.length;++y)a.r>=c[y][0].s.r&&a.r<=c[y][0].e.r&&a.c>=c[y][0].s.c&&a.c<=c[y][0].e.c&&(n.F=c[y][1]);l.cellStyles&&(p.forEach(function(w){!g.patternType&&w.patternType&&(g.patternType=w.patternType)}),n.s=g),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function CD(r){r.t=r.v||"",r.t=r.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.v=r.w=r.ixfe=void 0}function dm(r,e){var t=e||{};bu();var n=rh(S1(r));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(n=Lr(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var i=$r(t);return i.type="string",mu.to_workbook(n,i)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(lt){a.indexOf("<"+lt)>=0&&(s=!0)}),s)return pL(n,t);gh={"General Number":"General","General Date":Mt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Mt[15],"Short Date":Mt[14],"Long Time":Mt[19],"Medium Time":Mt[18],"Short Time":Mt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Mt[2],Standard:Mt[4],Percent:Mt[10],Scientific:Mt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],l,u={},d=[],g=t.dense?[]:{},p="",y={},v={},w=Vs('<Data ss:Type="String">'),E=0,R=0,P=0,q={s:{r:2e6,c:2e6},e:{r:0,c:0}},z={},K={},I="",N=0,F=[],j={},S={},A=0,C=[],J=[],ue={},me=[],pe,ge=!1,ne=[],we=[],Oe={},k=0,O=0,M={Sheets:[],WBProps:{date1904:!1}},U={};Lh.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ee="";o=Lh.exec(n);)switch(o[3]=(ee=o[3]).toLowerCase()){case"data":if(ee=="data"){if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?ID(n.slice(E,o.index),I,w,c[c.length-1][0]=="comment"?ue:y,{c:R,r:P},z,me[R],v,ne,t):(I="",w=Vs(o[0]),E=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(J.length>0&&(y.c=J),(!t.sheetRows||t.sheetRows>P)&&y.v!==void 0&&(t.dense?(g[P]||(g[P]=[]),g[P][R]=y):g[Zr(R)+yn(P)]=y),y.HRef&&(y.l={Target:mr(y.HRef)},y.HRefScreenTip&&(y.l.Tooltip=y.HRefScreenTip),delete y.HRef,delete y.HRefScreenTip),(y.MergeAcross||y.MergeDown)&&(k=R+(parseInt(y.MergeAcross,10)|0),O=P+(parseInt(y.MergeDown,10)|0),F.push({s:{c:R,r:P},e:{c:k,r:O}})),!t.sheetStubs)y.MergeAcross?R=k+1:++R;else if(y.MergeAcross||y.MergeDown){for(var he=R;he<=k;++he)for(var de=P;de<=O;++de)(he>R||de>P)&&(t.dense?(g[de]||(g[de]=[]),g[de][he]={t:"z"}):g[Zr(he)+yn(de)]={t:"z"});R=k+1}else++R;else y=SD(o[0]),y.Index&&(R=+y.Index-1),R<q.s.c&&(q.s.c=R),R>q.e.c&&(q.e.c=R),o[0].slice(-2)==="/>"&&++R,J=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(P<q.s.r&&(q.s.r=P),P>q.e.r&&(q.e.r=P),o[0].slice(-2)==="/>"&&(v=Vs(o[0]),v.Index&&(P=+v.Index-1)),R=0,++P):(v=Vs(o[0]),v.Index&&(P=+v.Index-1),Oe={},(v.AutoFitHeight=="0"||v.Height)&&(Oe.hpx=parseInt(v.Height,10),Oe.hpt=Vh(Oe.hpx),we[P]=Oe),v.Hidden=="1"&&(Oe.hidden=!0,we[P]=Oe));break;case"worksheet":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));d.push(p),q.s.r<=q.e.r&&q.s.c<=q.e.c&&(g["!ref"]=Jt(q),t.sheetRows&&t.sheetRows<=q.e.r&&(g["!fullref"]=g["!ref"],q.e.r=t.sheetRows-1,g["!ref"]=Jt(q))),F.length&&(g["!merges"]=F),me.length>0&&(g["!cols"]=me),we.length>0&&(g["!rows"]=we),u[p]=g}else q={s:{r:2e6,c:2e6},e:{r:0,c:0}},P=R=0,c.push([o[3],!1]),l=Vs(o[0]),p=mr(l.Name),g=t.dense?[]:{},F=[],ne=[],we=[],U={name:p,Hidden:0},M.Sheets.push(U);break;case"table":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),me=[],ge=!1}break;case"style":o[1]==="/"?kD(z,K,t):K=Vs(o[0]);break;case"numberformat":K.nf=mr(Vs(o[0]).Format||"General"),gh[K.nf]&&(K.nf=gh[K.nf]);for(var fe=0;fe!=392&&Mt[fe]!=K.nf;++fe);if(fe==392){for(fe=57;fe!=392;++fe)if(Mt[fe]==null){Vi(K.nf,fe);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(pe=Vs(o[0]),pe.Hidden&&(pe.hidden=!0,delete pe.Hidden),pe.Width&&(pe.wpx=parseInt(pe.Width,10)),!ge&&pe.wpx>10){ge=!0,ha=D_;for(var be=0;be<me.length;++be)me[be]&&Wo(me[be])}ge&&Wo(pe),me[pe.Index-1||me.length]=pe;for(var Me=0;Me<+pe.Span;++Me)me[me.length]=$r(pe);break;case"namedrange":if(o[1]==="/")break;M.Names||(M.Names=[]);var Z=Wt(o[0]),Xe={Name:Z.Name,Ref:Ql(Z.RefersTo.slice(1),{r:0,c:0})};M.Sheets.length>0&&(Xe.Sheet=M.Sheets.length-1),M.Names.push(Xe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?I+=n.slice(N,o.index):N=o.index+o[0].length;break;case"interior":if(!t.cellStyles)break;K.Interior=Vs(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?ek(j,ee,n.slice(A,o.index)):A=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));CD(ue),J.push(ue)}else c.push([o[3],!1]),l=Vs(o[0]),ue={a:l.Author};break;case"autofilter":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var st=Vs(o[0]);g["!autofilter"]={ref:Ql(st.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return rv(n,t);var Fe=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Fe=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Fe=!1}break;case"excelworkbook":switch(o[3]){case"date1904":M.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Fe=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Fe=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(A,o.index)){case"SheetHidden":U.Hidden=1;break;case"SheetVeryHidden":U.Hidden=2;break}else A=o.index+o[0].length;break;case"header":g["!margins"]||Dc(g["!margins"]={},"xlml"),isNaN(+Wt(o[0]).Margin)||(g["!margins"].header=+Wt(o[0]).Margin);break;case"footer":g["!margins"]||Dc(g["!margins"]={},"xlml"),isNaN(+Wt(o[0]).Margin)||(g["!margins"].footer=+Wt(o[0]).Margin);break;case"pagemargins":var se=Wt(o[0]);g["!margins"]||Dc(g["!margins"]={},"xlml"),isNaN(+se.Top)||(g["!margins"].top=+se.Top),isNaN(+se.Left)||(g["!margins"].left=+se.Left),isNaN(+se.Right)||(g["!margins"].right=+se.Right),isNaN(+se.Bottom)||(g["!margins"].bottom=+se.Bottom);break;case"displayrighttoleft":M.Views||(M.Views=[]),M.Views[0]||(M.Views[0]={}),M.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Fe=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Fe=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Fe=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Fe=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Fe=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Fe=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Fe=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Fe=!1}break;case"smarttags":break;default:Fe=!1;break}if(Fe||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?ND(S,ee,C,n.slice(A,o.index)):(C=o,A=o.index+o[0].length);break}if(t.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var qe={};return!t.bookSheets&&!t.bookProps&&(qe.Sheets=u),qe.SheetNames=d,qe.Workbook=M,qe.SSF=$r(Mt),qe.Props=j,qe.Custprops=S,qe}function up(r,e){switch(K1(e=e||{}),e.type||"base64"){case"base64":return dm(cs(r),e);case"binary":case"buffer":case"file":return dm(r,e);case"array":return dm(Jo(r),e)}}function PD(r,e){var t=[];return r.Props&&t.push(tk(r.Props,e)),r.Custprops&&t.push(rk(r.Props,r.Custprops)),t.join("")}function FD(){return""}function RD(r,e){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,a){var s=[];s.push(ct("NumberFormat",null,{"ss:Format":Tr(Mt[n.numFmtId])}));var i={"ss:ID":"s"+(21+a)};t.push(ct("Style",s.join(""),i))}),ct("Styles",t.join(""))}function ob(r){return ct("NamedRange",null,{"ss:Name":r.Name,"ss:RefersTo":"="+q1(r.Ref,{r:0,c:0})})}function DD(r){if(!((r||{}).Workbook||{}).Names)return"";for(var e=r.Workbook.Names,t=[],n=0;n<e.length;++n){var a=e[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||t.push(ob(a)))}return ct("Names",t.join(""))}function LD(r,e,t,n){if(!r||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,s=[],i=0;i<a.length;++i){var o=a[i];o.Sheet==t&&(o.Name.match(/^_xlfn\./)||s.push(ob(o)))}return s.join("")}function jD(r,e,t,n){if(!r)return"";var a=[];if(r["!margins"]&&(a.push("<PageSetup>"),r["!margins"].header&&a.push(ct("Header",null,{"x:Margin":r["!margins"].header})),r["!margins"].footer&&a.push(ct("Footer",null,{"x:Margin":r["!margins"].footer})),a.push(ct("PageMargins",null,{"x:Bottom":r["!margins"].bottom||"0.75","x:Left":r["!margins"].left||"0.7","x:Right":r["!margins"].right||"0.7","x:Top":r["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[t])if(n.Workbook.Sheets[t].Hidden)a.push(ct("Visible",n.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<t&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==t&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),r["!protect"]&&(a.push(Zn("ProtectContents","True")),r["!protect"].objects&&a.push(Zn("ProtectObjects","True")),r["!protect"].scenarios&&a.push(Zn("ProtectScenarios","True")),r["!protect"].selectLockedCells!=null&&!r["!protect"].selectLockedCells?a.push(Zn("EnableSelection","NoSelection")):r["!protect"].selectUnlockedCells!=null&&!r["!protect"].selectUnlockedCells&&a.push(Zn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){r["!protect"][i[0]]&&a.push("<"+i[1]+"/>")})),a.length==0?"":ct("WorksheetOptions",a.join(""),{xmlns:es.x})}function OD(r){return r.map(function(e){var t=a6(e.t||""),n=ct("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return ct("Comment",n,{"ss:Author":e.a})}).join("")}function MD(r,e,t,n,a,s,i){if(!r||r.v==null&&r.f==null)return"";var o={};if(r.f&&(o["ss:Formula"]="="+Tr(q1(r.f,i))),r.F&&r.F.slice(0,e.length)==e){var c=en(r.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==i.r?"":"["+(c.r-i.r)+"]")+"C"+(c.c==i.c?"":"["+(c.c-i.c)+"]")}if(r.l&&r.l.Target&&(o["ss:HRef"]=Tr(r.l.Target),r.l.Tooltip&&(o["x:HRefScreenTip"]=Tr(r.l.Tooltip))),t["!merges"])for(var l=t["!merges"],u=0;u!=l.length;++u)l[u].s.c!=i.c||l[u].s.r!=i.r||(l[u].e.c>l[u].s.c&&(o["ss:MergeAcross"]=l[u].e.c-l[u].s.c),l[u].e.r>l[u].s.r&&(o["ss:MergeDown"]=l[u].e.r-l[u].s.r));var d="",g="";switch(r.t){case"z":if(!n.sheetStubs)return"";break;case"n":d="Number",g=String(r.v);break;case"b":d="Boolean",g=r.v?"1":"0";break;case"e":d="Error",g=Xi[r.v];break;case"d":d="DateTime",g=new Date(r.v).toISOString(),r.z==null&&(r.z=r.z||Mt[14]);break;case"s":d="String",g=n6(r.v||"");break}var p=Zo(n.cellXfs,r,n);o["ss:StyleID"]="s"+(21+p),o["ss:Index"]=i.c+1;var y=r.v!=null?g:"",v=r.t=="z"?"":'<Data ss:Type="'+d+'">'+y+"</Data>";return(r.c||[]).length>0&&(v+=OD(r.c)),ct("Cell",v,o)}function BD(r,e){var t='<Row ss:Index="'+(r+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=pu(e.hpt)),e.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(t+=' ss:Hidden="1"')),t+">"}function VD(r,e,t,n){if(!r["!ref"])return"";var a=pr(r["!ref"]),s=r["!merges"]||[],i=0,o=[];r["!cols"]&&r["!cols"].forEach(function(w,E){Wo(w);var R=!!w.width,P=Nd(E,w),q={"ss:Index":E+1};R&&(q["ss:Width"]=Mh(P.width)),w.hidden&&(q["ss:Hidden"]="1"),o.push(ct("Column",null,q))});for(var c=Array.isArray(r),l=a.s.r;l<=a.e.r;++l){for(var u=[BD(l,(r["!rows"]||[])[l])],d=a.s.c;d<=a.e.c;++d){var g=!1;for(i=0;i!=s.length;++i)if(!(s[i].s.c>d)&&!(s[i].s.r>l)&&!(s[i].e.c<d)&&!(s[i].e.r<l)){(s[i].s.c!=d||s[i].s.r!=l)&&(g=!0);break}if(!g){var p={r:l,c:d},y=qt(p),v=c?(r[l]||[])[d]:r[y];u.push(MD(v,y,r,e,t,n,p))}}u.push("</Row>"),u.length>2&&o.push(u.join(""))}return o.join("")}function UD(r,e,t){var n=[],a=t.SheetNames[r],s=t.Sheets[a],i=s?LD(s,e,r,t):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=s?VD(s,e,r,t):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push(jD(s,e,r,t)),n.join("")}function qD(r,e){e||(e={}),r.SSF||(r.SSF=$r(Mt)),r.SSF&&(bu(),yd(r.SSF),e.revssf=_d(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF,e.cellXfs=[],Zo(e.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(PD(r,e)),t.push(FD()),t.push(""),t.push("");for(var n=0;n<r.SheetNames.length;++n)t.push(ct("Worksheet",UD(n,e,r),{"ss:Name":Tr(r.SheetNames[n])}));return t[2]=RD(r,e),t[3]=DD(r),wn+ct("Workbook",t.join(""),{xmlns:es.ss,"xmlns:o":es.o,"xmlns:x":es.x,"xmlns:ss":es.ss,"xmlns:dt":es.dt,"xmlns:html":es.html})}function zD(r){var e={},t=r.content;if(t.l=28,e.AnsiUserType=t.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=D6(t),t.length-t.l<=4)return e;var n=t.read_shift(4);if(n==0||n>40||(t.l-=4,e.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(n=t.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=L6(t),n=t.read_shift(4),n==0||n>40))return e;t.l-=4,e.Reserved2=t.read_shift(0,"lpwstr")}var WD=[60,1084,2066,2165,2175];function HD(r,e,t,n,a){var s=n,i=[],o=t.slice(t.l,t.l+s);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(r){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}i.push(o),t.l+=s;for(var c=Mi(t,t.l),l=hp[c],u=0;l!=null&&WD.indexOf(c)>-1;)s=Mi(t,t.l+2),u=t.l+4,c==2066?u+=4:(c==2165||c==2175)&&(u+=12),o=t.slice(u,t.l+4+s),i.push(o),t.l+=4+s,l=hp[c=Mi(t,t.l)];var d=qn(i);Qn(d,0);var g=0;d.lens=[];for(var p=0;p<i.length;++p)d.lens.push(g),g+=i[p].length;if(d.length<n)throw"XLS Record 0x"+r.toString(16)+" Truncated: "+d.length+" < "+n;return e.f(d,d.length,a)}function si(r,e,t){if(r.t!=="z"&&r.XF){var n=0;try{n=r.z||r.XF.numFmtId||0,e.cellNF&&(r.z=Mt[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{r.t==="e"?r.w=r.w||Xi[r.v]:n===0||n=="General"?r.t==="n"?(r.v|0)===r.v?r.w=r.v.toString(10):r.w=Fh(r.v):r.w=Hc(r.v):r.w=ks(n,r.v,{date1904:!!t,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&r.t=="n"&&_u(Mt[n]||String(n))){var a=kc(r.v);a&&(r.t="d",r.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function X0(r,e,t){return{v:r,ixfe:e,t}}function GD(r,e){var t={opts:{}},n={},a=e.dense?[]:{},s={},i={},o=null,c=[],l="",u={},d,g="",p,y,v,w,E={},R=[],P,q,z=[],K=[],I={Sheets:[],WBProps:{date1904:!1},Views:[{}]},N={},F=function(dt){return dt<8?Pc[dt]:dt<64&&K[dt-8]||Pc[dt]},j=function(dt,tt,sr){var Ct=tt.XF.data;if(!(!Ct||!Ct.patternType||!sr||!sr.cellStyles)){tt.s={},tt.s.patternType=Ct.patternType;var rn;(rn=Oh(F(Ct.icvFore)))&&(tt.s.fgColor={rgb:rn}),(rn=Oh(F(Ct.icvBack)))&&(tt.s.bgColor={rgb:rn})}},S=function(dt,tt,sr){if(!(Oe>1)&&!(sr.sheetRows&&dt.r>=sr.sheetRows)){if(sr.cellStyles&&tt.XF&&tt.XF.data&&j(dt,tt,sr),delete tt.ixfe,delete tt.XF,d=dt,g=qt(dt),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),dt.r<i.s.r&&(i.s.r=dt.r),dt.c<i.s.c&&(i.s.c=dt.c),dt.r+1>i.e.r&&(i.e.r=dt.r+1),dt.c+1>i.e.c&&(i.e.c=dt.c+1),sr.cellFormula&&tt.f){for(var Ct=0;Ct<R.length;++Ct)if(!(R[Ct][0].s.c>dt.c||R[Ct][0].s.r>dt.r)&&!(R[Ct][0].e.c<dt.c||R[Ct][0].e.r<dt.r)){tt.F=Jt(R[Ct][0]),(R[Ct][0].s.c!=dt.c||R[Ct][0].s.r!=dt.r)&&delete tt.f,tt.f&&(tt.f=""+ua(R[Ct][1],i,dt,ne,A));break}}sr.dense?(a[dt.r]||(a[dt.r]=[]),a[dt.r][dt.c]=tt):a[g]=tt}},A={enc:!1,sbcch:0,snames:[],sharedf:E,arrayf:R,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(A.password=e.password);var C,J=[],ue=[],me=[],pe=[],ge=!1,ne=[];ne.SheetNames=A.snames,ne.sharedf=A.sharedf,ne.arrayf=A.arrayf,ne.names=[],ne.XTI=[];var we=0,Oe=0,k=0,O=[],M=[],U;A.codepage=1200,Hs(1200);for(var ee=!1;r.l<r.length-1;){var he=r.l,de=r.read_shift(2);if(de===0&&we===10)break;var fe=r.l===r.length?0:r.read_shift(2),be=hp[de];if(be&&be.f){if(e.bookSheets&&we===133&&de!==133)break;if(we=de,be.r===2||be.r==12){var Me=r.read_shift(2);if(fe-=2,!A.enc&&Me!==de&&((Me&255)<<8|Me>>8)!==de)throw new Error("rt mismatch: "+Me+"!="+de);be.r==12&&(r.l+=10,fe-=10)}var Z={};if(de===10?Z=be.f(r,fe,A):Z=HD(de,be,r,fe,A),Oe==0&&[9,521,1033,2057].indexOf(we)===-1)continue;switch(de){case 34:t.opts.Date1904=I.WBProps.date1904=Z;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(A.enc||(r.l=0),A.enc=Z,!e.password)throw new Error("File is password-protected");if(Z.valid==null)throw new Error("Encryption scheme unsupported");if(!Z.valid)throw new Error("Password is incorrect");break;case 92:A.lastuser=Z;break;case 66:var Xe=Number(Z);switch(Xe){case 21010:Xe=1200;break;case 32768:Xe=1e4;break;case 32769:Xe=1252;break}Hs(A.codepage=Xe),ee=!0;break;case 317:A.rrtabid=Z;break;case 25:A.winlocked=Z;break;case 439:t.opts.RefreshAll=Z;break;case 12:t.opts.CalcCount=Z;break;case 16:t.opts.CalcDelta=Z;break;case 17:t.opts.CalcIter=Z;break;case 13:t.opts.CalcMode=Z;break;case 14:t.opts.CalcPrecision=Z;break;case 95:t.opts.CalcSaveRecalc=Z;break;case 15:A.CalcRefMode=Z;break;case 2211:t.opts.FullCalc=Z;break;case 129:Z.fDialog&&(a["!type"]="dialog"),Z.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),Z.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:z.push(Z);break;case 430:ne.push([Z]),ne[ne.length-1].XTI=[];break;case 35:case 547:ne[ne.length-1].push(Z);break;case 24:case 536:U={Name:Z.Name,Ref:ua(Z.rgce,i,null,ne,A)},Z.itab>0&&(U.Sheet=Z.itab-1),ne.names.push(U),ne[0]||(ne[0]=[],ne[0].XTI=[]),ne[ne.length-1].push(Z),Z.Name=="_xlnm._FilterDatabase"&&Z.itab>0&&Z.rgce&&Z.rgce[0]&&Z.rgce[0][0]&&Z.rgce[0][0][0]=="PtgArea3d"&&(M[Z.itab-1]={ref:Jt(Z.rgce[0][0][1][2])});break;case 22:A.ExternCount=Z;break;case 23:ne.length==0&&(ne[0]=[],ne[0].XTI=[]),ne[ne.length-1].XTI=ne[ne.length-1].XTI.concat(Z),ne.XTI=ne.XTI.concat(Z);break;case 2196:if(A.biff<8)break;U!=null&&(U.Comment=Z[1]);break;case 18:a["!protect"]=Z;break;case 19:Z!==0&&A.WTF&&console.error("Password verifier: "+Z);break;case 133:s[Z.pos]=Z,A.snames.push(Z.name);break;case 10:{if(--Oe)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,a["!ref"]=Jt(i),e.sheetRows&&e.sheetRows<=i.e.r){var st=i.e.r;i.e.r=e.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Jt(i),i.e.r=st}i.e.r++,i.e.c++}J.length>0&&(a["!merges"]=J),ue.length>0&&(a["!objects"]=ue),me.length>0&&(a["!cols"]=me),pe.length>0&&(a["!rows"]=pe),I.Sheets.push(N)}l===""?u=a:n[l]=a,a=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(A.biff===8&&(A.biff={9:2,521:3,1033:4}[de]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Z.BIFFVer]||8),A.biffguess=Z.BIFFVer==0,Z.BIFFVer==0&&Z.dt==4096&&(A.biff=5,ee=!0,Hs(A.codepage=28591)),A.biff==8&&Z.BIFFVer==0&&Z.dt==16&&(A.biff=2),Oe++)break;if(a=e.dense?[]:{},A.biff<8&&!ee&&(ee=!0,Hs(A.codepage=e.codepage||1252)),A.biff<5||Z.BIFFVer==0&&Z.dt==4096){l===""&&(l="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var Fe={pos:r.l-fe,name:l};s[Fe.pos]=Fe,A.snames.push(l)}else l=(s[he]||{name:""}).name;Z.dt==32&&(a["!type"]="chart"),Z.dt==64&&(a["!type"]="macro"),J=[],ue=[],A.arrayf=R=[],me=[],pe=[],ge=!1,N={Hidden:(s[he]||{hs:0}).hs,name:l}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(e.dense?(a[Z.r]||[])[Z.c]:a[qt({c:Z.c,r:Z.r})])&&++Z.c,P={ixfe:Z.ixfe,XF:z[Z.ixfe]||{},v:Z.val,t:"n"},k>0&&(P.z=O[P.ixfe>>8&63]),si(P,e,t.opts.Date1904),S({c:Z.c,r:Z.r},P,e);break;case 5:case 517:P={ixfe:Z.ixfe,XF:z[Z.ixfe],v:Z.val,t:Z.t},k>0&&(P.z=O[P.ixfe>>8&63]),si(P,e,t.opts.Date1904),S({c:Z.c,r:Z.r},P,e);break;case 638:P={ixfe:Z.ixfe,XF:z[Z.ixfe],v:Z.rknum,t:"n"},k>0&&(P.z=O[P.ixfe>>8&63]),si(P,e,t.opts.Date1904),S({c:Z.c,r:Z.r},P,e);break;case 189:for(var se=Z.c;se<=Z.C;++se){var qe=Z.rkrec[se-Z.c][0];P={ixfe:qe,XF:z[qe],v:Z.rkrec[se-Z.c][1],t:"n"},k>0&&(P.z=O[P.ixfe>>8&63]),si(P,e,t.opts.Date1904),S({c:se,r:Z.r},P,e)}break;case 6:case 518:case 1030:{if(Z.val=="String"){o=Z;break}if(P=X0(Z.val,Z.cell.ixfe,Z.tt),P.XF=z[P.ixfe],e.cellFormula){var lt=Z.formula;if(lt&&lt[0]&&lt[0][0]&&lt[0][0][0]=="PtgExp"){var $e=lt[0][0][1][0],rt=lt[0][0][1][1],ot=qt({r:$e,c:rt});E[ot]?P.f=""+ua(Z.formula,i,Z.cell,ne,A):P.F=((e.dense?(a[$e]||[])[rt]:a[ot])||{}).F}else P.f=""+ua(Z.formula,i,Z.cell,ne,A)}k>0&&(P.z=O[P.ixfe>>8&63]),si(P,e,t.opts.Date1904),S(Z.cell,P,e),o=Z}break;case 7:case 519:if(o)o.val=Z,P=X0(Z,o.cell.ixfe,"s"),P.XF=z[P.ixfe],e.cellFormula&&(P.f=""+ua(o.formula,i,o.cell,ne,A)),k>0&&(P.z=O[P.ixfe>>8&63]),si(P,e,t.opts.Date1904),S(o.cell,P,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{R.push(Z);var ht=qt(Z[0].s);if(p=e.dense?(a[Z[0].s.r]||[])[Z[0].s.c]:a[ht],e.cellFormula&&p){if(!o||!ht||!p)break;p.f=""+ua(Z[1],i,Z[0],ne,A),p.F=Jt(Z[0])}}break;case 1212:{if(!e.cellFormula)break;if(g){if(!o)break;E[qt(o.cell)]=Z[0],p=e.dense?(a[o.cell.r]||[])[o.cell.c]:a[qt(o.cell)],(p||{}).f=""+ua(Z[0],i,d,ne,A)}}break;case 253:P=X0(c[Z.isst].t,Z.ixfe,"s"),c[Z.isst].h&&(P.h=c[Z.isst].h),P.XF=z[P.ixfe],k>0&&(P.z=O[P.ixfe>>8&63]),si(P,e,t.opts.Date1904),S({c:Z.c,r:Z.r},P,e);break;case 513:e.sheetStubs&&(P={ixfe:Z.ixfe,XF:z[Z.ixfe],t:"z"},k>0&&(P.z=O[P.ixfe>>8&63]),si(P,e,t.opts.Date1904),S({c:Z.c,r:Z.r},P,e));break;case 190:if(e.sheetStubs)for(var _t=Z.c;_t<=Z.C;++_t){var At=Z.ixfe[_t-Z.c];P={ixfe:At,XF:z[At],t:"z"},k>0&&(P.z=O[P.ixfe>>8&63]),si(P,e,t.opts.Date1904),S({c:_t,r:Z.r},P,e)}break;case 214:case 516:case 4:P=X0(Z.val,Z.ixfe,"s"),P.XF=z[P.ixfe],k>0&&(P.z=O[P.ixfe>>8&63]),si(P,e,t.opts.Date1904),S({c:Z.c,r:Z.r},P,e);break;case 0:case 512:Oe===1&&(i=Z);break;case 252:c=Z;break;case 1054:if(A.biff==4){O[k++]=Z[1];for(var Ft=0;Ft<k+163&&Mt[Ft]!=Z[1];++Ft);Ft>=163&&Vi(Z[1],k+163)}else Vi(Z[1],Z[0]);break;case 30:{O[k++]=Z;for(var Et=0;Et<k+163&&Mt[Et]!=Z;++Et);Et>=163&&Vi(Z,k+163)}break;case 229:J=J.concat(Z);break;case 93:ue[Z.cmo[0]]=A.lastobj=Z;break;case 438:A.lastobj.TxO=Z;break;case 127:A.lastobj.ImData=Z;break;case 440:for(w=Z[0].s.r;w<=Z[0].e.r;++w)for(v=Z[0].s.c;v<=Z[0].e.c;++v)p=e.dense?(a[w]||[])[v]:a[qt({c:v,r:w})],p&&(p.l=Z[1]);break;case 2048:for(w=Z[0].s.r;w<=Z[0].e.r;++w)for(v=Z[0].s.c;v<=Z[0].e.c;++v)p=e.dense?(a[w]||[])[v]:a[qt({c:v,r:w})],p&&p.l&&(p.l.Tooltip=Z[1]);break;case 28:{if(A.biff<=5&&A.biff>=2)break;p=e.dense?(a[Z[0].r]||[])[Z[0].c]:a[qt(Z[0])];var It=ue[Z[2]];p||(e.dense?(a[Z[0].r]||(a[Z[0].r]=[]),p=a[Z[0].r][Z[0].c]={t:"z"}):p=a[qt(Z[0])]={t:"z"},i.e.r=Math.max(i.e.r,Z[0].r),i.s.r=Math.min(i.s.r,Z[0].r),i.e.c=Math.max(i.e.c,Z[0].c),i.s.c=Math.min(i.s.c,Z[0].c)),p.c||(p.c=[]),y={a:Z[1],t:It.TxO.t},p.c.push(y)}break;case 2173:R8(z[Z.ixfe],Z.ext);break;case 125:{if(!A.cellStyles)break;for(;Z.e>=Z.s;)me[Z.e--]={width:Z.w/256,level:Z.level||0,hidden:!!(Z.flags&1)},ge||(ge=!0,B1(Z.w/256)),Wo(me[Z.e+1])}break;case 520:{var Vt={};Z.level!=null&&(pe[Z.r]=Vt,Vt.level=Z.level),Z.hidden&&(pe[Z.r]=Vt,Vt.hidden=!0),Z.hpt&&(pe[Z.r]=Vt,Vt.hpt=Z.hpt,Vt.hpx=pu(Z.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Dc(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[de]]=Z;break;case 161:a["!margins"]||Dc(a["!margins"]={}),a["!margins"].header=Z.header,a["!margins"].footer=Z.footer;break;case 574:Z.RTL&&(I.Views[0].RTL=!0);break;case 146:K=Z;break;case 2198:C=Z;break;case 140:q=Z;break;case 442:l?N.CodeName=Z||N.name:I.WBProps.CodeName=Z||"ThisWorkbook";break}}else be||console.error("Missing Info for XLS Record 0x"+de.toString(16)),r.l+=fe}return t.SheetNames=fn(s).sort(function(Nt,dt){return Number(Nt)-Number(dt)}).map(function(Nt){return s[Nt].name}),e.bookSheets||(t.Sheets=n),!t.SheetNames.length&&u["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=u)):t.Preamble=u,t.Sheets&&M.forEach(function(Nt,dt){t.Sheets[t.SheetNames[dt]]["!autofilter"]=Nt}),t.Strings=c,t.SSF=$r(Mt),A.enc&&(t.Encryption=A.enc),C&&(t.Themes=C),t.Metadata={},q!==void 0&&(t.Metadata.Country=q),ne.names.length>0&&(I.Names=ne.names),t.Workbook=I,t}var xh={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function $D(r,e,t){var n=Pt.find(r,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=F2(n,ap,xh.DSI);for(var s in a)e[s]=a[s]}catch(l){if(t.WTF)throw l}var i=Pt.find(r,"/!SummaryInformation");if(i&&i.size>0)try{var o=F2(i,sp,xh.SI);for(var c in o)e[c]==null&&(e[c]=o[c])}catch(l){if(t.WTF)throw l}e.HeadingPairs&&e.TitlesOfParts&&(i_(e.HeadingPairs,e.TitlesOfParts,e,t),delete e.HeadingPairs,delete e.TitlesOfParts)}function KD(r,e){var t=[],n=[],a=[],s=0,i,o=c2(ap,"n"),c=c2(sp,"n");if(r.Props)for(i=fn(r.Props),s=0;s<i.length;++s)(Object.prototype.hasOwnProperty.call(o,i[s])?t:Object.prototype.hasOwnProperty.call(c,i[s])?n:a).push([i[s],r.Props[i[s]]]);if(r.Custprops)for(i=fn(r.Custprops),s=0;s<i.length;++s)Object.prototype.hasOwnProperty.call(r.Props||{},i[s])||(Object.prototype.hasOwnProperty.call(o,i[s])?t:Object.prototype.hasOwnProperty.call(c,i[s])?n:a).push([i[s],r.Custprops[i[s]]]);var l=[];for(s=0;s<a.length;++s)d_.indexOf(a[s][0])>-1||s_.indexOf(a[s][0])>-1||a[s][1]!=null&&l.push(a[s]);n.length&&Pt.utils.cfb_add(e,"/SummaryInformation",R2(n,xh.SI,c,sp)),(t.length||l.length)&&Pt.utils.cfb_add(e,"/DocumentSummaryInformation",R2(t,xh.DSI,o,ap,l.length?l:null,xh.UDI))}function cb(r,e){e||(e={}),K1(e),p1(),e.codepage&&m1(e.codepage);var t,n;if(r.FullPaths){if(Pt.find(r,"/encryption"))throw new Error("File is password-protected");t=Pt.find(r,"!CompObj"),n=Pt.find(r,"/Workbook")||Pt.find(r,"/Book")}else{switch(e.type){case"base64":r=rs(cs(r));break;case"binary":r=rs(r);break;case"buffer":break;case"array":Array.isArray(r)||(r=Array.prototype.slice.call(r));break}Qn(r,0),n={content:r}}var a,s;if(t&&zD(t),e.bookProps&&!e.bookSheets)a={};else{var i=Zt?"buffer":"array";if(n&&n.content)a=GD(n.content,e);else if((s=Pt.find(r,"PerfectOffice_MAIN"))&&s.content)a=Rc.to_workbook(s.content,(e.type=i,e));else if((s=Pt.find(r,"NativeContent_MAIN"))&&s.content)a=Rc.to_workbook(s.content,(e.type=i,e));else throw(s=Pt.find(r,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&r.FullPaths&&Pt.find(r,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=oP(r))}var o={};return r.FullPaths&&$D(r,o,e),a.Props=a.Custprops=o,e.bookFiles&&(a.cfb=r),a}function XD(r,e){var t=e||{},n=Pt.utils.cfb_new({root:"R"}),a="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":a="/Workbook",t.biff=8;break;case"biff5":a="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return Pt.utils.cfb_add(n,a,lb(r,t)),t.biff==8&&(r.Props||r.Custprops)&&KD(r,n),t.biff==8&&r.vbaraw&&cP(n,Pt.read(r.vbaraw,{type:typeof r.vbaraw=="string"?"binary":"buffer"})),n}var Uh={0:{f:y7},1:{f:T7},2:{f:G7},3:{f:L7},4:{f:P7},5:{f:z7},6:{f:J7},7:{f:B7},8:{f:aR},9:{f:nR},10:{f:tR},11:{f:rR},12:{f:I7},13:{f:K7},14:{f:O7},15:{f:R7},16:{f:eb},17:{f:Z7},18:{f:U7},19:{f:I1},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:ZR},40:{},42:{},43:{f:JC},44:{f:XC},45:{f:e8},46:{f:r8},47:{f:t8},48:{},49:{f:b6},50:{},51:{f:j8},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:S_},62:{f:Y7},63:{f:H8},64:{f:wR},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ga,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:gR},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:A7},148:{f:b7,p:16},151:{f:uR},152:{},153:{f:YR},154:{},155:{},156:{f:KR},157:{},158:{},159:{T:1,f:fC},160:{T:-1},161:{T:1,f:sl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:sR},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:D8},336:{T:-1},337:{f:B8,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:np},357:{},358:{},359:{},360:{T:1},361:{},362:{f:E_},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:hR},427:{f:fR},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:mR},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:S7},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:cR},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:np},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:rP},633:{T:1},634:{T:-1},635:{T:1,f:eP},636:{T:-1},637:{f:N6},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:OR},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:_R},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},hp={6:{f:hm},10:{f:To},12:{f:Tn},13:{f:Tn},14:{f:pn},15:{f:pn},16:{f:da},17:{f:pn},18:{f:pn},19:{f:Tn},20:{f:B2},21:{f:B2},23:{f:E_},24:{f:U2},25:{f:pn},26:{},27:{},28:{f:_I},29:{},34:{f:pn},35:{f:V2},38:{f:da},39:{f:da},40:{f:da},41:{f:da},42:{f:pn},43:{f:pn},47:{f:RC},49:{f:Kk},51:{f:Tn},60:{},61:{f:zk},64:{f:pn},65:{f:$k},66:{f:Tn},77:{},80:{},81:{},82:{},85:{f:Tn},89:{},90:{},91:{},92:{f:Fk},93:{f:SI},94:{},95:{f:pn},96:{},97:{},99:{f:pn},125:{f:S_},128:{f:lI},129:{f:Dk},130:{f:Tn},131:{f:pn},132:{f:pn},133:{f:Lk},134:{},140:{f:FI},141:{f:Tn},144:{},146:{f:LI},151:{},152:{},153:{},154:{},155:{},156:{f:Tn},157:{},158:{},160:{f:qI},161:{f:MI},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:sI},190:{f:iI},193:{f:To},197:{},198:{},199:{},200:{},201:{},202:{f:pn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Tn},220:{},221:{f:pn},222:{},224:{f:cI},225:{f:Pk},226:{f:To},227:{},229:{f:bI},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Ok},253:{f:Yk},255:{f:Bk},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:m_},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:pn},353:{f:To},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:mI},431:{f:pn},432:{},433:{},434:{},437:{},438:{f:TI},439:{f:pn},440:{f:kI},441:{},442:{f:s0},443:{},444:{f:Tn},445:{},446:{},448:{f:To},449:{f:qk,r:2},450:{f:To},512:{f:j2},513:{f:UI},515:{f:fI},516:{f:Qk},517:{f:M2},519:{f:zI},520:{f:Vk},523:{},545:{f:q2},549:{f:L2},566:{},574:{f:Hk},638:{f:aI},659:{},1048:{},1054:{f:eI},1084:{},1212:{f:vI},2048:{f:CI},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:G0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:To},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:jI,r:12},2173:{f:F8,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:pn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:xI,r:12},2197:{},2198:{f:N8,r:12},2199:{},2200:{},2201:{},2202:{f:yI,r:12},2203:{f:To},2204:{},2205:{},2206:{},2207:{},2211:{f:Uk},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Tn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:BI},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:DI},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:j2},1:{},2:{f:KI},3:{f:GI},4:{f:HI},5:{f:M2},7:{f:YI},8:{},9:{f:G0},11:{},22:{f:Tn},30:{f:rI},31:{},32:{},33:{f:q2},36:{},37:{f:L2},50:{f:JI},62:{},52:{},67:{},68:{f:Tn},69:{},86:{},126:{},127:{f:WI},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:QI},223:{},234:{},354:{},421:{},518:{f:hm},521:{f:G0},536:{f:U2},547:{f:V2},561:{},579:{},1030:{f:hm},1033:{f:G0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ut(r,e,t,n){var a=e;if(!isNaN(a)){var s=n||(t||[]).length||0,i=r.next(4);i.write_shift(2,a),i.write_shift(2,s),s>0&&N1(t)&&r.push(t)}}function YD(r,e,t,n){var a=(t||[]).length||0;if(a<=8224)return ut(r,e,t,a);var s=e;if(!isNaN(s)){for(var i=t.parts||[],o=0,c=0,l=0;l+(i[o]||8224)<=8224;)l+=i[o]||8224,o++;var u=r.next(4);for(u.write_shift(2,s),u.write_shift(2,l),r.push(t.slice(c,c+l)),c+=l;c<a;){for(u=r.next(4),u.write_shift(2,60),l=0;l+(i[o]||8224)<=8224;)l+=i[o]||8224,o++;u.write_shift(2,l),r.push(t.slice(c,c+l)),c+=l}}}function l0(r,e,t){return r||(r=Ue(7)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,0),r.write_shift(1,0),r}function JD(r,e,t,n){var a=Ue(9);return l0(a,r,e),p_(t,n||"b",a),a}function QD(r,e,t){var n=Ue(8+2*t.length);return l0(n,r,e),n.write_shift(1,t.length),n.write_shift(t.length,t,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function ZD(r,e,t,n){if(e.v!=null)switch(e.t){case"d":case"n":var a=e.t=="d"?Rn(Gr(e.v)):e.v;a==(a|0)&&a>=0&&a<65536?ut(r,2,XI(t,n,a)):ut(r,3,$I(t,n,a));return;case"b":case"e":ut(r,5,JD(t,n,e.v,e.t));return;case"s":case"str":ut(r,4,QD(t,n,(e.v||"").slice(0,255)));return}ut(r,1,l0(null,t,n))}function eL(r,e,t,n){var a=Array.isArray(e),s=pr(e["!ref"]||"A1"),i,o="",c=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),i=Jt(s)}for(var l=s.s.r;l<=s.e.r;++l){o=yn(l);for(var u=s.s.c;u<=s.e.c;++u){l===s.s.r&&(c[u]=Zr(u)),i=c[u]+o;var d=a?(e[l]||[])[u]:e[i];d&&ZD(r,d,l,u)}}}function tL(r,e){for(var t=e||{},n=qa(),a=0,s=0;s<r.SheetNames.length;++s)r.SheetNames[s]==t.sheet&&(a=s);if(a==0&&t.sheet&&r.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return ut(n,t.biff==4?1033:t.biff==3?521:9,j1(r,16,t)),eL(n,r.Sheets[r.SheetNames[a]],a,t),ut(n,10),n.end()}function rL(r,e,t){ut(r,49,Xk({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},t))}function nL(r,e,t){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&ut(r,1054,tI(a,e[a],t))})}function aL(r,e){var t=Ue(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),ut(r,2151,t),t=Ue(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),w_(pr(e["!ref"]||"A1"),t),t.write_shift(4,4),ut(r,2152,t)}function sL(r,e){for(var t=0;t<16;++t)ut(r,224,O2({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){ut(r,224,O2(n,0,e))})}function iL(r,e){for(var t=0;t<e["!links"].length;++t){var n=e["!links"][t];ut(r,440,II(n)),n[1].Tooltip&&ut(r,2048,PI(n))}delete e["!links"]}function oL(r,e){if(e){var t=0;e.forEach(function(n,a){++t<=256&&n&&ut(r,125,OI(Nd(a,n),a))})}}function cL(r,e,t,n,a){var s=16+Zo(a.cellXfs,e,a);if(e.v==null&&!e.bf){ut(r,513,Xc(t,n,s));return}if(e.bf)ut(r,6,DF(e,t,n,a,s));else switch(e.t){case"d":case"n":var i=e.t=="d"?Rn(Gr(e.v)):e.v;ut(r,515,dI(t,n,i,s));break;case"b":case"e":ut(r,517,hI(t,n,e.v,s,a,e.t));break;case"s":case"str":if(a.bookSST){var o=W1(a.Strings,e.v,a.revStrings);ut(r,253,Jk(t,n,o,s))}else ut(r,516,Zk(t,n,(e.v||"").slice(0,255),s,a));break;default:ut(r,513,Xc(t,n,s))}}function lL(r,e,t){var n=qa(),a=t.SheetNames[r],s=t.Sheets[a]||{},i=(t||{}).Workbook||{},o=(i.Sheets||[])[r]||{},c=Array.isArray(s),l=e.biff==8,u,d="",g=[],p=pr(s["!ref"]||"A1"),y=l?65536:16384;if(p.e.c>255||p.e.r>=y){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,y-1)}ut(n,2057,j1(t,16,e)),ut(n,13,Es(1)),ut(n,12,Es(100)),ut(n,15,Na(!0)),ut(n,17,Na(!1)),ut(n,16,$c(.001)),ut(n,95,Na(!0)),ut(n,42,Na(!1)),ut(n,43,Na(!1)),ut(n,130,Es(1)),ut(n,128,uI()),ut(n,131,Na(!1)),ut(n,132,Na(!1)),l&&oL(n,s["!cols"]),ut(n,512,nI(p,e)),l&&(s["!links"]=[]);for(var v=p.s.r;v<=p.e.r;++v){d=yn(v);for(var w=p.s.c;w<=p.e.c;++w){v===p.s.r&&(g[w]=Zr(w)),u=g[w]+d;var E=c?(s[v]||[])[w]:s[u];E&&(cL(n,E,v,w,e),l&&E.l&&s["!links"].push([u,E.l]))}}var R=o.CodeName||o.name||a;return l&&ut(n,574,Gk((i.Views||[])[0])),l&&(s["!merges"]||[]).length&&ut(n,229,EI(s["!merges"])),l&&iL(n,s),ut(n,442,g_(R)),l&&aL(n,s),ut(n,10),n.end()}function uL(r,e,t){var n=qa(),a=(r||{}).Workbook||{},s=a.Sheets||[],i=a.WBProps||{},o=t.biff==8,c=t.biff==5;if(ut(n,2057,j1(r,5,t)),t.bookType=="xla"&&ut(n,135),ut(n,225,o?Es(1200):null),ut(n,193,hk(2)),c&&ut(n,191),c&&ut(n,192),ut(n,226),ut(n,92,Rk("SheetJS",t)),ut(n,66,Es(o?1200:1252)),o&&ut(n,353,Es(0)),o&&ut(n,448),ut(n,317,VI(r.SheetNames.length)),o&&r.vbaraw&&ut(n,211),o&&r.vbaraw){var l=i.CodeName||"ThisWorkbook";ut(n,442,g_(l))}ut(n,156,Es(17)),ut(n,25,Na(!1)),ut(n,18,Na(!1)),ut(n,19,Es(0)),o&&ut(n,431,Na(!1)),o&&ut(n,444,Es(0)),ut(n,61,Wk()),ut(n,64,Na(!1)),ut(n,141,Es(0)),ut(n,34,Na(qR(r)=="true")),ut(n,14,Na(!0)),o&&ut(n,439,Na(!1)),ut(n,218,Es(0)),rL(n,r,t),nL(n,r.SSF,t),sL(n,t),o&&ut(n,352,Na(!1));var u=n.end(),d=qa();o&&ut(d,140,RI()),o&&t.Strings&&YD(d,252,Mk(t.Strings)),ut(d,10);var g=d.end(),p=qa(),y=0,v=0;for(v=0;v<r.SheetNames.length;++v)y+=(o?12:11)+(o?2:1)*r.SheetNames[v].length;var w=u.length+y+g.length;for(v=0;v<r.SheetNames.length;++v){var E=s[v]||{};ut(p,133,jk({pos:w,hs:E.Hidden||0,dt:0,name:r.SheetNames[v]},t)),w+=e[v].length}var R=p.end();if(y!=R.length)throw new Error("BS8 "+y+" != "+R.length);var P=[];return u.length&&P.push(u),R.length&&P.push(R),g.length&&P.push(g),qn(P)}function hL(r,e){var t=e||{},n=[];r&&!r.SSF&&(r.SSF=$r(Mt)),r&&r.SSF&&(bu(),yd(r.SSF),t.revssf=_d(r.SSF),t.revssf[r.SSF[65535]]=0,t.ssf=r.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,X1(t),t.cellXfs=[],Zo(t.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={});for(var a=0;a<r.SheetNames.length;++a)n[n.length]=lL(a,t,r);return n.unshift(uL(r,n,t)),qn(n)}function lb(r,e){for(var t=0;t<=r.SheetNames.length;++t){var n=r.Sheets[r.SheetNames[t]];if(!(!n||!n["!ref"])){var a=za(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+r.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return hL(r,e);case 4:case 3:case 2:return tL(r,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function Q2(r,e){var t=e||{},n=t.dense?[]:{};r=r.replace(/<!--.*?-->/g,"");var a=r.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=r.match(/<\/table/i),i=a.index,o=s&&s.index||r.length,c=XT(r.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),l=-1,u=0,d=0,g=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},y=[];for(i=0;i<c.length;++i){var v=c[i].trim(),w=v.slice(0,3).toLowerCase();if(w=="<tr"){if(++l,t.sheetRows&&t.sheetRows<=l){--l;break}u=0;continue}if(!(w!="<td"&&w!="<th")){var E=v.split(/<\/t[dh]>/i);for(o=0;o<E.length;++o){var R=E[o].trim();if(R.match(/<t[dh]/i)){for(var P=R,q=0;P.charAt(0)=="<"&&(q=P.indexOf(">"))>-1;)P=P.slice(q+1);for(var z=0;z<y.length;++z){var K=y[z];K.s.c==u&&K.s.r<l&&l<=K.e.r&&(u=K.e.c+1,z=-1)}var I=Wt(R.slice(0,R.indexOf(">")));g=I.colspan?+I.colspan:1,((d=+I.rowspan)>1||g>1)&&y.push({s:{r:l,c:u},e:{r:l+(d||1)-1,c:u+g-1}});var N=I.t||I["data-t"]||"";if(!P.length){u+=g;continue}if(P=Rw(P),p.s.r>l&&(p.s.r=l),p.e.r<l&&(p.e.r=l),p.s.c>u&&(p.s.c=u),p.e.c<u&&(p.e.c=u),!P.length){u+=g;continue}var F={t:"s",v:P};t.raw||!P.trim().length||N=="s"||(P==="TRUE"?F={t:"b",v:!0}:P==="FALSE"?F={t:"b",v:!1}:isNaN($s(P))?isNaN(du(P).getDate())||(F={t:"d",v:Gr(P)},t.cellDates||(F={t:"n",v:Rn(F.v)}),F.z=t.dateNF||Mt[14]):F={t:"n",v:$s(P)}),t.dense?(n[l]||(n[l]=[]),n[l][u]=F):n[qt({r:l,c:u})]=F,u+=g}}}}return n["!ref"]=Jt(p),y.length&&(n["!merges"]=y),n}function fL(r,e,t,n){for(var a=r["!merges"]||[],s=[],i=e.s.c;i<=e.e.c;++i){for(var o=0,c=0,l=0;l<a.length;++l)if(!(a[l].s.r>t||a[l].s.c>i)&&!(a[l].e.r<t||a[l].e.c<i)){if(a[l].s.r<t||a[l].s.c<i){o=-1;break}o=a[l].e.r-a[l].s.r+1,c=a[l].e.c-a[l].s.c+1;break}if(!(o<0)){var u=qt({r:t,c:i}),d=n.dense?(r[t]||[])[i]:r[u],g=d&&d.v!=null&&(d.h||E1(d.w||(Hi(d),d.w)||""))||"",p={};o>1&&(p.rowspan=o),c>1&&(p.colspan=c),n.editable?g='<span contenteditable="true">'+g+"</span>":d&&(p["data-t"]=d&&d.t||"z",d.v!=null&&(p["data-v"]=d.v),d.z!=null&&(p["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+d.l.Target+'">'+g+"</a>")),p.id=(n.id||"sjs")+"-"+u,s.push(ct("td",g,p))}}var y="<tr>";return y+s.join("")+"</tr>"}var dL='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',mL="</body></html>";function pL(r,e){var t=r.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return Qo(Q2(t[0],e),e);var n=Q1();return t.forEach(function(a,s){Z1(n,Q2(a,e),"Sheet"+(s+1))}),n}function gL(r,e,t){var n=[];return n.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function ub(r,e){var t=e||{},n=t.header!=null?t.header:dL,a=t.footer!=null?t.footer:mL,s=[n],i=za(r["!ref"]);t.dense=Array.isArray(r),s.push(gL(r,i,t));for(var o=i.s.r;o<=i.e.r;++o)s.push(fL(r,i,o,t));return s.push("</table>"+a),s.join("")}function hb(r,e,t){var n=t||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var i=typeof n.origin=="string"?en(n.origin):n.origin;a=i.r,s=i.c}var o=e.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),l={s:{r:0,c:0},e:{r:a,c:s}};if(r["!ref"]){var u=za(r["!ref"]);l.s.r=Math.min(l.s.r,u.s.r),l.s.c=Math.min(l.s.c,u.s.c),l.e.r=Math.max(l.e.r,u.e.r),l.e.c=Math.max(l.e.c,u.e.c),a==-1&&(l.e.r=a=u.e.r+1)}var d=[],g=0,p=r["!rows"]||(r["!rows"]=[]),y=0,v=0,w=0,E=0,R=0,P=0;for(r["!cols"]||(r["!cols"]=[]);y<o.length&&v<c;++y){var q=o[y];if(Z2(q)){if(n.display)continue;p[v]={hidden:!0}}var z=q.children;for(w=E=0;w<z.length;++w){var K=z[w];if(!(n.display&&Z2(K))){var I=K.hasAttribute("data-v")?K.getAttribute("data-v"):K.hasAttribute("v")?K.getAttribute("v"):Rw(K.innerHTML),N=K.getAttribute("data-z")||K.getAttribute("z");for(g=0;g<d.length;++g){var F=d[g];F.s.c==E+s&&F.s.r<v+a&&v+a<=F.e.r&&(E=F.e.c+1-s,g=-1)}P=+K.getAttribute("colspan")||1,((R=+K.getAttribute("rowspan")||1)>1||P>1)&&d.push({s:{r:v+a,c:E+s},e:{r:v+a+(R||1)-1,c:E+s+(P||1)-1}});var j={t:"s",v:I},S=K.getAttribute("data-t")||K.getAttribute("t")||"";I!=null&&(I.length==0?j.t=S||"z":n.raw||I.trim().length==0||S=="s"||(I==="TRUE"?j={t:"b",v:!0}:I==="FALSE"?j={t:"b",v:!1}:isNaN($s(I))?isNaN(du(I).getDate())||(j={t:"d",v:Gr(I)},n.cellDates||(j={t:"n",v:Rn(j.v)}),j.z=n.dateNF||Mt[14]):j={t:"n",v:$s(I)})),j.z===void 0&&N!=null&&(j.z=N);var A="",C=K.getElementsByTagName("A");if(C&&C.length)for(var J=0;J<C.length&&!(C[J].hasAttribute("href")&&(A=C[J].getAttribute("href"),A.charAt(0)!="#"));++J);A&&A.charAt(0)!="#"&&(j.l={Target:A}),n.dense?(r[v+a]||(r[v+a]=[]),r[v+a][E+s]=j):r[qt({c:E+s,r:v+a})]=j,l.e.c<E+s&&(l.e.c=E+s),E+=P}}++v}return d.length&&(r["!merges"]=(r["!merges"]||[]).concat(d)),l.e.r=Math.max(l.e.r,v-1+a),r["!ref"]=Jt(l),v>=c&&(r["!fullref"]=Jt((l.e.r=o.length-y+v-1+a,l))),r}function fb(r,e){var t=e||{},n=t.dense?[]:{};return hb(n,r,e)}function xL(r,e){return Qo(fb(r,e),e)}function Z2(r){var e="",t=vL(r);return t&&(e=t(r).getPropertyValue("display")),e||(e=r.style&&r.style.display),e==="none"}function vL(r){return r.ownerDocument.defaultView&&typeof r.ownerDocument.defaultView.getComputedStyle=="function"?r.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function yL(r){var e=r.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=mr(e.replace(/<[^>]*>/g,""));return[t]}var ev={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function db(r,e){var t=e||{},n=S1(r),a=[],s,i,o={name:""},c="",l=0,u,d,g={},p=[],y=t.dense?[]:{},v,w,E={value:""},R="",P=0,q=[],z=-1,K=-1,I={s:{r:1e6,c:1e7},e:{r:0,c:0}},N=0,F={},j=[],S={},A=0,C=0,J=[],ue=1,me=1,pe=[],ge={Names:[]},ne={},we=["",""],Oe=[],k={},O="",M=0,U=!1,ee=!1,he=0;for(Lh.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");v=Lh.exec(n);)switch(v[3]=v[3].replace(/_.*$/,"")){case"table":case"工作表":v[1]==="/"?(I.e.c>=I.s.c&&I.e.r>=I.s.r?y["!ref"]=Jt(I):y["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=I.e.r&&(y["!fullref"]=y["!ref"],I.e.r=t.sheetRows-1,y["!ref"]=Jt(I)),j.length&&(y["!merges"]=j),J.length&&(y["!rows"]=J),u.name=u.名称||u.name,typeof JSON<"u"&&JSON.stringify(u),p.push(u.name),g[u.name]=y,ee=!1):v[0].charAt(v[0].length-2)!=="/"&&(u=Wt(v[0],!1),z=K=-1,I.s.r=I.s.c=1e7,I.e.r=I.e.c=0,y=t.dense?[]:{},j=[],J=[],ee=!0);break;case"table-row-group":v[1]==="/"?--N:++N;break;case"table-row":case"行":if(v[1]==="/"){z+=ue,ue=1;break}if(d=Wt(v[0],!1),d.行号?z=d.行号-1:z==-1&&(z=0),ue=+d["number-rows-repeated"]||1,ue<10)for(he=0;he<ue;++he)N>0&&(J[z+he]={level:N});K=-1;break;case"covered-table-cell":v[1]!=="/"&&++K,t.sheetStubs&&(t.dense?(y[z]||(y[z]=[]),y[z][K]={t:"z"}):y[qt({r:z,c:K})]={t:"z"}),R="",q=[];break;case"table-cell":case"数据":if(v[0].charAt(v[0].length-2)==="/")++K,E=Wt(v[0],!1),me=parseInt(E["number-columns-repeated"]||"1",10),w={t:"z",v:null},E.formula&&t.cellFormula!=!1&&(w.f=X2(mr(E.formula))),(E.数据类型||E["value-type"])=="string"&&(w.t="s",w.v=mr(E["string-value"]||""),t.dense?(y[z]||(y[z]=[]),y[z][K]=w):y[qt({r:z,c:K})]=w),K+=me-1;else if(v[1]!=="/"){++K,R="",P=0,q=[],me=1;var de=ue?z+ue-1:z;if(K>I.e.c&&(I.e.c=K),K<I.s.c&&(I.s.c=K),z<I.s.r&&(I.s.r=z),de>I.e.r&&(I.e.r=de),E=Wt(v[0],!1),Oe=[],k={},w={t:E.数据类型||E["value-type"],v:null},t.cellFormula)if(E.formula&&(E.formula=mr(E.formula)),E["number-matrix-columns-spanned"]&&E["number-matrix-rows-spanned"]&&(A=parseInt(E["number-matrix-rows-spanned"],10)||0,C=parseInt(E["number-matrix-columns-spanned"],10)||0,S={s:{r:z,c:K},e:{r:z+A-1,c:K+C-1}},w.F=Jt(S),pe.push([S,w.F])),E.formula)w.f=X2(E.formula);else for(he=0;he<pe.length;++he)z>=pe[he][0].s.r&&z<=pe[he][0].e.r&&K>=pe[he][0].s.c&&K<=pe[he][0].e.c&&(w.F=pe[he][1]);switch((E["number-columns-spanned"]||E["number-rows-spanned"])&&(A=parseInt(E["number-rows-spanned"],10)||0,C=parseInt(E["number-columns-spanned"],10)||0,S={s:{r:z,c:K},e:{r:z+A-1,c:K+C-1}},j.push(S)),E["number-columns-repeated"]&&(me=parseInt(E["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=Wr(E["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(E.value);break;case"percentage":w.t="n",w.v=parseFloat(E.value);break;case"currency":w.t="n",w.v=parseFloat(E.value);break;case"date":w.t="d",w.v=Gr(E["date-value"]),t.cellDates||(w.t="n",w.v=Rn(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=GT(E["time-value"])/86400,t.cellDates&&(w.t="d",w.v=bd(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(E.数据数值);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",E["string-value"]!=null&&(R=mr(E["string-value"]),q=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(U=!1,w.t==="s"&&(w.v=R||"",q.length&&(w.R=q),U=P==0),ne.Target&&(w.l=ne),Oe.length>0&&(w.c=Oe,Oe=[]),R&&t.cellText!==!1&&(w.w=R),U&&(w.t="z",delete w.v),(!U||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=z))for(var fe=0;fe<ue;++fe){if(me=parseInt(E["number-columns-repeated"]||"1",10),t.dense)for(y[z+fe]||(y[z+fe]=[]),y[z+fe][K]=fe==0?w:$r(w);--me>0;)y[z+fe][K+me]=$r(w);else for(y[qt({r:z+fe,c:K})]=w;--me>0;)y[qt({r:z+fe,c:K+me})]=$r(w);I.e.c<=K&&(I.e.c=K)}me=parseInt(E["number-columns-repeated"]||"1",10),K+=me-1,me=0,w={},R="",q=[]}ne={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(v[1]==="/"){if((s=a.pop())[0]!==v[3])throw"Bad state: "+s}else v[0].charAt(v[0].length-2)!=="/"&&a.push([v[3],!0]);break;case"annotation":if(v[1]==="/"){if((s=a.pop())[0]!==v[3])throw"Bad state: "+s;k.t=R,q.length&&(k.R=q),k.a=O,Oe.push(k)}else v[0].charAt(v[0].length-2)!=="/"&&a.push([v[3],!1]);O="",M=0,R="",P=0,q=[];break;case"creator":v[1]==="/"?O=n.slice(M,v.index):M=v.index+v[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(v[1]==="/"){if((s=a.pop())[0]!==v[3])throw"Bad state: "+s}else v[0].charAt(v[0].length-2)!=="/"&&a.push([v[3],!1]);R="",P=0,q=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(v[1]==="/"){if(F[o.name]=c,(s=a.pop())[0]!==v[3])throw"Bad state: "+s}else v[0].charAt(v[0].length-2)!=="/"&&(c="",o=Wt(v[0],!1),a.push([v[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":i=Wt(v[0],!1),c+=ev[v[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":i=Wt(v[0],!1),c+=ev[v[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(v[0].slice(-2)==="/>")break;if(v[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(l,v.index);break}else l=v.index+v[0].length;break;case"named-range":i=Wt(v[0],!1),we=fm(i["cell-range-address"]);var be={Name:i.name,Ref:we[0]+"!"+we[1]};ee&&(be.Sheet=p.length),ge.Names.push(be);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(v[1]==="/"&&(!E||!E["string-value"])){var Me=yL(n.slice(P,v.index));R=(R.length>0?R+`
`:"")+Me[0]}else Wt(v[0],!1),P=v.index+v[0].length;break;case"s":break;case"database-range":if(v[1]==="/")break;try{we=fm(Wt(v[0])["target-range-address"]),g[we[0]]["!autofilter"]={ref:we[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(v[1]!=="/"){if(ne=Wt(v[0],!1),!ne.href)break;ne.Target=mr(ne.href),delete ne.href,ne.Target.charAt(0)=="#"&&ne.Target.indexOf(".")>-1?(we=fm(ne.Target.slice(1)),ne.Target="#"+we[0]+"!"+we[1]):ne.Target.match(/^\.\.[\\\/]/)&&(ne.Target=ne.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(v[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(t.WTF)throw new Error(v)}}var Z={Sheets:g,SheetNames:p,Workbook:ge};return t.bookSheets&&delete Z.Sheets,Z}function tv(r,e){e=e||{},_s(r,"META-INF/manifest.xml")&&G6(Nn(r,"META-INF/manifest.xml"),e);var t=ns(r,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var n=db(Lr(t),e);return _s(r,"meta.xml")&&(n.Props=n_(Nn(r,"meta.xml"))),n}function rv(r,e){return db(r,e)}var wL=function(){var r=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Dh({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+r+"</office:document-styles>";return function(){return wn+e}}(),nv=function(){var r=function(s){return Tr(s).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,n=function(s,i,o){var c=[];c.push('      <table:table table:name="'+Tr(i.SheetNames[o])+`" table:style-name="ta1">
`);var l=0,u=0,d=za(s["!ref"]||"A1"),g=s["!merges"]||[],p=0,y=Array.isArray(s);if(s["!cols"])for(u=0;u<=d.e.c;++u)c.push("        <table:table-column"+(s["!cols"][u]?' table:style-name="co'+s["!cols"][u].ods+'"':"")+`></table:table-column>
`);var v="",w=s["!rows"]||[];for(l=0;l<d.s.r;++l)v=w[l]?' table:style-name="ro'+w[l].ods+'"':"",c.push("        <table:table-row"+v+`></table:table-row>
`);for(;l<=d.e.r;++l){for(v=w[l]?' table:style-name="ro'+w[l].ods+'"':"",c.push("        <table:table-row"+v+`>
`),u=0;u<d.s.c;++u)c.push(e);for(;u<=d.e.c;++u){var E=!1,R={},P="";for(p=0;p!=g.length;++p)if(!(g[p].s.c>u)&&!(g[p].s.r>l)&&!(g[p].e.c<u)&&!(g[p].e.r<l)){(g[p].s.c!=u||g[p].s.r!=l)&&(E=!0),R["table:number-columns-spanned"]=g[p].e.c-g[p].s.c+1,R["table:number-rows-spanned"]=g[p].e.r-g[p].s.r+1;break}if(E){c.push(t);continue}var q=qt({r:l,c:u}),z=y?(s[l]||[])[u]:s[q];if(z&&z.f&&(R["table:formula"]=Tr(VF(z.f)),z.F&&z.F.slice(0,q.length)==q)){var K=za(z.F);R["table:number-matrix-columns-spanned"]=K.e.c-K.s.c+1,R["table:number-matrix-rows-spanned"]=K.e.r-K.s.r+1}if(!z){c.push(e);continue}switch(z.t){case"b":P=z.v?"TRUE":"FALSE",R["office:value-type"]="boolean",R["office:boolean-value"]=z.v?"true":"false";break;case"n":P=z.w||String(z.v||0),R["office:value-type"]="float",R["office:value"]=z.v||0;break;case"s":case"str":P=z.v==null?"":z.v,R["office:value-type"]="string";break;case"d":P=z.w||Gr(z.v).toISOString(),R["office:value-type"]="date",R["office:date-value"]=Gr(z.v).toISOString(),R["table:style-name"]="ce1";break;default:c.push(e);continue}var I=r(P);if(z.l&&z.l.Target){var N=z.l.Target;N=N.charAt(0)=="#"?"#"+UF(N.slice(1)):N,N.charAt(0)!="#"&&!N.match(/^\w+:/)&&(N="../"+N),I=ct("text:a",I,{"xlink:href":N.replace(/&/g,"&amp;")})}c.push("          "+ct("table:table-cell",ct("text:p",I,{}),R)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},a=function(s,i){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;i.SheetNames.map(function(l){return i.Sheets[l]}).forEach(function(l){if(l&&l["!cols"]){for(var u=0;u<l["!cols"].length;++u)if(l["!cols"][u]){var d=l["!cols"][u];if(d.width==null&&d.wpx==null&&d.wch==null)continue;Wo(d),d.ods=o;var g=l["!cols"][u].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+g+`"/>
`),s.push(`  </style:style>
`),++o}}});var c=0;i.SheetNames.map(function(l){return i.Sheets[l]}).forEach(function(l){if(l&&l["!rows"]){for(var u=0;u<l["!rows"].length;++u)if(l["!rows"][u]){l["!rows"][u].ods=c;var d=l["!rows"][u].hpx+"px";s.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+d+`"/>
`),s.push(`  </style:style>
`),++c}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(i,o){var c=[wn],l=Dh({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=Dh({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+l+u+`>
`),c.push(r_().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+l+`>
`),a(c,i),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var d=0;d!=i.SheetNames.length;++d)c.push(n(i.Sheets[i.SheetNames[d]],i,d));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function mb(r,e){if(e.bookType=="fods")return nv(r,e);var t=w1(),n="",a=[],s=[];return n="mimetype",Qt(t,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Qt(t,n,nv(r,e)),a.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Qt(t,n,wL(r,e)),a.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Qt(t,n,wn+r_()),a.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Qt(t,n,X6(s)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Qt(t,n,$6(a)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Yc(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function fp(r){return typeof TextDecoder<"u"?new TextDecoder().decode(r):Lr(Jo(r))}function _L(r){return typeof TextEncoder<"u"?new TextEncoder().encode(r):rs(hi(r))}function bL(r,e){e:for(var t=0;t<=r.length-e.length;++t){for(var n=0;n<e.length;++n)if(r[t+n]!=e[n])continue e;return!0}return!1}function Go(r){var e=r.reduce(function(a,s){return a+s.length},0),t=new Uint8Array(e),n=0;return r.forEach(function(a){t.set(a,n),n+=a.length}),t}function av(r){return r-=r>>1&1431655765,r=(r&858993459)+(r>>2&858993459),(r+(r>>4)&252645135)*16843009>>>24}function EL(r,e){for(var t=(r[e+15]&127)<<7|r[e+14]>>1,n=r[e+14]&1,a=e+13;a>=e;--a)n=n*256+r[a];return(r[e+15]&128?-n:n)*Math.pow(10,t-6176)}function SL(r,e,t){var n=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,a=t/Math.pow(10,n-6176);r[e+15]|=n>>7,r[e+14]|=(n&127)<<1;for(var s=0;a>=1;++s,a/=256)r[e+s]=a&255;r[e+15]|=t>=0?0:128}function qh(r,e){var t=e?e[0]:0,n=r[t]&127;e:if(r[t++]>=128&&(n|=(r[t]&127)<<7,r[t++]<128||(n|=(r[t]&127)<<14,r[t++]<128)||(n|=(r[t]&127)<<21,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,28),++t,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,35),++t,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,42),++t,r[t++]<128)))break e;return e&&(e[0]=t),n}function Sr(r){var e=new Uint8Array(7);e[0]=r&127;var t=1;e:if(r>127){if(e[t-1]|=128,e[t]=r>>7&127,++t,r<=16383||(e[t-1]|=128,e[t]=r>>14&127,++t,r<=2097151)||(e[t-1]|=128,e[t]=r>>21&127,++t,r<=268435455)||(e[t-1]|=128,e[t]=r/256>>>21&127,++t,r<=34359738367)||(e[t-1]|=128,e[t]=r/65536>>>21&127,++t,r<=4398046511103))break e;e[t-1]|=128,e[t]=r/16777216>>>21&127,++t}return e.slice(0,t)}function hn(r){var e=0,t=r[e]&127;e:if(r[e++]>=128){if(t|=(r[e]&127)<<7,r[e++]<128||(t|=(r[e]&127)<<14,r[e++]<128)||(t|=(r[e]&127)<<21,r[e++]<128))break e;t|=(r[e]&127)<<28}return t}function gr(r){for(var e=[],t=[0];t[0]<r.length;){var n=t[0],a=qh(r,t),s=a&7;a=Math.floor(a/8);var i=0,o;if(a==0)break;switch(s){case 0:{for(var c=t[0];r[t[0]++]>=128;);o=r.slice(c,t[0])}break;case 5:i=4,o=r.slice(t[0],t[0]+i),t[0]+=i;break;case 1:i=8,o=r.slice(t[0],t[0]+i),t[0]+=i;break;case 2:i=qh(r,t),o=r.slice(t[0],t[0]+i),t[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var l={data:o,type:s};e[a]==null?e[a]=[l]:e[a].push(l)}return e}function Xn(r){var e=[];return r.forEach(function(t,n){t.forEach(function(a){a.data&&(e.push(Sr(n*8+a.type)),a.type==2&&e.push(Sr(a.data.length)),e.push(a.data))})}),Go(e)}function $1(r,e){return(r==null?void 0:r.map(function(t){return e(t.data)}))||[]}function ys(r){for(var e,t=[],n=[0];n[0]<r.length;){var a=qh(r,n),s=gr(r.slice(n[0],n[0]+a));n[0]+=a;var i={id:hn(s[1][0].data),messages:[]};s[2].forEach(function(o){var c=gr(o.data),l=hn(c[3][0].data);i.messages.push({meta:c,data:r.slice(n[0],n[0]+l)}),n[0]+=l}),(e=s[3])!=null&&e[0]&&(i.merge=hn(s[3][0].data)>>>0>0),t.push(i)}return t}function Dl(r){var e=[];return r.forEach(function(t){var n=[];n[1]=[{data:Sr(t.id),type:0}],n[2]=[],t.merge!=null&&(n[3]=[{data:Sr(+!!t.merge),type:0}]);var a=[];t.messages.forEach(function(i){a.push(i.data),i.meta[3]=[{type:0,data:Sr(i.data.length)}],n[2].push({data:Xn(i.meta),type:2})});var s=Xn(n);e.push(Sr(s.length)),e.push(s),a.forEach(function(i){return e.push(i)})}),Go(e)}function AL(r,e){if(r!=0)throw new Error("Unexpected Snappy chunk type ".concat(r));for(var t=[0],n=qh(e,t),a=[];t[0]<e.length;){var s=e[t[0]]&3;if(s==0){var i=e[t[0]++]>>2;if(i<60)++i;else{var o=i-59;i=e[t[0]],o>1&&(i|=e[t[0]+1]<<8),o>2&&(i|=e[t[0]+2]<<16),o>3&&(i|=e[t[0]+3]<<24),i>>>=0,i++,t[0]+=o}a.push(e.slice(t[0],t[0]+i)),t[0]+=i;continue}else{var c=0,l=0;if(s==1?(l=(e[t[0]]>>2&7)+4,c=(e[t[0]++]&224)<<3,c|=e[t[0]++]):(l=(e[t[0]++]>>2)+1,s==2?(c=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(c=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),a=[Go(a)],c==0)throw new Error("Invalid offset 0");if(c>a[0].length)throw new Error("Invalid offset beyond length");if(l>=c)for(a.push(a[0].slice(-c)),l-=c;l>=a[a.length-1].length;)a.push(a[a.length-1]),l-=a[a.length-1].length;a.push(a[0].slice(-c,-c+l))}}var u=Go(a);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function ws(r){for(var e=[],t=0;t<r.length;){var n=r[t++],a=r[t]|r[t+1]<<8|r[t+2]<<16;t+=3,e.push(AL(n,r.slice(t,t+a))),t+=a}if(t!==r.length)throw new Error("data is not a valid framed stream!");return Go(e)}function Ll(r){for(var e=[],t=0;t<r.length;){var n=Math.min(r.length-t,268435455),a=new Uint8Array(4);e.push(a);var s=Sr(n),i=s.length;e.push(s),n<=60?(i++,e.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(r.slice(t,t+n)),i+=n,a[0]=0,a[1]=i&255,a[2]=i>>8&255,a[3]=i>>16&255,t+=n}return Go(e)}function NL(r,e,t,n){var a=Yc(r),s=a.getUint32(4,!0),i=(n>1?12:8)+av(s&(n>1?3470:398))*4,o=-1,c=-1,l=NaN,u=new Date(2001,0,1);s&512&&(o=a.getUint32(i,!0),i+=4),i+=av(s&(n>1?12288:4096))*4,s&16&&(c=a.getUint32(i,!0),i+=4),s&32&&(l=a.getFloat64(i,!0),i+=8),s&64&&(u.setTime(u.getTime()+a.getFloat64(i,!0)*1e3),i+=8);var d;switch(r[2]){case 0:break;case 2:d={t:"n",v:l};break;case 3:d={t:"s",v:e[c]};break;case 5:d={t:"d",v:u};break;case 6:d={t:"b",v:l>0};break;case 7:d={t:"n",v:l/86400};break;case 8:d={t:"e",v:0};break;case 9:if(o>-1)d={t:"s",v:t[o]};else if(c>-1)d={t:"s",v:e[c]};else if(!isNaN(l))d={t:"n",v:l};else throw new Error("Unsupported cell type ".concat(r.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(r.slice(0,4)))}return d}function TL(r,e,t){var n=Yc(r),a=n.getUint32(8,!0),s=12,i=-1,o=-1,c=NaN,l=NaN,u=new Date(2001,0,1);a&1&&(c=EL(r,s),s+=16),a&2&&(l=n.getFloat64(s,!0),s+=8),a&4&&(u.setTime(u.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(o=n.getUint32(s,!0),s+=4),a&16&&(i=n.getUint32(s,!0),s+=4);var d;switch(r[1]){case 0:break;case 2:d={t:"n",v:c};break;case 3:d={t:"s",v:e[o]};break;case 5:d={t:"d",v:u};break;case 6:d={t:"b",v:l>0};break;case 7:d={t:"n",v:l/86400};break;case 8:d={t:"e",v:0};break;case 9:if(i>-1)d={t:"s",v:t[i]};else throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(a&31," : ").concat(r.slice(0,4)));break;case 10:d={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(a&31," : ").concat(r.slice(0,4)))}return d}function mm(r,e){var t=new Uint8Array(32),n=Yc(t),a=12,s=0;switch(t[0]=5,r.t){case"n":t[1]=2,SL(t,a,r.v),s|=1,a+=16;break;case"b":t[1]=6,n.setFloat64(a,r.v?1:0,!0),s|=2,a+=8;break;case"s":if(e.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));t[1]=3,n.setUint32(a,e.indexOf(r.v),!0),s|=8,a+=4;break;default:throw"unsupported cell type "+r.t}return n.setUint32(8,s,!0),t.slice(0,a)}function pm(r,e){var t=new Uint8Array(32),n=Yc(t),a=12,s=0;switch(t[0]=3,r.t){case"n":t[2]=2,n.setFloat64(a,r.v,!0),s|=32,a+=8;break;case"b":t[2]=6,n.setFloat64(a,r.v?1:0,!0),s|=32,a+=8;break;case"s":if(e.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));t[2]=3,n.setUint32(a,e.indexOf(r.v),!0),s|=16,a+=4;break;default:throw"unsupported cell type "+r.t}return n.setUint32(4,s,!0),t.slice(0,a)}function kL(r,e,t){switch(r[0]){case 0:case 1:case 2:case 3:return NL(r,e,t,r[0]);case 5:return TL(r,e,t);default:throw new Error("Unsupported payload version ".concat(r[0]))}}function la(r){var e=gr(r);return qh(e[1][0].data)}function sv(r,e){var t=gr(e.data),n=hn(t[1][0].data),a=t[3],s=[];return(a||[]).forEach(function(i){var o=gr(i.data),c=hn(o[1][0].data)>>>0;switch(n){case 1:s[c]=fp(o[3][0].data);break;case 8:{var l=r[la(o[9][0].data)][0],u=gr(l.data),d=r[la(u[1][0].data)][0],g=hn(d.meta[1][0].data);if(g!=2001)throw new Error("2000 unexpected reference to ".concat(g));var p=gr(d.data);s[c]=p[3].map(function(y){return fp(y.data)}).join("")}break}}),s}function IL(r,e){var t,n,a,s,i,o,c,l,u,d,g,p,y,v,w=gr(r),E=hn(w[1][0].data)>>>0,R=hn(w[2][0].data)>>>0,P=((n=(t=w[8])==null?void 0:t[0])==null?void 0:n.data)&&hn(w[8][0].data)>0||!1,q,z;if((s=(a=w[7])==null?void 0:a[0])!=null&&s.data&&e!=0)q=(o=(i=w[7])==null?void 0:i[0])==null?void 0:o.data,z=(l=(c=w[6])==null?void 0:c[0])==null?void 0:l.data;else if((d=(u=w[4])==null?void 0:u[0])!=null&&d.data&&e!=1)q=(p=(g=w[4])==null?void 0:g[0])==null?void 0:p.data,z=(v=(y=w[3])==null?void 0:y[0])==null?void 0:v.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var K=P?4:1,I=Yc(q),N=[],F=0;F<q.length/2;++F){var j=I.getUint16(F*2,!0);j<65535&&N.push([F,j])}if(N.length!=R)throw"Expected ".concat(R," cells, found ").concat(N.length);var S=[];for(F=0;F<N.length-1;++F)S[N[F][0]]=z.subarray(N[F][1]*K,N[F+1][1]*K);return N.length>=1&&(S[N[N.length-1][0]]=z.subarray(N[N.length-1][1]*K)),{R:E,cells:S}}function CL(r,e){var t,n=gr(e.data),a=(t=n==null?void 0:n[7])!=null&&t[0]?hn(n[7][0].data)>>>0>0?1:0:-1,s=$1(n[5],function(i){return IL(i,a)});return{nrows:hn(n[4][0].data)>>>0,data:s.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(c,l){if(i[o.R][l])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(l));i[o.R][l]=c}),i},[])}}function PL(r,e,t){var n,a=gr(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(hn(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(hn(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));t["!ref"]=Jt(s);var i=gr(a[4][0].data),o=sv(r,r[la(i[4][0].data)][0]),c=(n=i[17])!=null&&n[0]?sv(r,r[la(i[17][0].data)][0]):[],l=gr(i[3][0].data),u=0;l[1].forEach(function(d){var g=gr(d.data),p=r[la(g[2][0].data)][0],y=hn(p.meta[1][0].data);if(y!=6002)throw new Error("6001 unexpected reference to ".concat(y));var v=CL(r,p);v.data.forEach(function(w,E){w.forEach(function(R,P){var q=qt({r:u+E,c:P}),z=kL(R,o,c);z&&(t[q]=z)})}),u+=v.nrows})}function FL(r,e){var t=gr(e.data),n={"!ref":"A1"},a=r[la(t[2][0].data)],s=hn(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return PL(r,a[0],n),n}function RL(r,e){var t,n=gr(e.data),a={name:(t=n[1])!=null&&t[0]?fp(n[1][0].data):"",sheets:[]},s=$1(n[2],la);return s.forEach(function(i){r[i].forEach(function(o){var c=hn(o.meta[1][0].data);c==6e3&&a.sheets.push(FL(r,o))})}),a}function DL(r,e){var t=Q1(),n=gr(e.data),a=$1(n[1],la);if(a.forEach(function(s){r[s].forEach(function(i){var o=hn(i.meta[1][0].data);if(o==2){var c=RL(r,i);c.sheets.forEach(function(l,u){Z1(t,l,u==0?c.name:c.name+"_"+u,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function gm(r){var e,t,n,a,s={},i=[];if(r.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),r.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var l;try{l=ws(c.content)}catch(d){return console.log("?? "+c.content.length+" "+(d.message||d))}var u;try{u=ys(l)}catch(d){return console.log("## "+(d.message||d))}u.forEach(function(d){s[d.id]=d.messages,i.push(d.id)})}}),!i.length)throw new Error("File has no messages");var o=((a=(n=(t=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:t.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&hn(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||i.forEach(function(c){s[c].forEach(function(l){var u=hn(l.meta[1][0].data)>>>0;if(u==1)if(!o)o=l;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return DL(s,o)}function LL(r,e,t){var n,a,s,i;if(!((n=r[6])!=null&&n[0])||!((a=r[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var o=((i=(s=r[8])==null?void 0:s[0])==null?void 0:i.data)&&hn(r[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,l=Yc(r[7][0].data),u=0,d=[],g=Yc(r[4][0].data),p=0,y=[],v=0;v<e.length;++v){if(e[v]==null){l.setUint16(v*2,65535,!0),g.setUint16(v*2,65535);continue}l.setUint16(v*2,u,!0),g.setUint16(v*2,p,!0);var w,E;switch(typeof e[v]){case"string":w=mm({t:"s",v:e[v]},t),E=pm({t:"s",v:e[v]},t);break;case"number":w=mm({t:"n",v:e[v]},t),E=pm({t:"n",v:e[v]},t);break;case"boolean":w=mm({t:"b",v:e[v]},t),E=pm({t:"b",v:e[v]},t);break;default:throw new Error("Unsupported value "+e[v])}d.push(w),u+=w.length,y.push(E),p+=E.length,++c}for(r[2][0].data=Sr(c);v<r[7][0].data.length/2;++v)l.setUint16(v*2,65535,!0),g.setUint16(v*2,65535,!0);return r[6][0].data=Go(d),r[3][0].data=Go(y),c}function jL(r,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=r.Sheets[r.SheetNames[0]];r.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=za(t["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(Jt(n)));var s=Gf(t,{range:n,header:1}),i=["~Sh33tJ5~"];s.forEach(function(O){return O.forEach(function(M){typeof M=="string"&&i.push(M)})});var o={},c=[],l=Pt.read(e.numbers,{type:"base64"});l.FileIndex.map(function(O,M){return[O,l.FullPaths[M]]}).forEach(function(O){var M=O[0],U=O[1];if(M.type==2&&M.name.match(/\.iwa/)){var ee=M.content,he=ws(ee),de=ys(he);de.forEach(function(fe){c.push(fe.id),o[fe.id]={deps:[],location:U,type:hn(fe.messages[0].meta[1][0].data)}})}}),c.sort(function(O,M){return O-M});var u=c.filter(function(O){return O>1}).map(function(O){return[O,Sr(O)]});l.FileIndex.map(function(O,M){return[O,l.FullPaths[M]]}).forEach(function(O){var M=O[0];if(O[1],!!M.name.match(/\.iwa/)){var U=ys(ws(M.content));U.forEach(function(ee){ee.messages.forEach(function(he){u.forEach(function(de){ee.messages.some(function(fe){return hn(fe.meta[1][0].data)!=11006&&bL(fe.data,de[1])})&&o[de[0]].deps.push(ee.id)})})})}});for(var d=Pt.find(l,o[1].location),g=ys(ws(d.content)),p,y=0;y<g.length;++y){var v=g[y];v.id==1&&(p=v)}var w=la(gr(p.messages[0].data)[1][0].data);for(d=Pt.find(l,o[w].location),g=ys(ws(d.content)),y=0;y<g.length;++y)v=g[y],v.id==w&&(p=v);for(w=la(gr(p.messages[0].data)[2][0].data),d=Pt.find(l,o[w].location),g=ys(ws(d.content)),y=0;y<g.length;++y)v=g[y],v.id==w&&(p=v);for(w=la(gr(p.messages[0].data)[2][0].data),d=Pt.find(l,o[w].location),g=ys(ws(d.content)),y=0;y<g.length;++y)v=g[y],v.id==w&&(p=v);var E=gr(p.messages[0].data);{E[6][0].data=Sr(n.e.r+1),E[7][0].data=Sr(n.e.c+1);var R=la(E[46][0].data),P=Pt.find(l,o[R].location),q=ys(ws(P.content));{for(var z=0;z<q.length&&q[z].id!=R;++z);if(q[z].id!=R)throw"Bad ColumnRowUIDMapArchive";var K=gr(q[z].messages[0].data);K[1]=[],K[2]=[],K[3]=[];for(var I=0;I<=n.e.c;++I){var N=[];N[1]=N[2]=[{type:0,data:Sr(I+420690)}],K[1].push({type:2,data:Xn(N)}),K[2].push({type:0,data:Sr(I)}),K[3].push({type:0,data:Sr(I)})}K[4]=[],K[5]=[],K[6]=[];for(var F=0;F<=n.e.r;++F)N=[],N[1]=N[2]=[{type:0,data:Sr(F+726270)}],K[4].push({type:2,data:Xn(N)}),K[5].push({type:0,data:Sr(F)}),K[6].push({type:0,data:Sr(F)});q[z].messages[0].data=Xn(K)}P.content=Ll(Dl(q)),P.size=P.content.length,delete E[46];var j=gr(E[4][0].data);{j[7][0].data=Sr(n.e.r+1);var S=gr(j[1][0].data),A=la(S[2][0].data);P=Pt.find(l,o[A].location),q=ys(ws(P.content));{if(q[0].id!=A)throw"Bad HeaderStorageBucket";var C=gr(q[0].messages[0].data);for(F=0;F<s.length;++F){var J=gr(C[2][0].data);J[1][0].data=Sr(F),J[4][0].data=Sr(s[F].length),C[2][F]={type:C[2][0].type,data:Xn(J)}}q[0].messages[0].data=Xn(C)}P.content=Ll(Dl(q)),P.size=P.content.length;var ue=la(j[2][0].data);P=Pt.find(l,o[ue].location),q=ys(ws(P.content));{if(q[0].id!=ue)throw"Bad HeaderStorageBucket";for(C=gr(q[0].messages[0].data),I=0;I<=n.e.c;++I)J=gr(C[2][0].data),J[1][0].data=Sr(I),J[4][0].data=Sr(n.e.r+1),C[2][I]={type:C[2][0].type,data:Xn(J)};q[0].messages[0].data=Xn(C)}P.content=Ll(Dl(q)),P.size=P.content.length;var me=la(j[4][0].data);(function(){for(var O=Pt.find(l,o[me].location),M=ys(ws(O.content)),U,ee=0;ee<M.length;++ee){var he=M[ee];he.id==me&&(U=he)}var de=gr(U.messages[0].data);{de[3]=[];var fe=[];i.forEach(function(Z,Xe){fe[1]=[{type:0,data:Sr(Xe)}],fe[2]=[{type:0,data:Sr(1)}],fe[3]=[{type:2,data:_L(Z)}],de[3].push({type:2,data:Xn(fe)})})}U.messages[0].data=Xn(de);var be=Dl(M),Me=Ll(be);O.content=Me,O.size=O.content.length})();var pe=gr(j[3][0].data);{var ge=pe[1][0];delete pe[2];var ne=gr(ge.data);{var we=la(ne[2][0].data);(function(){for(var O=Pt.find(l,o[we].location),M=ys(ws(O.content)),U,ee=0;ee<M.length;++ee){var he=M[ee];he.id==we&&(U=he)}var de=gr(U.messages[0].data);{delete de[6],delete pe[7];var fe=new Uint8Array(de[5][0].data);de[5]=[];for(var be=0,Me=0;Me<=n.e.r;++Me){var Z=gr(fe);be+=LL(Z,s[Me],i),Z[1][0].data=Sr(Me),de[5].push({data:Xn(Z),type:2})}de[1]=[{type:0,data:Sr(n.e.c+1)}],de[2]=[{type:0,data:Sr(n.e.r+1)}],de[3]=[{type:0,data:Sr(be)}],de[4]=[{type:0,data:Sr(n.e.r+1)}]}U.messages[0].data=Xn(de);var Xe=Dl(M),st=Ll(Xe);O.content=st,O.size=O.content.length})()}ge.data=Xn(ne)}j[3][0].data=Xn(pe)}E[4][0].data=Xn(j)}p.messages[0].data=Xn(E);var Oe=Dl(g),k=Ll(Oe);return d.content=k,d.size=d.content.length,l}function pb(r){return function(t){for(var n=0;n!=r.length;++n){var a=r[n];t[a[0]]===void 0&&(t[a[0]]=a[1]),a[2]==="n"&&(t[a[0]]=Number(t[a[0]]))}}}function K1(r){pb([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(r)}function X1(r){pb([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(r)}function OL(r){return tr.WS.indexOf(r)>-1?"sheet":r==tr.CS?"chart":r==tr.DS?"dialog":r==tr.MS?"macro":r&&r.length?r:"sheet"}function ML(r,e){if(!r)return 0;try{r=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,r["!id"][n.id].Target,OL(r["!id"][n.id].Type)]})}catch{return null}return!r||r.length===0?null:r}function BL(r,e,t,n,a,s,i,o,c,l,u,d){try{s[n]=dh(ns(r,t,!0),e);var g=Nn(r,e),p;switch(o){case"sheet":p=oD(g,e,a,c,s[n],l,u,d);break;case"chart":if(p=cD(g,e,a,c,s[n],l,u,d),!p||!p["!drawel"])break;var y=ah(p["!drawel"].Target,e),v=jh(y),w=K8(ns(r,y,!0),dh(ns(r,v,!0),y)),E=ah(w,y),R=jh(E);p=LR(ns(r,E,!0),E,c,dh(ns(r,R,!0),E),l,p);break;case"macro":p=lD(g,e,a,c,s[n],l,u,d);break;case"dialog":p=uD(g,e,a,c,s[n],l,u,d);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=p;var P=[];s&&s[n]&&fn(s[n]).forEach(function(q){var z="";if(s[n][q].Type==tr.CMNT){z=ah(s[n][q].Target,e);var K=mD(Nn(r,z,!0),z,c);if(!K||!K.length)return;W2(p,K,!1)}s[n][q].Type==tr.TCMNT&&(z=ah(s[n][q].Target,e),P=P.concat(Y8(Nn(r,z,!0),c)))}),P&&P.length&&W2(p,P,!0,c.people||[])}catch(q){if(c.WTF)throw q}}function xs(r){return r.charAt(0)=="/"?r.slice(1):r}function VL(r,e){if(bu(),e=e||{},K1(e),_s(r,"META-INF/manifest.xml")||_s(r,"objectdata.xml"))return tv(r,e);if(_s(r,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof gm<"u"){if(r.FileIndex)return gm(r);var t=Pt.utils.cfb_new();return h2(r).forEach(function(J){Qt(t,J,JT(r,J))}),gm(t)}throw new Error("Unsupported NUMBERS file")}if(!_s(r,"[Content_Types].xml"))throw _s(r,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):_s(r,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=h2(r),a=W6(ns(r,"[Content_Types].xml")),s=!1,i,o;if(a.workbooks.length===0&&(o="xl/workbook.xml",Nn(r,o,!0)&&a.workbooks.push(o)),a.workbooks.length===0){if(o="xl/workbook.bin",!Nn(r,o,!0))throw new Error("Could not find workbook");a.workbooks.push(o),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var c={},l={};if(!e.bookSheets&&!e.bookProps){if(mh=[],a.sst)try{mh=dD(Nn(r,xs(a.sst)),a.sst,e)}catch(J){if(e.WTF)throw J}e.cellStyles&&a.themes.length&&(c=fD(ns(r,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],e)),a.style&&(l=hD(Nn(r,xs(a.style)),a.style,c,e))}a.links.map(function(J){try{var ue=dh(ns(r,jh(xs(J))),J);return gD(Nn(r,xs(J)),ue,J,e)}catch{}});var u=iD(Nn(r,xs(a.workbooks[0])),a.workbooks[0],e),d={},g="";a.coreprops.length&&(g=Nn(r,xs(a.coreprops[0]),!0),g&&(d=n_(g)),a.extprops.length!==0&&(g=Nn(r,xs(a.extprops[0]),!0),g&&J6(g,d,e)));var p={};(!e.bookSheets||e.bookProps)&&a.custprops.length!==0&&(g=ns(r,xs(a.custprops[0]),!0),g&&(p=Z6(g,e)));var y={};if((e.bookSheets||e.bookProps)&&(u.Sheets?i=u.Sheets.map(function(ue){return ue.name}):d.Worksheets&&d.SheetNames.length>0&&(i=d.SheetNames),e.bookProps&&(y.Props=d,y.Custprops=p),e.bookSheets&&typeof i<"u"&&(y.SheetNames=i),e.bookSheets?y.SheetNames:e.bookProps))return y;i={};var v={};e.bookDeps&&a.calcchain&&(v=pD(Nn(r,xs(a.calcchain)),a.calcchain));var w=0,E={},R,P;{var q=u.Sheets;d.Worksheets=q.length,d.SheetNames=[];for(var z=0;z!=q.length;++z)d.SheetNames[z]=q[z].name}var K=s?"bin":"xml",I=a.workbooks[0].lastIndexOf("/"),N=(a.workbooks[0].slice(0,I+1)+"_rels/"+a.workbooks[0].slice(I+1)+".rels").replace(/^\//,"");_s(r,N)||(N="xl/_rels/workbook."+K+".rels");var F=dh(ns(r,N,!0),N.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(e.xlmeta=xD(Nn(r,xs(a.metadata[0])),a.metadata[0],e)),(a.people||[]).length>=1&&(e.people=Q8(Nn(r,xs(a.people[0])),e)),F&&(F=ML(F,u.Sheets));var j=Nn(r,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=d.Worksheets;++w){var S="sheet";if(F&&F[w]?(R="xl/"+F[w][1].replace(/[\/]?xl\//,""),_s(r,R)||(R=F[w][1]),_s(r,R)||(R=N.replace(/_rels\/.*$/,"")+F[w][1]),S=F[w][2]):(R="xl/worksheets/sheet"+(w+1-j)+"."+K,R=R.replace(/sheet0\./,"sheet.")),P=R.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(w!=e.sheets)continue e;break;case"string":if(d.SheetNames[w].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var A=!1,C=0;C!=e.sheets.length;++C)typeof e.sheets[C]=="number"&&e.sheets[C]==w&&(A=1),typeof e.sheets[C]=="string"&&e.sheets[C].toLowerCase()==d.SheetNames[w].toLowerCase()&&(A=1);if(!A)continue e}}BL(r,R,P,d.SheetNames[w],w,E,i,S,e,u,c,l)}return y={Directory:a,Workbook:u,Props:d,Custprops:p,Deps:v,Sheets:i,SheetNames:d.SheetNames,Strings:mh,Styles:l,Themes:c,SSF:$r(Mt)},e&&e.bookFiles&&(r.files?(y.keys=n,y.files=r.files):(y.keys=[],y.files={},r.FullPaths.forEach(function(J,ue){J=J.replace(/^Root Entry[\/]/,""),y.keys.push(J),y.files[J]=r.FileIndex[ue]}))),e&&e.bookVBA&&(a.vba.length>0?y.vbaraw=Nn(r,xs(a.vba[0]),!0):a.defaults&&a.defaults.bin===iP&&(y.vbaraw=Nn(r,"xl/vbaProject.bin",!0))),y}function UL(r,e){var t=e||{},n="Workbook",a=Pt.find(r,n);try{if(n="/!DataSpaces/Version",a=Pt.find(r,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(xC(a.content),n="/!DataSpaces/DataSpaceMap",a=Pt.find(r,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=yC(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Pt.find(r,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=wC(a.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Pt.find(r,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);bC(a.content)}catch{}if(n="/EncryptionInfo",a=Pt.find(r,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=EC(a.content);if(n="/EncryptedPackage",a=Pt.find(r,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],a.content,t.password||"",t);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],a.content,t.password||"",t);throw new Error("File is password-protected")}function qL(r,e){return e.bookType=="ods"?mb(r,e):e.bookType=="numbers"?jL(r,e):e.bookType=="xlsb"?zL(r,e):WL(r,e)}function zL(r,e){Gl=1024,r&&!r.SSF&&(r.SSF=$r(Mt)),r&&r.SSF&&(bu(),yd(r.SSF),e.revssf=_d(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,ph?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t=e.bookType=="xlsb"?"bin":"xml",n=q_.indexOf(e.bookType)>-1,a=D1();X1(e=e||{});var s=w1(),i="",o=0;if(e.cellXfs=[],Zo(e.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),i="docProps/core.xml",Qt(s,i,a_(r.Props,e)),a.coreprops.push(i),Ar(e.rels,2,i,tr.CORE_PROPS),i="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var c=[],l=0;l<r.SheetNames.length;++l)(r.Workbook.Sheets[l]||{}).Hidden!=2&&c.push(r.SheetNames[l]);r.Props.SheetNames=c}for(r.Props.Worksheets=r.Props.SheetNames.length,Qt(s,i,o_(r.Props)),a.extprops.push(i),Ar(e.rels,3,i,tr.EXT_PROPS),r.Custprops!==r.Props&&fn(r.Custprops||{}).length>0&&(i="docProps/custom.xml",Qt(s,i,c_(r.Custprops)),a.custprops.push(i),Ar(e.rels,4,i,tr.CUST_PROPS)),o=1;o<=r.SheetNames.length;++o){var u={"!id":{}},d=r.Sheets[r.SheetNames[o-1]],g=(d||{})["!type"]||"sheet";switch(g){case"chart":default:i="xl/worksheets/sheet"+o+"."+t,Qt(s,i,yD(o-1,i,e,r,u)),a.sheets.push(i),Ar(e.wbrels,-1,"worksheets/sheet"+o+"."+t,tr.WS[0])}if(d){var p=d["!comments"],y=!1,v="";p&&p.length>0&&(v="xl/comments"+o+"."+t,Qt(s,v,bD(p,v)),a.comments.push(v),Ar(u,-1,"../comments"+o+"."+t,tr.CMNT),y=!0),d["!legacy"]&&y&&Qt(s,"xl/drawings/vmlDrawing"+o+".vml",V_(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}u["!id"].rId1&&Qt(s,jh(i),Jl(u))}return e.Strings!=null&&e.Strings.length>0&&(i="xl/sharedStrings."+t,Qt(s,i,_D(e.Strings,i,e)),a.strs.push(i),Ar(e.wbrels,-1,"sharedStrings."+t,tr.SST)),i="xl/workbook."+t,Qt(s,i,vD(r,i)),a.workbooks.push(i),Ar(e.rels,1,i,tr.WB),i="xl/theme/theme1.xml",Qt(s,i,V1(r.Themes,e)),a.themes.push(i),Ar(e.wbrels,-1,"theme/theme1.xml",tr.THEME),i="xl/styles."+t,Qt(s,i,wD(r,i,e)),a.styles.push(i),Ar(e.wbrels,-1,"styles."+t,tr.STY),r.vbaraw&&n&&(i="xl/vbaProject.bin",Qt(s,i,r.vbaraw),a.vba.push(i),Ar(e.wbrels,-1,"vbaProject.bin",tr.VBA)),i="xl/metadata."+t,Qt(s,i,ED(i)),a.metadata.push(i),Ar(e.wbrels,-1,"metadata."+t,tr.XLMETA),Qt(s,"[Content_Types].xml",t_(a,e)),Qt(s,"_rels/.rels",Jl(e.rels)),Qt(s,"xl/_rels/workbook."+t+".rels",Jl(e.wbrels)),delete e.revssf,delete e.ssf,s}function WL(r,e){Gl=1024,r&&!r.SSF&&(r.SSF=$r(Mt)),r&&r.SSF&&(bu(),yd(r.SSF),e.revssf=_d(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,ph?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t="xml",n=q_.indexOf(e.bookType)>-1,a=D1();X1(e=e||{});var s=w1(),i="",o=0;if(e.cellXfs=[],Zo(e.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),i="docProps/core.xml",Qt(s,i,a_(r.Props,e)),a.coreprops.push(i),Ar(e.rels,2,i,tr.CORE_PROPS),i="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var c=[],l=0;l<r.SheetNames.length;++l)(r.Workbook.Sheets[l]||{}).Hidden!=2&&c.push(r.SheetNames[l]);r.Props.SheetNames=c}r.Props.Worksheets=r.Props.SheetNames.length,Qt(s,i,o_(r.Props)),a.extprops.push(i),Ar(e.rels,3,i,tr.EXT_PROPS),r.Custprops!==r.Props&&fn(r.Custprops||{}).length>0&&(i="docProps/custom.xml",Qt(s,i,c_(r.Custprops)),a.custprops.push(i),Ar(e.rels,4,i,tr.CUST_PROPS));var u=["SheetJ5"];for(e.tcid=0,o=1;o<=r.SheetNames.length;++o){var d={"!id":{}},g=r.Sheets[r.SheetNames[o-1]],p=(g||{})["!type"]||"sheet";switch(p){case"chart":default:i="xl/worksheets/sheet"+o+"."+t,Qt(s,i,Z_(o-1,e,r,d)),a.sheets.push(i),Ar(e.wbrels,-1,"worksheets/sheet"+o+"."+t,tr.WS[0])}if(g){var y=g["!comments"],v=!1,w="";if(y&&y.length>0){var E=!1;y.forEach(function(R){R[1].forEach(function(P){P.T==!0&&(E=!0)})}),E&&(w="xl/threadedComments/threadedComment"+o+"."+t,Qt(s,w,J8(y,u,e)),a.threadedcomments.push(w),Ar(d,-1,"../threadedComments/threadedComment"+o+"."+t,tr.TCMNT)),w="xl/comments"+o+"."+t,Qt(s,w,U_(y)),a.comments.push(w),Ar(d,-1,"../comments"+o+"."+t,tr.CMNT),v=!0}g["!legacy"]&&v&&Qt(s,"xl/drawings/vmlDrawing"+o+".vml",V_(o,g["!comments"])),delete g["!comments"],delete g["!legacy"]}d["!id"].rId1&&Qt(s,jh(i),Jl(d))}return e.Strings!=null&&e.Strings.length>0&&(i="xl/sharedStrings."+t,Qt(s,i,k_(e.Strings,e)),a.strs.push(i),Ar(e.wbrels,-1,"sharedStrings."+t,tr.SST)),i="xl/workbook."+t,Qt(s,i,ab(r)),a.workbooks.push(i),Ar(e.rels,1,i,tr.WB),i="xl/theme/theme1.xml",Qt(s,i,V1(r.Themes,e)),a.themes.push(i),Ar(e.wbrels,-1,"theme/theme1.xml",tr.THEME),i="xl/styles."+t,Qt(s,i,j_(r,e)),a.styles.push(i),Ar(e.wbrels,-1,"styles."+t,tr.STY),r.vbaraw&&n&&(i="xl/vbaProject.bin",Qt(s,i,r.vbaraw),a.vba.push(i),Ar(e.wbrels,-1,"vbaProject.bin",tr.VBA)),i="xl/metadata."+t,Qt(s,i,B_()),a.metadata.push(i),Ar(e.wbrels,-1,"metadata."+t,tr.XLMETA),u.length>1&&(i="xl/persons/person.xml",Qt(s,i,Z8(u)),a.people.push(i),Ar(e.wbrels,-1,"persons/person.xml",tr.PEOPLE)),Qt(s,"[Content_Types].xml",t_(a,e)),Qt(s,"_rels/.rels",Jl(e.rels)),Qt(s,"xl/_rels/workbook."+t+".rels",Jl(e.wbrels)),delete e.revssf,delete e.ssf,s}function Y1(r,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];case"base64":t=cs(r.slice(0,12));break;case"binary":t=r;break;case"array":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function HL(r,e){return Pt.find(r,"EncryptedPackage")?UL(r,e):cb(r,e)}function GL(r,e){var t,n=r,a=e||{};return a.type||(a.type=Zt&&Buffer.isBuffer(r)?"buffer":"base64"),t=Cw(n,a),VL(t,a)}function gb(r,e){var t=0;e:for(;t<r.length;)switch(r.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return up(r.slice(t),e);default:break e}return mu.to_workbook(r,e)}function $L(r,e){var t="",n=Y1(r,e);switch(e.type){case"base64":t=cs(r);break;case"binary":t=r;break;case"buffer":t=r.toString("binary");break;case"array":t=Gc(r);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(t=Lr(t)),e.type="binary",gb(t,e)}function KL(r,e){var t=r;return e.type=="base64"&&(t=cs(t)),t=Po.utils.decode(1200,t.slice(2),"str"),e.type="binary",gb(t,e)}function XL(r){return r.match(/[^\x00-\x7F]/)?hi(r):r}function xm(r,e,t,n){return n?(t.type="string",mu.to_workbook(r,t)):mu.to_workbook(e,t)}function dp(r,e){p1();var t=e||{};if(typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer)return dp(new Uint8Array(r),(t=$r(t),t.type="array",t));typeof Uint8Array<"u"&&r instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var n=r,a=[0,0,0,0],s=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),Zl={},t.dateNF&&(Zl.dateNF=t.dateNF),t.type||(t.type=Zt&&Buffer.isBuffer(r)?"buffer":"base64"),t.type=="file"&&(t.type=Zt?"buffer":"binary",n=zT(r),typeof Uint8Array<"u"&&!Zt&&(t.type="array")),t.type=="string"&&(s=!0,t.type="binary",t.codepage=65001,n=XL(r)),t.type=="array"&&typeof Uint8Array<"u"&&r instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return t=$r(t),t.type="array",dp(g1(n),t)}switch((a=Y1(n,t))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return HL(Pt.read(n,t),t);break;case 9:if(a[1]<=8)return cb(n,t);break;case 60:return up(n,t);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return eC(n,t);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return N_.to_workbook(n,t);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?GL(n,t):xm(r,n,t,s);case 239:return a[3]===60?up(n,t):xm(r,n,t,s);case 255:if(a[1]===254)return KL(n,t);if(a[1]===0&&a[2]===2&&a[3]===0)return Rc.to_workbook(n,t);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Rc.to_workbook(n,t);break;case 3:case 131:case 139:case 140:return lp.to_workbook(n,t);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return R_.to_workbook(n,t);break;case 10:case 13:case 32:return $L(n,t);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return ZI.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?lp.to_workbook(n,t):xm(r,n,t,s)}function xb(r,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return r0(e.file,Pt.write(r,{type:Zt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Pt.write(r,e)}function YL(r,e){var t=$r(e||{}),n=qL(r,t);return JL(n,t)}function JL(r,e){var t={},n=Zt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(t.compression="DEFLATE"),e.password)t.type=n;else switch(e.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":t.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var a=r.FullPaths?Pt.write(r,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!e.compression}):r.generate(t);if(typeof Deno<"u"&&typeof a=="string"){if(e.type=="binary"||e.type=="base64")return a;a=new Uint8Array(vd(a))}return e.password&&typeof encrypt_agile<"u"?xb(encrypt_agile(a,e.password),e):e.type==="file"?r0(e.file,a):e.type=="string"?Lr(a):a}function QL(r,e){var t=e||{},n=XD(r,t);return xb(n,t)}function oi(r,e,t){t||(t="");var n=t+r;switch(e.type){case"base64":return Ph(hi(n));case"binary":return hi(n);case"string":return r;case"file":return r0(e.file,n,"utf8");case"buffer":return Zt?$i(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):oi(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function ZL(r,e){switch(e.type){case"base64":return Ph(r);case"binary":return r;case"string":return r;case"file":return r0(e.file,r,"binary");case"buffer":return Zt?$i(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Y0(r,e){switch(e.type){case"string":case"base64":case"binary":for(var t="",n=0;n<r.length;++n)t+=String.fromCharCode(r[n]);return e.type=="base64"?Ph(t):e.type=="string"?Lr(t):t;case"file":return r0(e.file,r);case"buffer":return r;default:throw new Error("Unrecognized type "+e.type)}}function vb(r,e){p1(),HR(r);var t=$r(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var n=vb(r,t);return t.type="array",vd(n)}var a=0;if(t.sheet&&(typeof t.sheet=="number"?a=t.sheet:a=r.SheetNames.indexOf(t.sheet),!r.SheetNames[a]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return oi(qD(r,t),t);case"slk":case"sylk":return oi(A_.from_sheet(r.Sheets[r.SheetNames[a]],t),t);case"htm":case"html":return oi(ub(r.Sheets[r.SheetNames[a]],t),t);case"txt":return ZL(yb(r.Sheets[r.SheetNames[a]],t),t);case"csv":return oi(J1(r.Sheets[r.SheetNames[a]],t),t,"\uFEFF");case"dif":return oi(N_.from_sheet(r.Sheets[r.SheetNames[a]],t),t);case"dbf":return Y0(lp.from_sheet(r.Sheets[r.SheetNames[a]],t),t);case"prn":return oi(mu.from_sheet(r.Sheets[r.SheetNames[a]],t),t);case"rtf":return oi(R_.from_sheet(r.Sheets[r.SheetNames[a]],t),t);case"eth":return oi(T_.from_sheet(r.Sheets[r.SheetNames[a]],t),t);case"fods":return oi(mb(r,t),t);case"wk1":return Y0(Rc.sheet_to_wk1(r.Sheets[r.SheetNames[a]],t),t);case"wk3":return Y0(Rc.book_to_wk3(r,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),Y0(lb(r,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),QL(r,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return YL(r,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function ej(r){if(!r.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=r.file.slice(r.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(r.bookType=t.slice(1)),r.bookType=e[r.bookType]||r.bookType}}function tj(r,e,t){var n={};return n.type="file",n.file=e,ej(n),vb(r,n)}function rj(r,e,t,n,a,s,i,o){var c=yn(t),l=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,g=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:t,enumerable:!1})}catch{g.__rowNum__=t}else g.__rowNum__=t;if(!i||r[t])for(var p=e.s.c;p<=e.e.c;++p){var y=i?r[t][p]:r[n[p]+c];if(y===void 0||y.t===void 0){if(l===void 0)continue;s[p]!=null&&(g[s[p]]=l);continue}var v=y.v;switch(y.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(s[p]!=null){if(v==null)if(y.t=="e"&&v===null)g[s[p]]=null;else if(l!==void 0)g[s[p]]=l;else if(u&&v===null)g[s[p]]=null;else continue;else g[s[p]]=u&&(y.t!=="n"||y.t==="n"&&o.rawNumbers!==!1)?v:Hi(y,v,o);v!=null&&(d=!1)}}return{row:g,isempty:d}}function Gf(r,e){if(r==null||r["!ref"]==null)return[];var t={t:"n",v:0},n=0,a=1,s=[],i=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},l=e||{},u=l.range!=null?l.range:r["!ref"];switch(l.header===1?n=1:l.header==="A"?n=2:Array.isArray(l.header)?n=3:l.header==null&&(n=0),typeof u){case"string":c=pr(u);break;case"number":c=pr(r["!ref"]),c.s.r=u;break;default:c=u}n>0&&(a=0);var d=yn(c.s.r),g=[],p=[],y=0,v=0,w=Array.isArray(r),E=c.s.r,R=0,P={};w&&!r[E]&&(r[E]=[]);var q=l.skipHidden&&r["!cols"]||[],z=l.skipHidden&&r["!rows"]||[];for(R=c.s.c;R<=c.e.c;++R)if(!(q[R]||{}).hidden)switch(g[R]=Zr(R),t=w?r[E][R]:r[g[R]+d],n){case 1:s[R]=R-c.s.c;break;case 2:s[R]=g[R];break;case 3:s[R]=l.header[R-c.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),o=i=Hi(t,null,l),v=P[i]||0,!v)P[i]=1;else{do o=i+"_"+v++;while(P[o]);P[i]=v,P[o]=1}s[R]=o}for(E=c.s.r+a;E<=c.e.r;++E)if(!(z[E]||{}).hidden){var K=rj(r,c,E,g,n,s,w,l);(K.isempty===!1||(n===1?l.blankrows!==!1:l.blankrows))&&(p[y++]=K.row)}return p.length=y,p}var iv=/"/g;function nj(r,e,t,n,a,s,i,o){for(var c=!0,l=[],u="",d=yn(t),g=e.s.c;g<=e.e.c;++g)if(n[g]){var p=o.dense?(r[t]||[])[g]:r[n[g]+d];if(p==null)u="";else if(p.v!=null){c=!1,u=""+(o.rawNumbers&&p.t=="n"?p.v:Hi(p,null,o));for(var y=0,v=0;y!==u.length;++y)if((v=u.charCodeAt(y))===a||v===s||v===34||o.forceQuotes){u='"'+u.replace(iv,'""')+'"';break}u=="ID"&&(u='"ID"')}else p.f!=null&&!p.F?(c=!1,u="="+p.f,u.indexOf(",")>=0&&(u='"'+u.replace(iv,'""')+'"')):u="";l.push(u)}return o.blankrows===!1&&c?null:l.join(i)}function J1(r,e){var t=[],n=e??{};if(r==null||r["!ref"]==null)return"";var a=pr(r["!ref"]),s=n.FS!==void 0?n.FS:",",i=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),l=new RegExp((s=="|"?"\\|":s)+"+$"),u="",d=[];n.dense=Array.isArray(r);for(var g=n.skipHidden&&r["!cols"]||[],p=n.skipHidden&&r["!rows"]||[],y=a.s.c;y<=a.e.c;++y)(g[y]||{}).hidden||(d[y]=Zr(y));for(var v=0,w=a.s.r;w<=a.e.r;++w)(p[w]||{}).hidden||(u=nj(r,a,w,d,i,c,s,n),u!=null&&(n.strip&&(u=u.replace(l,"")),(u||n.blankrows!==!1)&&t.push((v++?o:"")+u)));return delete n.dense,t.join("")}function yb(r,e){e||(e={}),e.FS="	",e.RS=`
`;var t=J1(r,e);return t}function aj(r){var e="",t,n="";if(r==null||r["!ref"]==null)return[];var a=pr(r["!ref"]),s="",i=[],o,c=[],l=Array.isArray(r);for(o=a.s.c;o<=a.e.c;++o)i[o]=Zr(o);for(var u=a.s.r;u<=a.e.r;++u)for(s=yn(u),o=a.s.c;o<=a.e.c;++o)if(e=i[o]+s,t=l?(r[u]||[])[o]:r[e],n="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;n=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)n=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)n=""+t.v;else if(t.t=="b")n=t.v?"TRUE":"FALSE";else if(t.w!==void 0)n="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?n="'"+t.v:n=""+t.v}}c[c.length]=e+"="+n}return c}function wb(r,e,t){var n=t||{},a=+!n.skipHeader,s=r||{},i=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?en(n.origin):n.origin;i=c.r,o=c.c}var l,u={s:{c:0,r:0},e:{c:o,r:i+e.length-1+a}};if(s["!ref"]){var d=pr(s["!ref"]);u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),i==-1&&(i=d.e.r+1,u.e.r=i+e.length-1+a)}else i==-1&&(i=0,u.e.r=e.length-1+a);var g=n.header||[],p=0;e.forEach(function(v,w){fn(v).forEach(function(E){(p=g.indexOf(E))==-1&&(g[p=g.length]=E);var R=v[E],P="z",q="",z=qt({c:o+p,r:i+w+a});l=zh(s,z),R&&typeof R=="object"&&!(R instanceof Date)?s[z]=R:(typeof R=="number"?P="n":typeof R=="boolean"?P="b":typeof R=="string"?P="s":R instanceof Date?(P="d",n.cellDates||(P="n",R=Rn(R)),q=n.dateNF||Mt[14]):R===null&&n.nullError&&(P="e",R=0),l?(l.t=P,l.v=R,delete l.w,delete l.R,q&&(l.z=q)):s[z]=l={t:P,v:R},q&&(l.z=q))})}),u.e.c=Math.max(u.e.c,o+g.length-1);var y=yn(i);if(a)for(p=0;p<g.length;++p)s[Zr(p+o)+y]={t:"s",v:g[p]};return s["!ref"]=Jt(u),s}function sj(r,e){return wb(null,r,e)}function zh(r,e,t){if(typeof e=="string"){if(Array.isArray(r)){var n=en(e);return r[n.r]||(r[n.r]=[]),r[n.r][n.c]||(r[n.r][n.c]={t:"z"})}return r[e]||(r[e]={t:"z"})}return typeof e!="number"?zh(r,qt(e)):zh(r,qt({r:e,c:t||0}))}function ij(r,e){if(typeof e=="number"){if(e>=0&&r.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=r.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function Q1(){return{SheetNames:[],Sheets:{}}}function Z1(r,e,t,n){var a=1;if(!t)for(;a<=65535&&r.SheetNames.indexOf(t="Sheet"+a)!=-1;++a,t=void 0);if(!t||r.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&r.SheetNames.indexOf(t)>=0){var s=t.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var i=s&&s[1]||t;for(++a;a<=65535&&r.SheetNames.indexOf(t=i+a)!=-1;++a);}if(nb(t),r.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return r.SheetNames.push(t),r.Sheets[t]=e,t}function oj(r,e,t){r.Workbook||(r.Workbook={}),r.Workbook.Sheets||(r.Workbook.Sheets=[]);var n=ij(r,e);switch(r.Workbook.Sheets[n]||(r.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}r.Workbook.Sheets[n].Hidden=t}function cj(r,e){return r.z=e,r}function _b(r,e,t){return e?(r.l={Target:e},t&&(r.l.Tooltip=t)):delete r.l,r}function lj(r,e,t){return _b(r,"#"+e,t)}function uj(r,e,t){r.c||(r.c=[]),r.c.push({t:e,a:t||"SheetJS"})}function hj(r,e,t,n){for(var a=typeof e!="string"?e:pr(e),s=typeof e=="string"?e:Jt(e),i=a.s.r;i<=a.e.r;++i)for(var o=a.s.c;o<=a.e.c;++o){var c=zh(r,i,o);c.t="n",c.F=s,delete c.v,i==a.s.r&&o==a.s.c&&(c.f=t,n&&(c.D=!0))}return r}var df={encode_col:Zr,encode_row:yn,encode_cell:qt,encode_range:Jt,decode_col:k1,decode_row:T1,split_cell:_6,decode_cell:en,decode_range:za,format_cell:Hi,sheet_add_aoa:Kw,sheet_add_json:wb,sheet_add_dom:hb,aoa_to_sheet:Eu,json_to_sheet:sj,table_to_sheet:fb,table_to_book:xL,sheet_to_csv:J1,sheet_to_txt:yb,sheet_to_json:Gf,sheet_to_html:ub,sheet_to_formulae:aj,sheet_to_row_object_array:Gf,sheet_get_cell:zh,book_new:Q1,book_append_sheet:Z1,book_set_sheet_visibility:oj,cell_set_number_format:cj,cell_set_hyperlink:_b,cell_set_internal_link:lj,cell_add_comment:uj,sheet_set_array_formula:hj,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const fj=r=>{const e=r.map(a=>({Código:a.code,Nombre:a.name,Cantidad:a.quantity,"Precio de Costo":a.costPrice,"Precio de Venta":a.salePrice,Categoría:a.category,"URL de Imagen":a.imageUrl||"","Alerta Stock Bajo":a.lowStockThreshold})),t=df.book_new(),n=df.json_to_sheet(e);df.book_append_sheet(t,n,"Productos"),tj(t,"productos.xlsx")},dj=async r=>new Promise((e,t)=>{const n=new FileReader;n.onload=a=>{var s;try{const i=new Uint8Array((s=a.target)==null?void 0:s.result),o=dp(i,{type:"array"}),c=o.Sheets[o.SheetNames[0]],u=df.sheet_to_json(c).map(g=>{var p,y,v,w;return{id:Date.now().toString()+Math.random().toString(36).substr(2,9),code:((p=g.Código)==null?void 0:p.toString())||"",name:((y=g.Nombre)==null?void 0:y.toString())||"",quantity:Number(g.Cantidad)||0,costPrice:Number(g["Precio de Costo"])||0,salePrice:Number(g["Precio de Venta"])||0,category:((v=g.Categoría)==null?void 0:v.toString())||"",imageUrl:((w=g["URL de Imagen"])==null?void 0:w.toString())||"",lowStockThreshold:Number(g["Alerta Stock Bajo"])||5}}),d=u.reduce((g,p,y)=>(p.code||g.push(`Fila ${y+2}: Código es requerido`),p.name||g.push(`Fila ${y+2}: Nombre es requerido`),p.quantity<0&&g.push(`Fila ${y+2}: Cantidad no puede ser negativa`),p.costPrice<=0&&g.push(`Fila ${y+2}: Precio de costo debe ser mayor a 0`),p.salePrice<=0&&g.push(`Fila ${y+2}: Precio de venta debe ser mayor a 0`),p.salePrice<=p.costPrice&&g.push(`Fila ${y+2}: Precio de venta debe ser mayor al precio de costo`),p.category||g.push(`Fila ${y+2}: Categoría es requerida`),g),[]);if(d.length>0)throw new Error(`Errores en el archivo:
`+d.join(`
`));e(u)}catch(i){t(i)}},n.onerror=()=>{t(new Error("Error al leer el archivo"))},n.readAsArrayBuffer(r)});function mj(){const[r,e]=Se.useState([]),[t,n]=Se.useState(!0),[a,s]=Se.useState(null),[i,o]=Se.useState(()=>[]),[c,l]=Se.useState(!1),[u,d]=Se.useState(!1),[g,p]=Se.useState();Se.useEffect(()=>{(async()=>{n(!0);try{const[K,I]=await Promise.all([Bt.products.load(),Bt.categories.load()]);e(K),o(I),s(null)}catch(K){console.error("Error loading products:",K),s("Error loading products"),e([]),o([])}finally{n(!1)}})()},[]),Se.useEffect(()=>{!t&&r.length>0&&Bt.products.save(r).catch(z=>{console.error("Error saving products:",z)})},[r,t]),Se.useEffect(()=>{!t&&i.length>0&&Bt.categories.save(i).catch(z=>{console.error("Error saving categories:",z)})},[i,t]);const y=z=>{const K={...z,id:Date.now().toString()};e([...r,K]),l(!1)},v=z=>{g&&(e(r.map(K=>K.id===g.id?{...z,id:K.id}:K)),p(void 0),l(!1))},w=z=>{if(window.confirm("¿Estás seguro de que deseas eliminar este producto?")){const K=r.filter(I=>I.id!==z);e(K),Bt.products.save(K).catch(I=>{console.error("Error deleting product:",I),e(r),alert("Error al eliminar el producto. Por favor intente nuevamente.")})}},E=z=>{const K={id:Date.now().toString(),name:z},I=[...i,K];o(I),Bt.categories.save(I).catch(N=>{console.error("Error saving categories:",N),o(i)})},R=z=>{const K=i.find(I=>I.id===z);if(K&&r.some(I=>I.category===K.name)){alert("No se puede eliminar una categoría que tiene productos asociados");return}if(window.confirm("¿Estás seguro de que deseas eliminar esta categoría?")){const I=i.filter(N=>N.id!==z);o(I),Bt.categories.save(I).catch(N=>{console.error("Error saving categories after deletion:",N),o(i)})}},P=()=>{fj(r)},q=async z=>{var I;const K=(I=z.target.files)==null?void 0:I[0];if(K){try{const N=await dj(K),F=N.filter(j=>r.some(S=>S.code===j.code)).map(j=>j.code);if(F.length>0){alert(`Los siguientes códigos ya existen:
${F.join(`
`)}`);return}e([...r,...N]),alert("Productos importados correctamente")}catch(N){alert(N instanceof Error?N.message:"Error al importar productos")}z.target.value=""}};return h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Productos"}),h.jsxs("div",{className:"space-x-3",children:[h.jsxs("button",{onClick:P,className:"px-4 py-2 border border-green-600 text-green-600 rounded-lg hover:bg-green-50 flex items-center inline-flex",children:[h.jsx(zv,{className:"w-4 h-4 mr-2"}),"Exportar Excel"]}),h.jsxs("label",{className:"px-4 py-2 border border-blue-600 text-blue-600 rounded-lg hover:bg-blue-50 cursor-pointer inline-flex items-center",children:[h.jsx(L4,{className:"w-4 h-4 mr-2"}),"Importar Excel",h.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:q,className:"hidden"})]}),h.jsx("button",{onClick:()=>d(!0),className:"px-4 py-2 border border-purple-600 text-purple-600 rounded-lg hover:bg-purple-50",children:"Gestionar Categorías"}),h.jsxs("button",{onClick:()=>{p(void 0),l(!0)},className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 flex items-center",children:[h.jsx(Ts,{className:"w-4 h-4 mr-2"}),"Nuevo Producto"]})]})]}),r.length>0?h.jsx(Q4,{products:r,onEdit:z=>{p(z),l(!0)},onDelete:w}):h.jsx("div",{className:"bg-white rounded-lg shadow p-6 text-center text-gray-500",children:"No hay productos registrados. Comienza agregando uno nuevo."}),c&&h.jsx(Z4,{product:g,categories:i.map(z=>z.name),onSubmit:g?v:y,onClose:()=>{l(!1),p(void 0)},existingCodes:r.map(z=>z.code)}),u&&h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:h.jsx("div",{className:"bg-white rounded-lg max-w-md w-full",children:h.jsxs("div",{className:"p-6",children:[h.jsx(e3,{categories:i,onAddCategory:E,onDeleteCategory:R}),h.jsx("div",{className:"mt-4 flex justify-end",children:h.jsx("button",{onClick:()=>d(!1),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Cerrar"})})]})})})]})}function pj({clients:r,onEdit:e,onDelete:t,onViewHistory:n}){const a=s=>s.purchases.reduce((i,o)=>i+o.total,0);return h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"min-w-full bg-white rounded-lg overflow-hidden",children:[h.jsx("thead",{className:"bg-gray-50",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Código"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nombre"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Teléfono"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Compras"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),h.jsx("tbody",{className:"divide-y divide-gray-200",children:r.map(s=>h.jsxs("tr",{className:"hover:bg-gray-50",children:[h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.code}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.name}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.phone}),h.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[et(a(s)),h.jsxs("div",{className:"text-xs text-gray-500",children:[s.purchases.length," compras realizadas"]})]}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:h.jsxs("div",{className:"flex space-x-2",children:[h.jsx("button",{onClick:()=>n(s),className:"text-blue-600 hover:text-blue-900",title:"Ver historial",children:h.jsx(kp,{className:"w-4 h-4"})}),h.jsx("button",{onClick:()=>e(s),className:"text-indigo-600 hover:text-indigo-900",title:"Editar",children:h.jsx($h,{className:"w-4 h-4"})}),h.jsx("button",{onClick:()=>t(s.id),className:"text-red-600 hover:text-red-900",title:"Eliminar",children:h.jsx(pi,{className:"w-4 h-4"})})]})})]},s.id))})]})})}function gj({client:r,onSubmit:e,onClose:t,existingCodes:n}){const[a,s]=Se.useState({code:"",name:"",phone:""}),[i,o]=Se.useState({});Se.useEffect(()=>{r&&s({code:r.code,name:r.name,phone:r.phone})},[r]);const c=()=>{const u={};return a.code?!r&&n.includes(a.code)&&(u.code="Este código ya existe"):u.code="El código es requerido",a.name||(u.name="El nombre es requerido"),a.phone?/^\d{8}$/.test(a.phone)||(u.phone="El teléfono debe tener 8 dígitos"):u.phone="El teléfono es requerido",o(u),Object.keys(u).length===0},l=u=>{u.preventDefault(),c()&&e(a)};return h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full",children:[h.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:r?"Editar Cliente":"Nuevo Cliente"}),h.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700",children:h.jsx(Ir,{className:"w-6 h-6"})})]}),h.jsxs("form",{onSubmit:l,className:"p-6 space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Código *"}),h.jsx("input",{type:"text",value:a.code,onChange:u=>s({...a,code:u.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",disabled:!!r}),i.code&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.code})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre *"}),h.jsx("input",{type:"text",value:a.name,onChange:u=>s({...a,name:u.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),i.name&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.name})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Teléfono *"}),h.jsx("input",{type:"tel",value:a.phone,onChange:u=>s({...a,phone:u.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",maxLength:8}),i.phone&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.phone})]}),h.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[h.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancelar"}),h.jsx("button",{type:"submit",className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:r?"Guardar Cambios":"Crear Cliente"})]})]})]})})}function xj({client:r,onClose:e}){const t=n=>new Date(n).toLocaleDateString("es-NI",{year:"numeric",month:"long",day:"numeric"});return h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[h.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[h.jsxs("div",{children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Historial de Compras"}),h.jsxs("p",{className:"text-gray-600",children:["Cliente: ",r.name]})]}),h.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700",children:h.jsx(Ir,{className:"w-6 h-6"})})]}),h.jsx("div",{className:"flex-1 overflow-auto p-6",children:r.purchases.length===0?h.jsx("div",{className:"text-center text-gray-500 py-8",children:"Este cliente aún no tiene compras registradas."}):h.jsx("div",{className:"space-y-6",children:r.purchases.map(n=>h.jsxs("div",{className:"border rounded-lg p-4",children:[h.jsx("div",{className:"flex justify-between items-center mb-4",children:h.jsxs("div",{children:[h.jsx("div",{className:"text-sm text-gray-500",children:t(n.date)}),h.jsxs("div",{className:"font-medium text-gray-900",children:["Total: ",et(n.total)]})]})}),h.jsxs("table",{className:"min-w-full",children:[h.jsx("thead",{children:h.jsxs("tr",{className:"text-xs text-gray-500 uppercase",children:[h.jsx("th",{className:"text-left pb-2",children:"Producto"}),h.jsx("th",{className:"text-right pb-2",children:"Cantidad"}),h.jsx("th",{className:"text-right pb-2",children:"Precio"}),h.jsx("th",{className:"text-right pb-2",children:"Subtotal"})]})}),h.jsx("tbody",{className:"divide-y divide-gray-200",children:n.products.map(a=>h.jsxs("tr",{children:[h.jsx("td",{className:"py-2",children:a.name}),h.jsx("td",{className:"text-right py-2",children:a.quantity}),h.jsx("td",{className:"text-right py-2",children:et(a.price)}),h.jsx("td",{className:"text-right py-2",children:et(a.price*a.quantity)})]},a.id))})]})]},n.id))})}),h.jsx("div",{className:"border-t p-4",children:h.jsx("button",{onClick:e,className:"w-full px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"Cerrar"})})]})})}function ov(){const[r,e]=Se.useState([]),[t,n]=Se.useState(!0),[a,s]=Se.useState(null),[i,o]=Se.useState(!1),[c,l]=Se.useState(),[u,d]=Se.useState();Se.useEffect(()=>{(async()=>{n(!0);try{const E=await Bt.clients.load();e(Array.isArray(E)?E:[]),s(null)}catch(E){console.error("Error loading clients:",E),s("Error loading clients"),e([])}finally{n(!1)}})()},[]);const g=Se.useCallback(async w=>{try{await Bt.clients.save(w),e(w)}catch(E){console.error("Error saving clients:",E),s("Error saving clients")}},[]),p=w=>{const E={...w,id:Date.now().toString(),purchases:[]};g([...r,E]),o(!1)},y=w=>{c&&(e(r.map(E=>E.id===c.id?{...E,...w}:E)),g(r.map(E=>E.id===c.id?{...E,...w}:E)),o(!1))},v=w=>{window.confirm("¿Estás seguro de que deseas eliminar este cliente?")&&g(r.filter(E=>E.id!==w))};return t?h.jsx("div",{className:"flex justify-center items-center h-64",children:h.jsx("div",{className:"text-gray-500",children:"Cargando..."})}):a?h.jsxs("div",{className:"text-red-500",children:["Error: ",a]}):h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Clientes"}),h.jsxs("button",{onClick:()=>{l(void 0),o(!0)},className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 flex items-center",children:[h.jsx(Ts,{className:"w-4 h-4 mr-2"}),"Nuevo Cliente"]})]}),r.length>0?h.jsx(pj,{clients:r,onEdit:w=>{l(w),o(!0)},onDelete:v,onViewHistory:w=>d(w)}):h.jsx("div",{className:"bg-white rounded-lg shadow p-6 text-center text-gray-500",children:"No hay clientes registrados. Comienza agregando uno nuevo."}),i&&h.jsx(gj,{client:c,onSubmit:c?y:p,onClose:()=>{o(!1),l(void 0)},existingCodes:r.map(w=>w.code)}),u&&h.jsx(xj,{client:u,onClose:()=>d(void 0)})]})}function vj({inventoryCost:r,totalSales:e,totalExpenses:t,costOfSales:n,netProfit:a,cashBalance:s,cashPayments:i,cardPayments:o,transferPayments:c,creditTotal:l,creditPaid:u,creditPending:d,creditProfit:g}){return h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[h.jsxs("div",{className:"bg-white rounded-lg shadow p-6 space-y-4",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Dinero en Caja"}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("span",{className:"text-gray-600",children:"Ventas Totales"}),h.jsx("span",{className:"font-medium",children:et(e)})]}),h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("span",{className:"text-gray-600",children:"Gastos"}),h.jsx("span",{className:"font-medium text-red-600",children:et(t)})]}),h.jsx("div",{className:"pt-2 border-t",children:h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("span",{className:"font-semibold",children:"Balance en Caja"}),h.jsx("span",{className:`font-bold text-lg ${s>=0?"text-green-600":"text-red-600"}`,children:et(s)})]})})]})]}),h.jsxs("div",{className:"bg-white rounded-lg shadow p-6 space-y-4",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Ventas y Ganancias Directas"}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("span",{className:"text-gray-600",children:"Ventas Totales"}),h.jsx("span",{className:"font-medium",children:et(e)})]}),h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("span",{className:"text-gray-600",children:"Costo de Ventas"}),h.jsxs("span",{className:"font-medium text-red-600",children:["-",et(n)]})]}),h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("span",{className:"text-gray-600",children:"Gastos"}),h.jsxs("span",{className:"font-medium text-red-600",children:["-",et(t)]})]}),h.jsx("div",{className:"pt-2 border-t",children:h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("span",{className:"font-semibold",children:"Ganancia Neta"}),h.jsx("span",{className:`font-bold text-lg ${a>=0?"text-green-600":"text-red-600"}`,children:et(a)})]})})]})]}),h.jsxs("div",{className:"bg-white rounded-lg shadow p-6 space-y-4",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Ganancias en Créditos"}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("span",{className:"text-gray-600",children:"Ventas en Crédito"}),h.jsx("span",{className:"font-medium",children:et(l)})]}),h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("span",{className:"text-gray-600",children:"Costo Original"}),h.jsxs("span",{className:"font-medium text-red-600",children:["-",et(l-g)]})]}),h.jsxs("div",{className:"pt-2 border-t",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("span",{className:"font-semibold",children:"Ganancia Realizada"}),h.jsx("span",{className:"font-bold text-green-600",children:et(g)})]}),h.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:["Basado en pagos recibidos: ",et(u)]})]})]})]}),h.jsxs("div",{className:"bg-white rounded-lg shadow p-6 space-y-4",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Métodos de Pago"}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center",children:[h.jsx(Gh,{className:"w-5 h-5 text-green-600 mr-2"}),h.jsx("span",{className:"text-gray-600",children:"Efectivo"})]}),h.jsx("span",{className:"font-medium",children:et(i)})]}),h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center",children:[h.jsx(Xf,{className:"w-5 h-5 text-blue-600 mr-2"}),h.jsx("span",{className:"text-gray-600",children:"Tarjeta"})]}),h.jsx("span",{className:"font-medium",children:et(o)})]}),h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center",children:[h.jsx(j4,{className:"w-5 h-5 text-purple-600 mr-2"}),h.jsx("span",{className:"text-gray-600",children:"Transferencia"})]}),h.jsx("span",{className:"font-medium",children:et(c)})]})]})]}),h.jsxs("div",{className:"bg-white rounded-lg shadow p-6 space-y-4",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Créditos"}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("span",{className:"text-gray-600",children:"Total en Créditos"}),h.jsx("span",{className:"font-medium",children:et(l)})]}),h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("span",{className:"text-gray-600",children:"Pagado"}),h.jsx("span",{className:"font-medium text-green-600",children:et(u)})]}),h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("span",{className:"text-gray-600",children:"Pendiente"}),h.jsx("span",{className:"font-medium text-yellow-600",children:et(d)})]}),h.jsxs("div",{className:"flex justify-between items-center pt-2 border-t",children:[h.jsx("span",{className:"text-gray-600",children:"Ganancia en Créditos"}),h.jsx("span",{className:"font-medium text-green-600",children:et(g)})]})]})]})]}),h.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Resumen de Inventario"}),h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center",children:[h.jsx(gu,{className:"w-5 h-5 text-gray-600 mr-2"}),h.jsx("span",{className:"text-gray-600",children:"Valor Total del Inventario"})]}),h.jsx("span",{className:"font-medium",children:et(r)})]})]})]})}const J0=(r,e,t)=>{if(!Array.isArray(r))return[];const n=new Date(e),a=new Date(t);return isNaN(n.getTime())||isNaN(a.getTime())?(console.error("Invalid date range:",{startDate:e,endDate:t}),[]):(a.setHours(23,59,59,999),r.filter(s=>{try{if(!s||!s.date)return console.warn("Invalid sale object:",s),!1;const i=new Date(s.date);return isNaN(i.getTime())?(console.warn("Invalid sale date:",s.date),!1):i>=n&&i<=a&&s.status==="active"}catch(i){return console.error("Error filtering sale:",{saleId:s==null?void 0:s.id,date:s==null?void 0:s.date,error:i instanceof Error?i.message:i}),!1}}))},cv=(r,e,t)=>{try{if(!r)return!1;const n=new Date(r),a=new Date(e),s=new Date(t);return s.setHours(23,59,59,999),isNaN(n.getTime())||isNaN(a.getTime())||isNaN(s.getTime())?(console.warn("Invalid date in range check:",{date:r,startDate:e,endDate:t}),!1):n>=a&&n<=s}catch(n){return console.error("Error checking date range:",{date:r,startDate:e,endDate:t,error:n instanceof Error?n.message:n}),!1}},Ku=(r,e,t,n,a,s)=>{const i=e.reduce((y,v)=>y+v.costPrice*v.quantity,0);if(!Array.isArray(r)||r.length===0)return{inventoryCost:i,totalSales:0,totalExpenses:0,costOfSales:0,netProfit:0,cashBalance:0,totalProfit:0,cashPayments:0,cardPayments:0,transferPayments:0,creditTotal:0,creditPaid:0,creditPending:0,creditProfit:0};const o=n.filter(y=>cv(y.createdAt,a,s)&&y.status!=="cancelled").reduce((y,v)=>{const w=v.payments.reduce((q,z)=>q+z.amount,0),E=w/v.finalPrice,P=(v.finalPrice-v.originalPrice)*E;return{total:y.total+v.finalPrice,paid:y.paid+w,pending:y.pending+(v.finalPrice-w),profit:y.profit+P}},{total:0,paid:0,pending:0,profit:0}),c=r.reduce((y,v)=>y+v.total,0),l=r.reduce((y,v)=>y+v.products.reduce((w,E)=>w+E.originalPrice*E.quantity,0),0),u=t.filter(y=>y.status==="active"&&cv(y.date,a,s)).reduce((y,v)=>y+v.amount,0),d=r.reduce((y,v)=>{const w=Number(v.total)||0;switch(v.paymentMethod){case"cash":return{...y,cash:y.cash+w};case"card":return{...y,card:y.card+w};case"transfer":return{...y,transfer:y.transfer+w};default:return y}},{cash:0,card:0,transfer:0}),g=c-l-u,p=g+o.profit;return{inventoryCost:i,totalSales:c,totalExpenses:u,costOfSales:l,netProfit:g,cashBalance:c-u,totalProfit:p,cashPayments:d.cash,cardPayments:d.card,transferPayments:d.transfer,creditTotal:o.total,creditPaid:o.paid,creditPending:o.pending,creditProfit:o.profit}};function eg({startDate:r,endDate:e,onStartDateChange:t,onEndDateChange:n,onSearch:a}){return h.jsxs("div",{className:"bg-white rounded-lg shadow p-4 flex items-center space-x-4",children:[h.jsx(Tp,{className:"w-5 h-5 text-gray-500"}),h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Desde"}),h.jsx("input",{type:"date",value:r,onChange:s=>t(s.target.value),max:e,className:"px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hasta"}),h.jsx("input",{type:"date",value:e,onChange:s=>n(s.target.value),min:r,className:"px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]}),h.jsx("button",{onClick:a,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 flex items-center",children:"Buscar"})]})}const yj="modulepreload",wj=function(r){return"/"+r},lv={},mp=function(e,t,n){let a=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));a=Promise.allSettled(t.map(c=>{if(c=wj(c),c in lv)return;lv[c]=!0;const l=c.endsWith(".css"),u=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const d=document.createElement("link");if(d.rel=l?"stylesheet":yj,l||(d.as="script"),d.crossOrigin="",d.href=c,o&&d.setAttribute("nonce",o),document.head.appendChild(d),l)return new Promise((g,p)=>{d.addEventListener("load",g),d.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return a.then(i=>{for(const o of i||[])o.status==="rejected"&&s(o.reason);return e().catch(s)})};function kr(r){"@babel/helpers - typeof";return kr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kr(r)}var ma=Uint8Array,ss=Uint16Array,tg=Int32Array,Td=new ma([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),kd=new ma([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),pp=new ma([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),bb=function(r,e){for(var t=new ss(31),n=0;n<31;++n)t[n]=e+=1<<r[n-1];for(var a=new tg(t[30]),n=1;n<30;++n)for(var s=t[n];s<t[n+1];++s)a[s]=s-t[n]<<5|n;return{b:t,r:a}},Eb=bb(Td,2),Sb=Eb.b,gp=Eb.r;Sb[28]=258,gp[258]=28;var Ab=bb(kd,0),_j=Ab.b,uv=Ab.r,xp=new ss(32768);for(var Hr=0;Hr<32768;++Hr){var ko=(Hr&43690)>>1|(Hr&21845)<<1;ko=(ko&52428)>>2|(ko&13107)<<2,ko=(ko&61680)>>4|(ko&3855)<<4,xp[Hr]=((ko&65280)>>8|(ko&255)<<8)>>1}var mi=function(r,e,t){for(var n=r.length,a=0,s=new ss(e);a<n;++a)r[a]&&++s[r[a]-1];var i=new ss(e);for(a=1;a<e;++a)i[a]=i[a-1]+s[a-1]<<1;var o;if(t){o=new ss(1<<e);var c=15-e;for(a=0;a<n;++a)if(r[a])for(var l=a<<4|r[a],u=e-r[a],d=i[r[a]-1]++<<u,g=d|(1<<u)-1;d<=g;++d)o[xp[d]>>c]=l}else for(o=new ss(n),a=0;a<n;++a)r[a]&&(o[a]=xp[i[r[a]-1]++]>>15-r[a]);return o},$o=new ma(288);for(var Hr=0;Hr<144;++Hr)$o[Hr]=8;for(var Hr=144;Hr<256;++Hr)$o[Hr]=9;for(var Hr=256;Hr<280;++Hr)$o[Hr]=7;for(var Hr=280;Hr<288;++Hr)$o[Hr]=8;var Wh=new ma(32);for(var Hr=0;Hr<32;++Hr)Wh[Hr]=5;var bj=mi($o,9,0),Ej=mi($o,9,1),Sj=mi(Wh,5,0),Aj=mi(Wh,5,1),vm=function(r){for(var e=r[0],t=1;t<r.length;++t)r[t]>e&&(e=r[t]);return e},Us=function(r,e,t){var n=e/8|0;return(r[n]|r[n+1]<<8)>>(e&7)&t},ym=function(r,e){var t=e/8|0;return(r[t]|r[t+1]<<8|r[t+2]<<16)>>(e&7)},rg=function(r){return(r+7)/8|0},Nb=function(r,e,t){return(t==null||t>r.length)&&(t=r.length),new ma(r.subarray(e,t))},Nj=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Ws=function(r,e,t){var n=new Error(e||Nj[r]);if(n.code=r,Error.captureStackTrace&&Error.captureStackTrace(n,Ws),!t)throw n;return n},Tj=function(r,e,t,n){var a=r.length,s=0;if(!a||e.f&&!e.l)return t||new ma(0);var i=!t,o=i||e.i!=2,c=e.i;i&&(t=new ma(a*3));var l=function(Me){var Z=t.length;if(Me>Z){var Xe=new ma(Math.max(Z*2,Me));Xe.set(t),t=Xe}},u=e.f||0,d=e.p||0,g=e.b||0,p=e.l,y=e.d,v=e.m,w=e.n,E=a*8;do{if(!p){u=Us(r,d,1);var R=Us(r,d+1,3);if(d+=3,R)if(R==1)p=Ej,y=Aj,v=9,w=5;else if(R==2){var K=Us(r,d,31)+257,I=Us(r,d+10,15)+4,N=K+Us(r,d+5,31)+1;d+=14;for(var F=new ma(N),j=new ma(19),S=0;S<I;++S)j[pp[S]]=Us(r,d+S*3,7);d+=I*3;for(var A=vm(j),C=(1<<A)-1,J=mi(j,A,1),S=0;S<N;){var ue=J[Us(r,d,C)];d+=ue&15;var P=ue>>4;if(P<16)F[S++]=P;else{var me=0,pe=0;for(P==16?(pe=3+Us(r,d,3),d+=2,me=F[S-1]):P==17?(pe=3+Us(r,d,7),d+=3):P==18&&(pe=11+Us(r,d,127),d+=7);pe--;)F[S++]=me}}var ge=F.subarray(0,K),ne=F.subarray(K);v=vm(ge),w=vm(ne),p=mi(ge,v,1),y=mi(ne,w,1)}else Ws(1);else{var P=rg(d)+4,q=r[P-4]|r[P-3]<<8,z=P+q;if(z>a){c&&Ws(0);break}o&&l(g+q),t.set(r.subarray(P,z),g),e.b=g+=q,e.p=d=z*8,e.f=u;continue}if(d>E){c&&Ws(0);break}}o&&l(g+131072);for(var we=(1<<v)-1,Oe=(1<<w)-1,k=d;;k=d){var me=p[ym(r,d)&we],O=me>>4;if(d+=me&15,d>E){c&&Ws(0);break}if(me||Ws(2),O<256)t[g++]=O;else if(O==256){k=d,p=null;break}else{var M=O-254;if(O>264){var S=O-257,U=Td[S];M=Us(r,d,(1<<U)-1)+Sb[S],d+=U}var ee=y[ym(r,d)&Oe],he=ee>>4;ee||Ws(3),d+=ee&15;var ne=_j[he];if(he>3){var U=kd[he];ne+=ym(r,d)&(1<<U)-1,d+=U}if(d>E){c&&Ws(0);break}o&&l(g+131072);var de=g+M;if(g<ne){var fe=s-ne,be=Math.min(ne,de);for(fe+g<0&&Ws(3);g<be;++g)t[g]=n[fe+g]}for(;g<de;++g)t[g]=t[g-ne]}}e.l=p,e.p=k,e.b=g,e.f=u,p&&(u=1,e.m=v,e.d=y,e.n=w)}while(!u);return g!=t.length&&i?Nb(t,0,g):t.subarray(0,g)},ji=function(r,e,t){t<<=e&7;var n=e/8|0;r[n]|=t,r[n+1]|=t>>8},Xu=function(r,e,t){t<<=e&7;var n=e/8|0;r[n]|=t,r[n+1]|=t>>8,r[n+2]|=t>>16},wm=function(r,e){for(var t=[],n=0;n<r.length;++n)r[n]&&t.push({s:n,f:r[n]});var a=t.length,s=t.slice();if(!a)return{t:kb,l:0};if(a==1){var i=new ma(t[0].s+1);return i[t[0].s]=1,{t:i,l:1}}t.sort(function(z,K){return z.f-K.f}),t.push({s:-1,f:25001});var o=t[0],c=t[1],l=0,u=1,d=2;for(t[0]={s:-1,f:o.f+c.f,l:o,r:c};u!=a-1;)o=t[t[l].f<t[d].f?l++:d++],c=t[l!=u&&t[l].f<t[d].f?l++:d++],t[u++]={s:-1,f:o.f+c.f,l:o,r:c};for(var g=s[0].s,n=1;n<a;++n)s[n].s>g&&(g=s[n].s);var p=new ss(g+1),y=vp(t[u-1],p,0);if(y>e){var n=0,v=0,w=y-e,E=1<<w;for(s.sort(function(K,I){return p[I.s]-p[K.s]||K.f-I.f});n<a;++n){var R=s[n].s;if(p[R]>e)v+=E-(1<<y-p[R]),p[R]=e;else break}for(v>>=w;v>0;){var P=s[n].s;p[P]<e?v-=1<<e-p[P]++-1:++n}for(;n>=0&&v;--n){var q=s[n].s;p[q]==e&&(--p[q],++v)}y=e}return{t:new ma(p),l:y}},vp=function(r,e,t){return r.s==-1?Math.max(vp(r.l,e,t+1),vp(r.r,e,t+1)):e[r.s]=t},hv=function(r){for(var e=r.length;e&&!r[--e];);for(var t=new ss(++e),n=0,a=r[0],s=1,i=function(c){t[n++]=c},o=1;o<=e;++o)if(r[o]==a&&o!=e)++s;else{if(!a&&s>2){for(;s>138;s-=138)i(32754);s>2&&(i(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(i(a),--s;s>6;s-=6)i(8304);s>2&&(i(s-3<<5|8208),s=0)}for(;s--;)i(a);s=1,a=r[o]}return{c:t.subarray(0,n),n:e}},Yu=function(r,e){for(var t=0,n=0;n<e.length;++n)t+=r[n]*e[n];return t},Tb=function(r,e,t){var n=t.length,a=rg(e+2);r[a]=n&255,r[a+1]=n>>8,r[a+2]=r[a]^255,r[a+3]=r[a+1]^255;for(var s=0;s<n;++s)r[a+s+4]=t[s];return(a+4+n)*8},fv=function(r,e,t,n,a,s,i,o,c,l,u){ji(e,u++,t),++a[256];for(var d=wm(a,15),g=d.t,p=d.l,y=wm(s,15),v=y.t,w=y.l,E=hv(g),R=E.c,P=E.n,q=hv(v),z=q.c,K=q.n,I=new ss(19),N=0;N<R.length;++N)++I[R[N]&31];for(var N=0;N<z.length;++N)++I[z[N]&31];for(var F=wm(I,7),j=F.t,S=F.l,A=19;A>4&&!j[pp[A-1]];--A);var C=l+5<<3,J=Yu(a,$o)+Yu(s,Wh)+i,ue=Yu(a,g)+Yu(s,v)+i+14+3*A+Yu(I,j)+2*I[16]+3*I[17]+7*I[18];if(c>=0&&C<=J&&C<=ue)return Tb(e,u,r.subarray(c,c+l));var me,pe,ge,ne;if(ji(e,u,1+(ue<J)),u+=2,ue<J){me=mi(g,p,0),pe=g,ge=mi(v,w,0),ne=v;var we=mi(j,S,0);ji(e,u,P-257),ji(e,u+5,K-1),ji(e,u+10,A-4),u+=14;for(var N=0;N<A;++N)ji(e,u+3*N,j[pp[N]]);u+=3*A;for(var Oe=[R,z],k=0;k<2;++k)for(var O=Oe[k],N=0;N<O.length;++N){var M=O[N]&31;ji(e,u,we[M]),u+=j[M],M>15&&(ji(e,u,O[N]>>5&127),u+=O[N]>>12)}}else me=bj,pe=$o,ge=Sj,ne=Wh;for(var N=0;N<o;++N){var U=n[N];if(U>255){var M=U>>18&31;Xu(e,u,me[M+257]),u+=pe[M+257],M>7&&(ji(e,u,U>>23&31),u+=Td[M]);var ee=U&31;Xu(e,u,ge[ee]),u+=ne[ee],ee>3&&(Xu(e,u,U>>5&8191),u+=kd[ee])}else Xu(e,u,me[U]),u+=pe[U]}return Xu(e,u,me[256]),u+pe[256]},kj=new tg([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),kb=new ma(0),Ij=function(r,e,t,n,a,s){var i=s.z||r.length,o=new ma(n+i+5*(1+Math.ceil(i/7e3))+a),c=o.subarray(n,o.length-a),l=s.l,u=(s.r||0)&7;if(e){u&&(c[0]=s.r>>3);for(var d=kj[e-1],g=d>>13,p=d&8191,y=(1<<t)-1,v=s.p||new ss(32768),w=s.h||new ss(y+1),E=Math.ceil(t/3),R=2*E,P=function(st){return(r[st]^r[st+1]<<E^r[st+2]<<R)&y},q=new tg(25e3),z=new ss(288),K=new ss(32),I=0,N=0,F=s.i||0,j=0,S=s.w||0,A=0;F+2<i;++F){var C=P(F),J=F&32767,ue=w[C];if(v[J]=ue,w[C]=J,S<=F){var me=i-F;if((I>7e3||j>24576)&&(me>423||!l)){u=fv(r,c,0,q,z,K,N,j,A,F-A,u),j=I=N=0,A=F;for(var pe=0;pe<286;++pe)z[pe]=0;for(var pe=0;pe<30;++pe)K[pe]=0}var ge=2,ne=0,we=p,Oe=J-ue&32767;if(me>2&&C==P(F-Oe))for(var k=Math.min(g,me)-1,O=Math.min(32767,F),M=Math.min(258,me);Oe<=O&&--we&&J!=ue;){if(r[F+ge]==r[F+ge-Oe]){for(var U=0;U<M&&r[F+U]==r[F+U-Oe];++U);if(U>ge){if(ge=U,ne=Oe,U>k)break;for(var ee=Math.min(Oe,U-2),he=0,pe=0;pe<ee;++pe){var de=F-Oe+pe&32767,fe=v[de],be=de-fe&32767;be>he&&(he=be,ue=de)}}}J=ue,ue=v[J],Oe+=J-ue&32767}if(ne){q[j++]=268435456|gp[ge]<<18|uv[ne];var Me=gp[ge]&31,Z=uv[ne]&31;N+=Td[Me]+kd[Z],++z[257+Me],++K[Z],S=F+ge,++I}else q[j++]=r[F],++z[r[F]]}}for(F=Math.max(F,S);F<i;++F)q[j++]=r[F],++z[r[F]];u=fv(r,c,l,q,z,K,N,j,A,F-A,u),l||(s.r=u&7|c[u/8|0]<<3,u-=7,s.h=w,s.p=v,s.i=F,s.w=S)}else{for(var F=s.w||0;F<i+l;F+=65535){var Xe=F+65535;Xe>=i&&(c[u/8|0]=l,Xe=i),u=Tb(c,u+1,r.subarray(F,Xe))}s.i=i}return Nb(o,0,n+rg(u)+a)},Ib=function(){var r=1,e=0;return{p:function(t){for(var n=r,a=e,s=t.length|0,i=0;i!=s;){for(var o=Math.min(i+2655,s);i<o;++i)a+=n+=t[i];n=(n&65535)+15*(n>>16),a=(a&65535)+15*(a>>16)}r=n,e=a},d:function(){return r%=65521,e%=65521,(r&255)<<24|(r&65280)<<8|(e&255)<<8|e>>8}}},Cj=function(r,e,t,n,a){if(!a&&(a={l:1},e.dictionary)){var s=e.dictionary.subarray(-32768),i=new ma(s.length+r.length);i.set(s),i.set(r,s.length),r=i,a.w=s.length}return Ij(r,e.level==null?6:e.level,e.mem==null?a.l?Math.ceil(Math.max(8,Math.min(13,Math.log(r.length)))*1.5):20:12+e.mem,t,n,a)},Cb=function(r,e,t){for(;t;++e)r[e]=t,t>>>=8},Pj=function(r,e){var t=e.level,n=t==0?0:t<6?1:t==9?3:2;if(r[0]=120,r[1]=n<<6|(e.dictionary&&32),r[1]|=31-(r[0]<<8|r[1])%31,e.dictionary){var a=Ib();a.p(e.dictionary),Cb(r,2,a.d())}},Fj=function(r,e){return((r[0]&15)!=8||r[0]>>4>7||(r[0]<<8|r[1])%31)&&Ws(6,"invalid zlib data"),(r[1]>>5&1)==+!e&&Ws(6,"invalid zlib data: "+(r[1]&32?"need":"unexpected")+" dictionary"),(r[1]>>3&4)+2};function yp(r,e){e||(e={});var t=Ib();t.p(r);var n=Cj(r,e,e.dictionary?6:2,4);return Pj(n,e),Cb(n,n.length-4,t.d()),n}function Rj(r,e){return Tj(r.subarray(Fj(r,e),-4),{i:2},e,e)}var Dj=typeof TextDecoder<"u"&&new TextDecoder,Lj=0;try{Dj.decode(kb,{stream:!0}),Lj=1}catch{}var Ut=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function _m(){Ut.console&&typeof Ut.console.log=="function"&&Ut.console.log.apply(Ut.console,arguments)}var Br={log:_m,warn:function(r){Ut.console&&(typeof Ut.console.warn=="function"?Ut.console.warn.apply(Ut.console,arguments):_m.call(null,arguments))},error:function(r){Ut.console&&(typeof Ut.console.error=="function"?Ut.console.error.apply(Ut.console,arguments):_m(r))}};function bm(r,e,t){var n=new XMLHttpRequest;n.open("GET",r),n.responseType="blob",n.onload=function(){_c(n.response,e,t)},n.onerror=function(){Br.error("could not download file")},n.send()}function dv(r){var e=new XMLHttpRequest;e.open("HEAD",r,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function Q0(r){try{r.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),r.dispatchEvent(e)}}var vh,wp,_c=Ut.saveAs||((typeof window>"u"?"undefined":kr(window))!=="object"||window!==Ut?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(r,e,t){var n=Ut.URL||Ut.webkitURL,a=document.createElement("a");e=e||r.name||"download",a.download=e,a.rel="noopener",typeof r=="string"?(a.href=r,a.origin!==location.origin?dv(a.href)?bm(r,e,t):Q0(a,a.target="_blank"):Q0(a)):(a.href=n.createObjectURL(r),setTimeout(function(){n.revokeObjectURL(a.href)},4e4),setTimeout(function(){Q0(a)},0))}:"msSaveOrOpenBlob"in navigator?function(r,e,t){if(e=e||r.name||"download",typeof r=="string")if(dv(r))bm(r,e,t);else{var n=document.createElement("a");n.href=r,n.target="_blank",setTimeout(function(){Q0(n)})}else navigator.msSaveOrOpenBlob(function(a,s){return s===void 0?s={autoBom:!1}:kr(s)!=="object"&&(Br.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}(r,t),e)}:function(r,e,t,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof r=="string")return bm(r,e,t);var a=r.type==="application/octet-stream",s=/constructor/i.test(Ut.HTMLElement)||Ut.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent);if((i||a&&s)&&(typeof FileReader>"u"?"undefined":kr(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var u=o.result;u=i?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=u:location=u,n=null},o.readAsDataURL(r)}else{var c=Ut.URL||Ut.webkitURL,l=c.createObjectURL(r);n?n.location=l:location.href=l,n=null,setTimeout(function(){c.revokeObjectURL(l)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function Pb(r){var e;r=r||"",this.ok=!1,r.charAt(0)=="#"&&(r=r.substr(1,6)),r={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[r=(r=r.replace(/ /g,"")).toLowerCase()]||r;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],n=0;n<t.length;n++){var a=t[n].re,s=t[n].process,i=a.exec(r);i&&(e=s(i),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),c=this.g.toString(16),l=this.b.toString(16);return o.length==1&&(o="0"+o),c.length==1&&(c="0"+c),l.length==1&&(l="0"+l),"#"+o+c+l}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Em(r,e){var t=r[0],n=r[1],a=r[2],s=r[3];t=sa(t,n,a,s,e[0],7,-680876936),s=sa(s,t,n,a,e[1],12,-389564586),a=sa(a,s,t,n,e[2],17,606105819),n=sa(n,a,s,t,e[3],22,-1044525330),t=sa(t,n,a,s,e[4],7,-176418897),s=sa(s,t,n,a,e[5],12,1200080426),a=sa(a,s,t,n,e[6],17,-1473231341),n=sa(n,a,s,t,e[7],22,-45705983),t=sa(t,n,a,s,e[8],7,1770035416),s=sa(s,t,n,a,e[9],12,-1958414417),a=sa(a,s,t,n,e[10],17,-42063),n=sa(n,a,s,t,e[11],22,-1990404162),t=sa(t,n,a,s,e[12],7,1804603682),s=sa(s,t,n,a,e[13],12,-40341101),a=sa(a,s,t,n,e[14],17,-1502002290),t=ia(t,n=sa(n,a,s,t,e[15],22,1236535329),a,s,e[1],5,-165796510),s=ia(s,t,n,a,e[6],9,-1069501632),a=ia(a,s,t,n,e[11],14,643717713),n=ia(n,a,s,t,e[0],20,-373897302),t=ia(t,n,a,s,e[5],5,-701558691),s=ia(s,t,n,a,e[10],9,38016083),a=ia(a,s,t,n,e[15],14,-660478335),n=ia(n,a,s,t,e[4],20,-405537848),t=ia(t,n,a,s,e[9],5,568446438),s=ia(s,t,n,a,e[14],9,-1019803690),a=ia(a,s,t,n,e[3],14,-187363961),n=ia(n,a,s,t,e[8],20,1163531501),t=ia(t,n,a,s,e[13],5,-1444681467),s=ia(s,t,n,a,e[2],9,-51403784),a=ia(a,s,t,n,e[7],14,1735328473),t=oa(t,n=ia(n,a,s,t,e[12],20,-1926607734),a,s,e[5],4,-378558),s=oa(s,t,n,a,e[8],11,-2022574463),a=oa(a,s,t,n,e[11],16,1839030562),n=oa(n,a,s,t,e[14],23,-35309556),t=oa(t,n,a,s,e[1],4,-1530992060),s=oa(s,t,n,a,e[4],11,1272893353),a=oa(a,s,t,n,e[7],16,-155497632),n=oa(n,a,s,t,e[10],23,-1094730640),t=oa(t,n,a,s,e[13],4,681279174),s=oa(s,t,n,a,e[0],11,-358537222),a=oa(a,s,t,n,e[3],16,-722521979),n=oa(n,a,s,t,e[6],23,76029189),t=oa(t,n,a,s,e[9],4,-640364487),s=oa(s,t,n,a,e[12],11,-421815835),a=oa(a,s,t,n,e[15],16,530742520),t=ca(t,n=oa(n,a,s,t,e[2],23,-995338651),a,s,e[0],6,-198630844),s=ca(s,t,n,a,e[7],10,1126891415),a=ca(a,s,t,n,e[14],15,-1416354905),n=ca(n,a,s,t,e[5],21,-57434055),t=ca(t,n,a,s,e[12],6,1700485571),s=ca(s,t,n,a,e[3],10,-1894986606),a=ca(a,s,t,n,e[10],15,-1051523),n=ca(n,a,s,t,e[1],21,-2054922799),t=ca(t,n,a,s,e[8],6,1873313359),s=ca(s,t,n,a,e[15],10,-30611744),a=ca(a,s,t,n,e[6],15,-1560198380),n=ca(n,a,s,t,e[13],21,1309151649),t=ca(t,n,a,s,e[4],6,-145523070),s=ca(s,t,n,a,e[11],10,-1120210379),a=ca(a,s,t,n,e[2],15,718787259),n=ca(n,a,s,t,e[9],21,-343485551),r[0]=Lo(t,r[0]),r[1]=Lo(n,r[1]),r[2]=Lo(a,r[2]),r[3]=Lo(s,r[3])}function Id(r,e,t,n,a,s){return e=Lo(Lo(e,r),Lo(n,s)),Lo(e<<a|e>>>32-a,t)}function sa(r,e,t,n,a,s,i){return Id(e&t|~e&n,r,e,a,s,i)}function ia(r,e,t,n,a,s,i){return Id(e&n|t&~n,r,e,a,s,i)}function oa(r,e,t,n,a,s,i){return Id(e^t^n,r,e,a,s,i)}function ca(r,e,t,n,a,s,i){return Id(t^(e|~n),r,e,a,s,i)}function Fb(r){var e,t=r.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=r.length;e+=64)Em(n,jj(r.substring(e-64,e)));r=r.substring(e-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<r.length;e++)a[e>>2]|=r.charCodeAt(e)<<(e%4<<3);if(a[e>>2]|=128<<(e%4<<3),e>55)for(Em(n,a),e=0;e<16;e++)a[e]=0;return a[14]=8*t,Em(n,a),n}function jj(r){var e,t=[];for(e=0;e<64;e+=4)t[e>>2]=r.charCodeAt(e)+(r.charCodeAt(e+1)<<8)+(r.charCodeAt(e+2)<<16)+(r.charCodeAt(e+3)<<24);return t}vh=Ut.atob.bind(Ut),wp=Ut.btoa.bind(Ut);var mv="0123456789abcdef".split("");function Oj(r){for(var e="",t=0;t<4;t++)e+=mv[r>>8*t+4&15]+mv[r>>8*t&15];return e}function Mj(r){return String.fromCharCode((255&r)>>0,(65280&r)>>8,(16711680&r)>>16,(4278190080&r)>>24)}function _p(r){return Fb(r).map(Mj).join("")}var Bj=function(r){for(var e=0;e<r.length;e++)r[e]=Oj(r[e]);return r.join("")}(Fb("hello"))!="5d41402abc4b2a76b9719d911017c592";function Lo(r,e){if(Bj){var t=(65535&r)+(65535&e);return(r>>16)+(e>>16)+(t>>16)<<16|65535&t}return r+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function bp(r,e){var t,n,a,s;if(r!==t){for(var i=(a=r,s=1+(256/r.length>>0),new Array(s+1).join(a)),o=[],c=0;c<256;c++)o[c]=c;var l=0;for(c=0;c<256;c++){var u=o[c];l=(l+u+i.charCodeAt(c))%256,o[c]=o[l],o[l]=u}t=r,n=o}else o=n;var d=e.length,g=0,p=0,y="";for(c=0;c<d;c++)p=(p+(u=o[g=(g+1)%256]))%256,o[g]=o[p],o[p]=u,i=o[(o[g]+o[p])%256],y+=String.fromCharCode(e.charCodeAt(c)^i);return y}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var pv={print:4,modify:8,copy:16,"annot-forms":32};function Wl(r,e,t,n){this.v=1,this.r=2;var a=192;r.forEach(function(o){if(pv.perm!==void 0)throw new Error("Invalid permission: "+o);a+=pv[o]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var s=(e+this.padding).substr(0,32),i=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,i),this.P=-(1+(255^a)),this.encryptionKey=_p(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=bp(this.encryptionKey,this.padding)}function Hl(r){if(/[^\u0000-\u00ff]/.test(r))throw new Error("Invalid PDF Name Object: "+r+", Only accept ASCII characters.");for(var e="",t=r.length,n=0;n<t;n++){var a=r.charCodeAt(n);a<33||a===35||a===37||a===40||a===41||a===47||a===60||a===62||a===91||a===93||a===123||a===125||a>126?e+="#"+("0"+a.toString(16)).slice(-2):e+=r[n]}return e}function gv(r){if(kr(r)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(t,n,a){if(a=a||!1,typeof t!="string"||typeof n!="function"||typeof a!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(t)||(e[t]={});var s=Math.random().toString(35);return e[t][s]=[n,!!a],s},this.unsubscribe=function(t){for(var n in e)if(e[n][t])return delete e[n][t],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(t){if(e.hasOwnProperty(t)){var n=Array.prototype.slice.call(arguments,1),a=[];for(var s in e[t]){var i=e[t][s];try{i[0].apply(r,n)}catch(o){Ut.console&&Br.error("jsPDF PubSub Error",o.message,o)}i[1]&&a.push(s)}a.length&&a.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function $f(r){if(!(this instanceof $f))return new $f(r);var e="opacity,stroke-opacity".split(",");for(var t in r)r.hasOwnProperty(t)&&e.indexOf(t)>=0&&(this[t]=r[t]);this.id="",this.objectNumber=-1}function Rb(r,e){this.gState=r,this.matrix=e,this.id="",this.objectNumber=-1}function Tc(r,e,t,n,a){if(!(this instanceof Tc))return new Tc(r,e,t,n,a);this.type=r==="axial"?2:3,this.coords=e,this.colors=t,Rb.call(this,n,a)}function $l(r,e,t,n,a){if(!(this instanceof $l))return new $l(r,e,t,n,a);this.boundingBox=r,this.xStep=e,this.yStep=t,this.stream="",this.cloneIndex=0,Rb.call(this,n,a)}function jt(r){var e,t=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],a=arguments[2],s=arguments[3],i=[],o=1,c=16,l="S",u=null;kr(r=r||{})==="object"&&(t=r.orientation,n=r.unit||n,a=r.format||a,s=r.compress||r.compressPdf||s,(u=r.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),o=typeof r.userUnit=="number"?Math.abs(r.userUnit):1,r.precision!==void 0&&(e=r.precision),r.floatPrecision!==void 0&&(c=r.floatPrecision),l=r.defaultPathOperation||"S"),i=r.filters||(s===!0?["FlateEncode"]:i),n=n||"mm",t=(""+(t||"P")).toLowerCase();var d=r.putOnlyUsedFonts||!1,g={},p={internal:{},__private__:{}};p.__private__.PubSub=gv;var y="1.3",v=p.__private__.getPdfVersion=function(){return y};p.__private__.setPdfVersion=function(_){y=_};var w={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};p.__private__.getPageFormats=function(){return w};var E=p.__private__.getPageFormat=function(_){return w[_]};a=a||"a4";var R={COMPAT:"compat",ADVANCED:"advanced"},P=R.COMPAT;function q(){this.saveGraphicsState(),se(new bt(tt,0,0,-tt,0,ra()*tt).toString()+" cm"),this.setFontSize(this.getFontSize()/tt),l="n",P=R.ADVANCED}function z(){this.restoreGraphicsState(),l="S",P=R.COMPAT}var K=p.__private__.combineFontStyleAndFontWeight=function(_,B){if(_=="bold"&&B=="normal"||_=="bold"&&B==400||_=="normal"&&B=="italic"||_=="bold"&&B=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return B&&(_=B==400||B==="normal"?_==="italic"?"italic":"normal":B!=700&&B!=="bold"||_!=="normal"?(B==700?"bold":B)+""+_:"bold"),_};p.advancedAPI=function(_){var B=P===R.COMPAT;return B&&q.call(this),typeof _!="function"||(_(this),B&&z.call(this)),this},p.compatAPI=function(_){var B=P===R.ADVANCED;return B&&z.call(this),typeof _!="function"||(_(this),B&&q.call(this)),this},p.isAdvancedAPI=function(){return P===R.ADVANCED};var I,N=function(_){if(P!==R.ADVANCED)throw new Error(_+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},F=p.roundToPrecision=p.__private__.roundToPrecision=function(_,B){var le=e||B;if(isNaN(_)||isNaN(le))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return _.toFixed(le).replace(/0+$/,"")};I=p.hpf=p.__private__.hpf=typeof c=="number"?function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.hpf");return F(_,c)}:c==="smart"?function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.hpf");return F(_,_>-1&&_<1?16:5)}:function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.hpf");return F(_,16)};var j=p.f2=p.__private__.f2=function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.f2");return F(_,2)},S=p.__private__.f3=function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.f3");return F(_,3)},A=p.scale=p.__private__.scale=function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.scale");return P===R.COMPAT?_*tt:P===R.ADVANCED?_:void 0},C=function(_){return P===R.COMPAT?ra()-_:P===R.ADVANCED?_:void 0},J=function(_){return A(C(_))};p.__private__.setPrecision=p.setPrecision=function(_){typeof parseInt(_,10)=="number"&&(e=parseInt(_,10))};var ue,me="00000000000000000000000000000000",pe=p.__private__.getFileId=function(){return me},ge=p.__private__.setFileId=function(_){return me=_!==void 0&&/^[a-fA-F0-9]{32}$/.test(_)?_.toUpperCase():me.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),u!==null&&(zr=new Wl(u.userPermissions,u.userPassword,u.ownerPassword,me)),me};p.setFileId=function(_){return ge(_),this},p.getFileId=function(){return pe()};var ne=p.__private__.convertDateToPDFDate=function(_){var B=_.getTimezoneOffset(),le=B<0?"+":"-",xe=Math.floor(Math.abs(B/60)),Ae=Math.abs(B%60),Ve=[le,M(xe),"'",M(Ae),"'"].join("");return["D:",_.getFullYear(),M(_.getMonth()+1),M(_.getDate()),M(_.getHours()),M(_.getMinutes()),M(_.getSeconds()),Ve].join("")},we=p.__private__.convertPDFDateToDate=function(_){var B=parseInt(_.substr(2,4),10),le=parseInt(_.substr(6,2),10)-1,xe=parseInt(_.substr(8,2),10),Ae=parseInt(_.substr(10,2),10),Ve=parseInt(_.substr(12,2),10),Qe=parseInt(_.substr(14,2),10);return new Date(B,le,xe,Ae,Ve,Qe,0)},Oe=p.__private__.setCreationDate=function(_){var B;if(_===void 0&&(_=new Date),_ instanceof Date)B=ne(_);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(_))throw new Error("Invalid argument passed to jsPDF.setCreationDate");B=_}return ue=B},k=p.__private__.getCreationDate=function(_){var B=ue;return _==="jsDate"&&(B=we(ue)),B};p.setCreationDate=function(_){return Oe(_),this},p.getCreationDate=function(_){return k(_)};var O,M=p.__private__.padd2=function(_){return("0"+parseInt(_)).slice(-2)},U=p.__private__.padd2Hex=function(_){return("00"+(_=_.toString())).substr(_.length)},ee=0,he=[],de=[],fe=0,be=[],Me=[],Z=!1,Xe=de,st=function(){ee=0,fe=0,de=[],he=[],be=[],te=Kr(),re=Kr()};p.__private__.setCustomOutputDestination=function(_){Z=!0,Xe=_};var Fe=function(_){Z||(Xe=_)};p.__private__.resetCustomOutputDestination=function(){Z=!1,Xe=de};var se=p.__private__.out=function(_){return _=_.toString(),fe+=_.length+1,Xe.push(_),Xe},qe=p.__private__.write=function(_){return se(arguments.length===1?_.toString():Array.prototype.join.call(arguments," "))},lt=p.__private__.getArrayBuffer=function(_){for(var B=_.length,le=new ArrayBuffer(B),xe=new Uint8Array(le);B--;)xe[B]=_.charCodeAt(B);return le},$e=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];p.__private__.getStandardFonts=function(){return $e};var rt=r.fontSize||16;p.__private__.setFontSize=p.setFontSize=function(_){return rt=P===R.ADVANCED?_/tt:_,this};var ot,ht=p.__private__.getFontSize=p.getFontSize=function(){return P===R.COMPAT?rt:rt*tt},_t=r.R2L||!1;p.__private__.setR2L=p.setR2L=function(_){return _t=_,this},p.__private__.getR2L=p.getR2L=function(){return _t};var At,Ft=p.__private__.setZoomMode=function(_){var B=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(_))ot=_;else if(isNaN(_)){if(B.indexOf(_)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+_+'" is not recognized.');ot=_}else ot=parseInt(_,10)};p.__private__.getZoomMode=function(){return ot};var Et,It=p.__private__.setPageMode=function(_){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(_)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+_+'" is not recognized.');At=_};p.__private__.getPageMode=function(){return At};var Vt=p.__private__.setLayoutMode=function(_){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(_)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+_+'" is not recognized.');Et=_};p.__private__.getLayoutMode=function(){return Et},p.__private__.setDisplayMode=p.setDisplayMode=function(_,B,le){return Ft(_),Vt(B),It(le),this};var Nt={title:"",subject:"",author:"",keywords:"",creator:""};p.__private__.getDocumentProperty=function(_){if(Object.keys(Nt).indexOf(_)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Nt[_]},p.__private__.getDocumentProperties=function(){return Nt},p.__private__.setDocumentProperties=p.setProperties=p.setDocumentProperties=function(_){for(var B in Nt)Nt.hasOwnProperty(B)&&_[B]&&(Nt[B]=_[B]);return this},p.__private__.setDocumentProperty=function(_,B){if(Object.keys(Nt).indexOf(_)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Nt[_]=B};var dt,tt,sr,Ct,rn,cr={},Cr={},Pa=[],rr={},Ha={},Pr={},In={},va=null,xr=0,Rt=[],ir=new gv(p),Fa=r.hotfixes||[],nn={},Ln={},ya=[],bt=function _(B,le,xe,Ae,Ve,Qe){if(!(this instanceof _))return new _(B,le,xe,Ae,Ve,Qe);isNaN(B)&&(B=1),isNaN(le)&&(le=0),isNaN(xe)&&(xe=0),isNaN(Ae)&&(Ae=1),isNaN(Ve)&&(Ve=0),isNaN(Qe)&&(Qe=0),this._matrix=[B,le,xe,Ae,Ve,Qe]};Object.defineProperty(bt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(_){this._matrix[0]=_}}),Object.defineProperty(bt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(_){this._matrix[1]=_}}),Object.defineProperty(bt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(_){this._matrix[2]=_}}),Object.defineProperty(bt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(_){this._matrix[3]=_}}),Object.defineProperty(bt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(_){this._matrix[4]=_}}),Object.defineProperty(bt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(_){this._matrix[5]=_}}),Object.defineProperty(bt.prototype,"a",{get:function(){return this._matrix[0]},set:function(_){this._matrix[0]=_}}),Object.defineProperty(bt.prototype,"b",{get:function(){return this._matrix[1]},set:function(_){this._matrix[1]=_}}),Object.defineProperty(bt.prototype,"c",{get:function(){return this._matrix[2]},set:function(_){this._matrix[2]=_}}),Object.defineProperty(bt.prototype,"d",{get:function(){return this._matrix[3]},set:function(_){this._matrix[3]=_}}),Object.defineProperty(bt.prototype,"e",{get:function(){return this._matrix[4]},set:function(_){this._matrix[4]=_}}),Object.defineProperty(bt.prototype,"f",{get:function(){return this._matrix[5]},set:function(_){this._matrix[5]=_}}),Object.defineProperty(bt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(bt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(bt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(bt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),bt.prototype.join=function(_){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(I).join(_)},bt.prototype.multiply=function(_){var B=_.sx*this.sx+_.shy*this.shx,le=_.sx*this.shy+_.shy*this.sy,xe=_.shx*this.sx+_.sy*this.shx,Ae=_.shx*this.shy+_.sy*this.sy,Ve=_.tx*this.sx+_.ty*this.shx+this.tx,Qe=_.tx*this.shy+_.ty*this.sy+this.ty;return new bt(B,le,xe,Ae,Ve,Qe)},bt.prototype.decompose=function(){var _=this.sx,B=this.shy,le=this.shx,xe=this.sy,Ae=this.tx,Ve=this.ty,Qe=Math.sqrt(_*_+B*B),pt=(_/=Qe)*le+(B/=Qe)*xe;le-=_*pt,xe-=B*pt;var m=Math.sqrt(le*le+xe*xe);return pt/=m,_*(xe/=m)<B*(le/=m)&&(_=-_,B=-B,pt=-pt,Qe=-Qe),{scale:new bt(Qe,0,0,m,0,0),translate:new bt(1,0,0,1,Ae,Ve),rotate:new bt(_,B,-B,_,0,0),skew:new bt(1,0,pt,1,0,0)}},bt.prototype.toString=function(_){return this.join(" ")},bt.prototype.inversed=function(){var _=this.sx,B=this.shy,le=this.shx,xe=this.sy,Ae=this.tx,Ve=this.ty,Qe=1/(_*xe-B*le),pt=xe*Qe,m=-B*Qe,T=-le*Qe,L=_*Qe;return new bt(pt,m,T,L,-pt*Ae-T*Ve,-m*Ae-L*Ve)},bt.prototype.applyToPoint=function(_){var B=_.x*this.sx+_.y*this.shx+this.tx,le=_.x*this.shy+_.y*this.sy+this.ty;return new Ni(B,le)},bt.prototype.applyToRectangle=function(_){var B=this.applyToPoint(_),le=this.applyToPoint(new Ni(_.x+_.w,_.y+_.h));return new co(B.x,B.y,le.x-B.x,le.y-B.y)},bt.prototype.clone=function(){var _=this.sx,B=this.shy,le=this.shx,xe=this.sy,Ae=this.tx,Ve=this.ty;return new bt(_,B,le,xe,Ae,Ve)},p.Matrix=bt;var ta=p.matrixMult=function(_,B){return B.multiply(_)},_n=new bt(1,0,0,1,0,0);p.unitMatrix=p.identityMatrix=_n;var an=function(_,B){if(!Ha[_]){var le=(B instanceof Tc?"Sh":"P")+(Object.keys(rr).length+1).toString(10);B.id=le,Ha[_]=le,rr[le]=B,ir.publish("addPattern",B)}};p.ShadingPattern=Tc,p.TilingPattern=$l,p.addShadingPattern=function(_,B){return N("addShadingPattern()"),an(_,B),this},p.beginTilingPattern=function(_){N("beginTilingPattern()"),lo(_.boundingBox[0],_.boundingBox[1],_.boundingBox[2]-_.boundingBox[0],_.boundingBox[3]-_.boundingBox[1],_.matrix)},p.endTilingPattern=function(_,B){N("endTilingPattern()"),B.stream=Me[O].join(`
`),an(_,B),ir.publish("endTilingPattern",B),ya.pop().restore()};var Jr=p.__private__.newObject=function(){var _=Kr();return W(_,!0),_},Kr=p.__private__.newObjectDeferred=function(){return ee++,he[ee]=function(){return fe},ee},W=function(_,B){return B=typeof B=="boolean"&&B,he[_]=fe,B&&se(_+" 0 obj"),_},oe=p.__private__.newAdditionalObject=function(){var _={objId:Kr(),content:""};return be.push(_),_},te=Kr(),re=Kr(),ie=p.__private__.decodeColorString=function(_){var B=_.split(" ");if(B.length!==2||B[1]!=="g"&&B[1]!=="G")B.length===5&&(B[4]==="k"||B[4]==="K")&&(B=[(1-B[0])*(1-B[3]),(1-B[1])*(1-B[3]),(1-B[2])*(1-B[3]),"r"]);else{var le=parseFloat(B[0]);B=[le,le,le,"r"]}for(var xe="#",Ae=0;Ae<3;Ae++)xe+=("0"+Math.floor(255*parseFloat(B[Ae])).toString(16)).slice(-2);return xe},ce=p.__private__.encodeColorString=function(_){var B;typeof _=="string"&&(_={ch1:_});var le=_.ch1,xe=_.ch2,Ae=_.ch3,Ve=_.ch4,Qe=_.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof le=="string"&&le.charAt(0)!=="#"){var pt=new Pb(le);if(pt.ok)le=pt.toHex();else if(!/^\d*\.?\d*$/.test(le))throw new Error('Invalid color "'+le+'" passed to jsPDF.encodeColorString.')}if(typeof le=="string"&&/^#[0-9A-Fa-f]{3}$/.test(le)&&(le="#"+le[1]+le[1]+le[2]+le[2]+le[3]+le[3]),typeof le=="string"&&/^#[0-9A-Fa-f]{6}$/.test(le)){var m=parseInt(le.substr(1),16);le=m>>16&255,xe=m>>8&255,Ae=255&m}if(xe===void 0||Ve===void 0&&le===xe&&xe===Ae)if(typeof le=="string")B=le+" "+Qe[0];else switch(_.precision){case 2:B=j(le/255)+" "+Qe[0];break;case 3:default:B=S(le/255)+" "+Qe[0]}else if(Ve===void 0||kr(Ve)==="object"){if(Ve&&!isNaN(Ve.a)&&Ve.a===0)return B=["1.","1.","1.",Qe[1]].join(" ");if(typeof le=="string")B=[le,xe,Ae,Qe[1]].join(" ");else switch(_.precision){case 2:B=[j(le/255),j(xe/255),j(Ae/255),Qe[1]].join(" ");break;default:case 3:B=[S(le/255),S(xe/255),S(Ae/255),Qe[1]].join(" ")}}else if(typeof le=="string")B=[le,xe,Ae,Ve,Qe[2]].join(" ");else switch(_.precision){case 2:B=[j(le),j(xe),j(Ae),j(Ve),Qe[2]].join(" ");break;case 3:default:B=[S(le),S(xe),S(Ae),S(Ve),Qe[2]].join(" ")}return B},Te=p.__private__.getFilters=function(){return i},je=p.__private__.putStream=function(_){var B=(_=_||{}).data||"",le=_.filters||Te(),xe=_.alreadyAppliedFilters||[],Ae=_.addLength1||!1,Ve=B.length,Qe=_.objectId,pt=function(Gt){return Gt};if(u!==null&&Qe===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&(pt=zr.encryptor(Qe,0));var m={};le===!0&&(le=["FlateEncode"]);var T=_.additionalKeyValues||[],L=(m=jt.API.processDataByFilters!==void 0?jt.API.processDataByFilters(B,le):{data:B,reverseChain:[]}).reverseChain+(Array.isArray(xe)?xe.join(" "):xe.toString());if(m.data.length!==0&&(T.push({key:"Length",value:m.data.length}),Ae===!0&&T.push({key:"Length1",value:Ve})),L.length!=0)if(L.split("/").length-1==1)T.push({key:"Filter",value:L});else{T.push({key:"Filter",value:"["+L+"]"});for(var X=0;X<T.length;X+=1)if(T[X].key==="DecodeParms"){for(var Ee=[],Re=0;Re<m.reverseChain.split("/").length-1;Re+=1)Ee.push("null");Ee.push(T[X].value),T[X].value="["+Ee.join(" ")+"]"}}se("<<");for(var Ze=0;Ze<T.length;Ze++)se("/"+T[Ze].key+" "+T[Ze].value);se(">>"),m.data.length!==0&&(se("stream"),se(pt(m.data)),se("endstream"))},ke=p.__private__.putPage=function(_){var B=_.number,le=_.data,xe=_.objId,Ae=_.contentsObjId;W(xe,!0),se("<</Type /Page"),se("/Parent "+_.rootDictionaryObjId+" 0 R"),se("/Resources "+_.resourceDictionaryObjId+" 0 R"),se("/MediaBox ["+parseFloat(I(_.mediaBox.bottomLeftX))+" "+parseFloat(I(_.mediaBox.bottomLeftY))+" "+I(_.mediaBox.topRightX)+" "+I(_.mediaBox.topRightY)+"]"),_.cropBox!==null&&se("/CropBox ["+I(_.cropBox.bottomLeftX)+" "+I(_.cropBox.bottomLeftY)+" "+I(_.cropBox.topRightX)+" "+I(_.cropBox.topRightY)+"]"),_.bleedBox!==null&&se("/BleedBox ["+I(_.bleedBox.bottomLeftX)+" "+I(_.bleedBox.bottomLeftY)+" "+I(_.bleedBox.topRightX)+" "+I(_.bleedBox.topRightY)+"]"),_.trimBox!==null&&se("/TrimBox ["+I(_.trimBox.bottomLeftX)+" "+I(_.trimBox.bottomLeftY)+" "+I(_.trimBox.topRightX)+" "+I(_.trimBox.topRightY)+"]"),_.artBox!==null&&se("/ArtBox ["+I(_.artBox.bottomLeftX)+" "+I(_.artBox.bottomLeftY)+" "+I(_.artBox.topRightX)+" "+I(_.artBox.topRightY)+"]"),typeof _.userUnit=="number"&&_.userUnit!==1&&se("/UserUnit "+_.userUnit),ir.publish("putPage",{objId:xe,pageContext:Rt[B],pageNumber:B,page:le}),se("/Contents "+Ae+" 0 R"),se(">>"),se("endobj");var Ve=le.join(`
`);return P===R.ADVANCED&&(Ve+=`
Q`),W(Ae,!0),je({data:Ve,filters:Te(),objectId:Ae}),se("endobj"),xe},Ie=p.__private__.putPages=function(){var _,B,le=[];for(_=1;_<=xr;_++)Rt[_].objId=Kr(),Rt[_].contentsObjId=Kr();for(_=1;_<=xr;_++)le.push(ke({number:_,data:Me[_],objId:Rt[_].objId,contentsObjId:Rt[_].contentsObjId,mediaBox:Rt[_].mediaBox,cropBox:Rt[_].cropBox,bleedBox:Rt[_].bleedBox,trimBox:Rt[_].trimBox,artBox:Rt[_].artBox,userUnit:Rt[_].userUnit,rootDictionaryObjId:te,resourceDictionaryObjId:re}));W(te,!0),se("<</Type /Pages");var xe="/Kids [";for(B=0;B<xr;B++)xe+=le[B]+" 0 R ";se(xe+"]"),se("/Count "+xr),se(">>"),se("endobj"),ir.publish("postPutPages")},Le=function(_){ir.publish("putFont",{font:_,out:se,newObject:Jr,putStream:je}),_.isAlreadyPutted!==!0&&(_.objectNumber=Jr(),se("<<"),se("/Type /Font"),se("/BaseFont /"+Hl(_.postScriptName)),se("/Subtype /Type1"),typeof _.encoding=="string"&&se("/Encoding /"+_.encoding),se("/FirstChar 32"),se("/LastChar 255"),se(">>"),se("endobj"))},Je=function(){for(var _ in cr)cr.hasOwnProperty(_)&&(d===!1||d===!0&&g.hasOwnProperty(_))&&Le(cr[_])},it=function(_){_.objectNumber=Jr();var B=[];B.push({key:"Type",value:"/XObject"}),B.push({key:"Subtype",value:"/Form"}),B.push({key:"BBox",value:"["+[I(_.x),I(_.y),I(_.x+_.width),I(_.y+_.height)].join(" ")+"]"}),B.push({key:"Matrix",value:"["+_.matrix.toString()+"]"});var le=_.pages[1].join(`
`);je({data:le,additionalKeyValues:B,objectId:_.objectNumber}),se("endobj")},gt=function(){for(var _ in nn)nn.hasOwnProperty(_)&&it(nn[_])},nt=function(_,B){var le,xe=[],Ae=1/(B-1);for(le=0;le<1;le+=Ae)xe.push(le);if(xe.push(1),_[0].offset!=0){var Ve={offset:0,color:_[0].color};_.unshift(Ve)}if(_[_.length-1].offset!=1){var Qe={offset:1,color:_[_.length-1].color};_.push(Qe)}for(var pt="",m=0,T=0;T<xe.length;T++){for(le=xe[T];le>_[m+1].offset;)m++;var L=_[m].offset,X=(le-L)/(_[m+1].offset-L),Ee=_[m].color,Re=_[m+1].color;pt+=U(Math.round((1-X)*Ee[0]+X*Re[0]).toString(16))+U(Math.round((1-X)*Ee[1]+X*Re[1]).toString(16))+U(Math.round((1-X)*Ee[2]+X*Re[2]).toString(16))}return pt.trim()},ft=function(_,B){B||(B=21);var le=Jr(),xe=nt(_.colors,B),Ae=[];Ae.push({key:"FunctionType",value:"0"}),Ae.push({key:"Domain",value:"[0.0 1.0]"}),Ae.push({key:"Size",value:"["+B+"]"}),Ae.push({key:"BitsPerSample",value:"8"}),Ae.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ae.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),je({data:xe,additionalKeyValues:Ae,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:le}),se("endobj"),_.objectNumber=Jr(),se("<< /ShadingType "+_.type),se("/ColorSpace /DeviceRGB");var Ve="/Coords ["+I(parseFloat(_.coords[0]))+" "+I(parseFloat(_.coords[1]))+" ";_.type===2?Ve+=I(parseFloat(_.coords[2]))+" "+I(parseFloat(_.coords[3])):Ve+=I(parseFloat(_.coords[2]))+" "+I(parseFloat(_.coords[3]))+" "+I(parseFloat(_.coords[4]))+" "+I(parseFloat(_.coords[5])),se(Ve+="]"),_.matrix&&se("/Matrix ["+_.matrix.toString()+"]"),se("/Function "+le+" 0 R"),se("/Extend [true true]"),se(">>"),se("endobj")},Ot=function(_,B){var le=Kr(),xe=Jr();B.push({resourcesOid:le,objectOid:xe}),_.objectNumber=xe;var Ae=[];Ae.push({key:"Type",value:"/Pattern"}),Ae.push({key:"PatternType",value:"1"}),Ae.push({key:"PaintType",value:"1"}),Ae.push({key:"TilingType",value:"1"}),Ae.push({key:"BBox",value:"["+_.boundingBox.map(I).join(" ")+"]"}),Ae.push({key:"XStep",value:I(_.xStep)}),Ae.push({key:"YStep",value:I(_.yStep)}),Ae.push({key:"Resources",value:le+" 0 R"}),_.matrix&&Ae.push({key:"Matrix",value:"["+_.matrix.toString()+"]"}),je({data:_.stream,additionalKeyValues:Ae,objectId:_.objectNumber}),se("endobj")},lr=function(_){var B;for(B in rr)rr.hasOwnProperty(B)&&(rr[B]instanceof Tc?ft(rr[B]):rr[B]instanceof $l&&Ot(rr[B],_))},ur=function(_){for(var B in _.objectNumber=Jr(),se("<<"),_)switch(B){case"opacity":se("/ca "+j(_[B]));break;case"stroke-opacity":se("/CA "+j(_[B]))}se(">>"),se("endobj")},Fr=function(){var _;for(_ in Pr)Pr.hasOwnProperty(_)&&ur(Pr[_])},wa=function(){for(var _ in se("/XObject <<"),nn)nn.hasOwnProperty(_)&&nn[_].objectNumber>=0&&se("/"+_+" "+nn[_].objectNumber+" 0 R");ir.publish("putXobjectDict"),se(">>")},Cs=function(){zr.oid=Jr(),se("<<"),se("/Filter /Standard"),se("/V "+zr.v),se("/R "+zr.r),se("/U <"+zr.toHexString(zr.U)+">"),se("/O <"+zr.toHexString(zr.O)+">"),se("/P "+zr.P),se(">>"),se("endobj")},Ga=function(){for(var _ in se("/Font <<"),cr)cr.hasOwnProperty(_)&&(d===!1||d===!0&&g.hasOwnProperty(_))&&se("/"+_+" "+cr[_].objectNumber+" 0 R");se(">>")},Ra=function(){if(Object.keys(rr).length>0){for(var _ in se("/Shading <<"),rr)rr.hasOwnProperty(_)&&rr[_]instanceof Tc&&rr[_].objectNumber>=0&&se("/"+_+" "+rr[_].objectNumber+" 0 R");ir.publish("putShadingPatternDict"),se(">>")}},$a=function(_){if(Object.keys(rr).length>0){for(var B in se("/Pattern <<"),rr)rr.hasOwnProperty(B)&&rr[B]instanceof p.TilingPattern&&rr[B].objectNumber>=0&&rr[B].objectNumber<_&&se("/"+B+" "+rr[B].objectNumber+" 0 R");ir.publish("putTilingPatternDict"),se(">>")}},Wn=function(){if(Object.keys(Pr).length>0){var _;for(_ in se("/ExtGState <<"),Pr)Pr.hasOwnProperty(_)&&Pr[_].objectNumber>=0&&se("/"+_+" "+Pr[_].objectNumber+" 0 R");ir.publish("putGStateDict"),se(">>")}},qr=function(_){W(_.resourcesOid,!0),se("<<"),se("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Ga(),Ra(),$a(_.objectOid),Wn(),wa(),se(">>"),se("endobj")},ec=function(){var _=[];Je(),Fr(),gt(),lr(_),ir.publish("putResources"),_.forEach(qr),qr({resourcesOid:re,objectOid:Number.MAX_SAFE_INTEGER}),ir.publish("postPutResources")},tc=function(){ir.publish("putAdditionalObjects");for(var _=0;_<be.length;_++){var B=be[_];W(B.objId,!0),se(B.content),se("endobj")}ir.publish("postPutAdditionalObjects")},cl=function(_){Cr[_.fontName]=Cr[_.fontName]||{},Cr[_.fontName][_.fontStyle]=_.id},rc=function(_,B,le,xe,Ae){var Ve={id:"F"+(Object.keys(cr).length+1).toString(10),postScriptName:_,fontName:B,fontStyle:le,encoding:xe,isStandardFont:Ae||!1,metadata:{}};return ir.publish("addFont",{font:Ve,instance:this}),cr[Ve.id]=Ve,cl(Ve),Ve.id},ll=function(_){for(var B=0,le=$e.length;B<le;B++){var xe=rc.call(this,_[B][0],_[B][1],_[B][2],$e[B][3],!0);d===!1&&(g[xe]=!0);var Ae=_[B][0].split("-");cl({id:xe,fontName:Ae[0],fontStyle:Ae[1]||""})}ir.publish("addFonts",{fonts:cr,dictionary:Cr})},Da=function(_){return _.foo=function(){try{return _.apply(this,arguments)}catch(xe){var B=xe.stack||"";~B.indexOf(" at ")&&(B=B.split(" at ")[1]);var le="Error in function "+B.split(`
`)[0].split("<")[0]+": "+xe.message;if(!Ut.console)throw new Error(le);Ut.console.error(le,xe),Ut.alert&&alert(le)}},_.foo.bar=_,_.foo},Yi=function(_,B){var le,xe,Ae,Ve,Qe,pt,m,T,L;if(Ae=(B=B||{}).sourceEncoding||"Unicode",Qe=B.outputEncoding,(B.autoencode||Qe)&&cr[dt].metadata&&cr[dt].metadata[Ae]&&cr[dt].metadata[Ae].encoding&&(Ve=cr[dt].metadata[Ae].encoding,!Qe&&cr[dt].encoding&&(Qe=cr[dt].encoding),!Qe&&Ve.codePages&&(Qe=Ve.codePages[0]),typeof Qe=="string"&&(Qe=Ve[Qe]),Qe)){for(m=!1,pt=[],le=0,xe=_.length;le<xe;le++)(T=Qe[_.charCodeAt(le)])?pt.push(String.fromCharCode(T)):pt.push(_[le]),pt[le].charCodeAt(0)>>8&&(m=!0);_=pt.join("")}for(le=_.length;m===void 0&&le!==0;)_.charCodeAt(le-1)>>8&&(m=!0),le--;if(!m)return _;for(pt=B.noBOM?[]:[254,255],le=0,xe=_.length;le<xe;le++){if((L=(T=_.charCodeAt(le))>>8)>>8)throw new Error("Character at position "+le+" of string '"+_+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");pt.push(L),pt.push(T-(L<<8))}return String.fromCharCode.apply(void 0,pt)},sn=p.__private__.pdfEscape=p.pdfEscape=function(_,B){return Yi(_,B).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},_a=p.__private__.beginPage=function(_){Me[++xr]=[],Rt[xr]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(_[0]),topRightY:Number(_[1])}},nc(xr),Fe(Me[O])},_i=function(_,B){var le,xe,Ae;switch(t=B||t,typeof _=="string"&&(le=E(_.toLowerCase()),Array.isArray(le)&&(xe=le[0],Ae=le[1])),Array.isArray(_)&&(xe=_[0]*tt,Ae=_[1]*tt),isNaN(xe)&&(xe=a[0],Ae=a[1]),(xe>14400||Ae>14400)&&(Br.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),xe=Math.min(14400,xe),Ae=Math.min(14400,Ae)),a=[xe,Ae],t.substr(0,1)){case"l":Ae>xe&&(a=[Ae,xe]);break;case"p":xe>Ae&&(a=[Ae,xe])}_a(a),cc(oc),se(Hn),hc!==0&&se(hc+" J"),oo!==0&&se(oo+" j"),ir.publish("addPage",{pageNumber:xr})},Ji=function(_){_>0&&_<=xr&&(Me.splice(_,1),Rt.splice(_,1),xr--,O>xr&&(O=xr),this.setPage(O))},nc=function(_){_>0&&_<=xr&&(O=_)},_r=p.__private__.getNumberOfPages=p.getNumberOfPages=function(){return Me.length-1},bi=function(_,B,le){var xe,Ae=void 0;return le=le||{},_=_!==void 0?_:cr[dt].fontName,B=B!==void 0?B:cr[dt].fontStyle,xe=_.toLowerCase(),Cr[xe]!==void 0&&Cr[xe][B]!==void 0?Ae=Cr[xe][B]:Cr[_]!==void 0&&Cr[_][B]!==void 0?Ae=Cr[_][B]:le.disableWarning===!1&&Br.warn("Unable to look up font label for font '"+_+"', '"+B+"'. Refer to getFontList() for available fonts."),Ae||le.noFallback||(Ae=Cr.times[B])==null&&(Ae=Cr.times.normal),Ae},Ei=p.__private__.putInfo=function(){var _=Jr(),B=function(xe){return xe};for(var le in u!==null&&(B=zr.encryptor(_,0)),se("<<"),se("/Producer ("+sn(B("jsPDF "+jt.version))+")"),Nt)Nt.hasOwnProperty(le)&&Nt[le]&&se("/"+le.substr(0,1).toUpperCase()+le.substr(1)+" ("+sn(B(Nt[le]))+")");se("/CreationDate ("+sn(B(ue))+")"),se(">>"),se("endobj")},Ps=p.__private__.putCatalog=function(_){var B=(_=_||{}).rootDictionaryObjId||te;switch(Jr(),se("<<"),se("/Type /Catalog"),se("/Pages "+B+" 0 R"),ot||(ot="fullwidth"),ot){case"fullwidth":se("/OpenAction [3 0 R /FitH null]");break;case"fullheight":se("/OpenAction [3 0 R /FitV null]");break;case"fullpage":se("/OpenAction [3 0 R /Fit]");break;case"original":se("/OpenAction [3 0 R /XYZ null null 1]");break;default:var le=""+ot;le.substr(le.length-1)==="%"&&(ot=parseInt(ot)/100),typeof ot=="number"&&se("/OpenAction [3 0 R /XYZ null null "+j(ot)+"]")}switch(Et||(Et="continuous"),Et){case"continuous":se("/PageLayout /OneColumn");break;case"single":se("/PageLayout /SinglePage");break;case"two":case"twoleft":se("/PageLayout /TwoColumnLeft");break;case"tworight":se("/PageLayout /TwoColumnRight")}At&&se("/PageMode /"+At),ir.publish("putCatalog"),se(">>"),se("endobj")},Au=p.__private__.putTrailer=function(){se("trailer"),se("<<"),se("/Size "+(ee+1)),se("/Root "+ee+" 0 R"),se("/Info "+(ee-1)+" 0 R"),u!==null&&se("/Encrypt "+zr.oid+" 0 R"),se("/ID [ <"+me+"> <"+me+"> ]"),se(">>")},ul=p.__private__.putHeader=function(){se("%PDF-"+y),se("%ºß¬à")},Nu=p.__private__.putXRef=function(){var _="0000000000";se("xref"),se("0 "+(ee+1)),se("0000000000 65535 f ");for(var B=1;B<=ee;B++)typeof he[B]=="function"?se((_+he[B]()).slice(-10)+" 00000 n "):he[B]!==void 0?se((_+he[B]).slice(-10)+" 00000 n "):se("0000000000 00000 n ")},Fs=p.__private__.buildDocument=function(){st(),Fe(de),ir.publish("buildDocument"),ul(),Ie(),tc(),ec(),u!==null&&Cs(),Ei(),Ps();var _=fe;return Nu(),Au(),se("startxref"),se(""+_),se("%%EOF"),Fe(Me[O]),de.join(`
`)},Qi=p.__private__.getBlob=function(_){return new Blob([lt(_)],{type:"application/pdf"})},Zi=p.output=p.__private__.output=Da(function(_,B){switch(typeof(B=B||{})=="string"?B={filename:B}:B.filename=B.filename||"generated.pdf",_){case void 0:return Fs();case"save":p.save(B.filename);break;case"arraybuffer":return lt(Fs());case"blob":return Qi(Fs());case"bloburi":case"bloburl":if(Ut.URL!==void 0&&typeof Ut.URL.createObjectURL=="function")return Ut.URL&&Ut.URL.createObjectURL(Qi(Fs()))||void 0;Br.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var le="",xe=Fs();try{le=wp(xe)}catch{le=wp(unescape(encodeURIComponent(xe)))}return"data:application/pdf;filename="+B.filename+";base64,"+le;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Ut)==="[object Window]"){var Ae="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Ve=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';B.pdfObjectUrl&&(Ae=B.pdfObjectUrl,Ve="");var Qe='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Ae+'"'+Ve+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(B)+");<\/script></body></html>",pt=Ut.open();return pt!==null&&pt.document.write(Qe),pt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Ut)==="[object Window]"){var m='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(B.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+B.filename+'" width="500px" height="400px" /></body></html>',T=Ut.open();if(T!==null){T.document.write(m);var L=this;T.document.documentElement.querySelector("#pdfViewer").onload=function(){T.document.title=B.filename,T.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(L.output("bloburl"))}}return T}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Ut)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var X='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",B)+'"></iframe></body></html>',Ee=Ut.open();if(Ee!==null&&(Ee.document.write(X),Ee.document.title=B.filename),Ee||typeof safari>"u")return Ee;break;case"datauri":case"dataurl":return Ut.document.location.href=this.output("datauristring",B);default:return null}}),Js=function(_){return Array.isArray(Fa)===!0&&Fa.indexOf(_)>-1};switch(n){case"pt":tt=1;break;case"mm":tt=72/25.4;break;case"cm":tt=72/2.54;break;case"in":tt=72;break;case"px":tt=Js("px_scaling")==1?.75:96/72;break;case"pc":case"em":tt=12;break;case"ex":tt=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);tt=n}var zr=null;Oe(),ge();var hl=function(_){return u!==null?zr.encryptor(_,0):function(B){return B}},ac=p.__private__.getPageInfo=p.getPageInfo=function(_){if(isNaN(_)||_%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Rt[_].objId,pageNumber:_,pageContext:Rt[_]}},zt=p.__private__.getPageInfoByObjId=function(_){if(isNaN(_)||_%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var B in Rt)if(Rt[B].objId===_)break;return ac(B)},Qs=p.__private__.getCurrentPageInfo=p.getCurrentPageInfo=function(){return{objId:Rt[O].objId,pageNumber:O,pageContext:Rt[O]}};p.addPage=function(){return _i.apply(this,arguments),this},p.setPage=function(){return nc.apply(this,arguments),Fe.call(this,Me[O]),this},p.insertPage=function(_){return this.addPage(),this.movePage(O,_),this},p.movePage=function(_,B){var le,xe;if(_>B){le=Me[_],xe=Rt[_];for(var Ae=_;Ae>B;Ae--)Me[Ae]=Me[Ae-1],Rt[Ae]=Rt[Ae-1];Me[B]=le,Rt[B]=xe,this.setPage(B)}else if(_<B){le=Me[_],xe=Rt[_];for(var Ve=_;Ve<B;Ve++)Me[Ve]=Me[Ve+1],Rt[Ve]=Rt[Ve+1];Me[B]=le,Rt[B]=xe,this.setPage(B)}return this},p.deletePage=function(){return Ji.apply(this,arguments),this},p.__private__.text=p.text=function(_,B,le,xe,Ae){var Ve,Qe,pt,m,T,L,X,Ee,Re,Ze=(xe=xe||{}).scope||this;if(typeof _=="number"&&typeof B=="number"&&(typeof le=="string"||Array.isArray(le))){var Gt=le;le=B,B=_,_=Gt}if(arguments[3]instanceof bt?(N("The transform parameter of text() with a Matrix value"),Re=Ae):(pt=arguments[4],m=arguments[5],kr(X=arguments[3])==="object"&&X!==null||(typeof pt=="string"&&(m=pt,pt=null),typeof X=="string"&&(m=X,X=null),typeof X=="number"&&(pt=X,X=null),xe={flags:X,angle:pt,align:m})),isNaN(B)||isNaN(le)||_==null)throw new Error("Invalid arguments passed to jsPDF.text");if(_.length===0)return Ze;var nr="",$t=!1,wr=typeof xe.lineHeightFactor=="number"?xe.lineHeightFactor:yr,Or=Ze.internal.scaleFactor;function Os(Vr){return Vr=Vr.split("	").join(Array(xe.TabLen||9).join(" ")),sn(Vr,X)}function Gn(Vr){for(var Ur,mn=Vr.concat(),Pn=[],Pi=mn.length;Pi--;)typeof(Ur=mn.shift())=="string"?Pn.push(Ur):Array.isArray(Vr)&&(Ur.length===1||Ur[1]===void 0&&Ur[2]===void 0)?Pn.push(Ur[0]):Pn.push([Ur[0],Ur[1],Ur[2]]);return Pn}function ri(Vr,Ur){var mn;if(typeof Vr=="string")mn=Ur(Vr)[0];else if(Array.isArray(Vr)){for(var Pn,Pi,Lu=Vr.concat(),Sl=[],m0=Lu.length;m0--;)typeof(Pn=Lu.shift())=="string"?Sl.push(Ur(Pn)[0]):Array.isArray(Pn)&&typeof Pn[0]=="string"&&(Pi=Ur(Pn[0],Pn[1],Pn[2]),Sl.push([Pi[0],Pi[1],Pi[2]]));mn=Sl}return mn}var ni=!1,ku=!0;if(typeof _=="string")ni=!0;else if(Array.isArray(_)){var Iu=_.concat();Qe=[];for(var gl,$n=Iu.length;$n--;)(typeof(gl=Iu.shift())!="string"||Array.isArray(gl)&&typeof gl[0]!="string")&&(ku=!1);ni=ku}if(ni===!1)throw new Error('Type of text must be string or Array. "'+_+'" is not recognized.');typeof _=="string"&&(_=_.match(/[\r?\n]/)?_.split(/\r\n|\r|\n/g):[_]);var xl=rt/Ze.internal.scaleFactor,vl=xl*(wr-1);switch(xe.baseline){case"bottom":le-=vl;break;case"top":le+=xl-vl;break;case"hanging":le+=xl-2*vl;break;case"middle":le+=xl/2-vl}if((L=xe.maxWidth||0)>0&&(typeof _=="string"?_=Ze.splitTextToSize(_,L):Object.prototype.toString.call(_)==="[object Array]"&&(_=_.reduce(function(Vr,Ur){return Vr.concat(Ze.splitTextToSize(Ur,L))},[]))),Ve={text:_,x:B,y:le,options:xe,mutex:{pdfEscape:sn,activeFontKey:dt,fonts:cr,activeFontSize:rt}},ir.publish("preProcessText",Ve),_=Ve.text,pt=(xe=Ve.options).angle,!(Re instanceof bt)&&pt&&typeof pt=="number"){pt*=Math.PI/180,xe.rotationDirection===0&&(pt=-pt),P===R.ADVANCED&&(pt=-pt);var yl=Math.cos(pt),Cu=Math.sin(pt);Re=new bt(yl,Cu,-Cu,yl,0,0)}else pt&&pt instanceof bt&&(Re=pt);P!==R.ADVANCED||Re||(Re=_n),(T=xe.charSpace||Ai)!==void 0&&(nr+=I(A(T))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Ee=xe.horizontalScale)!==void 0&&(nr+=I(100*Ee)+` Tz
`),xe.lang;var La=-1,Pd=xe.renderingMode!==void 0?xe.renderingMode:xe.stroke,Pu=Ze.internal.getCurrentPageInfo().pageContext;switch(Pd){case 0:case!1:case"fill":La=0;break;case 1:case!0:case"stroke":La=1;break;case 2:case"fillThenStroke":La=2;break;case 3:case"invisible":La=3;break;case 4:case"fillAndAddForClipping":La=4;break;case 5:case"strokeAndAddPathForClipping":La=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":La=6;break;case 7:case"addToPathForClipping":La=7}var u0=Pu.usedRenderingMode!==void 0?Pu.usedRenderingMode:-1;La!==-1?nr+=La+` Tr
`:u0!==-1&&(nr+=`0 Tr
`),La!==-1&&(Pu.usedRenderingMode=La),m=xe.align||"left";var us,wl=rt*wr,h0=Ze.internal.pageSize.getWidth(),f0=cr[dt];T=xe.charSpace||Ai,L=xe.maxWidth||0,X=Object.assign({autoencode:!0,noBOM:!0},xe.flags);var fo=[],fc=function(Vr){return Ze.getStringUnitWidth(Vr,{font:f0,charSpace:T,fontSize:rt,doKerning:!1})*rt/Or};if(Object.prototype.toString.call(_)==="[object Array]"){var ja;Qe=Gn(_),m!=="left"&&(us=Qe.map(fc));var ba,mo=0;if(m==="right"){B-=us[0],_=[],$n=Qe.length;for(var ki=0;ki<$n;ki++)ki===0?(ba=Ya(B),ja=Cn(le)):(ba=A(mo-us[ki]),ja=-wl),_.push([Qe[ki],ba,ja]),mo=us[ki]}else if(m==="center"){B-=us[0]/2,_=[],$n=Qe.length;for(var Ii=0;Ii<$n;Ii++)Ii===0?(ba=Ya(B),ja=Cn(le)):(ba=A((mo-us[Ii])/2),ja=-wl),_.push([Qe[Ii],ba,ja]),mo=us[Ii]}else if(m==="left"){_=[],$n=Qe.length;for(var _l=0;_l<$n;_l++)_.push(Qe[_l])}else if(m==="justify"&&f0.encoding==="Identity-H"){_=[],$n=Qe.length,L=L!==0?L:h0;for(var Ci=0,dn=0;dn<$n;dn++)if(ja=dn===0?Cn(le):-wl,ba=dn===0?Ya(B):Ci,dn<$n-1){var Fu=A((L-us[dn])/(Qe[dn].split(" ").length-1)),Ea=Qe[dn].split(" ");_.push([Ea[0]+" ",ba,ja]),Ci=0;for(var hs=1;hs<Ea.length;hs++){var bl=(fc(Ea[hs-1]+" "+Ea[hs])-fc(Ea[hs]))*Or+Fu;hs==Ea.length-1?_.push([Ea[hs],bl,0]):_.push([Ea[hs]+" ",bl,0]),Ci-=bl}}else _.push([Qe[dn],ba,ja]);_.push(["",Ci,0])}else{if(m!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(_=[],$n=Qe.length,L=L!==0?L:h0,dn=0;dn<$n;dn++)ja=dn===0?Cn(le):-wl,ba=dn===0?Ya(B):0,dn<$n-1?fo.push(I(A((L-us[dn])/(Qe[dn].split(" ").length-1)))):fo.push(0),_.push([Qe[dn],ba,ja])}}var d0=typeof xe.R2L=="boolean"?xe.R2L:_t;d0===!0&&(_=ri(_,function(Vr,Ur,mn){return[Vr.split("").reverse().join(""),Ur,mn]})),Ve={text:_,x:B,y:le,options:xe,mutex:{pdfEscape:sn,activeFontKey:dt,fonts:cr,activeFontSize:rt}},ir.publish("postProcessText",Ve),_=Ve.text,$t=Ve.mutex.isHex||!1;var Ru=cr[dt].encoding;Ru!=="WinAnsiEncoding"&&Ru!=="StandardEncoding"||(_=ri(_,function(Vr,Ur,mn){return[Os(Vr),Ur,mn]})),Qe=Gn(_),_=[];for(var dc,mc,po,pc=0,El=1,gc=Array.isArray(Qe[0])?El:pc,go="",Du=function(Vr,Ur,mn){var Pn="";return mn instanceof bt?(mn=typeof xe.angle=="number"?ta(mn,new bt(1,0,0,1,Vr,Ur)):ta(new bt(1,0,0,1,Vr,Ur),mn),P===R.ADVANCED&&(mn=ta(new bt(1,0,0,-1,0,0),mn)),Pn=mn.join(" ")+` Tm
`):Pn=I(Vr)+" "+I(Ur)+` Td
`,Pn},fs=0;fs<Qe.length;fs++){switch(go="",gc){case El:po=($t?"<":"(")+Qe[fs][0]+($t?">":")"),dc=parseFloat(Qe[fs][1]),mc=parseFloat(Qe[fs][2]);break;case pc:po=($t?"<":"(")+Qe[fs]+($t?">":")"),dc=Ya(B),mc=Cn(le)}fo!==void 0&&fo[fs]!==void 0&&(go=fo[fs]+` Tw
`),fs===0?_.push(go+Du(dc,mc,Re)+po):gc===pc?_.push(go+po):gc===El&&_.push(go+Du(dc,mc,Re)+po)}_=gc===pc?_.join(` Tj
T* `):_.join(` Tj
`),_+=` Tj
`;var ds=`BT
/`;return ds+=dt+" "+rt+` Tf
`,ds+=I(rt*wr)+` TL
`,ds+=Ls+`
`,ds+=nr,ds+=_,se(ds+="ET"),g[dt]=!0,Ze};var Tu=p.__private__.clip=p.clip=function(_){return se(_==="evenodd"?"W*":"W"),this};p.clipEvenOdd=function(){return Tu("evenodd")},p.__private__.discardPath=p.discardPath=function(){return se("n"),this};var ls=p.__private__.isValidStyle=function(_){var B=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(_)!==-1&&(B=!0),B};p.__private__.setDefaultPathOperation=p.setDefaultPathOperation=function(_){return ls(_)&&(l=_),this};var fl=p.__private__.getStyle=p.getStyle=function(_){var B=l;switch(_){case"D":case"S":B="S";break;case"F":B="f";break;case"FD":case"DF":B="B";break;case"f":case"f*":case"B":case"B*":B=_}return B},Ka=p.close=function(){return se("h"),this};p.stroke=function(){return se("S"),this},p.fill=function(_){return eo("f",_),this},p.fillEvenOdd=function(_){return eo("f*",_),this},p.fillStroke=function(_){return eo("B",_),this},p.fillStrokeEvenOdd=function(_){return eo("B*",_),this};var eo=function(_,B){kr(B)==="object"?ro(B,_):se(_)},sc=function(_){_===null||P===R.ADVANCED&&_===void 0||(_=fl(_),se(_))};function to(_,B,le,xe,Ae){var Ve=new $l(B||this.boundingBox,le||this.xStep,xe||this.yStep,this.gState,Ae||this.matrix);Ve.stream=this.stream;var Qe=_+"$$"+this.cloneIndex+++"$$";return an(Qe,Ve),Ve}var ro=function(_,B){var le=Ha[_.key],xe=rr[le];if(xe instanceof Tc)se("q"),se(dl(B)),xe.gState&&p.setGState(xe.gState),se(_.matrix.toString()+" cm"),se("/"+le+" sh"),se("Q");else if(xe instanceof $l){var Ae=new bt(1,0,0,-1,0,ra());_.matrix&&(Ae=Ae.multiply(_.matrix||_n),le=to.call(xe,_.key,_.boundingBox,_.xStep,_.yStep,Ae).id),se("q"),se("/Pattern cs"),se("/"+le+" scn"),xe.gState&&p.setGState(xe.gState),se(B),se("Q")}},dl=function(_){switch(_){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Rs=p.moveTo=function(_,B){return se(I(A(_))+" "+I(J(B))+" m"),this},Xa=p.lineTo=function(_,B){return se(I(A(_))+" "+I(J(B))+" l"),this},Ds=p.curveTo=function(_,B,le,xe,Ae,Ve){return se([I(A(_)),I(J(B)),I(A(le)),I(J(xe)),I(A(Ae)),I(J(Ve)),"c"].join(" ")),this};p.__private__.line=p.line=function(_,B,le,xe,Ae){if(isNaN(_)||isNaN(B)||isNaN(le)||isNaN(xe)||!ls(Ae))throw new Error("Invalid arguments passed to jsPDF.line");return P===R.COMPAT?this.lines([[le-_,xe-B]],_,B,[1,1],Ae||"S"):this.lines([[le-_,xe-B]],_,B,[1,1]).stroke()},p.__private__.lines=p.lines=function(_,B,le,xe,Ae,Ve){var Qe,pt,m,T,L,X,Ee,Re,Ze,Gt,nr,$t;if(typeof _=="number"&&($t=le,le=B,B=_,_=$t),xe=xe||[1,1],Ve=Ve||!1,isNaN(B)||isNaN(le)||!Array.isArray(_)||!Array.isArray(xe)||!ls(Ae)||typeof Ve!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Rs(B,le),Qe=xe[0],pt=xe[1],T=_.length,Gt=B,nr=le,m=0;m<T;m++)(L=_[m]).length===2?(Gt=L[0]*Qe+Gt,nr=L[1]*pt+nr,Xa(Gt,nr)):(X=L[0]*Qe+Gt,Ee=L[1]*pt+nr,Re=L[2]*Qe+Gt,Ze=L[3]*pt+nr,Gt=L[4]*Qe+Gt,nr=L[5]*pt+nr,Ds(X,Ee,Re,Ze,Gt,nr));return Ve&&Ka(),sc(Ae),this},p.path=function(_){for(var B=0;B<_.length;B++){var le=_[B],xe=le.c;switch(le.op){case"m":Rs(xe[0],xe[1]);break;case"l":Xa(xe[0],xe[1]);break;case"c":Ds.apply(this,xe);break;case"h":Ka()}}return this},p.__private__.rect=p.rect=function(_,B,le,xe,Ae){if(isNaN(_)||isNaN(B)||isNaN(le)||isNaN(xe)||!ls(Ae))throw new Error("Invalid arguments passed to jsPDF.rect");return P===R.COMPAT&&(xe=-xe),se([I(A(_)),I(J(B)),I(A(le)),I(A(xe)),"re"].join(" ")),sc(Ae),this},p.__private__.triangle=p.triangle=function(_,B,le,xe,Ae,Ve,Qe){if(isNaN(_)||isNaN(B)||isNaN(le)||isNaN(xe)||isNaN(Ae)||isNaN(Ve)||!ls(Qe))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[le-_,xe-B],[Ae-le,Ve-xe],[_-Ae,B-Ve]],_,B,[1,1],Qe,!0),this},p.__private__.roundedRect=p.roundedRect=function(_,B,le,xe,Ae,Ve,Qe){if(isNaN(_)||isNaN(B)||isNaN(le)||isNaN(xe)||isNaN(Ae)||isNaN(Ve)||!ls(Qe))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var pt=4/3*(Math.SQRT2-1);return Ae=Math.min(Ae,.5*le),Ve=Math.min(Ve,.5*xe),this.lines([[le-2*Ae,0],[Ae*pt,0,Ae,Ve-Ve*pt,Ae,Ve],[0,xe-2*Ve],[0,Ve*pt,-Ae*pt,Ve,-Ae,Ve],[2*Ae-le,0],[-Ae*pt,0,-Ae,-Ve*pt,-Ae,-Ve],[0,2*Ve-xe],[0,-Ve*pt,Ae*pt,-Ve,Ae,-Ve]],_+Ae,B,[1,1],Qe,!0),this},p.__private__.ellipse=p.ellipse=function(_,B,le,xe,Ae){if(isNaN(_)||isNaN(B)||isNaN(le)||isNaN(xe)||!ls(Ae))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Ve=4/3*(Math.SQRT2-1)*le,Qe=4/3*(Math.SQRT2-1)*xe;return Rs(_+le,B),Ds(_+le,B-Qe,_+Ve,B-xe,_,B-xe),Ds(_-Ve,B-xe,_-le,B-Qe,_-le,B),Ds(_-le,B+Qe,_-Ve,B+xe,_,B+xe),Ds(_+Ve,B+xe,_+le,B+Qe,_+le,B),sc(Ae),this},p.__private__.circle=p.circle=function(_,B,le,xe){if(isNaN(_)||isNaN(B)||isNaN(le)||!ls(xe))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(_,B,le,le,xe)},p.setFont=function(_,B,le){return le&&(B=K(B,le)),dt=bi(_,B,{disableWarning:!1}),this};var ic=p.__private__.getFont=p.getFont=function(){return cr[bi.apply(p,arguments)]};p.__private__.getFontList=p.getFontList=function(){var _,B,le={};for(_ in Cr)if(Cr.hasOwnProperty(_))for(B in le[_]=[],Cr[_])Cr[_].hasOwnProperty(B)&&le[_].push(B);return le},p.addFont=function(_,B,le,xe,Ae){var Ve=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Ve.indexOf(arguments[3])!==-1?Ae=arguments[3]:arguments[3]&&Ve.indexOf(arguments[3])==-1&&(le=K(le,xe)),Ae=Ae||"Identity-H",rc.call(this,_,B,le,Ae)};var yr,oc=r.lineWidth||.200025,no=p.__private__.getLineWidth=p.getLineWidth=function(){return oc},cc=p.__private__.setLineWidth=p.setLineWidth=function(_){return oc=_,se(I(A(_))+" w"),this};p.__private__.setLineDash=jt.API.setLineDash=jt.API.setLineDashPattern=function(_,B){if(_=_||[],B=B||0,isNaN(B)||!Array.isArray(_))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return _=_.map(function(le){return I(A(le))}).join(" "),B=I(A(B)),se("["+_+"] "+B+" d"),this};var lc=p.__private__.getLineHeight=p.getLineHeight=function(){return rt*yr};p.__private__.getLineHeight=p.getLineHeight=function(){return rt*yr};var uc=p.__private__.setLineHeightFactor=p.setLineHeightFactor=function(_){return typeof(_=_||1.15)=="number"&&(yr=_),this},Si=p.__private__.getLineHeightFactor=p.getLineHeightFactor=function(){return yr};uc(r.lineHeight);var Ya=p.__private__.getHorizontalCoordinate=function(_){return A(_)},Cn=p.__private__.getVerticalCoordinate=function(_){return P===R.ADVANCED?_:Rt[O].mediaBox.topRightY-Rt[O].mediaBox.bottomLeftY-A(_)},ml=p.__private__.getHorizontalCoordinateString=p.getHorizontalCoordinateString=function(_){return I(Ya(_))},Zs=p.__private__.getVerticalCoordinateString=p.getVerticalCoordinateString=function(_){return I(Cn(_))},Hn=r.strokeColor||"0 G";p.__private__.getStrokeColor=p.getDrawColor=function(){return ie(Hn)},p.__private__.setStrokeColor=p.setDrawColor=function(_,B,le,xe){return Hn=ce({ch1:_,ch2:B,ch3:le,ch4:xe,pdfColorType:"draw",precision:2}),se(Hn),this};var ao=r.fillColor||"0 g";p.__private__.getFillColor=p.getFillColor=function(){return ie(ao)},p.__private__.setFillColor=p.setFillColor=function(_,B,le,xe){return ao=ce({ch1:_,ch2:B,ch3:le,ch4:xe,pdfColorType:"fill",precision:2}),se(ao),this};var Ls=r.textColor||"0 g",so=p.__private__.getTextColor=p.getTextColor=function(){return ie(Ls)};p.__private__.setTextColor=p.setTextColor=function(_,B,le,xe){return Ls=ce({ch1:_,ch2:B,ch3:le,ch4:xe,pdfColorType:"text",precision:3}),this};var Ai=r.charSpace,io=p.__private__.getCharSpace=p.getCharSpace=function(){return parseFloat(Ai||0)};p.__private__.setCharSpace=p.setCharSpace=function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Ai=_,this};var hc=0;p.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},p.__private__.setLineCap=p.setLineCap=function(_){var B=p.CapJoinStyles[_];if(B===void 0)throw new Error("Line cap style of '"+_+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return hc=B,se(B+" J"),this};var oo=0;p.__private__.setLineJoin=p.setLineJoin=function(_){var B=p.CapJoinStyles[_];if(B===void 0)throw new Error("Line join style of '"+_+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return oo=B,se(B+" j"),this},p.__private__.setLineMiterLimit=p.__private__.setMiterLimit=p.setLineMiterLimit=p.setMiterLimit=function(_){if(_=_||0,isNaN(_))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return se(I(A(_))+" M"),this},p.GState=$f,p.setGState=function(_){(_=typeof _=="string"?Pr[In[_]]:ei(null,_)).equals(va)||(se("/"+_.id+" gs"),va=_)};var ei=function(_,B){if(!_||!In[_]){var le=!1;for(var xe in Pr)if(Pr.hasOwnProperty(xe)&&Pr[xe].equals(B)){le=!0;break}if(le)B=Pr[xe];else{var Ae="GS"+(Object.keys(Pr).length+1).toString(10);Pr[Ae]=B,B.id=Ae}return _&&(In[_]=B.id),ir.publish("addGState",B),B}};p.addGState=function(_,B){return ei(_,B),this},p.saveGraphicsState=function(){return se("q"),Pa.push({key:dt,size:rt,color:Ls}),this},p.restoreGraphicsState=function(){se("Q");var _=Pa.pop();return dt=_.key,rt=_.size,Ls=_.color,va=null,this},p.setCurrentTransformationMatrix=function(_){return se(_.toString()+" cm"),this},p.comment=function(_){return se("#"+_),this};var Ni=function(_,B){var le=_||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return le},set:function(Ve){isNaN(Ve)||(le=parseFloat(Ve))}});var xe=B||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return xe},set:function(Ve){isNaN(Ve)||(xe=parseFloat(Ve))}});var Ae="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Ae},set:function(Ve){Ae=Ve.toString()}}),this},co=function(_,B,le,xe){Ni.call(this,_,B),this.type="rect";var Ae=le||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Ae},set:function(Qe){isNaN(Qe)||(Ae=parseFloat(Qe))}});var Ve=xe||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Ve},set:function(Qe){isNaN(Qe)||(Ve=parseFloat(Qe))}}),this},Ti=function(){this.page=xr,this.currentPage=O,this.pages=Me.slice(0),this.pagesContext=Rt.slice(0),this.x=sr,this.y=Ct,this.matrix=rn,this.width=ti(O),this.height=ra(O),this.outputDestination=Xe,this.id="",this.objectNumber=-1};Ti.prototype.restore=function(){xr=this.page,O=this.currentPage,Rt=this.pagesContext,Me=this.pages,sr=this.x,Ct=this.y,rn=this.matrix,uo(O,this.width),ho(O,this.height),Xe=this.outputDestination};var lo=function(_,B,le,xe,Ae){ya.push(new Ti),xr=O=0,Me=[],sr=_,Ct=B,rn=Ae,_a([le,xe])},pl=function(_){if(Ln[_])ya.pop().restore();else{var B=new Ti,le="Xo"+(Object.keys(nn).length+1).toString(10);B.id=le,Ln[_]=le,nn[le]=B,ir.publish("addFormObject",B),ya.pop().restore()}};for(var js in p.beginFormObject=function(_,B,le,xe,Ae){return lo(_,B,le,xe,Ae),this},p.endFormObject=function(_){return pl(_),this},p.doFormObject=function(_,B){var le=nn[Ln[_]];return se("q"),se(B.toString()+" cm"),se("/"+le.id+" Do"),se("Q"),this},p.getFormObject=function(_){var B=nn[Ln[_]];return{x:B.x,y:B.y,width:B.width,height:B.height,matrix:B.matrix}},p.save=function(_,B){return _=_||"generated.pdf",(B=B||{}).returnPromise=B.returnPromise||!1,B.returnPromise===!1?(_c(Qi(Fs()),_),typeof _c.unload=="function"&&Ut.setTimeout&&setTimeout(_c.unload,911),this):new Promise(function(le,xe){try{var Ae=_c(Qi(Fs()),_);typeof _c.unload=="function"&&Ut.setTimeout&&setTimeout(_c.unload,911),le(Ae)}catch(Ve){xe(Ve.message)}})},jt.API)jt.API.hasOwnProperty(js)&&(js==="events"&&jt.API.events.length?function(_,B){var le,xe,Ae;for(Ae=B.length-1;Ae!==-1;Ae--)le=B[Ae][0],xe=B[Ae][1],_.subscribe.apply(_,[le].concat(typeof xe=="function"?[xe]:xe))}(ir,jt.API.events):p[js]=jt.API[js]);var ti=p.getPageWidth=function(_){return(Rt[_=_||O].mediaBox.topRightX-Rt[_].mediaBox.bottomLeftX)/tt},uo=p.setPageWidth=function(_,B){Rt[_].mediaBox.topRightX=B*tt+Rt[_].mediaBox.bottomLeftX},ra=p.getPageHeight=function(_){return(Rt[_=_||O].mediaBox.topRightY-Rt[_].mediaBox.bottomLeftY)/tt},ho=p.setPageHeight=function(_,B){Rt[_].mediaBox.topRightY=B*tt+Rt[_].mediaBox.bottomLeftY};return p.internal={pdfEscape:sn,getStyle:fl,getFont:ic,getFontSize:ht,getCharSpace:io,getTextColor:so,getLineHeight:lc,getLineHeightFactor:Si,getLineWidth:no,write:qe,getHorizontalCoordinate:Ya,getVerticalCoordinate:Cn,getCoordinateString:ml,getVerticalCoordinateString:Zs,collections:{},newObject:Jr,newAdditionalObject:oe,newObjectDeferred:Kr,newObjectDeferredBegin:W,getFilters:Te,putStream:je,events:ir,scaleFactor:tt,pageSize:{getWidth:function(){return ti(O)},setWidth:function(_){uo(O,_)},getHeight:function(){return ra(O)},setHeight:function(_){ho(O,_)}},encryptionOptions:u,encryption:zr,getEncryptor:hl,output:Zi,getNumberOfPages:_r,pages:Me,out:se,f2:j,f3:S,getPageInfo:ac,getPageInfoByObjId:zt,getCurrentPageInfo:Qs,getPDFVersion:v,Point:Ni,Rectangle:co,Matrix:bt,hasHotfix:Js},Object.defineProperty(p.internal.pageSize,"width",{get:function(){return ti(O)},set:function(_){uo(O,_)},enumerable:!0,configurable:!0}),Object.defineProperty(p.internal.pageSize,"height",{get:function(){return ra(O)},set:function(_){ho(O,_)},enumerable:!0,configurable:!0}),ll.call(p,$e),dt="F1",_i(a,t),ir.publish("initialized"),p}Wl.prototype.lsbFirstWord=function(r){return String.fromCharCode(r>>0&255,r>>8&255,r>>16&255,r>>24&255)},Wl.prototype.toHexString=function(r){return r.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Wl.prototype.hexToBytes=function(r){for(var e=[],t=0;t<r.length;t+=2)e.push(String.fromCharCode(parseInt(r.substr(t,2),16)));return e.join("")},Wl.prototype.processOwnerPassword=function(r,e){return bp(_p(e).substr(0,5),r)},Wl.prototype.encryptor=function(r,e){var t=_p(this.encryptionKey+String.fromCharCode(255&r,r>>8&255,r>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return bp(t,n)}},$f.prototype.equals=function(r){var e,t="id,objectNumber,equals";if(!r||kr(r)!==kr(this))return!1;var n=0;for(e in this)if(!(t.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!r.hasOwnProperty(e)||this[e]!==r[e])return!1;n++}for(e in r)r.hasOwnProperty(e)&&t.indexOf(e)<0&&n--;return n===0},jt.API={events:[]},jt.version="2.5.2";var cn=jt.API,ng=1,ol=function(r){return r.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},jl=function(r){return r.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Kt=function(r){return r.toFixed(2)},Io=function(r){return r.toFixed(5)};cn.__acroform__={};var Wa=function(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r},xv=function(r){return r*ng},ci=function(r){var e=new Lb,t=St.internal.getHeight(r)||0,n=St.internal.getWidth(r)||0;return e.BBox=[0,0,Number(Kt(n)),Number(Kt(t))],e},Vj=cn.__acroform__.setBit=function(r,e){if(r=r||0,e=e||0,isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return r|=1<<e},Uj=cn.__acroform__.clearBit=function(r,e){if(r=r||0,e=e||0,isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return r&=~(1<<e)},qj=cn.__acroform__.getBit=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return r&1<<e?1:0},gn=cn.__acroform__.getBitForPdf=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return qj(r,e-1)},xn=cn.__acroform__.setBitForPdf=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return Vj(r,e-1)},vn=cn.__acroform__.clearBitForPdf=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return Uj(r,e-1)},zj=cn.__acroform__.calculateCoordinates=function(r,e){var t=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,a=r[0],s=r[1],i=r[2],o=r[3],c={};return c.lowerLeft_X=t(a)||0,c.lowerLeft_Y=n(s+o)||0,c.upperRight_X=t(a+i)||0,c.upperRight_Y=n(s)||0,[Number(Kt(c.lowerLeft_X)),Number(Kt(c.lowerLeft_Y)),Number(Kt(c.upperRight_X)),Number(Kt(c.upperRight_Y))]},Wj=function(r){if(r.appearanceStreamContent)return r.appearanceStreamContent;if(r.V||r.DV){var e=[],t=r._V||r.DV,n=Ep(r,t),a=r.scope.internal.getFont(r.fontName,r.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(r.scope.__private__.encodeColorString(r.color)),e.push("/"+a+" "+Kt(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var s=ci(r);return s.scope=r.scope,s.stream=e.join(`
`),s}},Ep=function(r,e){var t=r.fontSize===0?r.maxFontSize:r.fontSize,n={text:"",fontSize:""},a=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");a=r.multiline?a.map(function(S){return S.split(`
`)}):a.map(function(S){return[S]});var s=t,i=St.internal.getHeight(r)||0;i=i<0?-i:i;var o=St.internal.getWidth(r)||0;o=o<0?-o:o;var c=function(S,A,C){if(S+1<a.length){var J=A+" "+a[S+1][0];return Z0(J,r,C).width<=o-4}return!1};s++;e:for(;s>0;){e="",s--;var l,u,d=Z0("3",r,s).height,g=r.multiline?i-s:(i-d)/2,p=g+=2,y=0,v=0,w=0;if(s<=0){e=`(...) Tj
`,e+="% Width of Text: "+Z0(e,r,s=12).width+", FieldWidth:"+o+`
`;break}for(var E="",R=0,P=0;P<a.length;P++)if(a.hasOwnProperty(P)){var q=!1;if(a[P].length!==1&&w!==a[P].length-1){if((d+2)*(R+2)+2>i)continue e;E+=a[P][w],q=!0,v=P,P--}else{E=(E+=a[P][w]+" ").substr(E.length-1)==" "?E.substr(0,E.length-1):E;var z=parseInt(P),K=c(z,E,s),I=P>=a.length-1;if(K&&!I){E+=" ",w=0;continue}if(K||I){if(I)v=z;else if(r.multiline&&(d+2)*(R+2)+2>i)continue e}else{if(!r.multiline||(d+2)*(R+2)+2>i)continue e;v=z}}for(var N="",F=y;F<=v;F++){var j=a[F];if(r.multiline){if(F===v){N+=j[w]+" ",w=(w+1)%j.length;continue}if(F===y){N+=j[j.length-1]+" ";continue}}N+=j[0]+" "}switch(N=N.substr(N.length-1)==" "?N.substr(0,N.length-1):N,u=Z0(N,r,s).width,r.textAlign){case"right":l=o-u-2;break;case"center":l=(o-u)/2;break;case"left":default:l=2}e+=Kt(l)+" "+Kt(p)+` Td
`,e+="("+ol(N)+`) Tj
`,e+=-Kt(l)+` 0 Td
`,p=-(s+2),u=0,y=q?v:v+1,R++,E=""}break}return n.text=e,n.fontSize=s,n},Z0=function(r,e,t){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),a=e.scope.getStringUnitWidth(r,{font:n,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:a}},Hj={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},Gj=function(r,e){var t={type:"reference",object:r};e.internal.getPageInfo(r.page).pageContext.annotations.find(function(n){return n.type===t.type&&n.object===t.object})===void 0&&e.internal.getPageInfo(r.page).pageContext.annotations.push(t)},$j=function(r,e){for(var t in r)if(r.hasOwnProperty(t)){var n=t,a=r[t];e.internal.newObjectDeferredBegin(a.objId,!0),kr(a)==="object"&&typeof a.putStream=="function"&&a.putStream(),delete r[n]}},Kj=function(r,e){if(e.scope=r,r.internal!==void 0&&(r.internal.acroformPlugin===void 0||r.internal.acroformPlugin.isInitialized===!1)){if(Xs.FieldNum=0,r.internal.acroformPlugin=JSON.parse(JSON.stringify(Hj)),r.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");ng=r.internal.scaleFactor,r.internal.acroformPlugin.acroFormDictionaryRoot=new jb,r.internal.acroformPlugin.acroFormDictionaryRoot.scope=r,r.internal.acroformPlugin.acroFormDictionaryRoot._eventID=r.internal.events.subscribe("postPutResources",function(){(function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})(r)}),r.internal.events.subscribe("buildDocument",function(){(function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var a in n)if(n.hasOwnProperty(a)){var s=n[a];s.objId=void 0,s.hasAnnotation&&Gj(s,t)}})(r)}),r.internal.events.subscribe("putCatalog",function(){(function(t){if(t.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(r)}),r.internal.events.subscribe("postPutPages",function(t){(function(n,a){var s=!n;for(var i in n||(a.internal.newObjectDeferredBegin(a.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),a.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||a.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(i)){var o=n[i],c=[],l=o.Rect;if(o.Rect&&(o.Rect=zj(o.Rect,a)),a.internal.newObjectDeferredBegin(o.objId,!0),o.DA=St.createDefaultAppearanceStream(o),kr(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(c=o.getKeyValueListForStream()),o.Rect=l,o.hasAppearanceStream&&!o.appearanceStreamContent){var u=Wj(o);c.push({key:"AP",value:"<</N "+u+">>"}),a.internal.acroformPlugin.xForms.push(u)}if(o.appearanceStreamContent){var d="";for(var g in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(g)){var p=o.appearanceStreamContent[g];if(d+="/"+g+" ",d+="<<",Object.keys(p).length>=1||Array.isArray(p)){for(var i in p)if(p.hasOwnProperty(i)){var y=p[i];typeof y=="function"&&(y=y.call(a,o)),d+="/"+i+" "+y+" ",a.internal.acroformPlugin.xForms.indexOf(y)>=0||a.internal.acroformPlugin.xForms.push(y)}}else typeof(y=p)=="function"&&(y=y.call(a,o)),d+="/"+i+" "+y,a.internal.acroformPlugin.xForms.indexOf(y)>=0||a.internal.acroformPlugin.xForms.push(y);d+=">>"}c.push({key:"AP",value:`<<
`+d+">>"})}a.internal.putStream({additionalKeyValues:c,objectId:o.objId}),a.internal.out("endobj")}s&&$j(a.internal.acroformPlugin.xForms,a)})(t,r)}),r.internal.acroformPlugin.isInitialized=!0}},Db=cn.__acroform__.arrayToPdfArray=function(r,e,t){var n=function(i){return i};if(Array.isArray(r)){for(var a="[",s=0;s<r.length;s++)switch(s!==0&&(a+=" "),kr(r[s])){case"boolean":case"number":case"object":a+=r[s].toString();break;case"string":r[s].substr(0,1)!=="/"?(e!==void 0&&t&&(n=t.internal.getEncryptor(e)),a+="("+ol(n(r[s].toString()))+")"):a+=r[s].toString()}return a+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Sm=function(r,e,t){var n=function(a){return a};return e!==void 0&&t&&(n=t.internal.getEncryptor(e)),(r=r||"").toString(),r="("+ol(n(r))+")"},fi=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(r){this._objId=r}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};fi.prototype.toString=function(){return this.objId+" 0 R"},fi.prototype.putStream=function(){var r=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:r,objectId:this.objId}),this.scope.internal.out("endobj")},fi.prototype.getKeyValueListForStream=function(){var r=[],e=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var t in e)if(Object.getOwnPropertyDescriptor(this,e[t]).configurable===!1){var n=e[t],a=this[n];a&&(Array.isArray(a)?r.push({key:n,value:Db(a,this.objId,this.scope)}):a instanceof fi?(a.scope=this.scope,r.push({key:n,value:a.objId+" 0 R"})):typeof a!="function"&&r.push({key:n,value:a}))}return r};var Lb=function(){fi.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var r,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){r=t.trim()},get:function(){return r||null}})};Wa(Lb,fi);var jb=function(){fi.call(this);var r,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(r){var t=function(n){return n};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+ol(t(r))+")"}},set:function(t){r=t}})};Wa(jb,fi);var Xs=function r(){fi.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(E){if(isNaN(E))throw new Error('Invalid value "'+E+'" for attribute F supplied.');e=E}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!gn(e,3)},set:function(E){E?this.F=xn(e,3):this.F=vn(e,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(E){if(isNaN(E))throw new Error('Invalid value "'+E+'" for attribute Ff supplied.');t=E}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(E){n=E!==void 0?E:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(E){n[0]=E}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(E){n[1]=E}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(E){n[2]=E}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(E){n[3]=E}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(E){switch(E){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=E;break;default:throw new Error('Invalid value "'+E+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof Kf)return;s="FieldObject"+r.FieldNum++}var E=function(R){return R};return this.scope&&(E=this.scope.internal.getEncryptor(this.objId)),"("+ol(E(s))+")"},set:function(E){s=E.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(E){s=E}});var i="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return i},set:function(E){i=E}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(E){o=E}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(E){c=E}});var l=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return l===void 0?50/ng:l},set:function(E){l=E}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(E){u=E}});var d="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!d||this instanceof Kf||this instanceof Lc))return Sm(d,this.objId,this.scope)},set:function(E){E=E.toString(),d=E}});var g=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(g)return this instanceof Vn?g:Sm(g,this.objId,this.scope)},set:function(E){E=E.toString(),g=this instanceof Vn?E:E.substr(0,1)==="("?jl(E.substr(1,E.length-2)):jl(E)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Vn?jl(g.substr(1,g.length-1)):g},set:function(E){E=E.toString(),g=this instanceof Vn?"/"+E:E}});var p=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(p)return p},set:function(E){this.V=E}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof Vn?p:Sm(p,this.objId,this.scope)},set:function(E){E=E.toString(),p=this instanceof Vn?E:E.substr(0,1)==="("?jl(E.substr(1,E.length-2)):jl(E)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Vn?jl(p.substr(1,p.length-1)):p},set:function(E){E=E.toString(),p=this instanceof Vn?"/"+E:E}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var y,v=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return v},set:function(E){E=!!E,v=E}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(y)return y},set:function(E){y=E}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!gn(this.Ff,1)},set:function(E){E?this.Ff=xn(this.Ff,1):this.Ff=vn(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!gn(this.Ff,2)},set:function(E){E?this.Ff=xn(this.Ff,2):this.Ff=vn(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!gn(this.Ff,3)},set:function(E){E?this.Ff=xn(this.Ff,3):this.Ff=vn(this.Ff,3)}});var w=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(w!==null)return w},set:function(E){if([0,1,2].indexOf(E)===-1)throw new Error('Invalid value "'+E+'" for attribute Q supplied.');w=E}}),Object.defineProperty(this,"textAlign",{get:function(){var E;switch(w){case 0:default:E="left";break;case 1:E="center";break;case 2:E="right"}return E},configurable:!0,enumerable:!0,set:function(E){switch(E){case"right":case 2:w=2;break;case"center":case 1:w=1;break;case"left":case 0:default:w=0}}})};Wa(Xs,fi);var eu=function(){Xs.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var r=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return r},set:function(t){r=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return r},set:function(t){r=t}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return Db(e,this.objId,this.scope)},set:function(t){var n,a;a=[],typeof(n=t)=="string"&&(a=function(s,i,o){o||(o=1);for(var c,l=[];c=i.exec(s);)l.push(c[o]);return l}(n,/\((.*?)\)/g)),e=a}}),this.getOptions=function(){return e},this.setOptions=function(t){e=t,this.sort&&e.sort()},this.addOption=function(t){t=(t=t||"").toString(),e.push(t),this.sort&&e.sort()},this.removeOption=function(t,n){for(n=n||!1,t=(t=t||"").toString();e.indexOf(t)!==-1&&(e.splice(e.indexOf(t),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!gn(this.Ff,18)},set:function(t){t?this.Ff=xn(this.Ff,18):this.Ff=vn(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!gn(this.Ff,19)},set:function(t){this.combo===!0&&(t?this.Ff=xn(this.Ff,19):this.Ff=vn(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!gn(this.Ff,20)},set:function(t){t?(this.Ff=xn(this.Ff,20),e.sort()):this.Ff=vn(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!gn(this.Ff,22)},set:function(t){t?this.Ff=xn(this.Ff,22):this.Ff=vn(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!gn(this.Ff,23)},set:function(t){t?this.Ff=xn(this.Ff,23):this.Ff=vn(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!gn(this.Ff,27)},set:function(t){t?this.Ff=xn(this.Ff,27):this.Ff=vn(this.Ff,27)}}),this.hasAppearanceStream=!1};Wa(eu,Xs);var tu=function(){eu.call(this),this.fontName="helvetica",this.combo=!1};Wa(tu,eu);var ru=function(){tu.call(this),this.combo=!0};Wa(ru,tu);var mf=function(){ru.call(this),this.edit=!0};Wa(mf,ru);var Vn=function(){Xs.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!gn(this.Ff,15)},set:function(t){t?this.Ff=xn(this.Ff,15):this.Ff=vn(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!gn(this.Ff,16)},set:function(t){t?this.Ff=xn(this.Ff,16):this.Ff=vn(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!gn(this.Ff,17)},set:function(t){t?this.Ff=xn(this.Ff,17):this.Ff=vn(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!gn(this.Ff,26)},set:function(t){t?this.Ff=xn(this.Ff,26):this.Ff=vn(this.Ff,26)}});var r,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(s){return s};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,a=[];for(n in a.push("<<"),e)a.push("/"+n+" ("+ol(t(e[n]))+")");return a.push(">>"),a.join(`
`)}},set:function(t){kr(t)==="object"&&(e=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(t){typeof t=="string"&&(e.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(t){r=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(t){r="/"+t}})};Wa(Vn,Xs);var pf=function(){Vn.call(this),this.pushButton=!0};Wa(pf,Vn);var nu=function(){Vn.call(this),this.radio=!0,this.pushButton=!1;var r=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return r},set:function(e){r=e!==void 0?e:[]}})};Wa(nu,Vn);var Kf=function(){var r,e;Xs.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return r},set:function(a){r=a}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(a){e=a}});var t,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var a=function(o){return o};this.scope&&(a=this.scope.internal.getEncryptor(this.objId));var s,i=[];for(s in i.push("<<"),n)i.push("/"+s+" ("+ol(a(n[s]))+")");return i.push(">>"),i.join(`
`)},set:function(a){kr(a)==="object"&&(n=a)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(a){typeof a=="string"&&(n.CA=a)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(a){t=a}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(a){t="/"+a}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=St.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Wa(Kf,Xs),nu.prototype.setAppearance=function(r){if(!("createAppearanceStream"in r)||!("getCA"in r))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var t=this.Kids[e];t.appearanceStreamContent=r.createAppearanceStream(t.optionName),t.caption=r.getCA()}},nu.prototype.createOption=function(r){var e=new Kf;return e.Parent=this,e.optionName=r,this.Kids.push(e),Xj.call(this.scope,e),e};var gf=function(){Vn.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=St.CheckBox.createAppearanceStream()};Wa(gf,Vn);var Lc=function(){Xs.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!gn(this.Ff,13)},set:function(e){e?this.Ff=xn(this.Ff,13):this.Ff=vn(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!gn(this.Ff,21)},set:function(e){e?this.Ff=xn(this.Ff,21):this.Ff=vn(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!gn(this.Ff,23)},set:function(e){e?this.Ff=xn(this.Ff,23):this.Ff=vn(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!gn(this.Ff,24)},set:function(e){e?this.Ff=xn(this.Ff,24):this.Ff=vn(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!gn(this.Ff,25)},set:function(e){e?this.Ff=xn(this.Ff,25):this.Ff=vn(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!gn(this.Ff,26)},set:function(e){e?this.Ff=xn(this.Ff,26):this.Ff=vn(this.Ff,26)}});var r=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return r},set:function(e){r=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return r},set:function(e){Number.isInteger(e)&&(r=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Wa(Lc,Xs);var xf=function(){Lc.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!gn(this.Ff,14)},set:function(r){r?this.Ff=xn(this.Ff,14):this.Ff=vn(this.Ff,14)}}),this.password=!0};Wa(xf,Lc);var St={CheckBox:{createAppearanceStream:function(){return{N:{On:St.CheckBox.YesNormal},D:{On:St.CheckBox.YesPushDown,Off:St.CheckBox.OffPushDown}}},YesPushDown:function(r){var e=ci(r);e.scope=r.scope;var t=[],n=r.scope.internal.getFont(r.fontName,r.fontStyle).id,a=r.scope.__private__.encodeColorString(r.color),s=Ep(r,r.caption);return t.push("0.749023 g"),t.push("0 0 "+Kt(St.internal.getWidth(r))+" "+Kt(St.internal.getHeight(r))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+n+" "+Kt(s.fontSize)+" Tf "+a),t.push("BT"),t.push(s.text),t.push("ET"),t.push("Q"),t.push("EMC"),e.stream=t.join(`
`),e},YesNormal:function(r){var e=ci(r);e.scope=r.scope;var t=r.scope.internal.getFont(r.fontName,r.fontStyle).id,n=r.scope.__private__.encodeColorString(r.color),a=[],s=St.internal.getHeight(r),i=St.internal.getWidth(r),o=Ep(r,r.caption);return a.push("1 g"),a.push("0 0 "+Kt(i)+" "+Kt(s)+" re"),a.push("f"),a.push("q"),a.push("0 0 1 rg"),a.push("0 0 "+Kt(i-1)+" "+Kt(s-1)+" re"),a.push("W"),a.push("n"),a.push("0 g"),a.push("BT"),a.push("/"+t+" "+Kt(o.fontSize)+" Tf "+n),a.push(o.text),a.push("ET"),a.push("Q"),e.stream=a.join(`
`),e},OffPushDown:function(r){var e=ci(r);e.scope=r.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+Kt(St.internal.getWidth(r))+" "+Kt(St.internal.getHeight(r))+" re"),t.push("f"),e.stream=t.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(r){var e={D:{Off:St.RadioButton.Circle.OffPushDown},N:{}};return e.N[r]=St.RadioButton.Circle.YesNormal,e.D[r]=St.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(r){var e=ci(r);e.scope=r.scope;var t=[],n=St.internal.getWidth(r)<=St.internal.getHeight(r)?St.internal.getWidth(r)/4:St.internal.getHeight(r)/4;n=Number((.9*n).toFixed(5));var a=St.internal.Bezier_C,s=Number((n*a).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+Io(St.internal.getWidth(r)/2)+" "+Io(St.internal.getHeight(r)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),t.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),t.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),t.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(r){var e=ci(r);e.scope=r.scope;var t=[],n=St.internal.getWidth(r)<=St.internal.getHeight(r)?St.internal.getWidth(r)/4:St.internal.getHeight(r)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),s=Number((a*St.internal.Bezier_C).toFixed(5)),i=Number((n*St.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+Io(St.internal.getWidth(r)/2)+" "+Io(St.internal.getHeight(r)/2)+" cm"),t.push(a+" 0 m"),t.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),t.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),t.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),t.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+Io(St.internal.getWidth(r)/2)+" "+Io(St.internal.getHeight(r)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),t.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),t.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),t.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},OffPushDown:function(r){var e=ci(r);e.scope=r.scope;var t=[],n=St.internal.getWidth(r)<=St.internal.getHeight(r)?St.internal.getWidth(r)/4:St.internal.getHeight(r)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),s=Number((a*St.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+Io(St.internal.getWidth(r)/2)+" "+Io(St.internal.getHeight(r)/2)+" cm"),t.push(a+" 0 m"),t.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),t.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),t.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),t.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e}},Cross:{createAppearanceStream:function(r){var e={D:{Off:St.RadioButton.Cross.OffPushDown},N:{}};return e.N[r]=St.RadioButton.Cross.YesNormal,e.D[r]=St.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(r){var e=ci(r);e.scope=r.scope;var t=[],n=St.internal.calculateCross(r);return t.push("q"),t.push("1 1 "+Kt(St.internal.getWidth(r)-2)+" "+Kt(St.internal.getHeight(r)-2)+" re"),t.push("W"),t.push("n"),t.push(Kt(n.x1.x)+" "+Kt(n.x1.y)+" m"),t.push(Kt(n.x2.x)+" "+Kt(n.x2.y)+" l"),t.push(Kt(n.x4.x)+" "+Kt(n.x4.y)+" m"),t.push(Kt(n.x3.x)+" "+Kt(n.x3.y)+" l"),t.push("s"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(r){var e=ci(r);e.scope=r.scope;var t=St.internal.calculateCross(r),n=[];return n.push("0.749023 g"),n.push("0 0 "+Kt(St.internal.getWidth(r))+" "+Kt(St.internal.getHeight(r))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Kt(St.internal.getWidth(r)-2)+" "+Kt(St.internal.getHeight(r)-2)+" re"),n.push("W"),n.push("n"),n.push(Kt(t.x1.x)+" "+Kt(t.x1.y)+" m"),n.push(Kt(t.x2.x)+" "+Kt(t.x2.y)+" l"),n.push(Kt(t.x4.x)+" "+Kt(t.x4.y)+" m"),n.push(Kt(t.x3.x)+" "+Kt(t.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(r){var e=ci(r);e.scope=r.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+Kt(St.internal.getWidth(r))+" "+Kt(St.internal.getHeight(r))+" re"),t.push("f"),e.stream=t.join(`
`),e}}},createDefaultAppearanceStream:function(r){var e=r.scope.internal.getFont(r.fontName,r.fontStyle).id,t=r.scope.__private__.encodeColorString(r.color);return"/"+e+" "+r.fontSize+" Tf "+t}};St.internal={Bezier_C:.551915024494,calculateCross:function(r){var e=St.internal.getWidth(r),t=St.internal.getHeight(r),n=Math.min(e,t);return{x1:{x:(e-n)/2,y:(t-n)/2+n},x2:{x:(e-n)/2+n,y:(t-n)/2},x3:{x:(e-n)/2,y:(t-n)/2},x4:{x:(e-n)/2+n,y:(t-n)/2+n}}}},St.internal.getWidth=function(r){var e=0;return kr(r)==="object"&&(e=xv(r.Rect[2])),e},St.internal.getHeight=function(r){var e=0;return kr(r)==="object"&&(e=xv(r.Rect[3])),e};var Xj=cn.addField=function(r){if(Kj(this,r),!(r instanceof Xs))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=r).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),r.page=r.scope.internal.getCurrentPageInfo().pageNumber,this};cn.AcroFormChoiceField=eu,cn.AcroFormListBox=tu,cn.AcroFormComboBox=ru,cn.AcroFormEditBox=mf,cn.AcroFormButton=Vn,cn.AcroFormPushButton=pf,cn.AcroFormRadioButton=nu,cn.AcroFormCheckBox=gf,cn.AcroFormTextField=Lc,cn.AcroFormPasswordField=xf,cn.AcroFormAppearance=St,cn.AcroForm={ChoiceField:eu,ListBox:tu,ComboBox:ru,EditBox:mf,Button:Vn,PushButton:pf,RadioButton:nu,CheckBox:gf,TextField:Lc,PasswordField:xf,Appearance:St},jt.AcroForm={ChoiceField:eu,ListBox:tu,ComboBox:ru,EditBox:mf,Button:Vn,PushButton:pf,RadioButton:nu,CheckBox:gf,TextField:Lc,PasswordField:xf,Appearance:St};function Ob(r){return r.reduce(function(e,t,n){return e[t]=n,e},{})}(function(r){r.__addimage__={};var e="UNKNOWN",t={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=r.__addimage__.getImageFileTypeByImageData=function(S,A){var C,J,ue,me,pe,ge=e;if((A=A||e)==="RGBA"||S.data!==void 0&&S.data instanceof Uint8ClampedArray&&"height"in S&&"width"in S)return"RGBA";if(K(S))for(pe in t)for(ue=t[pe],C=0;C<ue.length;C+=1){for(me=!0,J=0;J<ue[C].length;J+=1)if(ue[C][J]!==void 0&&ue[C][J]!==S[J]){me=!1;break}if(me===!0){ge=pe;break}}else for(pe in t)for(ue=t[pe],C=0;C<ue.length;C+=1){for(me=!0,J=0;J<ue[C].length;J+=1)if(ue[C][J]!==void 0&&ue[C][J]!==S.charCodeAt(J)){me=!1;break}if(me===!0){ge=pe;break}}return ge===e&&A!==e&&(ge=A),ge},a=function S(A){for(var C=this.internal.write,J=this.internal.putStream,ue=(0,this.internal.getFilters)();ue.indexOf("FlateEncode")!==-1;)ue.splice(ue.indexOf("FlateEncode"),1);A.objectId=this.internal.newObject();var me=[];if(me.push({key:"Type",value:"/XObject"}),me.push({key:"Subtype",value:"/Image"}),me.push({key:"Width",value:A.width}),me.push({key:"Height",value:A.height}),A.colorSpace===w.INDEXED?me.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(A.palette.length/3-1)+" "+("sMask"in A&&A.sMask!==void 0?A.objectId+2:A.objectId+1)+" 0 R]"}):(me.push({key:"ColorSpace",value:"/"+A.colorSpace}),A.colorSpace===w.DEVICE_CMYK&&me.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),me.push({key:"BitsPerComponent",value:A.bitsPerComponent}),"decodeParameters"in A&&A.decodeParameters!==void 0&&me.push({key:"DecodeParms",value:"<<"+A.decodeParameters+">>"}),"transparency"in A&&Array.isArray(A.transparency)){for(var pe="",ge=0,ne=A.transparency.length;ge<ne;ge++)pe+=A.transparency[ge]+" "+A.transparency[ge]+" ";me.push({key:"Mask",value:"["+pe+"]"})}A.sMask!==void 0&&me.push({key:"SMask",value:A.objectId+1+" 0 R"});var we=A.filter!==void 0?["/"+A.filter]:void 0;if(J({data:A.data,additionalKeyValues:me,alreadyAppliedFilters:we,objectId:A.objectId}),C("endobj"),"sMask"in A&&A.sMask!==void 0){var Oe="/Predictor "+A.predictor+" /Colors 1 /BitsPerComponent "+A.bitsPerComponent+" /Columns "+A.width,k={width:A.width,height:A.height,colorSpace:"DeviceGray",bitsPerComponent:A.bitsPerComponent,decodeParameters:Oe,data:A.sMask};"filter"in A&&(k.filter=A.filter),S.call(this,k)}if(A.colorSpace===w.INDEXED){var O=this.internal.newObject();J({data:N(new Uint8Array(A.palette)),objectId:O}),C("endobj")}},s=function(){var S=this.internal.collections.addImage_images;for(var A in S)a.call(this,S[A])},i=function(){var S,A=this.internal.collections.addImage_images,C=this.internal.write;for(var J in A)C("/I"+(S=A[J]).index,S.objectId,"0","R")},o=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",i))},c=function(){var S=this.internal.collections.addImage_images;return o.call(this),S},l=function(){return Object.keys(this.internal.collections.addImage_images).length},u=function(S){return typeof r["process"+S.toUpperCase()]=="function"},d=function(S){return kr(S)==="object"&&S.nodeType===1},g=function(S,A){if(S.nodeName==="IMG"&&S.hasAttribute("src")){var C=""+S.getAttribute("src");if(C.indexOf("data:image/")===0)return vh(unescape(C).split("base64,").pop());var J=r.loadFile(C,!0);if(J!==void 0)return J}if(S.nodeName==="CANVAS"){if(S.width===0||S.height===0)throw new Error("Given canvas must have data. Canvas width: "+S.width+", height: "+S.height);var ue;switch(A){case"PNG":ue="image/png";break;case"WEBP":ue="image/webp";break;case"JPEG":case"JPG":default:ue="image/jpeg"}return vh(S.toDataURL(ue,1).split("base64,").pop())}},p=function(S){var A=this.internal.collections.addImage_images;if(A){for(var C in A)if(S===A[C].alias)return A[C]}},y=function(S,A,C){return S||A||(S=-96,A=-96),S<0&&(S=-1*C.width*72/S/this.internal.scaleFactor),A<0&&(A=-1*C.height*72/A/this.internal.scaleFactor),S===0&&(S=A*C.width/C.height),A===0&&(A=S*C.height/C.width),[S,A]},v=function(S,A,C,J,ue,me){var pe=y.call(this,C,J,ue),ge=this.internal.getCoordinateString,ne=this.internal.getVerticalCoordinateString,we=c.call(this);if(C=pe[0],J=pe[1],we[ue.index]=ue,me){me*=Math.PI/180;var Oe=Math.cos(me),k=Math.sin(me),O=function(U){return U.toFixed(4)},M=[O(Oe),O(k),O(-1*k),O(Oe),0,0,"cm"]}this.internal.write("q"),me?(this.internal.write([1,"0","0",1,ge(S),ne(A+J),"cm"].join(" ")),this.internal.write(M.join(" ")),this.internal.write([ge(C),"0","0",ge(J),"0","0","cm"].join(" "))):this.internal.write([ge(C),"0","0",ge(J),ge(S),ne(A+J),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ue.index+" Do"),this.internal.write("Q")},w=r.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};r.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var E=r.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},R=r.__addimage__.sHashCode=function(S){var A,C,J=0;if(typeof S=="string")for(C=S.length,A=0;A<C;A++)J=(J<<5)-J+S.charCodeAt(A),J|=0;else if(K(S))for(C=S.byteLength/2,A=0;A<C;A++)J=(J<<5)-J+S[A],J|=0;return J},P=r.__addimage__.validateStringAsBase64=function(S){(S=S||"").toString().trim();var A=!0;return S.length===0&&(A=!1),S.length%4!=0&&(A=!1),/^[A-Za-z0-9+/]+$/.test(S.substr(0,S.length-2))===!1&&(A=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(S.substr(-2))===!1&&(A=!1),A},q=r.__addimage__.extractImageFromDataUrl=function(S){var A=(S=S||"").split("base64,"),C=null;if(A.length===2){var J=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(A[0]);Array.isArray(J)&&(C={mimeType:J[1],charset:J[2],data:A[1]})}return C},z=r.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};r.__addimage__.isArrayBuffer=function(S){return z()&&S instanceof ArrayBuffer};var K=r.__addimage__.isArrayBufferView=function(S){return z()&&typeof Uint32Array<"u"&&(S instanceof Int8Array||S instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&S instanceof Uint8ClampedArray||S instanceof Int16Array||S instanceof Uint16Array||S instanceof Int32Array||S instanceof Uint32Array||S instanceof Float32Array||S instanceof Float64Array)},I=r.__addimage__.binaryStringToUint8Array=function(S){for(var A=S.length,C=new Uint8Array(A),J=0;J<A;J++)C[J]=S.charCodeAt(J);return C},N=r.__addimage__.arrayBufferToBinaryString=function(S){for(var A="",C=K(S)?S:new Uint8Array(S),J=0;J<C.length;J+=8192)A+=String.fromCharCode.apply(null,C.subarray(J,J+8192));return A};r.addImage=function(){var S,A,C,J,ue,me,pe,ge,ne;if(typeof arguments[1]=="number"?(A=e,C=arguments[1],J=arguments[2],ue=arguments[3],me=arguments[4],pe=arguments[5],ge=arguments[6],ne=arguments[7]):(A=arguments[1],C=arguments[2],J=arguments[3],ue=arguments[4],me=arguments[5],pe=arguments[6],ge=arguments[7],ne=arguments[8]),kr(S=arguments[0])==="object"&&!d(S)&&"imageData"in S){var we=S;S=we.imageData,A=we.format||A||e,C=we.x||C||0,J=we.y||J||0,ue=we.w||we.width||ue,me=we.h||we.height||me,pe=we.alias||pe,ge=we.compression||ge,ne=we.rotation||we.angle||ne}var Oe=this.internal.getFilters();if(ge===void 0&&Oe.indexOf("FlateEncode")!==-1&&(ge="SLOW"),isNaN(C)||isNaN(J))throw new Error("Invalid coordinates passed to jsPDF.addImage");o.call(this);var k=F.call(this,S,A,pe,ge);return v.call(this,C,J,ue,me,k,ne),this};var F=function(S,A,C,J){var ue,me,pe;if(typeof S=="string"&&n(S)===e){S=unescape(S);var ge=j(S,!1);(ge!==""||(ge=r.loadFile(S,!0))!==void 0)&&(S=ge)}if(d(S)&&(S=g(S,A)),A=n(S,A),!u(A))throw new Error("addImage does not support files of type '"+A+"', please ensure that a plugin for '"+A+"' support is added.");if(((pe=C)==null||pe.length===0)&&(C=function(ne){return typeof ne=="string"||K(ne)?R(ne):K(ne.data)?R(ne.data):null}(S)),(ue=p.call(this,C))||(z()&&(S instanceof Uint8Array||A==="RGBA"||(me=S,S=I(S))),ue=this["process"+A.toUpperCase()](S,l.call(this),C,function(ne){return ne&&typeof ne=="string"&&(ne=ne.toUpperCase()),ne in r.image_compression?ne:E.NONE}(J),me)),!ue)throw new Error("An unknown error occurred whilst processing the image.");return ue},j=r.__addimage__.convertBase64ToBinaryString=function(S,A){var C;A=typeof A!="boolean"||A;var J,ue="";if(typeof S=="string"){J=(C=q(S))!==null?C.data:S;try{ue=vh(J)}catch(me){if(A)throw P(J)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+me.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return ue};r.getImageProperties=function(S){var A,C,J="";if(d(S)&&(S=g(S)),typeof S=="string"&&n(S)===e&&((J=j(S,!1))===""&&(J=r.loadFile(S)||""),S=J),C=n(S),!u(C))throw new Error("addImage does not support files of type '"+C+"', please ensure that a plugin for '"+C+"' support is added.");if(!z()||S instanceof Uint8Array||(S=I(S)),!(A=this["process"+C.toUpperCase()](S)))throw new Error("An unknown error occurred whilst processing the image");return A.fileType=C,A}})(jt.API),function(r){var e=function(t){if(t!==void 0&&t!="")return!0};jt.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),r.events.push(["putPage",function(t){for(var n,a,s,i=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(t.objId),l=t.pageContext.annotations,u=!1,d=0;d<l.length&&!u;d++)switch((n=l[d]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var g=0;g<l.length;g++){n=l[g];var p=this.internal.pdfEscape,y=this.internal.getEncryptor(t.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var v=this.internal.newAdditionalObject(),w=this.internal.newAdditionalObject(),E=this.internal.getEncryptor(v.objId),R=n.title||"Note";s="<</Type /Annot /Subtype /Text "+(a="/Rect ["+i(n.bounds.x)+" "+o(n.bounds.y+n.bounds.h)+" "+i(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y)+"] ")+"/Contents ("+p(E(n.contents))+")",s+=" /Popup "+w.objId+" 0 R",s+=" /P "+c.objId+" 0 R",s+=" /T ("+p(E(R))+") >>",v.content=s;var P=v.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(a="/Rect ["+i(n.bounds.x+30)+" "+o(n.bounds.y+n.bounds.h)+" "+i(n.bounds.x+n.bounds.w+30)+" "+o(n.bounds.y)+"] ")+" /Parent "+P,n.open&&(s+=" /Open true"),s+=" >>",w.content=s,this.internal.write(v.objId,"0 R",w.objId,"0 R");break;case"freetext":a="/Rect ["+i(n.bounds.x)+" "+o(n.bounds.y)+" "+i(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y+n.bounds.h)+"] ";var q=n.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+a+"/Contents ("+p(y(n.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+q+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(n.options.name){var z=this.annotations._nameMap[n.options.name];n.options.pageNumber=z.page,n.options.top=z.y}else n.options.top||(n.options.top=0);if(a="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",s="",n.options.url)s="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /A <</S /URI /URI ("+p(y(n.options.url))+") >>";else if(n.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,s+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var K=o(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),s+=" /XYZ "+n.options.left+" "+K+" "+n.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),r.createAnnotation=function(t){var n=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":n.pageContext.annotations.push(t)}},r.link=function(t,n,a,s,i){var o=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:c(t),y:l(n),w:c(t+a),h:l(n+s)},options:i,type:"link"})},r.textWithLink=function(t,n,a,s){var i,o,c=this.getTextWidth(t),l=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){o=s.maxWidth;var u=this.splitTextToSize(t,o).length;i=Math.ceil(l*u)}else o=c,i=l;return this.text(t,n,a,s),a+=.2*l,s.align==="center"&&(n-=c/2),s.align==="right"&&(n-=c),this.link(n,a-l,o,i,s),c},r.getTextWidth=function(t){var n=this.internal.getFontSize();return this.getStringUnitWidth(t)*n/this.internal.scaleFactor}}(jt.API),function(r){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];r.__arabicParser__={};var s=r.__arabicParser__.isInArabicSubstitutionA=function(v){return e[v.charCodeAt(0)]!==void 0},i=r.__arabicParser__.isArabicLetter=function(v){return typeof v=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(v)},o=r.__arabicParser__.isArabicEndLetter=function(v){return i(v)&&s(v)&&e[v.charCodeAt(0)].length<=2},c=r.__arabicParser__.isArabicAlfLetter=function(v){return i(v)&&a.indexOf(v.charCodeAt(0))>=0};r.__arabicParser__.arabicLetterHasIsolatedForm=function(v){return i(v)&&s(v)&&e[v.charCodeAt(0)].length>=1};var l=r.__arabicParser__.arabicLetterHasFinalForm=function(v){return i(v)&&s(v)&&e[v.charCodeAt(0)].length>=2};r.__arabicParser__.arabicLetterHasInitialForm=function(v){return i(v)&&s(v)&&e[v.charCodeAt(0)].length>=3};var u=r.__arabicParser__.arabicLetterHasMedialForm=function(v){return i(v)&&s(v)&&e[v.charCodeAt(0)].length==4},d=r.__arabicParser__.resolveLigatures=function(v){var w=0,E=t,R="",P=0;for(w=0;w<v.length;w+=1)E[v.charCodeAt(w)]!==void 0?(P++,typeof(E=E[v.charCodeAt(w)])=="number"&&(R+=String.fromCharCode(E),E=t,P=0),w===v.length-1&&(E=t,R+=v.charAt(w-(P-1)),w-=P-1,P=0)):(E=t,R+=v.charAt(w-P),w-=P,P=0);return R};r.__arabicParser__.isArabicDiacritic=function(v){return v!==void 0&&n[v.charCodeAt(0)]!==void 0};var g=r.__arabicParser__.getCorrectForm=function(v,w,E){return i(v)?s(v)===!1?-1:!l(v)||!i(w)&&!i(E)||!i(E)&&o(w)||o(v)&&!i(w)||o(v)&&c(w)||o(v)&&o(w)?0:u(v)&&i(w)&&!o(w)&&i(E)&&l(E)?3:o(v)||!i(E)?1:2:-1},p=function(v){var w=0,E=0,R=0,P="",q="",z="",K=(v=v||"").split("\\s+"),I=[];for(w=0;w<K.length;w+=1){for(I.push(""),E=0;E<K[w].length;E+=1)P=K[w][E],q=K[w][E-1],z=K[w][E+1],i(P)?(R=g(P,q,z),I[w]+=R!==-1?String.fromCharCode(e[P.charCodeAt(0)][R]):P):I[w]+=P;I[w]=d(I[w])}return I.join(" ")},y=r.__arabicParser__.processArabic=r.processArabic=function(){var v,w=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,E=[];if(Array.isArray(w)){var R=0;for(E=[],R=0;R<w.length;R+=1)Array.isArray(w[R])?E.push([p(w[R][0]),w[R][1],w[R][2]]):E.push([p(w[R])]);v=E}else v=p(w);return typeof arguments[0]=="string"?v:(arguments[0].text=v,arguments[0])};r.events.push(["preProcessText",y])}(jt.API),jt.API.autoPrint=function(r){var e;switch((r=r||{}).variant=r.variant||"non-conform",r.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})}return this},function(r){var e=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(o){t=o}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var a=300;Object.defineProperty(this,"height",{get:function(){return a},set:function(o){a=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=a+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(o){s=o}});var i={};Object.defineProperty(this,"style",{get:function(){return i},set:function(o){i=o}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(t,n){var a;if((t=t||"2d")!=="2d")return null;for(a in n)this.pdf.context2d.hasOwnProperty(a)&&(this.pdf.context2d[a]=n[a]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},r.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(jt.API),function(r){var e={left:0,top:0,bottom:0,right:0},t=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),a.call(this))},a=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(v){c=v}});var l=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return l},set:function(v){l=v}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(v){u=v}});var d=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return d},set:function(v){d=v}});var g=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return g},set:function(v){g=v}});var p=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return p},set:function(v){p=v}});var y=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return y},set:function(v){y=v}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},r.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},r.getTextDimensions=function(c,l){n.call(this);var u=(l=l||{}).fontSize||this.getFontSize(),d=l.font||this.getFont(),g=l.scaleFactor||this.internal.scaleFactor,p=0,y=0,v=0,w=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var E=l.maxWidth;E>0?typeof c=="string"?c=this.splitTextToSize(c,E):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(P,q){return P.concat(w.splitTextToSize(q,E))},[])):c=Array.isArray(c)?c:[c];for(var R=0;R<c.length;R++)p<(v=this.getStringUnitWidth(c[R],{font:d})*u)&&(p=v);return p!==0&&(y=c.length),{w:p/=g,h:Math.max((y*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/g,0)}},r.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new s(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var i=r.cell=function(){var c;c=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var l=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,d=this.internal.__cell__.margins||e,g=this.internal.__cell__.tableHeaderRow,p=this.internal.__cell__.printHeaders;return l.lineNumber!==void 0&&(l.lineNumber===c.lineNumber?(c.x=(l.x||0)+(l.width||0),c.y=l.y||0):l.y+l.height+c.height+d.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=d.top,p&&g&&(this.printHeaderRow(c.lineNumber,!0),c.y+=g[0].height)):c.y=l.y+l.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,t===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-u,c.y+u,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+u,{align:"center",baseline:"top",maxWidth:c.width-u-u}):this.text(c.text,c.x+u,c.y+u,{align:"left",baseline:"top",maxWidth:c.width-u-u})),this.internal.__cell__.lastCell=c,this};r.table=function(c,l,u,d,g){if(n.call(this),!u)throw new Error("No data for PDF table.");var p,y,v,w,E=[],R=[],P=[],q={},z={},K=[],I=[],N=(g=g||{}).autoSize||!1,F=g.printHeaders!==!1,j=g.css&&g.css["font-size"]!==void 0?16*g.css["font-size"]:g.fontSize||12,S=g.margins||Object.assign({width:this.getPageWidth()},e),A=typeof g.padding=="number"?g.padding:3,C=g.headerBackgroundColor||"#c8c8c8",J=g.headerTextColor||"#000";if(a.call(this),this.internal.__cell__.printHeaders=F,this.internal.__cell__.margins=S,this.internal.__cell__.table_font_size=j,this.internal.__cell__.padding=A,this.internal.__cell__.headerBackgroundColor=C,this.internal.__cell__.headerTextColor=J,this.setFontSize(j),d==null)R=E=Object.keys(u[0]),P=E.map(function(){return"left"});else if(Array.isArray(d)&&kr(d[0])==="object")for(E=d.map(function(we){return we.name}),R=d.map(function(we){return we.prompt||we.name||""}),P=d.map(function(we){return we.align||"left"}),p=0;p<d.length;p+=1)z[d[p].name]=d[p].width*(19.049976/25.4);else Array.isArray(d)&&typeof d[0]=="string"&&(R=E=d,P=E.map(function(){return"left"}));if(N||Array.isArray(d)&&typeof d[0]=="string")for(p=0;p<E.length;p+=1){for(q[w=E[p]]=u.map(function(we){return we[w]}),this.setFont(void 0,"bold"),K.push(this.getTextDimensions(R[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),y=q[w],this.setFont(void 0,"normal"),v=0;v<y.length;v+=1)K.push(this.getTextDimensions(y[v],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);z[w]=Math.max.apply(null,K)+A+A,K=[]}if(F){var ue={};for(p=0;p<E.length;p+=1)ue[E[p]]={},ue[E[p]].text=R[p],ue[E[p]].align=P[p];var me=o.call(this,ue,z);I=E.map(function(we){return new s(c,l,z[we],me,ue[we].text,void 0,ue[we].align)}),this.setTableHeaderRow(I),this.printHeaderRow(1,!1)}var pe=d.reduce(function(we,Oe){return we[Oe.name]=Oe.align,we},{});for(p=0;p<u.length;p+=1){"rowStart"in g&&g.rowStart instanceof Function&&g.rowStart({row:p,data:u[p]},this);var ge=o.call(this,u[p],z);for(v=0;v<E.length;v+=1){var ne=u[p][E[v]];"cellStart"in g&&g.cellStart instanceof Function&&g.cellStart({row:p,col:v,data:ne},this),i.call(this,new s(c,l,z[E[v]],ge,ne,p+2,pe[E[v]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=l,this};var o=function(c,l){var u=this.internal.__cell__.padding,d=this.internal.__cell__.table_font_size,g=this.internal.scaleFactor;return Object.keys(c).map(function(p){var y=c[p];return this.splitTextToSize(y.hasOwnProperty("text")?y.text:y,l[p]-u-u)},this).map(function(p){return this.getLineHeightFactor()*p.length*d/g+u+u},this).reduce(function(p,y){return Math.max(p,y)},0)};r.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},r.printHeaderRow=function(c,l){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(t=!0,typeof this.internal.__cell__.headerFunction=="function"){var d=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(d[0],d[1],d[2],d[3],void 0,-1)}this.setFont(void 0,"bold");for(var g=[],p=0;p<this.internal.__cell__.tableHeaderRow.length;p+=1){u=this.internal.__cell__.tableHeaderRow[p].clone(),l&&(u.y=this.internal.__cell__.margins.top||0,g.push(u)),u.lineNumber=c;var y=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),i.call(this,u),this.setTextColor(y)}g.length>0&&this.setTableHeaderRow(g),this.setFont(void 0,"normal"),t=!1}}(jt.API);var Mb={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Bb=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Sp=Ob(Bb),Vb=[100,200,300,400,500,600,700,800,900],Yj=Ob(Vb);function Ap(r){var e=r.family.replace(/"|'/g,"").toLowerCase(),t=function(s){return Mb[s=s||"normal"]?s:"normal"}(r.style),n=function(s){if(!s)return 400;if(typeof s=="number")return s>=100&&s<=900&&s%100==0?s:400;if(/^\d00$/.test(s))return parseInt(s);switch(s){case"bold":return 700;case"normal":default:return 400}}(r.weight),a=function(s){return typeof Sp[s=s||"normal"]=="number"?s:"normal"}(r.stretch);return{family:e,style:t,weight:n,stretch:a,src:r.src||[],ref:r.ref||{name:e,style:[a,t,n].join(" ")}}}function vv(r,e,t,n){var a;for(a=t;a>=0&&a<e.length;a+=n)if(r[e[a]])return r[e[a]];for(a=t;a>=0&&a<e.length;a-=n)if(r[e[a]])return r[e[a]]}var Jj={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},yv={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function wv(r){return[r.stretch,r.style,r.weight,r.family].join(" ")}function Qj(r,e,t){for(var n=(t=t||{}).defaultFontFamily||"times",a=Object.assign({},Jj,t.genericFontFamilies||{}),s=null,i=null,o=0;o<e.length;++o)if(a[(s=Ap(e[o])).family]&&(s.family=a[s.family]),r.hasOwnProperty(s.family)){i=r[s.family];break}if(!(i=i||r[n]))throw new Error("Could not find a font-family for the rule '"+wv(s)+"' and default family '"+n+"'.");if(i=function(c,l){if(l[c])return l[c];var u=Sp[c],d=u<=Sp.normal?-1:1,g=vv(l,Bb,u,d);if(!g)throw new Error("Could not find a matching font-stretch value for "+c);return g}(s.stretch,i),i=function(c,l){if(l[c])return l[c];for(var u=Mb[c],d=0;d<u.length;++d)if(l[u[d]])return l[u[d]];throw new Error("Could not find a matching font-style for "+c)}(s.style,i),!(i=function(c,l){if(l[c])return l[c];if(c===400&&l[500])return l[500];if(c===500&&l[400])return l[400];var u=Yj[c],d=vv(l,Vb,u,c<400?-1:1);if(!d)throw new Error("Could not find a matching font-weight for value "+c);return d}(s.weight,i)))throw new Error("Failed to resolve a font for the rule '"+wv(s)+"'.");return i}function _v(r){return r.trimLeft()}function Zj(r,e){for(var t=0;t<r.length;){if(r.charAt(t)===e)return[r.substring(0,t),r.substring(t+1)];t+=1}return null}function e9(r){var e=r.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],r.substring(e[0].length)]}var ef,bv,Ev,Am=["times"];(function(r){var e,t,n,a,s,i,o,c,l,u=function(k){return k=k||{},this.isStrokeTransparent=k.isStrokeTransparent||!1,this.strokeOpacity=k.strokeOpacity||1,this.strokeStyle=k.strokeStyle||"#000000",this.fillStyle=k.fillStyle||"#000000",this.isFillTransparent=k.isFillTransparent||!1,this.fillOpacity=k.fillOpacity||1,this.font=k.font||"10px sans-serif",this.textBaseline=k.textBaseline||"alphabetic",this.textAlign=k.textAlign||"left",this.lineWidth=k.lineWidth||1,this.lineJoin=k.lineJoin||"miter",this.lineCap=k.lineCap||"butt",this.path=k.path||[],this.transform=k.transform!==void 0?k.transform.clone():new c,this.globalCompositeOperation=k.globalCompositeOperation||"normal",this.globalAlpha=k.globalAlpha||1,this.clip_path=k.clip_path||[],this.currentPoint=k.currentPoint||new i,this.miterLimit=k.miterLimit||10,this.lastPoint=k.lastPoint||new i,this.lineDashOffset=k.lineDashOffset||0,this.lineDash=k.lineDash||[],this.margin=k.margin||[0,0,0,0],this.prevPageLastElemOffset=k.prevPageLastElemOffset||0,this.ignoreClearRect=typeof k.ignoreClearRect!="boolean"||k.ignoreClearRect,this};r.events.push(["initialized",function(){this.context2d=new d(this),e=this.internal.f2,t=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,a=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,i=this.internal.Point,o=this.internal.Rectangle,c=this.internal.Matrix,l=new u}]);var d=function(k){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var O=k;Object.defineProperty(this,"pdf",{get:function(){return O}});var M=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return M},set:function(Fe){M=!!Fe}});var U=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return U},set:function(Fe){U=!!Fe}});var ee=0;Object.defineProperty(this,"posX",{get:function(){return ee},set:function(Fe){isNaN(Fe)||(ee=Fe)}});var he=0;Object.defineProperty(this,"posY",{get:function(){return he},set:function(Fe){isNaN(Fe)||(he=Fe)}}),Object.defineProperty(this,"margin",{get:function(){return l.margin},set:function(Fe){var se;typeof Fe=="number"?se=[Fe,Fe,Fe,Fe]:((se=new Array(4))[0]=Fe[0],se[1]=Fe.length>=2?Fe[1]:se[0],se[2]=Fe.length>=3?Fe[2]:se[0],se[3]=Fe.length>=4?Fe[3]:se[1]),l.margin=se}});var de=!1;Object.defineProperty(this,"autoPaging",{get:function(){return de},set:function(Fe){de=Fe}});var fe=0;Object.defineProperty(this,"lastBreak",{get:function(){return fe},set:function(Fe){fe=Fe}});var be=[];Object.defineProperty(this,"pageBreaks",{get:function(){return be},set:function(Fe){be=Fe}}),Object.defineProperty(this,"ctx",{get:function(){return l},set:function(Fe){Fe instanceof u&&(l=Fe)}}),Object.defineProperty(this,"path",{get:function(){return l.path},set:function(Fe){l.path=Fe}});var Me=[];Object.defineProperty(this,"ctxStack",{get:function(){return Me},set:function(Fe){Me=Fe}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Fe){var se;se=g(Fe),this.ctx.fillStyle=se.style,this.ctx.isFillTransparent=se.a===0,this.ctx.fillOpacity=se.a,this.pdf.setFillColor(se.r,se.g,se.b,{a:se.a}),this.pdf.setTextColor(se.r,se.g,se.b,{a:se.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Fe){var se=g(Fe);this.ctx.strokeStyle=se.style,this.ctx.isStrokeTransparent=se.a===0,this.ctx.strokeOpacity=se.a,se.a===0?this.pdf.setDrawColor(255,255,255):(se.a,this.pdf.setDrawColor(se.r,se.g,se.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Fe){["butt","round","square"].indexOf(Fe)!==-1&&(this.ctx.lineCap=Fe,this.pdf.setLineCap(Fe))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Fe){isNaN(Fe)||(this.ctx.lineWidth=Fe,this.pdf.setLineWidth(Fe))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Fe){["bevel","round","miter"].indexOf(Fe)!==-1&&(this.ctx.lineJoin=Fe,this.pdf.setLineJoin(Fe))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Fe){isNaN(Fe)||(this.ctx.miterLimit=Fe,this.pdf.setMiterLimit(Fe))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Fe){this.ctx.textBaseline=Fe}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Fe){["right","end","center","left","start"].indexOf(Fe)!==-1&&(this.ctx.textAlign=Fe)}});var Z=null;function Xe(Fe,se){if(Z===null){var qe=function(lt){var $e=[];return Object.keys(lt).forEach(function(rt){lt[rt].forEach(function(ot){var ht=null;switch(ot){case"bold":ht={family:rt,weight:"bold"};break;case"italic":ht={family:rt,style:"italic"};break;case"bolditalic":ht={family:rt,weight:"bold",style:"italic"};break;case"":case"normal":ht={family:rt}}ht!==null&&(ht.ref={name:rt,style:ot},$e.push(ht))})}),$e}(Fe.getFontList());Z=function(lt){for(var $e={},rt=0;rt<lt.length;++rt){var ot=Ap(lt[rt]),ht=ot.family,_t=ot.stretch,At=ot.style,Ft=ot.weight;$e[ht]=$e[ht]||{},$e[ht][_t]=$e[ht][_t]||{},$e[ht][_t][At]=$e[ht][_t][At]||{},$e[ht][_t][At][Ft]=ot}return $e}(qe.concat(se))}return Z}var st=null;Object.defineProperty(this,"fontFaces",{get:function(){return st},set:function(Fe){Z=null,st=Fe}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Fe){var se;if(this.ctx.font=Fe,(se=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Fe))!==null){var qe=se[1],lt=(se[2],se[3]),$e=se[4],rt=(se[5],se[6]),ot=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec($e)[2];$e=Math.floor(ot==="px"?parseFloat($e)*this.pdf.internal.scaleFactor:ot==="em"?parseFloat($e)*this.pdf.getFontSize():parseFloat($e)*this.pdf.internal.scaleFactor),this.pdf.setFontSize($e);var ht=function(Nt){var dt,tt,sr=[],Ct=Nt.trim();if(Ct==="")return Am;if(Ct in yv)return[yv[Ct]];for(;Ct!=="";){switch(tt=null,dt=(Ct=_v(Ct)).charAt(0)){case'"':case"'":tt=Zj(Ct.substring(1),dt);break;default:tt=e9(Ct)}if(tt===null||(sr.push(tt[0]),(Ct=_v(tt[1]))!==""&&Ct.charAt(0)!==","))return Am;Ct=Ct.replace(/^,/,"")}return sr}(rt);if(this.fontFaces){var _t=Qj(Xe(this.pdf,this.fontFaces),ht.map(function(Nt){return{family:Nt,stretch:"normal",weight:lt,style:qe}}));this.pdf.setFont(_t.ref.name,_t.ref.style)}else{var At="";(lt==="bold"||parseInt(lt,10)>=700||qe==="bold")&&(At="bold"),qe==="italic"&&(At+="italic"),At.length===0&&(At="normal");for(var Ft="",Et={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},It=0;It<ht.length;It++){if(this.pdf.internal.getFont(ht[It],At,{noFallback:!0,disableWarning:!0})!==void 0){Ft=ht[It];break}if(At==="bolditalic"&&this.pdf.internal.getFont(ht[It],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Ft=ht[It],At="bold";else if(this.pdf.internal.getFont(ht[It],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Ft=ht[It],At="normal";break}}if(Ft===""){for(var Vt=0;Vt<ht.length;Vt++)if(Et[ht[Vt]]){Ft=Et[ht[Vt]];break}}Ft=Ft===""?"Times":Ft,this.pdf.setFont(Ft,At)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Fe){this.ctx.globalCompositeOperation=Fe}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Fe){this.ctx.globalAlpha=Fe}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Fe){this.ctx.lineDashOffset=Fe,Oe.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Fe){this.ctx.lineDash=Fe,Oe.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Fe){this.ctx.ignoreClearRect=!!Fe}})};d.prototype.setLineDash=function(k){this.lineDash=k},d.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},d.prototype.fill=function(){q.call(this,"fill",!1)},d.prototype.stroke=function(){q.call(this,"stroke",!1)},d.prototype.beginPath=function(){this.path=[{type:"begin"}]},d.prototype.moveTo=function(k,O){if(isNaN(k)||isNaN(O))throw Br.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var M=this.ctx.transform.applyToPoint(new i(k,O));this.path.push({type:"mt",x:M.x,y:M.y}),this.ctx.lastPoint=new i(k,O)},d.prototype.closePath=function(){var k=new i(0,0),O=0;for(O=this.path.length-1;O!==-1;O--)if(this.path[O].type==="begin"&&kr(this.path[O+1])==="object"&&typeof this.path[O+1].x=="number"){k=new i(this.path[O+1].x,this.path[O+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new i(k.x,k.y)},d.prototype.lineTo=function(k,O){if(isNaN(k)||isNaN(O))throw Br.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var M=this.ctx.transform.applyToPoint(new i(k,O));this.path.push({type:"lt",x:M.x,y:M.y}),this.ctx.lastPoint=new i(M.x,M.y)},d.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),q.call(this,null,!0)},d.prototype.quadraticCurveTo=function(k,O,M,U){if(isNaN(M)||isNaN(U)||isNaN(k)||isNaN(O))throw Br.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var ee=this.ctx.transform.applyToPoint(new i(M,U)),he=this.ctx.transform.applyToPoint(new i(k,O));this.path.push({type:"qct",x1:he.x,y1:he.y,x:ee.x,y:ee.y}),this.ctx.lastPoint=new i(ee.x,ee.y)},d.prototype.bezierCurveTo=function(k,O,M,U,ee,he){if(isNaN(ee)||isNaN(he)||isNaN(k)||isNaN(O)||isNaN(M)||isNaN(U))throw Br.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var de=this.ctx.transform.applyToPoint(new i(ee,he)),fe=this.ctx.transform.applyToPoint(new i(k,O)),be=this.ctx.transform.applyToPoint(new i(M,U));this.path.push({type:"bct",x1:fe.x,y1:fe.y,x2:be.x,y2:be.y,x:de.x,y:de.y}),this.ctx.lastPoint=new i(de.x,de.y)},d.prototype.arc=function(k,O,M,U,ee,he){if(isNaN(k)||isNaN(O)||isNaN(M)||isNaN(U)||isNaN(ee))throw Br.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(he=!!he,!this.ctx.transform.isIdentity){var de=this.ctx.transform.applyToPoint(new i(k,O));k=de.x,O=de.y;var fe=this.ctx.transform.applyToPoint(new i(0,M)),be=this.ctx.transform.applyToPoint(new i(0,0));M=Math.sqrt(Math.pow(fe.x-be.x,2)+Math.pow(fe.y-be.y,2))}Math.abs(ee-U)>=2*Math.PI&&(U=0,ee=2*Math.PI),this.path.push({type:"arc",x:k,y:O,radius:M,startAngle:U,endAngle:ee,counterclockwise:he})},d.prototype.arcTo=function(k,O,M,U,ee){throw new Error("arcTo not implemented.")},d.prototype.rect=function(k,O,M,U){if(isNaN(k)||isNaN(O)||isNaN(M)||isNaN(U))throw Br.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(k,O),this.lineTo(k+M,O),this.lineTo(k+M,O+U),this.lineTo(k,O+U),this.lineTo(k,O),this.lineTo(k+M,O),this.lineTo(k,O)},d.prototype.fillRect=function(k,O,M,U){if(isNaN(k)||isNaN(O)||isNaN(M)||isNaN(U))throw Br.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!p.call(this)){var ee={};this.lineCap!=="butt"&&(ee.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(ee.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(k,O,M,U),this.fill(),ee.hasOwnProperty("lineCap")&&(this.lineCap=ee.lineCap),ee.hasOwnProperty("lineJoin")&&(this.lineJoin=ee.lineJoin)}},d.prototype.strokeRect=function(k,O,M,U){if(isNaN(k)||isNaN(O)||isNaN(M)||isNaN(U))throw Br.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");y.call(this)||(this.beginPath(),this.rect(k,O,M,U),this.stroke())},d.prototype.clearRect=function(k,O,M,U){if(isNaN(k)||isNaN(O)||isNaN(M)||isNaN(U))throw Br.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(k,O,M,U))},d.prototype.save=function(k){k=typeof k!="boolean"||k;for(var O=this.pdf.internal.getCurrentPageInfo().pageNumber,M=0;M<this.pdf.internal.getNumberOfPages();M++)this.pdf.setPage(M+1),this.pdf.internal.out("q");if(this.pdf.setPage(O),k){this.ctx.fontSize=this.pdf.internal.getFontSize();var U=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=U}},d.prototype.restore=function(k){k=typeof k!="boolean"||k;for(var O=this.pdf.internal.getCurrentPageInfo().pageNumber,M=0;M<this.pdf.internal.getNumberOfPages();M++)this.pdf.setPage(M+1),this.pdf.internal.out("Q");this.pdf.setPage(O),k&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},d.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var g=function(k){var O,M,U,ee;if(k.isCanvasGradient===!0&&(k=k.getColor()),!k)return{r:0,g:0,b:0,a:0,style:k};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(k))O=0,M=0,U=0,ee=0;else{var he=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(k);if(he!==null)O=parseInt(he[1]),M=parseInt(he[2]),U=parseInt(he[3]),ee=1;else if((he=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(k))!==null)O=parseInt(he[1]),M=parseInt(he[2]),U=parseInt(he[3]),ee=parseFloat(he[4]);else{if(ee=1,typeof k=="string"&&k.charAt(0)!=="#"){var de=new Pb(k);k=de.ok?de.toHex():"#000000"}k.length===4?(O=k.substring(1,2),O+=O,M=k.substring(2,3),M+=M,U=k.substring(3,4),U+=U):(O=k.substring(1,3),M=k.substring(3,5),U=k.substring(5,7)),O=parseInt(O,16),M=parseInt(M,16),U=parseInt(U,16)}}return{r:O,g:M,b:U,a:ee,style:k}},p=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},y=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};d.prototype.fillText=function(k,O,M,U){if(isNaN(O)||isNaN(M)||typeof k!="string")throw Br.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(U=isNaN(U)?void 0:U,!p.call(this)){var ee=ge(this.ctx.transform.rotation),he=this.ctx.transform.scaleX;A.call(this,{text:k,x:O,y:M,scale:he,angle:ee,align:this.textAlign,maxWidth:U})}},d.prototype.strokeText=function(k,O,M,U){if(isNaN(O)||isNaN(M)||typeof k!="string")throw Br.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!y.call(this)){U=isNaN(U)?void 0:U;var ee=ge(this.ctx.transform.rotation),he=this.ctx.transform.scaleX;A.call(this,{text:k,x:O,y:M,scale:he,renderingMode:"stroke",angle:ee,align:this.textAlign,maxWidth:U})}},d.prototype.measureText=function(k){if(typeof k!="string")throw Br.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var O=this.pdf,M=this.pdf.internal.scaleFactor,U=O.internal.getFontSize(),ee=O.getStringUnitWidth(k)*U/O.internal.scaleFactor,he=function(de){var fe=(de=de||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return fe}}),this};return new he({width:ee*=Math.round(96*M/72*1e4)/1e4})},d.prototype.scale=function(k,O){if(isNaN(k)||isNaN(O))throw Br.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var M=new c(k,0,0,O,0,0);this.ctx.transform=this.ctx.transform.multiply(M)},d.prototype.rotate=function(k){if(isNaN(k))throw Br.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var O=new c(Math.cos(k),Math.sin(k),-Math.sin(k),Math.cos(k),0,0);this.ctx.transform=this.ctx.transform.multiply(O)},d.prototype.translate=function(k,O){if(isNaN(k)||isNaN(O))throw Br.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var M=new c(1,0,0,1,k,O);this.ctx.transform=this.ctx.transform.multiply(M)},d.prototype.transform=function(k,O,M,U,ee,he){if(isNaN(k)||isNaN(O)||isNaN(M)||isNaN(U)||isNaN(ee)||isNaN(he))throw Br.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var de=new c(k,O,M,U,ee,he);this.ctx.transform=this.ctx.transform.multiply(de)},d.prototype.setTransform=function(k,O,M,U,ee,he){k=isNaN(k)?1:k,O=isNaN(O)?0:O,M=isNaN(M)?0:M,U=isNaN(U)?1:U,ee=isNaN(ee)?0:ee,he=isNaN(he)?0:he,this.ctx.transform=new c(k,O,M,U,ee,he)};var v=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};d.prototype.drawImage=function(k,O,M,U,ee,he,de,fe,be){var Me=this.pdf.getImageProperties(k),Z=1,Xe=1,st=1,Fe=1;U!==void 0&&fe!==void 0&&(st=fe/U,Fe=be/ee,Z=Me.width/U*fe/U,Xe=Me.height/ee*be/ee),he===void 0&&(he=O,de=M,O=0,M=0),U!==void 0&&fe===void 0&&(fe=U,be=ee),U===void 0&&fe===void 0&&(fe=Me.width,be=Me.height);for(var se,qe=this.ctx.transform.decompose(),lt=ge(qe.rotate.shx),$e=new c,rt=($e=($e=($e=$e.multiply(qe.translate)).multiply(qe.skew)).multiply(qe.scale)).applyToRectangle(new o(he-O*st,de-M*Fe,U*Z,ee*Xe)),ot=w.call(this,rt),ht=[],_t=0;_t<ot.length;_t+=1)ht.indexOf(ot[_t])===-1&&ht.push(ot[_t]);if(P(ht),this.autoPaging)for(var At=ht[0],Ft=ht[ht.length-1],Et=At;Et<Ft+1;Et++){this.pdf.setPage(Et);var It=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Vt=Et===1?this.posY+this.margin[0]:this.margin[0],Nt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],dt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],tt=Et===1?0:Nt+(Et-2)*dt;if(this.ctx.clip_path.length!==0){var sr=this.path;se=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=R(se,this.posX+this.margin[3],-tt+Vt+this.ctx.prevPageLastElemOffset),z.call(this,"fill",!0),this.path=sr}var Ct=JSON.parse(JSON.stringify(rt));Ct=R([Ct],this.posX+this.margin[3],-tt+Vt+this.ctx.prevPageLastElemOffset)[0];var rn=(Et>At||Et<Ft)&&v.call(this);rn&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],It,dt,null).clip().discardPath()),this.pdf.addImage(k,"JPEG",Ct.x,Ct.y,Ct.w,Ct.h,null,null,lt),rn&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(k,"JPEG",rt.x,rt.y,rt.w,rt.h,null,null,lt)};var w=function(k,O,M){var U=[];O=O||this.pdf.internal.pageSize.width,M=M||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var ee=this.posY+this.ctx.prevPageLastElemOffset;switch(k.type){default:case"mt":case"lt":U.push(Math.floor((k.y+ee)/M)+1);break;case"arc":U.push(Math.floor((k.y+ee-k.radius)/M)+1),U.push(Math.floor((k.y+ee+k.radius)/M)+1);break;case"qct":var he=ne(this.ctx.lastPoint.x,this.ctx.lastPoint.y,k.x1,k.y1,k.x,k.y);U.push(Math.floor((he.y+ee)/M)+1),U.push(Math.floor((he.y+he.h+ee)/M)+1);break;case"bct":var de=we(this.ctx.lastPoint.x,this.ctx.lastPoint.y,k.x1,k.y1,k.x2,k.y2,k.x,k.y);U.push(Math.floor((de.y+ee)/M)+1),U.push(Math.floor((de.y+de.h+ee)/M)+1);break;case"rect":U.push(Math.floor((k.y+ee)/M)+1),U.push(Math.floor((k.y+k.h+ee)/M)+1)}for(var fe=0;fe<U.length;fe+=1)for(;this.pdf.internal.getNumberOfPages()<U[fe];)E.call(this);return U},E=function(){var k=this.fillStyle,O=this.strokeStyle,M=this.font,U=this.lineCap,ee=this.lineWidth,he=this.lineJoin;this.pdf.addPage(),this.fillStyle=k,this.strokeStyle=O,this.font=M,this.lineCap=U,this.lineWidth=ee,this.lineJoin=he},R=function(k,O,M){for(var U=0;U<k.length;U++)switch(k[U].type){case"bct":k[U].x2+=O,k[U].y2+=M;case"qct":k[U].x1+=O,k[U].y1+=M;case"mt":case"lt":case"arc":default:k[U].x+=O,k[U].y+=M}return k},P=function(k){return k.sort(function(O,M){return O-M})},q=function(k,O){for(var M,U,ee=this.fillStyle,he=this.strokeStyle,de=this.lineCap,fe=this.lineWidth,be=Math.abs(fe*this.ctx.transform.scaleX),Me=this.lineJoin,Z=JSON.parse(JSON.stringify(this.path)),Xe=JSON.parse(JSON.stringify(this.path)),st=[],Fe=0;Fe<Xe.length;Fe++)if(Xe[Fe].x!==void 0)for(var se=w.call(this,Xe[Fe]),qe=0;qe<se.length;qe+=1)st.indexOf(se[qe])===-1&&st.push(se[qe]);for(var lt=0;lt<st.length;lt++)for(;this.pdf.internal.getNumberOfPages()<st[lt];)E.call(this);if(P(st),this.autoPaging)for(var $e=st[0],rt=st[st.length-1],ot=$e;ot<rt+1;ot++){this.pdf.setPage(ot),this.fillStyle=ee,this.strokeStyle=he,this.lineCap=de,this.lineWidth=be,this.lineJoin=Me;var ht=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],_t=ot===1?this.posY+this.margin[0]:this.margin[0],At=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ft=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Et=ot===1?0:At+(ot-2)*Ft;if(this.ctx.clip_path.length!==0){var It=this.path;M=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=R(M,this.posX+this.margin[3],-Et+_t+this.ctx.prevPageLastElemOffset),z.call(this,k,!0),this.path=It}if(U=JSON.parse(JSON.stringify(Z)),this.path=R(U,this.posX+this.margin[3],-Et+_t+this.ctx.prevPageLastElemOffset),O===!1||ot===0){var Vt=(ot>$e||ot<rt)&&v.call(this);Vt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ht,Ft,null).clip().discardPath()),z.call(this,k,O),Vt&&this.pdf.restoreGraphicsState()}this.lineWidth=fe}else this.lineWidth=be,z.call(this,k,O),this.lineWidth=fe;this.path=Z},z=function(k,O){if((k!=="stroke"||O||!y.call(this))&&(k==="stroke"||O||!p.call(this))){for(var M,U,ee=[],he=this.path,de=0;de<he.length;de++){var fe=he[de];switch(fe.type){case"begin":ee.push({begin:!0});break;case"close":ee.push({close:!0});break;case"mt":ee.push({start:fe,deltas:[],abs:[]});break;case"lt":var be=ee.length;if(he[de-1]&&!isNaN(he[de-1].x)&&(M=[fe.x-he[de-1].x,fe.y-he[de-1].y],be>0)){for(;be>=0;be--)if(ee[be-1].close!==!0&&ee[be-1].begin!==!0){ee[be-1].deltas.push(M),ee[be-1].abs.push(fe);break}}break;case"bct":M=[fe.x1-he[de-1].x,fe.y1-he[de-1].y,fe.x2-he[de-1].x,fe.y2-he[de-1].y,fe.x-he[de-1].x,fe.y-he[de-1].y],ee[ee.length-1].deltas.push(M);break;case"qct":var Me=he[de-1].x+2/3*(fe.x1-he[de-1].x),Z=he[de-1].y+2/3*(fe.y1-he[de-1].y),Xe=fe.x+2/3*(fe.x1-fe.x),st=fe.y+2/3*(fe.y1-fe.y),Fe=fe.x,se=fe.y;M=[Me-he[de-1].x,Z-he[de-1].y,Xe-he[de-1].x,st-he[de-1].y,Fe-he[de-1].x,se-he[de-1].y],ee[ee.length-1].deltas.push(M);break;case"arc":ee.push({deltas:[],abs:[],arc:!0}),Array.isArray(ee[ee.length-1].abs)&&ee[ee.length-1].abs.push(fe)}}U=O?null:k==="stroke"?"stroke":"fill";for(var qe=!1,lt=0;lt<ee.length;lt++)if(ee[lt].arc)for(var $e=ee[lt].abs,rt=0;rt<$e.length;rt++){var ot=$e[rt];ot.type==="arc"?N.call(this,ot.x,ot.y,ot.radius,ot.startAngle,ot.endAngle,ot.counterclockwise,void 0,O,!qe):C.call(this,ot.x,ot.y),qe=!0}else if(ee[lt].close===!0)this.pdf.internal.out("h"),qe=!1;else if(ee[lt].begin!==!0){var ht=ee[lt].start.x,_t=ee[lt].start.y;J.call(this,ee[lt].deltas,ht,_t),qe=!0}U&&F.call(this,U),O&&j.call(this)}},K=function(k){var O=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,M=O*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return k-M;case"top":return k+O-M;case"hanging":return k+O-2*M;case"middle":return k+O/2-M;case"ideographic":return k;case"alphabetic":default:return k}},I=function(k){return k+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};d.prototype.createLinearGradient=function(){var k=function(){};return k.colorStops=[],k.addColorStop=function(O,M){this.colorStops.push([O,M])},k.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},k.isCanvasGradient=!0,k},d.prototype.createPattern=function(){return this.createLinearGradient()},d.prototype.createRadialGradient=function(){return this.createLinearGradient()};var N=function(k,O,M,U,ee,he,de,fe,be){for(var Me=me.call(this,M,U,ee,he),Z=0;Z<Me.length;Z++){var Xe=Me[Z];Z===0&&(be?S.call(this,Xe.x1+k,Xe.y1+O):C.call(this,Xe.x1+k,Xe.y1+O)),ue.call(this,k,O,Xe.x2,Xe.y2,Xe.x3,Xe.y3,Xe.x4,Xe.y4)}fe?j.call(this):F.call(this,de)},F=function(k){switch(k){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},j=function(){this.pdf.clip(),this.pdf.discardPath()},S=function(k,O){this.pdf.internal.out(t(k)+" "+n(O)+" m")},A=function(k){var O;switch(k.align){case"right":case"end":O="right";break;case"center":O="center";break;case"left":case"start":default:O="left"}var M=this.pdf.getTextDimensions(k.text),U=K.call(this,k.y),ee=I.call(this,U)-M.h,he=this.ctx.transform.applyToPoint(new i(k.x,U)),de=this.ctx.transform.decompose(),fe=new c;fe=(fe=(fe=fe.multiply(de.translate)).multiply(de.skew)).multiply(de.scale);for(var be,Me,Z,Xe=this.ctx.transform.applyToRectangle(new o(k.x,U,M.w,M.h)),st=fe.applyToRectangle(new o(k.x,ee,M.w,M.h)),Fe=w.call(this,st),se=[],qe=0;qe<Fe.length;qe+=1)se.indexOf(Fe[qe])===-1&&se.push(Fe[qe]);if(P(se),this.autoPaging)for(var lt=se[0],$e=se[se.length-1],rt=lt;rt<$e+1;rt++){this.pdf.setPage(rt);var ot=rt===1?this.posY+this.margin[0]:this.margin[0],ht=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],_t=this.pdf.internal.pageSize.height-this.margin[2],At=_t-this.margin[0],Ft=this.pdf.internal.pageSize.width-this.margin[1],Et=Ft-this.margin[3],It=rt===1?0:ht+(rt-2)*At;if(this.ctx.clip_path.length!==0){var Vt=this.path;be=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=R(be,this.posX+this.margin[3],-1*It+ot),z.call(this,"fill",!0),this.path=Vt}var Nt=R([JSON.parse(JSON.stringify(st))],this.posX+this.margin[3],-It+ot+this.ctx.prevPageLastElemOffset)[0];k.scale>=.01&&(Me=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Me*k.scale),Z=this.lineWidth,this.lineWidth=Z*k.scale);var dt=this.autoPaging!=="text";if(dt||Nt.y+Nt.h<=_t){if(dt||Nt.y>=ot&&Nt.x<=Ft){var tt=dt?k.text:this.pdf.splitTextToSize(k.text,k.maxWidth||Ft-Nt.x)[0],sr=R([JSON.parse(JSON.stringify(Xe))],this.posX+this.margin[3],-It+ot+this.ctx.prevPageLastElemOffset)[0],Ct=dt&&(rt>lt||rt<$e)&&v.call(this);Ct&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Et,At,null).clip().discardPath()),this.pdf.text(tt,sr.x,sr.y,{angle:k.angle,align:O,renderingMode:k.renderingMode}),Ct&&this.pdf.restoreGraphicsState()}}else Nt.y<_t&&(this.ctx.prevPageLastElemOffset+=_t-Nt.y);k.scale>=.01&&(this.pdf.setFontSize(Me),this.lineWidth=Z)}else k.scale>=.01&&(Me=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Me*k.scale),Z=this.lineWidth,this.lineWidth=Z*k.scale),this.pdf.text(k.text,he.x+this.posX,he.y+this.posY,{angle:k.angle,align:O,renderingMode:k.renderingMode,maxWidth:k.maxWidth}),k.scale>=.01&&(this.pdf.setFontSize(Me),this.lineWidth=Z)},C=function(k,O,M,U){M=M||0,U=U||0,this.pdf.internal.out(t(k+M)+" "+n(O+U)+" l")},J=function(k,O,M){return this.pdf.lines(k,O,M,null,null)},ue=function(k,O,M,U,ee,he,de,fe){this.pdf.internal.out([e(a(M+k)),e(s(U+O)),e(a(ee+k)),e(s(he+O)),e(a(de+k)),e(s(fe+O)),"c"].join(" "))},me=function(k,O,M,U){for(var ee=2*Math.PI,he=Math.PI/2;O>M;)O-=ee;var de=Math.abs(M-O);de<ee&&U&&(de=ee-de);for(var fe=[],be=U?-1:1,Me=O;de>1e-5;){var Z=Me+be*Math.min(de,he);fe.push(pe.call(this,k,Me,Z)),de-=Math.abs(Z-Me),Me=Z}return fe},pe=function(k,O,M){var U=(M-O)/2,ee=k*Math.cos(U),he=k*Math.sin(U),de=ee,fe=-he,be=de*de+fe*fe,Me=be+de*ee+fe*he,Z=4/3*(Math.sqrt(2*be*Me)-Me)/(de*he-fe*ee),Xe=de-Z*fe,st=fe+Z*de,Fe=Xe,se=-st,qe=U+O,lt=Math.cos(qe),$e=Math.sin(qe);return{x1:k*Math.cos(O),y1:k*Math.sin(O),x2:Xe*lt-st*$e,y2:Xe*$e+st*lt,x3:Fe*lt-se*$e,y3:Fe*$e+se*lt,x4:k*Math.cos(M),y4:k*Math.sin(M)}},ge=function(k){return 180*k/Math.PI},ne=function(k,O,M,U,ee,he){var de=k+.5*(M-k),fe=O+.5*(U-O),be=ee+.5*(M-ee),Me=he+.5*(U-he),Z=Math.min(k,ee,de,be),Xe=Math.max(k,ee,de,be),st=Math.min(O,he,fe,Me),Fe=Math.max(O,he,fe,Me);return new o(Z,st,Xe-Z,Fe-st)},we=function(k,O,M,U,ee,he,de,fe){var be,Me,Z,Xe,st,Fe,se,qe,lt,$e,rt,ot,ht,_t,At=M-k,Ft=U-O,Et=ee-M,It=he-U,Vt=de-ee,Nt=fe-he;for(Me=0;Me<41;Me++)lt=(se=(Z=k+(be=Me/40)*At)+be*((st=M+be*Et)-Z))+be*(st+be*(ee+be*Vt-st)-se),$e=(qe=(Xe=O+be*Ft)+be*((Fe=U+be*It)-Xe))+be*(Fe+be*(he+be*Nt-Fe)-qe),Me==0?(rt=lt,ot=$e,ht=lt,_t=$e):(rt=Math.min(rt,lt),ot=Math.min(ot,$e),ht=Math.max(ht,lt),_t=Math.max(_t,$e));return new o(Math.round(rt),Math.round(ot),Math.round(ht-rt),Math.round(_t-ot))},Oe=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var k,O,M=(k=this.ctx.lineDash,O=this.ctx.lineDashOffset,JSON.stringify({lineDash:k,lineDashOffset:O}));this.prevLineDash!==M&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=M)}}})(jt.API),function(r){var e=function(s){var i,o,c,l,u,d,g,p,y,v;for(o=[],c=0,l=(s+=i="\0\0\0\0".slice(s.length%4||4)).length;l>c;c+=4)(u=(s.charCodeAt(c)<<24)+(s.charCodeAt(c+1)<<16)+(s.charCodeAt(c+2)<<8)+s.charCodeAt(c+3))!==0?(d=(u=((u=((u=((u=(u-(v=u%85))/85)-(y=u%85))/85)-(p=u%85))/85)-(g=u%85))/85)%85,o.push(d+33,g+33,p+33,y+33,v+33)):o.push(122);return function(w,E){for(var R=E;R>0;R--)w.pop()}(o,i.length),String.fromCharCode.apply(String,o)+"~>"},t=function(s){var i,o,c,l,u,d=String,g="length",p=255,y="charCodeAt",v="slice",w="replace";for(s[v](-2),s=s[v](0,-2)[w](/\s/g,"")[w]("z","!!!!!"),c=[],l=0,u=(s+=i="uuuuu"[v](s[g]%5||5))[g];u>l;l+=5)o=52200625*(s[y](l)-33)+614125*(s[y](l+1)-33)+7225*(s[y](l+2)-33)+85*(s[y](l+3)-33)+(s[y](l+4)-33),c.push(p&o>>24,p&o>>16,p&o>>8,p&o);return function(E,R){for(var P=R;P>0;P--)E.pop()}(c,i[g]),d.fromCharCode.apply(d,c)},n=function(s){var i=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((s=s.replace(/\s/g,"")).indexOf(">")!==-1&&(s=s.substr(0,s.indexOf(">"))),s.length%2&&(s+="0"),i.test(s)===!1)return"";for(var o="",c=0;c<s.length;c+=2)o+=String.fromCharCode("0x"+(s[c]+s[c+1]));return o},a=function(s){for(var i=new Uint8Array(s.length),o=s.length;o--;)i[o]=s.charCodeAt(o);return s=(i=yp(i)).reduce(function(c,l){return c+String.fromCharCode(l)},"")};r.processDataByFilters=function(s,i){var o=0,c=s||"",l=[];for(typeof(i=i||[])=="string"&&(i=[i]),o=0;o<i.length;o+=1)switch(i[o]){case"ASCII85Decode":case"/ASCII85Decode":c=t(c),l.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=e(c),l.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=n(c),l.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=c.split("").map(function(u){return("0"+u.charCodeAt().toString(16)).slice(-2)}).join("")+">",l.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=a(c),l.push("/FlateDecode");break;default:throw new Error('The filter: "'+i[o]+'" is not implemented')}return{data:c,reverseChain:l.reverse().join(" ")}}}(jt.API),function(r){r.loadFile=function(e,t,n){return function(a,s,i){s=s!==!1,i=typeof i=="function"?i:function(){};var o=void 0;try{o=function(c,l,u){var d=new XMLHttpRequest,g=0,p=function(y){var v=y.length,w=[],E=String.fromCharCode;for(g=0;g<v;g+=1)w.push(E(255&y.charCodeAt(g)));return w.join("")};if(d.open("GET",c,!l),d.overrideMimeType("text/plain; charset=x-user-defined"),l===!1&&(d.onload=function(){d.status===200?u(p(this.responseText)):u(void 0)}),d.send(null),l&&d.status===200)return p(d.responseText)}(a,s,i)}catch{}return o}(e,t,n)},r.loadImageFile=r.loadFile}(jt.API),function(r){function e(){return(Ut.html2canvas?Promise.resolve(Ut.html2canvas):mp(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(i){return Promise.reject(new Error("Could not load html2canvas: "+i))}).then(function(i){return i.default?i.default:i})}function t(){return(Ut.DOMPurify?Promise.resolve(Ut.DOMPurify):mp(()=>import("./purify.es-C_uT9hQ1.js"),[])).catch(function(i){return Promise.reject(new Error("Could not load dompurify: "+i))}).then(function(i){return i.default?i.default:i})}var n=function(i){var o=kr(i);return o==="undefined"?"undefined":o==="string"||i instanceof String?"string":o==="number"||i instanceof Number?"number":o==="function"||i instanceof Function?"function":i&&i.constructor===Array?"array":i&&i.nodeType===1?"element":o==="object"?"object":"unknown"},a=function(i,o){var c=document.createElement(i);for(var l in o.className&&(c.className=o.className),o.innerHTML&&o.dompurify&&(c.innerHTML=o.dompurify.sanitize(o.innerHTML)),o.style)c.style[l]=o.style[l];return c},s=function i(o){var c=Object.assign(i.convert(Promise.resolve()),JSON.parse(JSON.stringify(i.template))),l=i.convert(Promise.resolve(),c);return l=(l=l.setProgress(1,i,1,[i])).set(o)};(s.prototype=Object.create(Promise.prototype)).constructor=s,s.convert=function(i,o){return i.__proto__=o||s.prototype,i},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},s.prototype.from=function(i,o){return this.then(function(){switch(o=o||function(c){switch(n(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(i)){case"string":return this.then(t).then(function(c){return this.set({src:a("div",{innerHTML:i,dompurify:c})})});case"element":return this.set({src:i});case"canvas":return this.set({canvas:i});case"img":return this.set({img:i});default:return this.error("Unknown source type.")}})},s.prototype.to=function(i){switch(i){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var i={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},o=function c(l,u){for(var d=l.nodeType===3?document.createTextNode(l.nodeValue):l.cloneNode(!1),g=l.firstChild;g;g=g.nextSibling)u!==!0&&g.nodeType===1&&g.nodeName==="SCRIPT"||d.appendChild(c(g,u));return l.nodeType===1&&(l.nodeName==="CANVAS"?(d.width=l.width,d.height=l.height,d.getContext("2d").drawImage(l,0,0)):l.nodeName!=="TEXTAREA"&&l.nodeName!=="SELECT"||(d.value=l.value),d.addEventListener("load",function(){d.scrollTop=l.scrollTop,d.scrollLeft=l.scrollLeft},!0)),d}(this.prop.src,this.opt.html2canvas.javascriptEnabled);o.tagName==="BODY"&&(i.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=a("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=a("div",{className:"html2pdf__container",style:i}),this.prop.container.appendChild(o),this.prop.container.firstChild.appendChild(a("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},s.prototype.toCanvas=function(){var i=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(i).then(e).then(function(o){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,o(this.prop.container,c)}).then(function(o){(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},s.prototype.toContext2d=function(){var i=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(i).then(e).then(function(o){var c=this.opt.jsPDF,l=this.opt.fontFaces,u=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,d=Object.assign({async:!0,allowTaint:!0,scale:u,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete d.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=l,l)for(var g=0;g<l.length;++g){var p=l[g],y=p.src.find(function(v){return v.format==="truetype"});y&&c.addFont(y.url,p.ref.name,p.ref.style)}return d.windowHeight=d.windowHeight||0,d.windowHeight=d.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):d.windowHeight,c.context2d.save(!0),o(this.prop.container,d)}).then(function(o){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},s.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var i=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=i})},s.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},s.prototype.output=function(i,o,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(i,o):this.outputPdf(i,o)},s.prototype.outputPdf=function(i,o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(i,o)})},s.prototype.outputImg=function(i){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(i){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+i+'" is not supported.'}})},s.prototype.save=function(i){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(i?{filename:i}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},s.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},s.prototype.set=function(i){if(n(i)!=="object")return this;var o=Object.keys(i||{}).map(function(c){if(c in s.template.prop)return function(){this.prop[c]=i[c]};switch(c){case"margin":return this.setMargin.bind(this,i.margin);case"jsPDF":return function(){return this.opt.jsPDF=i.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,i.pageSize);default:return function(){this.opt[c]=i[c]}}},this);return this.then(function(){return this.thenList(o)})},s.prototype.get=function(i,o){return this.then(function(){var c=i in s.template.prop?this.prop[i]:this.opt[i];return o?o(c):c})},s.prototype.setMargin=function(i){return this.then(function(){switch(n(i)){case"number":i=[i,i,i,i];case"array":if(i.length===2&&(i=[i[0],i[1],i[0],i[1]]),i.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=i}).then(this.setPageSize)},s.prototype.setPageSize=function(i){function o(c,l){return Math.floor(c*l/72*96)}return this.then(function(){(i=i||jt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(i.inner={width:i.width-this.opt.margin[1]-this.opt.margin[3],height:i.height-this.opt.margin[0]-this.opt.margin[2]},i.inner.px={width:o(i.inner.width,i.k),height:o(i.inner.height,i.k)},i.inner.ratio=i.inner.height/i.inner.width),this.prop.pageSize=i})},s.prototype.setProgress=function(i,o,c,l){return i!=null&&(this.progress.val=i),o!=null&&(this.progress.state=o),c!=null&&(this.progress.n=c),l!=null&&(this.progress.stack=l),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(i,o,c,l){return this.setProgress(i?this.progress.val+i:null,o||null,c?this.progress.n+c:null,l?this.progress.stack.concat(l):null)},s.prototype.then=function(i,o){var c=this;return this.thenCore(i,o,function(l,u){return c.updateProgress(null,null,1,[l]),Promise.prototype.then.call(this,function(d){return c.updateProgress(null,l),d}).then(l,u).then(function(d){return c.updateProgress(1),d})})},s.prototype.thenCore=function(i,o,c){c=c||Promise.prototype.then,i&&(i=i.bind(this)),o&&(o=o.bind(this));var l=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:s.convert(Object.assign({},this),Promise.prototype),u=c.call(l,i,o);return s.convert(u,this.__proto__)},s.prototype.thenExternal=function(i,o){return Promise.prototype.then.call(this,i,o)},s.prototype.thenList=function(i){var o=this;return i.forEach(function(c){o=o.thenCore(c)}),o},s.prototype.catch=function(i){i&&(i=i.bind(this));var o=Promise.prototype.catch.call(this,i);return s.convert(o,this)},s.prototype.catchExternal=function(i){return Promise.prototype.catch.call(this,i)},s.prototype.error=function(i){return this.then(function(){throw new Error(i)})},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,jt.getPageSize=function(i,o,c){if(kr(i)==="object"){var l=i;i=l.orientation,o=l.unit||o,c=l.format||c}o=o||"mm",c=c||"a4",i=(""+(i||"P")).toLowerCase();var u,d=(""+c).toLowerCase(),g={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(o){case"pt":u=1;break;case"mm":u=72/25.4;break;case"cm":u=72/2.54;break;case"in":u=72;break;case"px":u=.75;break;case"pc":case"em":u=12;break;case"ex":u=6;break;default:throw"Invalid unit: "+o}var p,y=0,v=0;if(g.hasOwnProperty(d))y=g[d][1]/u,v=g[d][0]/u;else try{y=c[1],v=c[0]}catch{throw new Error("Invalid format: "+c)}if(i==="p"||i==="portrait")i="p",v>y&&(p=v,v=y,y=p);else{if(i!=="l"&&i!=="landscape")throw"Invalid orientation: "+i;i="l",y>v&&(p=v,v=y,y=p)}return{width:v,height:y,unit:o,k:u,orientation:i}},r.html=function(i,o){(o=o||{}).callback=o.callback||function(){},o.html2canvas=o.html2canvas||{},o.html2canvas.canvas=o.html2canvas.canvas||this.canvas,o.jsPDF=o.jsPDF||this,o.fontFaces=o.fontFaces?o.fontFaces.map(Ap):null;var c=new s(o);return o.worker?c:c.from(i).doCallback()}}(jt.API),jt.API.addJS=function(r){return Ev=r,this.internal.events.subscribe("postPutResources",function(){ef=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(ef+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),bv=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Ev+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){ef!==void 0&&bv!==void 0&&this.internal.out("/Names <</JavaScript "+ef+" 0 R>>")}),this},function(r){var e;r.events.push(["postPutResources",function(){var t=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var a=t.outline.render().split(/\r\n/),s=0;s<a.length;s++){var i=a[s],o=n.exec(i);if(o!=null){var c=o[1];t.internal.newObjectDeferredBegin(c,!1)}t.internal.write(i)}if(this.outline.createNamedDestinations){var l=this.internal.pages.length,u=[];for(s=0;s<l;s++){var d=t.internal.newObject();u.push(d);var g=t.internal.getPageInfo(s+1);t.internal.write("<< /D["+g.objId+" 0 R /XYZ null null null]>> endobj")}var p=t.internal.newObject();for(t.internal.write("<< /Names [ "),s=0;s<u.length;s++)t.internal.write("(page_"+(s+1)+")"+u[s]+" 0 R");t.internal.write(" ] >>","endobj"),e=t.internal.newObject(),t.internal.write("<< /Dests "+p+" 0 R"),t.internal.write(">>","endobj")}}]),r.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+e+" 0 R"))}]),r.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(n,a,s){var i={title:a,options:s,children:[]};return n==null&&(n=this.root),n.children.push(i),i},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(n){n.id=t.internal.newObjectDeferred();for(var a=0;a<n.children.length;a++)this.genIds_r(n.children[a])},t.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},t.outline.renderItems=function(n){for(var a=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<n.children.length;s++){var i=n.children[s];this.objStart(i),this.line("/Title "+this.makeString(i.title)),this.line("/Parent "+this.makeRef(n)),s>0&&this.line("/Prev "+this.makeRef(n.children[s-1])),s<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[s+1])),i.children.length>0&&(this.line("/First "+this.makeRef(i.children[0])),this.line("/Last "+this.makeRef(i.children[i.children.length-1])));var o=this.count=this.count_r({count:0},i);if(o>0&&this.line("/Count "+o),i.options&&i.options.pageNumber){var c=t.internal.getPageInfo(i.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+a(0)+" 0]")}this.objEnd()}for(var l=0;l<n.children.length;l++)this.renderItems(n.children[l])},t.outline.line=function(n){this.ctx.val+=n+`\r
`},t.outline.makeRef=function(n){return n.id+" 0 R"},t.outline.makeString=function(n){return"("+t.internal.pdfEscape(n)+")"},t.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},t.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t.outline.count_r=function(n,a){for(var s=0;s<a.children.length;s++)n.count++,this.count_r(n,a.children[s]);return n.count}}])}(jt.API),function(r){var e=[192,193,194,195,196,197,198,199];r.processJPEG=function(t,n,a,s,i,o){var c,l=this.decode.DCT_DECODE,u=null;if(typeof t=="string"||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=i||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,(c=function(d){for(var g,p=256*d.charCodeAt(4)+d.charCodeAt(5),y=d.length,v={width:0,height:0,numcomponents:1},w=4;w<y;w+=2){if(w+=p,e.indexOf(d.charCodeAt(w+1))!==-1){g=256*d.charCodeAt(w+5)+d.charCodeAt(w+6),v={width:256*d.charCodeAt(w+7)+d.charCodeAt(w+8),height:g,numcomponents:d.charCodeAt(w+9)};break}p=256*d.charCodeAt(w+2)+d.charCodeAt(w+3)}return v}(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t)).numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}u={data:t,width:c.width,height:c.height,colorSpace:o,bitsPerComponent:8,filter:l,index:n,alias:a}}return u}}(jt.API);var Ol,tf,Sv,Av,Nv,t9=function(){var r,e,t;function n(s){var i,o,c,l,u,d,g,p,y,v,w,E,R,P;for(this.data=s,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},d=null;;){switch(i=this.readUInt32(),y=(function(){var q,z;for(z=[],q=0;q<4;++q)z.push(String.fromCharCode(this.data[this.pos++]));return z}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(i);break;case"fcTL":d&&this.animation.frames.push(d),this.pos+=4,d={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},u=this.readUInt16(),l=this.readUInt16()||100,d.delay=1e3*u/l,d.disposeOp=this.data[this.pos++],d.blendOp=this.data[this.pos++],d.data=[];break;case"IDAT":case"fdAT":for(y==="fdAT"&&(this.pos+=4,i-=4),s=(d!=null?d.data:void 0)||this.imgData,E=0;0<=i?E<i:E>i;0<=i?++E:--E)s.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(c=this.palette.length/3,this.transparency.indexed=this.read(i),this.transparency.indexed.length>c)throw new Error("More transparent colors than palette size");if((v=c-this.transparency.indexed.length)>0)for(R=0;0<=v?R<v:R>v;0<=v?++R:--R)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(i)[0];break;case 2:this.transparency.rgb=this.read(i)}break;case"tEXt":g=(w=this.read(i)).indexOf(0),p=String.fromCharCode.apply(String,w.slice(0,g)),this.text[p]=String.fromCharCode.apply(String,w.slice(g+1));break;case"IEND":return d&&this.animation.frames.push(d),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(P=this.colorType)===4||P===6,o=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*o,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=i}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(s){var i,o;for(o=[],i=0;0<=s?i<s:i>s;0<=s?++i:--i)o.push(this.data[this.pos++]);return o},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(s){var i=this.pixelBitlength/8,o=new Uint8Array(this.width*this.height*i),c=0,l=this;if(s==null&&(s=this.imgData),s.length===0)return new Uint8Array(0);function u(d,g,p,y){var v,w,E,R,P,q,z,K,I,N,F,j,S,A,C,J,ue,me,pe,ge,ne,we=Math.ceil((l.width-d)/p),Oe=Math.ceil((l.height-g)/y),k=l.width==we&&l.height==Oe;for(A=i*we,j=k?o:new Uint8Array(A*Oe),q=s.length,S=0,w=0;S<Oe&&c<q;){switch(s[c++]){case 0:for(R=ue=0;ue<A;R=ue+=1)j[w++]=s[c++];break;case 1:for(R=me=0;me<A;R=me+=1)v=s[c++],P=R<i?0:j[w-i],j[w++]=(v+P)%256;break;case 2:for(R=pe=0;pe<A;R=pe+=1)v=s[c++],E=(R-R%i)/i,C=S&&j[(S-1)*A+E*i+R%i],j[w++]=(C+v)%256;break;case 3:for(R=ge=0;ge<A;R=ge+=1)v=s[c++],E=(R-R%i)/i,P=R<i?0:j[w-i],C=S&&j[(S-1)*A+E*i+R%i],j[w++]=(v+Math.floor((P+C)/2))%256;break;case 4:for(R=ne=0;ne<A;R=ne+=1)v=s[c++],E=(R-R%i)/i,P=R<i?0:j[w-i],S===0?C=J=0:(C=j[(S-1)*A+E*i+R%i],J=E&&j[(S-1)*A+(E-1)*i+R%i]),z=P+C-J,K=Math.abs(z-P),N=Math.abs(z-C),F=Math.abs(z-J),I=K<=N&&K<=F?P:N<=F?C:J,j[w++]=(v+I)%256;break;default:throw new Error("Invalid filter algorithm: "+s[c-1])}if(!k){var O=((g+S*y)*l.width+d)*i,M=S*A;for(R=0;R<we;R+=1){for(var U=0;U<i;U+=1)o[O++]=j[M++];O+=(p-1)*i}}S++}}return s=Rj(s),l.interlaceMethod==1?(u(0,0,8,8),u(4,0,8,8),u(0,4,4,8),u(2,0,4,4),u(0,2,2,4),u(1,0,2,2),u(0,1,1,2)):u(0,0,1,1),o},n.prototype.decodePalette=function(){var s,i,o,c,l,u,d,g,p;for(o=this.palette,u=this.transparency.indexed||[],l=new Uint8Array((u.length||0)+o.length),c=0,s=0,i=d=0,g=o.length;d<g;i=d+=3)l[c++]=o[i],l[c++]=o[i+1],l[c++]=o[i+2],l[c++]=(p=u[s++])!=null?p:255;return l},n.prototype.copyToImageData=function(s,i){var o,c,l,u,d,g,p,y,v,w,E;if(c=this.colors,v=null,o=this.hasAlphaChannel,this.palette.length&&(v=(E=this._decodedPalette)!=null?E:this._decodedPalette=this.decodePalette(),c=4,o=!0),y=(l=s.data||s).length,d=v||i,u=g=0,c===1)for(;u<y;)p=v?4*i[u/4]:g,w=d[p++],l[u++]=w,l[u++]=w,l[u++]=w,l[u++]=o?d[p++]:255,g=p;else for(;u<y;)p=v?4*i[u/4]:g,l[u++]=d[p++],l[u++]=d[p++],l[u++]=d[p++],l[u++]=o?d[p++]:255,g=p},n.prototype.decode=function(){var s;return s=new Uint8Array(this.width*this.height*4),this.copyToImageData(s,this.decodePixels()),s};var a=function(){if(Object.prototype.toString.call(Ut)==="[object Window]"){try{e=Ut.document.createElement("canvas"),t=e.getContext("2d")}catch{return!1}return!0}return!1};return a(),r=function(s){var i;if(a()===!0)return t.width=s.width,t.height=s.height,t.clearRect(0,0,s.width,s.height),t.putImageData(s,0,0),(i=new Image).src=e.toDataURL(),i;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(s){var i,o,c,l,u,d,g,p;if(this.animation){for(p=[],o=u=0,d=(g=this.animation.frames).length;u<d;o=++u)i=g[o],c=s.createImageData(i.width,i.height),l=this.decodePixels(new Uint8Array(i.data)),this.copyToImageData(c,l),i.imageData=c,p.push(i.image=r(c));return p}},n.prototype.renderFrame=function(s,i){var o,c,l;return o=(c=this.animation.frames)[i],l=c[i-1],i===0&&s.clearRect(0,0,this.width,this.height),(l!=null?l.disposeOp:void 0)===1?s.clearRect(l.xOffset,l.yOffset,l.width,l.height):(l!=null?l.disposeOp:void 0)===2&&s.putImageData(l.imageData,l.xOffset,l.yOffset),o.blendOp===0&&s.clearRect(o.xOffset,o.yOffset,o.width,o.height),s.drawImage(o.image,o.xOffset,o.yOffset)},n.prototype.animate=function(s){var i,o,c,l,u,d,g=this;return o=0,d=this.animation,l=d.numFrames,c=d.frames,u=d.numPlays,(i=function(){var p,y;if(p=o++%l,y=c[p],g.renderFrame(s,p),l>1&&o/l<u)return g.animation._timeout=setTimeout(i,y.delay)})()},n.prototype.stopAnimation=function(){var s;return clearTimeout((s=this.animation)!=null?s._timeout:void 0)},n.prototype.render=function(s){var i,o;return s._png&&s._png.stopAnimation(),s._png=this,s.width=this.width,s.height=this.height,i=s.getContext("2d"),this.animation?(this.decodeFrames(i),this.animate(i)):(o=i.createImageData(this.width,this.height),this.copyToImageData(o,this.decodePixels()),i.putImageData(o,0,0))},n}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function r9(r){var e=0;if(r[e++]!==71||r[e++]!==73||r[e++]!==70||r[e++]!==56||(r[e++]+1&253)!=56||r[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var t=r[e++]|r[e++]<<8,n=r[e++]|r[e++]<<8,a=r[e++],s=a>>7,i=1<<(7&a)+1;r[e++],r[e++];var o=null,c=null;s&&(o=e,c=i,e+=3*i);var l=!0,u=[],d=0,g=null,p=0,y=null;for(this.width=t,this.height=n;l&&e<r.length;)switch(r[e++]){case 33:switch(r[e++]){case 255:if(r[e]!==11||r[e+1]==78&&r[e+2]==69&&r[e+3]==84&&r[e+4]==83&&r[e+5]==67&&r[e+6]==65&&r[e+7]==80&&r[e+8]==69&&r[e+9]==50&&r[e+10]==46&&r[e+11]==48&&r[e+12]==3&&r[e+13]==1&&r[e+16]==0)e+=14,y=r[e++]|r[e++]<<8,e++;else for(e+=12;;){if(!((S=r[e++])>=0))throw Error("Invalid block size");if(S===0)break;e+=S}break;case 249:if(r[e++]!==4||r[e+4]!==0)throw new Error("Invalid graphics extension block.");var v=r[e++];d=r[e++]|r[e++]<<8,g=r[e++],!(1&v)&&(g=null),p=v>>2&7,e++;break;case 254:for(;;){if(!((S=r[e++])>=0))throw Error("Invalid block size");if(S===0)break;e+=S}break;default:throw new Error("Unknown graphic control label: 0x"+r[e-1].toString(16))}break;case 44:var w=r[e++]|r[e++]<<8,E=r[e++]|r[e++]<<8,R=r[e++]|r[e++]<<8,P=r[e++]|r[e++]<<8,q=r[e++],z=q>>6&1,K=1<<(7&q)+1,I=o,N=c,F=!1;q>>7&&(F=!0,I=e,N=K,e+=3*K);var j=e;for(e++;;){var S;if(!((S=r[e++])>=0))throw Error("Invalid block size");if(S===0)break;e+=S}u.push({x:w,y:E,width:R,height:P,has_local_palette:F,palette_offset:I,palette_size:N,data_offset:j,data_length:e-j,transparent_index:g,interlaced:!!z,delay:d,disposal:p});break;case 59:l=!1;break;default:throw new Error("Unknown gif block: 0x"+r[e-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return y},this.frameInfo=function(A){if(A<0||A>=u.length)throw new Error("Frame index out of range.");return u[A]},this.decodeAndBlitFrameBGRA=function(A,C){var J=this.frameInfo(A),ue=J.width*J.height,me=new Uint8Array(ue);Tv(r,J.data_offset,me,ue);var pe=J.palette_offset,ge=J.transparent_index;ge===null&&(ge=256);var ne=J.width,we=t-ne,Oe=ne,k=4*(J.y*t+J.x),O=4*((J.y+J.height)*t+J.x),M=k,U=4*we;J.interlaced===!0&&(U+=4*t*7);for(var ee=8,he=0,de=me.length;he<de;++he){var fe=me[he];if(Oe===0&&(Oe=ne,(M+=U)>=O&&(U=4*we+4*t*(ee-1),M=k+(ne+we)*(ee<<1),ee>>=1)),fe===ge)M+=4;else{var be=r[pe+3*fe],Me=r[pe+3*fe+1],Z=r[pe+3*fe+2];C[M++]=Z,C[M++]=Me,C[M++]=be,C[M++]=255}--Oe}},this.decodeAndBlitFrameRGBA=function(A,C){var J=this.frameInfo(A),ue=J.width*J.height,me=new Uint8Array(ue);Tv(r,J.data_offset,me,ue);var pe=J.palette_offset,ge=J.transparent_index;ge===null&&(ge=256);var ne=J.width,we=t-ne,Oe=ne,k=4*(J.y*t+J.x),O=4*((J.y+J.height)*t+J.x),M=k,U=4*we;J.interlaced===!0&&(U+=4*t*7);for(var ee=8,he=0,de=me.length;he<de;++he){var fe=me[he];if(Oe===0&&(Oe=ne,(M+=U)>=O&&(U=4*we+4*t*(ee-1),M=k+(ne+we)*(ee<<1),ee>>=1)),fe===ge)M+=4;else{var be=r[pe+3*fe],Me=r[pe+3*fe+1],Z=r[pe+3*fe+2];C[M++]=be,C[M++]=Me,C[M++]=Z,C[M++]=255}--Oe}}}function Tv(r,e,t,n){for(var a=r[e++],s=1<<a,i=s+1,o=i+1,c=a+1,l=(1<<c)-1,u=0,d=0,g=0,p=r[e++],y=new Int32Array(4096),v=null;;){for(;u<16&&p!==0;)d|=r[e++]<<u,u+=8,p===1?p=r[e++]:--p;if(u<c)break;var w=d&l;if(d>>=c,u-=c,w!==s){if(w===i)break;for(var E=w<o?w:v,R=0,P=E;P>s;)P=y[P]>>8,++R;var q=P;if(g+R+(E!==w?1:0)>n)return void Br.log("Warning, gif stream longer than expected.");t[g++]=q;var z=g+=R;for(E!==w&&(t[g++]=q),P=E;R--;)P=y[P],t[--z]=255&P,P>>=8;v!==null&&o<4096&&(y[o++]=v<<8|q,o>=l+1&&c<12&&(++c,l=l<<1|1)),v=w}else o=i+1,l=(1<<(c=a+1))-1,v=null}return g!==n&&Br.log("Warning, gif stream shorter than expected."),t}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Nm(r){var e,t,n,a,s,i=Math.floor,o=new Array(64),c=new Array(64),l=new Array(64),u=new Array(64),d=new Array(65535),g=new Array(65535),p=new Array(64),y=new Array(64),v=[],w=0,E=7,R=new Array(64),P=new Array(64),q=new Array(64),z=new Array(256),K=new Array(2048),I=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],N=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],F=[0,1,2,3,4,5,6,7,8,9,10,11],j=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],S=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],A=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],C=[0,1,2,3,4,5,6,7,8,9,10,11],J=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ue=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function me(k,O){for(var M=0,U=0,ee=new Array,he=1;he<=16;he++){for(var de=1;de<=k[he];de++)ee[O[U]]=[],ee[O[U]][0]=M,ee[O[U]][1]=he,U++,M++;M*=2}return ee}function pe(k){for(var O=k[0],M=k[1]-1;M>=0;)O&1<<M&&(w|=1<<E),M--,--E<0&&(w==255?(ge(255),ge(0)):ge(w),E=7,w=0)}function ge(k){v.push(k)}function ne(k){ge(k>>8&255),ge(255&k)}function we(k,O,M,U,ee){for(var he,de=ee[0],fe=ee[240],be=function($e,rt){var ot,ht,_t,At,Ft,Et,It,Vt,Nt,dt,tt=0;for(Nt=0;Nt<8;++Nt){ot=$e[tt],ht=$e[tt+1],_t=$e[tt+2],At=$e[tt+3],Ft=$e[tt+4],Et=$e[tt+5],It=$e[tt+6];var sr=ot+(Vt=$e[tt+7]),Ct=ot-Vt,rn=ht+It,cr=ht-It,Cr=_t+Et,Pa=_t-Et,rr=At+Ft,Ha=At-Ft,Pr=sr+rr,In=sr-rr,va=rn+Cr,xr=rn-Cr;$e[tt]=Pr+va,$e[tt+4]=Pr-va;var Rt=.707106781*(xr+In);$e[tt+2]=In+Rt,$e[tt+6]=In-Rt;var ir=.382683433*((Pr=Ha+Pa)-(xr=cr+Ct)),Fa=.5411961*Pr+ir,nn=1.306562965*xr+ir,Ln=.707106781*(va=Pa+cr),ya=Ct+Ln,bt=Ct-Ln;$e[tt+5]=bt+Fa,$e[tt+3]=bt-Fa,$e[tt+1]=ya+nn,$e[tt+7]=ya-nn,tt+=8}for(tt=0,Nt=0;Nt<8;++Nt){ot=$e[tt],ht=$e[tt+8],_t=$e[tt+16],At=$e[tt+24],Ft=$e[tt+32],Et=$e[tt+40],It=$e[tt+48];var ta=ot+(Vt=$e[tt+56]),_n=ot-Vt,an=ht+It,Jr=ht-It,Kr=_t+Et,W=_t-Et,oe=At+Ft,te=At-Ft,re=ta+oe,ie=ta-oe,ce=an+Kr,Te=an-Kr;$e[tt]=re+ce,$e[tt+32]=re-ce;var je=.707106781*(Te+ie);$e[tt+16]=ie+je,$e[tt+48]=ie-je;var ke=.382683433*((re=te+W)-(Te=Jr+_n)),Ie=.5411961*re+ke,Le=1.306562965*Te+ke,Je=.707106781*(ce=W+Jr),it=_n+Je,gt=_n-Je;$e[tt+40]=gt+Ie,$e[tt+24]=gt-Ie,$e[tt+8]=it+Le,$e[tt+56]=it-Le,tt++}for(Nt=0;Nt<64;++Nt)dt=$e[Nt]*rt[Nt],p[Nt]=dt>0?dt+.5|0:dt-.5|0;return p}(k,O),Me=0;Me<64;++Me)y[I[Me]]=be[Me];var Z=y[0]-M;M=y[0],Z==0?pe(U[0]):(pe(U[g[he=32767+Z]]),pe(d[he]));for(var Xe=63;Xe>0&&y[Xe]==0;)Xe--;if(Xe==0)return pe(de),M;for(var st,Fe=1;Fe<=Xe;){for(var se=Fe;y[Fe]==0&&Fe<=Xe;)++Fe;var qe=Fe-se;if(qe>=16){st=qe>>4;for(var lt=1;lt<=st;++lt)pe(fe);qe&=15}he=32767+y[Fe],pe(ee[(qe<<4)+g[he]]),pe(d[he]),Fe++}return Xe!=63&&pe(de),M}function Oe(k){k=Math.min(Math.max(k,1),100),s!=k&&(function(O){for(var M=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],U=0;U<64;U++){var ee=i((M[U]*O+50)/100);ee=Math.min(Math.max(ee,1),255),o[I[U]]=ee}for(var he=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],de=0;de<64;de++){var fe=i((he[de]*O+50)/100);fe=Math.min(Math.max(fe,1),255),c[I[de]]=fe}for(var be=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Me=0,Z=0;Z<8;Z++)for(var Xe=0;Xe<8;Xe++)l[Me]=1/(o[I[Me]]*be[Z]*be[Xe]*8),u[Me]=1/(c[I[Me]]*be[Z]*be[Xe]*8),Me++}(k<50?Math.floor(5e3/k):Math.floor(200-2*k)),s=k)}this.encode=function(k,O){O&&Oe(O),v=new Array,w=0,E=7,ne(65496),ne(65504),ne(16),ge(74),ge(70),ge(73),ge(70),ge(0),ge(1),ge(1),ge(0),ne(1),ne(1),ge(0),ge(0),function(){ne(65499),ne(132),ge(0);for(var ht=0;ht<64;ht++)ge(o[ht]);ge(1);for(var _t=0;_t<64;_t++)ge(c[_t])}(),function(ht,_t){ne(65472),ne(17),ge(8),ne(_t),ne(ht),ge(3),ge(1),ge(17),ge(0),ge(2),ge(17),ge(1),ge(3),ge(17),ge(1)}(k.width,k.height),function(){ne(65476),ne(418),ge(0);for(var ht=0;ht<16;ht++)ge(N[ht+1]);for(var _t=0;_t<=11;_t++)ge(F[_t]);ge(16);for(var At=0;At<16;At++)ge(j[At+1]);for(var Ft=0;Ft<=161;Ft++)ge(S[Ft]);ge(1);for(var Et=0;Et<16;Et++)ge(A[Et+1]);for(var It=0;It<=11;It++)ge(C[It]);ge(17);for(var Vt=0;Vt<16;Vt++)ge(J[Vt+1]);for(var Nt=0;Nt<=161;Nt++)ge(ue[Nt])}(),ne(65498),ne(12),ge(3),ge(1),ge(0),ge(2),ge(17),ge(3),ge(17),ge(0),ge(63),ge(0);var M=0,U=0,ee=0;w=0,E=7,this.encode.displayName="_encode_";for(var he,de,fe,be,Me,Z,Xe,st,Fe,se=k.data,qe=k.width,lt=k.height,$e=4*qe,rt=0;rt<lt;){for(he=0;he<$e;){for(Me=$e*rt+he,Xe=-1,st=0,Fe=0;Fe<64;Fe++)Z=Me+(st=Fe>>3)*$e+(Xe=4*(7&Fe)),rt+st>=lt&&(Z-=$e*(rt+1+st-lt)),he+Xe>=$e&&(Z-=he+Xe-$e+4),de=se[Z++],fe=se[Z++],be=se[Z++],R[Fe]=(K[de]+K[fe+256>>0]+K[be+512>>0]>>16)-128,P[Fe]=(K[de+768>>0]+K[fe+1024>>0]+K[be+1280>>0]>>16)-128,q[Fe]=(K[de+1280>>0]+K[fe+1536>>0]+K[be+1792>>0]>>16)-128;M=we(R,l,M,e,n),U=we(P,u,U,t,a),ee=we(q,u,ee,t,a),he+=32}rt+=8}if(E>=0){var ot=[];ot[1]=E+1,ot[0]=(1<<E+1)-1,pe(ot)}return ne(65497),new Uint8Array(v)},r=r||50,function(){for(var k=String.fromCharCode,O=0;O<256;O++)z[O]=k(O)}(),e=me(N,F),t=me(A,C),n=me(j,S),a=me(J,ue),function(){for(var k=1,O=2,M=1;M<=15;M++){for(var U=k;U<O;U++)g[32767+U]=M,d[32767+U]=[],d[32767+U][1]=M,d[32767+U][0]=U;for(var ee=-(O-1);ee<=-k;ee++)g[32767+ee]=M,d[32767+ee]=[],d[32767+ee][1]=M,d[32767+ee][0]=O-1+ee;k<<=1,O<<=1}}(),function(){for(var k=0;k<256;k++)K[k]=19595*k,K[k+256>>0]=38470*k,K[k+512>>0]=7471*k+32768,K[k+768>>0]=-11059*k,K[k+1024>>0]=-21709*k,K[k+1280>>0]=32768*k+8421375,K[k+1536>>0]=-27439*k,K[k+1792>>0]=-5329*k}(),Oe(r)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function qs(r,e){if(this.pos=0,this.buffer=r,this.datav=new DataView(r.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function kv(r){function e(N){if(!N)throw Error("assert :P")}function t(N,F,j){for(var S=0;4>S;S++)if(N[F+S]!=j.charCodeAt(S))return!0;return!1}function n(N,F,j,S,A){for(var C=0;C<A;C++)N[F+C]=j[S+C]}function a(N,F,j,S){for(var A=0;A<S;A++)N[F+A]=j}function s(N){return new Int32Array(N)}function i(N,F){for(var j=[],S=0;S<N;S++)j.push(new F);return j}function o(N,F){var j=[];return function S(A,C,J){for(var ue=J[C],me=0;me<ue&&(A.push(J.length>C+1?[]:new F),!(J.length<C+1));me++)S(A[me],C+1,J)}(j,0,N),j}var c=function(){var N=this;function F(f,x){for(var b=1<<x-1>>>0;f&b;)b>>>=1;return b?(f&b-1)+b:f}function j(f,x,b,D,V){e(!(D%b));do f[x+(D-=b)]=V;while(0<D)}function S(f,x,b,D,V){if(e(2328>=V),512>=V)var H=s(512);else if((H=s(V))==null)return 0;return function(G,Y,Q,ae,ve,Ce){var Pe,Ne,He=Y,Be=1<<Q,ye=s(16),_e=s(16);for(e(ve!=0),e(ae!=null),e(G!=null),e(0<Q),Ne=0;Ne<ve;++Ne){if(15<ae[Ne])return 0;++ye[ae[Ne]]}if(ye[0]==ve)return 0;for(_e[1]=0,Pe=1;15>Pe;++Pe){if(ye[Pe]>1<<Pe)return 0;_e[Pe+1]=_e[Pe]+ye[Pe]}for(Ne=0;Ne<ve;++Ne)Pe=ae[Ne],0<ae[Ne]&&(Ce[_e[Pe]++]=Ne);if(_e[15]==1)return(ae=new A).g=0,ae.value=Ce[0],j(G,He,1,Be,ae),Be;var ze,Ye=-1,We=Be-1,yt=0,mt=1,Lt=1,xt=1<<Q;for(Ne=0,Pe=1,ve=2;Pe<=Q;++Pe,ve<<=1){if(mt+=Lt<<=1,0>(Lt-=ye[Pe]))return 0;for(;0<ye[Pe];--ye[Pe])(ae=new A).g=Pe,ae.value=Ce[Ne++],j(G,He+yt,ve,xt,ae),yt=F(yt,Pe)}for(Pe=Q+1,ve=2;15>=Pe;++Pe,ve<<=1){if(mt+=Lt<<=1,0>(Lt-=ye[Pe]))return 0;for(;0<ye[Pe];--ye[Pe]){if(ae=new A,(yt&We)!=Ye){for(He+=xt,ze=1<<(Ye=Pe)-Q;15>Ye&&!(0>=(ze-=ye[Ye]));)++Ye,ze<<=1;Be+=xt=1<<(ze=Ye-Q),G[Y+(Ye=yt&We)].g=ze+Q,G[Y+Ye].value=He-Y-Ye}ae.g=Pe-Q,ae.value=Ce[Ne++],j(G,He+(yt>>Q),ve,xt,ae),yt=F(yt,Pe)}}return mt!=2*_e[15]-1?0:Be}(f,x,b,D,V,H)}function A(){this.value=this.g=0}function C(){this.value=this.g=0}function J(){this.G=i(5,A),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=i($n,C)}function ue(f,x,b,D){e(f!=null),e(x!=null),e(2147483648>D),f.Ca=254,f.I=0,f.b=-8,f.Ka=0,f.oa=x,f.pa=b,f.Jd=x,f.Yc=b+D,f.Zc=4<=D?b+D-4+1:b,he(f)}function me(f,x){for(var b=0;0<x--;)b|=fe(f,128)<<x;return b}function pe(f,x){var b=me(f,x);return de(f)?-b:b}function ge(f,x,b,D){var V,H=0;for(e(f!=null),e(x!=null),e(4294967288>D),f.Sb=D,f.Ra=0,f.u=0,f.h=0,4<D&&(D=4),V=0;V<D;++V)H+=x[b+V]<<8*V;f.Ra=H,f.bb=D,f.oa=x,f.pa=b}function ne(f){for(;8<=f.u&&f.bb<f.Sb;)f.Ra>>>=8,f.Ra+=f.oa[f.pa+f.bb]<<yl-8>>>0,++f.bb,f.u-=8;M(f)&&(f.h=1,f.u=0)}function we(f,x){if(e(0<=x),!f.h&&x<=vl){var b=O(f)&xl[x];return f.u+=x,ne(f),b}return f.h=1,f.u=0}function Oe(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function k(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function O(f){return f.Ra>>>(f.u&yl-1)>>>0}function M(f){return e(f.bb<=f.Sb),f.h||f.bb==f.Sb&&f.u>yl}function U(f,x){f.u=x,f.h=M(f)}function ee(f){f.u>=Cu&&(e(f.u>=Cu),ne(f))}function he(f){e(f!=null&&f.oa!=null),f.pa<f.Zc?(f.I=(f.oa[f.pa++]|f.I<<8)>>>0,f.b+=8):(e(f!=null&&f.oa!=null),f.pa<f.Yc?(f.b+=8,f.I=f.oa[f.pa++]|f.I<<8):f.Ka?f.b=0:(f.I<<=8,f.b+=8,f.Ka=1))}function de(f){return me(f,1)}function fe(f,x){var b=f.Ca;0>f.b&&he(f);var D=f.b,V=b*x>>>8,H=(f.I>>>D>V)+0;for(H?(b-=V,f.I-=V+1<<D>>>0):b=V+1,D=b,V=0;256<=D;)V+=8,D>>=8;return D=7^V+La[D],f.b-=D,f.Ca=(b<<D)-1,H}function be(f,x,b){f[x+0]=b>>24&255,f[x+1]=b>>16&255,f[x+2]=b>>8&255,f[x+3]=b>>0&255}function Me(f,x){return f[x+0]<<0|f[x+1]<<8}function Z(f,x){return Me(f,x)|f[x+2]<<16}function Xe(f,x){return Me(f,x)|Me(f,x+2)<<16}function st(f,x){var b=1<<x;return e(f!=null),e(0<x),f.X=s(b),f.X==null?0:(f.Mb=32-x,f.Xa=x,1)}function Fe(f,x){e(f!=null),e(x!=null),e(f.Xa==x.Xa),n(x.X,0,f.X,0,1<<x.Xa)}function se(){this.X=[],this.Xa=this.Mb=0}function qe(f,x,b,D){e(b!=null),e(D!=null);var V=b[0],H=D[0];return V==0&&(V=(f*H+x/2)/x),H==0&&(H=(x*V+f/2)/f),0>=V||0>=H?0:(b[0]=V,D[0]=H,1)}function lt(f,x){return f+(1<<x)-1>>>x}function $e(f,x){return((4278255360&f)+(4278255360&x)>>>0&4278255360)+((16711935&f)+(16711935&x)>>>0&16711935)>>>0}function rt(f,x){N[x]=function(b,D,V,H,G,Y,Q){var ae;for(ae=0;ae<G;++ae){var ve=N[f](Y[Q+ae-1],V,H+ae);Y[Q+ae]=$e(b[D+ae],ve)}}}function ot(){this.ud=this.hd=this.jd=0}function ht(f,x){return((4278124286&(f^x))>>>1)+(f&x)>>>0}function _t(f){return 0<=f&&256>f?f:0>f?0:255<f?255:void 0}function At(f,x){return _t(f+(f-x+.5>>1))}function Ft(f,x,b){return Math.abs(x-b)-Math.abs(f-b)}function Et(f,x,b,D,V,H,G){for(D=H[G-1],b=0;b<V;++b)H[G+b]=D=$e(f[x+b],D)}function It(f,x,b,D,V){var H;for(H=0;H<b;++H){var G=f[x+H],Y=G>>8&255,Q=16711935&(Q=(Q=16711935&G)+((Y<<16)+Y));D[V+H]=(4278255360&G)+Q>>>0}}function Vt(f,x){x.jd=f>>0&255,x.hd=f>>8&255,x.ud=f>>16&255}function Nt(f,x,b,D,V,H){var G;for(G=0;G<D;++G){var Y=x[b+G],Q=Y>>>8,ae=Y,ve=255&(ve=(ve=Y>>>16)+((f.jd<<24>>24)*(Q<<24>>24)>>>5));ae=255&(ae=(ae=ae+((f.hd<<24>>24)*(Q<<24>>24)>>>5))+((f.ud<<24>>24)*(ve<<24>>24)>>>5)),V[H+G]=(4278255360&Y)+(ve<<16)+ae}}function dt(f,x,b,D,V){N[x]=function(H,G,Y,Q,ae,ve,Ce,Pe,Ne){for(Q=Ce;Q<Pe;++Q)for(Ce=0;Ce<Ne;++Ce)ae[ve++]=V(Y[D(H[G++])])},N[f]=function(H,G,Y,Q,ae,ve,Ce){var Pe=8>>H.b,Ne=H.Ea,He=H.K[0],Be=H.w;if(8>Pe)for(H=(1<<H.b)-1,Be=(1<<Pe)-1;G<Y;++G){var ye,_e=0;for(ye=0;ye<Ne;++ye)ye&H||(_e=D(Q[ae++])),ve[Ce++]=V(He[_e&Be]),_e>>=Pe}else N["VP8LMapColor"+b](Q,ae,He,Be,ve,Ce,G,Y,Ne)}}function tt(f,x,b,D,V){for(b=x+b;x<b;){var H=f[x++];D[V++]=H>>16&255,D[V++]=H>>8&255,D[V++]=H>>0&255}}function sr(f,x,b,D,V){for(b=x+b;x<b;){var H=f[x++];D[V++]=H>>16&255,D[V++]=H>>8&255,D[V++]=H>>0&255,D[V++]=H>>24&255}}function Ct(f,x,b,D,V){for(b=x+b;x<b;){var H=(G=f[x++])>>16&240|G>>12&15,G=G>>0&240|G>>28&15;D[V++]=H,D[V++]=G}}function rn(f,x,b,D,V){for(b=x+b;x<b;){var H=(G=f[x++])>>16&248|G>>13&7,G=G>>5&224|G>>3&31;D[V++]=H,D[V++]=G}}function cr(f,x,b,D,V){for(b=x+b;x<b;){var H=f[x++];D[V++]=H>>0&255,D[V++]=H>>8&255,D[V++]=H>>16&255}}function Cr(f,x,b,D,V,H){if(H==0)for(b=x+b;x<b;)be(D,((H=f[x++])[0]>>24|H[1]>>8&65280|H[2]<<8&16711680|H[3]<<24)>>>0),V+=32;else n(D,V,f,x,b)}function Pa(f,x){N[x][0]=N[f+"0"],N[x][1]=N[f+"1"],N[x][2]=N[f+"2"],N[x][3]=N[f+"3"],N[x][4]=N[f+"4"],N[x][5]=N[f+"5"],N[x][6]=N[f+"6"],N[x][7]=N[f+"7"],N[x][8]=N[f+"8"],N[x][9]=N[f+"9"],N[x][10]=N[f+"10"],N[x][11]=N[f+"11"],N[x][12]=N[f+"12"],N[x][13]=N[f+"13"],N[x][14]=N[f+"0"],N[x][15]=N[f+"0"]}function rr(f){return f==Dd||f==Ld||f==w0||f==jd}function Ha(){this.eb=[],this.size=this.A=this.fb=0}function Pr(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function In(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Ha,this.f.kb=new Pr,this.sd=null}function va(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function xr(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Rt(f){return alert("todo:WebPSamplerProcessPlane"),f.T}function ir(f,x){var b=f.T,D=x.ba.f.RGBA,V=D.eb,H=D.fb+f.ka*D.A,G=ps[x.ba.S],Y=f.y,Q=f.O,ae=f.f,ve=f.N,Ce=f.ea,Pe=f.W,Ne=x.cc,He=x.dc,Be=x.Mc,ye=x.Nc,_e=f.ka,ze=f.ka+f.T,Ye=f.U,We=Ye+1>>1;for(_e==0?G(Y,Q,null,null,ae,ve,Ce,Pe,ae,ve,Ce,Pe,V,H,null,null,Ye):(G(x.ec,x.fc,Y,Q,Ne,He,Be,ye,ae,ve,Ce,Pe,V,H-D.A,V,H,Ye),++b);_e+2<ze;_e+=2)Ne=ae,He=ve,Be=Ce,ye=Pe,ve+=f.Rc,Pe+=f.Rc,H+=2*D.A,G(Y,(Q+=2*f.fa)-f.fa,Y,Q,Ne,He,Be,ye,ae,ve,Ce,Pe,V,H-D.A,V,H,Ye);return Q+=f.fa,f.j+ze<f.o?(n(x.ec,x.fc,Y,Q,Ye),n(x.cc,x.dc,ae,ve,We),n(x.Mc,x.Nc,Ce,Pe,We),b--):1&ze||G(Y,Q,null,null,ae,ve,Ce,Pe,ae,ve,Ce,Pe,V,H+D.A,null,null,Ye),b}function Fa(f,x,b){var D=f.F,V=[f.J];if(D!=null){var H=f.U,G=x.ba.S,Y=G==y0||G==w0;x=x.ba.f.RGBA;var Q=[0],ae=f.ka;Q[0]=f.T,f.Kb&&(ae==0?--Q[0]:(--ae,V[0]-=f.width),f.j+f.ka+f.T==f.o&&(Q[0]=f.o-f.j-ae));var ve=x.eb;ae=x.fb+ae*x.A,f=Ur(D,V[0],f.width,H,Q,ve,ae+(Y?0:3),x.A),e(b==Q),f&&rr(G)&&ds(ve,ae,Y,H,Q,x.A)}return 0}function nn(f){var x=f.ma,b=x.ba.S,D=11>b,V=b==x0||b==v0||b==y0||b==Rd||b==12||rr(b);if(x.memory=null,x.Ib=null,x.Jb=null,x.Nd=null,!ku(x.Oa,f,V?11:12))return 0;if(V&&rr(b)&&Qe(),f.da)alert("todo:use_scaling");else{if(D){if(x.Ib=Rt,f.Kb){if(b=f.U+1>>1,x.memory=s(f.U+2*b),x.memory==null)return 0;x.ec=x.memory,x.fc=0,x.cc=x.ec,x.dc=x.fc+f.U,x.Mc=x.cc,x.Nc=x.dc+b,x.Ib=ir,Qe()}}else alert("todo:EmitYUV");V&&(x.Jb=Fa,D&&Ae())}if(D&&!mg){for(f=0;256>f;++f)c4[f]=89858*(f-128)+b0>>_0,h4[f]=-22014*(f-128)+b0,u4[f]=-45773*(f-128),l4[f]=113618*(f-128)+b0>>_0;for(f=Ou;f<Bd;++f)x=76283*(f-16)+b0>>_0,f4[f-Ou]=wr(x,255),d4[f-Ou]=wr(x+8>>4,15);mg=1}return 1}function Ln(f){var x=f.ma,b=f.U,D=f.T;return e(!(1&f.ka)),0>=b||0>=D?0:(b=x.Ib(f,x),x.Jb!=null&&x.Jb(f,x,b),x.Dc+=b,1)}function ya(f){f.ma.memory=null}function bt(f,x,b,D){return we(f,8)!=47?0:(x[0]=we(f,14)+1,b[0]=we(f,14)+1,D[0]=we(f,1),we(f,3)!=0?0:!f.h)}function ta(f,x){if(4>f)return f+1;var b=f-2>>1;return(2+(1&f)<<b)+we(x,b)+1}function _n(f,x){return 120<x?x-120:1<=(b=((b=Kb[x-1])>>4)*f+(8-(15&b)))?b:1;var b}function an(f,x,b){var D=O(b),V=f[x+=255&D].g-8;return 0<V&&(U(b,b.u+8),D=O(b),x+=f[x].value,x+=D&(1<<V)-1),U(b,b.u+f[x].g),f[x].value}function Jr(f,x,b){return b.g+=f.g,b.value+=f.value<<x>>>0,e(8>=b.g),f.g}function Kr(f,x,b){var D=f.xc;return e((x=D==0?0:f.vc[f.md*(b>>D)+(x>>D)])<f.Wb),f.Ya[x]}function W(f,x,b,D){var V=f.ab,H=f.c*x,G=f.C;x=G+x;var Y=b,Q=D;for(D=f.Ta,b=f.Ua;0<V--;){var ae=f.gc[V],ve=G,Ce=x,Pe=Y,Ne=Q,He=(Q=D,Y=b,ae.Ea);switch(e(ve<Ce),e(Ce<=ae.nc),ae.hc){case 2:u0(Pe,Ne,(Ce-ve)*He,Q,Y);break;case 0:var Be=ve,ye=Ce,_e=Q,ze=Y,Ye=(xt=ae).Ea;Be==0&&(Pd(Pe,Ne,null,null,1,_e,ze),Et(Pe,Ne+1,0,0,Ye-1,_e,ze+1),Ne+=Ye,ze+=Ye,++Be);for(var We=1<<xt.b,yt=We-1,mt=lt(Ye,xt.b),Lt=xt.K,xt=xt.w+(Be>>xt.b)*mt;Be<ye;){var vr=Lt,br=xt,dr=1;for(Pu(Pe,Ne,_e,ze-Ye,1,_e,ze);dr<Ye;){var ar=(dr&~yt)+We;ar>Ye&&(ar=Ye),(0,fo[vr[br++]>>8&15])(Pe,Ne+ +dr,_e,ze+dr-Ye,ar-dr,_e,ze+dr),dr=ar}Ne+=Ye,ze+=Ye,++Be&yt||(xt+=mt)}Ce!=ae.nc&&n(Q,Y-He,Q,Y+(Ce-ve-1)*He,He);break;case 1:for(He=Pe,ye=Ne,Ye=(Pe=ae.Ea)-(ze=Pe&~(_e=(Ne=1<<ae.b)-1)),Be=lt(Pe,ae.b),We=ae.K,ae=ae.w+(ve>>ae.b)*Be;ve<Ce;){for(yt=We,mt=ae,Lt=new ot,xt=ye+ze,vr=ye+Pe;ye<xt;)Vt(yt[mt++],Lt),fc(Lt,He,ye,Ne,Q,Y),ye+=Ne,Y+=Ne;ye<vr&&(Vt(yt[mt++],Lt),fc(Lt,He,ye,Ye,Q,Y),ye+=Ye,Y+=Ye),++ve&_e||(ae+=Be)}break;case 3:if(Pe==Q&&Ne==Y&&0<ae.b){for(ye=Q,Pe=He=Y+(Ce-ve)*He-(ze=(Ce-ve)*lt(ae.Ea,ae.b)),Ne=Q,_e=Y,Be=[],ze=(Ye=ze)-1;0<=ze;--ze)Be[ze]=Ne[_e+ze];for(ze=Ye-1;0<=ze;--ze)ye[Pe+ze]=Be[ze];us(ae,ve,Ce,Q,He,Q,Y)}else us(ae,ve,Ce,Pe,Ne,Q,Y)}Y=D,Q=b}Q!=b&&n(D,b,Y,Q,H)}function oe(f,x){var b=f.V,D=f.Ba+f.c*f.C,V=x-f.C;if(e(x<=f.l.o),e(16>=V),0<V){var H=f.l,G=f.Ta,Y=f.Ua,Q=H.width;if(W(f,V,b,D),V=Y=[Y],e((b=f.C)<(D=x)),e(H.v<H.va),D>H.o&&(D=H.o),b<H.j){var ae=H.j-b;b=H.j,V[0]+=ae*Q}if(b>=D?b=0:(V[0]+=4*H.v,H.ka=b-H.j,H.U=H.va-H.v,H.T=D-b,b=1),b){if(Y=Y[0],11>(b=f.ca).S){var ve=b.f.RGBA,Ce=(D=b.S,V=H.U,H=H.T,ae=ve.eb,ve.A),Pe=H;for(ve=ve.fb+f.Ma*ve.A;0<Pe--;){var Ne=G,He=Y,Be=V,ye=ae,_e=ve;switch(D){case g0:ja(Ne,He,Be,ye,_e);break;case x0:ba(Ne,He,Be,ye,_e);break;case Dd:ba(Ne,He,Be,ye,_e),ds(ye,_e,0,Be,1,0);break;case ag:Ii(Ne,He,Be,ye,_e);break;case v0:Cr(Ne,He,Be,ye,_e,1);break;case Ld:Cr(Ne,He,Be,ye,_e,1),ds(ye,_e,0,Be,1,0);break;case y0:Cr(Ne,He,Be,ye,_e,0);break;case w0:Cr(Ne,He,Be,ye,_e,0),ds(ye,_e,1,Be,1,0);break;case Rd:mo(Ne,He,Be,ye,_e);break;case jd:mo(Ne,He,Be,ye,_e),Vr(ye,_e,Be,1,0);break;case sg:ki(Ne,He,Be,ye,_e);break;default:e(0)}Y+=Q,ve+=Ce}f.Ma+=H}else alert("todo:EmitRescaledRowsYUVA");e(f.Ma<=b.height)}}f.C=x,e(f.C<=f.i)}function te(f){var x;if(0<f.ua)return 0;for(x=0;x<f.Wb;++x){var b=f.Ya[x].G,D=f.Ya[x].H;if(0<b[1][D[1]+0].g||0<b[2][D[2]+0].g||0<b[3][D[3]+0].g)return 0}return 1}function re(f,x,b,D,V,H){if(f.Z!=0){var G=f.qd,Y=f.rd;for(e(vo[f.Z]!=null);x<b;++x)vo[f.Z](G,Y,D,V,D,V,H),G=D,Y=V,V+=H;f.qd=G,f.rd=Y}}function ie(f,x){var b=f.l.ma,D=b.Z==0||b.Z==1?f.l.j:f.C;if(D=f.C<D?D:f.C,e(x<=f.l.o),x>D){var V=f.l.width,H=b.ca,G=b.tb+V*D,Y=f.V,Q=f.Ba+f.c*D,ae=f.gc;e(f.ab==1),e(ae[0].hc==3),h0(ae[0],D,x,Y,Q,H,G),re(b,D,x,H,G,V)}f.C=f.Ma=x}function ce(f,x,b,D,V,H,G){var Y=f.$/D,Q=f.$%D,ae=f.m,ve=f.s,Ce=b+f.$,Pe=Ce;V=b+D*V;var Ne=b+D*H,He=280+ve.ua,Be=f.Pb?Y:16777216,ye=0<ve.ua?ve.Wa:null,_e=ve.wc,ze=Ce<Ne?Kr(ve,Q,Y):null;e(f.C<H),e(Ne<=V);var Ye=!1;e:for(;;){for(;Ye||Ce<Ne;){var We=0;if(Y>=Be){var yt=Ce-b;e((Be=f).Pb),Be.wd=Be.m,Be.xd=yt,0<Be.s.ua&&Fe(Be.s.Wa,Be.s.vb),Be=Y+Yb}if(Q&_e||(ze=Kr(ve,Q,Y)),e(ze!=null),ze.Qb&&(x[Ce]=ze.qb,Ye=!0),!Ye)if(ee(ae),ze.jc){We=ae,yt=x;var mt=Ce,Lt=ze.pd[O(We)&$n-1];e(ze.jc),256>Lt.g?(U(We,We.u+Lt.g),yt[mt]=Lt.value,We=0):(U(We,We.u+Lt.g-256),e(256<=Lt.value),We=Lt.value),We==0&&(Ye=!0)}else We=an(ze.G[0],ze.H[0],ae);if(ae.h)break;if(Ye||256>We){if(!Ye)if(ze.nd)x[Ce]=(ze.qb|We<<8)>>>0;else{if(ee(ae),Ye=an(ze.G[1],ze.H[1],ae),ee(ae),yt=an(ze.G[2],ze.H[2],ae),mt=an(ze.G[3],ze.H[3],ae),ae.h)break;x[Ce]=(mt<<24|Ye<<16|We<<8|yt)>>>0}if(Ye=!1,++Ce,++Q>=D&&(Q=0,++Y,G!=null&&Y<=H&&!(Y%16)&&G(f,Y),ye!=null))for(;Pe<Ce;)We=x[Pe++],ye.X[(506832829*We&4294967295)>>>ye.Mb]=We}else if(280>We){if(We=ta(We-256,ae),yt=an(ze.G[4],ze.H[4],ae),ee(ae),yt=_n(D,yt=ta(yt,ae)),ae.h)break;if(Ce-b<yt||V-Ce<We)break e;for(mt=0;mt<We;++mt)x[Ce+mt]=x[Ce+mt-yt];for(Ce+=We,Q+=We;Q>=D;)Q-=D,++Y,G!=null&&Y<=H&&!(Y%16)&&G(f,Y);if(e(Ce<=V),Q&_e&&(ze=Kr(ve,Q,Y)),ye!=null)for(;Pe<Ce;)We=x[Pe++],ye.X[(506832829*We&4294967295)>>>ye.Mb]=We}else{if(!(We<He))break e;for(Ye=We-280,e(ye!=null);Pe<Ce;)We=x[Pe++],ye.X[(506832829*We&4294967295)>>>ye.Mb]=We;We=Ce,e(!(Ye>>>(yt=ye).Xa)),x[We]=yt.X[Ye],Ye=!0}Ye||e(ae.h==M(ae))}if(f.Pb&&ae.h&&Ce<V)e(f.m.h),f.a=5,f.m=f.wd,f.$=f.xd,0<f.s.ua&&Fe(f.s.vb,f.s.Wa);else{if(ae.h)break e;G!=null&&G(f,Y>H?H:Y),f.a=0,f.$=Ce-b}return 1}return f.a=3,0}function Te(f){e(f!=null),f.vc=null,f.yc=null,f.Ya=null;var x=f.Wa;x!=null&&(x.X=null),f.vb=null,e(f!=null)}function je(){var f=new pl;return f==null?null:(f.a=0,f.xb=cg,Pa("Predictor","VP8LPredictors"),Pa("Predictor","VP8LPredictors_C"),Pa("PredictorAdd","VP8LPredictorsAdd"),Pa("PredictorAdd","VP8LPredictorsAdd_C"),u0=It,fc=Nt,ja=tt,ba=sr,mo=Ct,ki=rn,Ii=cr,N.VP8LMapColor32b=wl,N.VP8LMapColor8b=f0,f)}function ke(f,x,b,D,V){var H=1,G=[f],Y=[x],Q=D.m,ae=D.s,ve=null,Ce=0;e:for(;;){if(b)for(;H&&we(Q,1);){var Pe=G,Ne=Y,He=D,Be=1,ye=He.m,_e=He.gc[He.ab],ze=we(ye,2);if(He.Oc&1<<ze)H=0;else{switch(He.Oc|=1<<ze,_e.hc=ze,_e.Ea=Pe[0],_e.nc=Ne[0],_e.K=[null],++He.ab,e(4>=He.ab),ze){case 0:case 1:_e.b=we(ye,3)+2,Be=ke(lt(_e.Ea,_e.b),lt(_e.nc,_e.b),0,He,_e.K),_e.K=_e.K[0];break;case 3:var Ye,We=we(ye,8)+1,yt=16<We?0:4<We?1:2<We?2:3;if(Pe[0]=lt(_e.Ea,yt),_e.b=yt,Ye=Be=ke(We,1,0,He,_e.K)){var mt,Lt=We,xt=_e,vr=1<<(8>>xt.b),br=s(vr);if(br==null)Ye=0;else{var dr=xt.K[0],ar=xt.w;for(br[0]=xt.K[0][0],mt=1;mt<1*Lt;++mt)br[mt]=$e(dr[ar+mt],br[mt-1]);for(;mt<4*vr;++mt)br[mt]=0;xt.K[0]=null,xt.K[0]=br,Ye=1}}Be=Ye;break;case 2:break;default:e(0)}H=Be}}if(G=G[0],Y=Y[0],H&&we(Q,1)&&!(H=1<=(Ce=we(Q,4))&&11>=Ce)){D.a=3;break e}var Mr;if(Mr=H)t:{var Rr,Yt,bn,Oa=D,En=G,Ma=Y,Er=Ce,Qa=b,Za=Oa.m,jn=Oa.s,Kn=[null],Sa=1,gs=0,ai=Xb[Er];r:for(;;){if(Qa&&we(Za,1)){var On=we(Za,3)+2,Ri=lt(En,On),xc=lt(Ma,On),Al=Ri*xc;if(!ke(Ri,xc,0,Oa,Kn))break r;for(Kn=Kn[0],jn.xc=On,Rr=0;Rr<Al;++Rr){var yo=Kn[Rr]>>8&65535;Kn[Rr]=yo,yo>=Sa&&(Sa=yo+1)}}if(Za.h)break r;for(Yt=0;5>Yt;++Yt){var on=ig[Yt];!Yt&&0<Er&&(on+=1<<Er),gs<on&&(gs=on)}var Vd=i(Sa*ai,A),xg=Sa,vg=i(xg,J);if(vg==null)var S0=null;else e(65536>=xg),S0=vg;var Mu=s(gs);if(S0==null||Mu==null||Vd==null){Oa.a=1;break r}var A0=Vd;for(Rr=bn=0;Rr<Sa;++Rr){var Bs=S0[Rr],Nl=Bs.G,Tl=Bs.H,yg=0,N0=1,wg=0;for(Yt=0;5>Yt;++Yt){on=ig[Yt],Nl[Yt]=A0,Tl[Yt]=bn,!Yt&&0<Er&&(on+=1<<Er);a:{var T0,Ud=on,k0=Oa,Bu=Mu,g4=A0,x4=bn,qd=0,wo=k0.m,v4=we(wo,1);if(a(Bu,0,0,Ud),v4){var y4=we(wo,1)+1,w4=we(wo,1),_g=we(wo,w4==0?1:8);Bu[_g]=1,y4==2&&(Bu[_g=we(wo,8)]=1);var I0=1}else{var bg=s(19),Eg=we(wo,4)+4;if(19<Eg){k0.a=3;var C0=0;break a}for(T0=0;T0<Eg;++T0)bg[$b[T0]]=we(wo,3);var zd=void 0,Vu=void 0,Sg=k0,_4=bg,P0=Ud,Ag=Bu,Wd=0,_o=Sg.m,Ng=8,Tg=i(128,A);n:for(;S(Tg,0,7,_4,19);){if(we(_o,1)){var b4=2+2*we(_o,3);if((zd=2+we(_o,b4))>P0)break n}else zd=P0;for(Vu=0;Vu<P0&&zd--;){ee(_o);var kg=Tg[0+(127&O(_o))];U(_o,_o.u+kg.g);var kl=kg.value;if(16>kl)Ag[Vu++]=kl,kl!=0&&(Ng=kl);else{var E4=kl==16,Ig=kl-16,S4=Hb[Ig],Cg=we(_o,Wb[Ig])+S4;if(Vu+Cg>P0)break n;for(var A4=E4?Ng:0;0<Cg--;)Ag[Vu++]=A4}}Wd=1;break n}Wd||(Sg.a=3),I0=Wd}(I0=I0&&!wo.h)&&(qd=S(g4,x4,8,Bu,Ud)),I0&&qd!=0?C0=qd:(k0.a=3,C0=0)}if(C0==0)break r;if(N0&&Gb[Yt]==1&&(N0=A0[bn].g==0),yg+=A0[bn].g,bn+=C0,3>=Yt){var Uu,Hd=Mu[0];for(Uu=1;Uu<on;++Uu)Mu[Uu]>Hd&&(Hd=Mu[Uu]);wg+=Hd}}if(Bs.nd=N0,Bs.Qb=0,N0&&(Bs.qb=(Nl[3][Tl[3]+0].value<<24|Nl[1][Tl[1]+0].value<<16|Nl[2][Tl[2]+0].value)>>>0,yg==0&&256>Nl[0][Tl[0]+0].value&&(Bs.Qb=1,Bs.qb+=Nl[0][Tl[0]+0].value<<8)),Bs.jc=!Bs.Qb&&6>wg,Bs.jc){var F0,Di=Bs;for(F0=0;F0<$n;++F0){var bo=F0,Eo=Di.pd[bo],R0=Di.G[0][Di.H[0]+bo];256<=R0.value?(Eo.g=R0.g+256,Eo.value=R0.value):(Eo.g=0,Eo.value=0,bo>>=Jr(R0,8,Eo),bo>>=Jr(Di.G[1][Di.H[1]+bo],16,Eo),bo>>=Jr(Di.G[2][Di.H[2]+bo],0,Eo),Jr(Di.G[3][Di.H[3]+bo],24,Eo))}}}jn.vc=Kn,jn.Wb=Sa,jn.Ya=S0,jn.yc=Vd,Mr=1;break t}Mr=0}if(!(H=Mr)){D.a=3;break e}if(0<Ce){if(ae.ua=1<<Ce,!st(ae.Wa,Ce)){D.a=1,H=0;break e}}else ae.ua=0;var Gd=D,Pg=G,N4=Y,$d=Gd.s,Kd=$d.xc;if(Gd.c=Pg,Gd.i=N4,$d.md=lt(Pg,Kd),$d.wc=Kd==0?-1:(1<<Kd)-1,b){D.xb=n4;break e}if((ve=s(G*Y))==null){D.a=1,H=0;break e}H=(H=ce(D,ve,0,G,Y,Y,null))&&!Q.h;break e}return H?(V!=null?V[0]=ve:(e(ve==null),e(b)),D.$=0,b||Te(ae)):Te(ae),H}function Ie(f,x){var b=f.c*f.i,D=b+x+16*x;return e(f.c<=x),f.V=s(D),f.V==null?(f.Ta=null,f.Ua=0,f.a=1,0):(f.Ta=f.V,f.Ua=f.Ba+b+x,1)}function Le(f,x){var b=f.C,D=x-b,V=f.V,H=f.Ba+f.c*b;for(e(x<=f.l.o);0<D;){var G=16<D?16:D,Y=f.l.ma,Q=f.l.width,ae=Q*G,ve=Y.ca,Ce=Y.tb+Q*b,Pe=f.Ta,Ne=f.Ua;W(f,G,V,H),mn(Pe,Ne,ve,Ce,ae),re(Y,b,b+G,ve,Ce,Q),D-=G,V+=G*f.c,b+=G}e(b==x),f.C=f.Ma=x}function Je(){this.ub=this.yd=this.td=this.Rb=0}function it(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function gt(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function nt(){this.Yb=function(){var f=[];return function x(b,D,V){for(var H=V[D],G=0;G<H&&(b.push(V.length>D+1?[]:0),!(V.length<D+1));G++)x(b[G],D+1,V)}(f,0,[3,11]),f}()}function ft(){this.jb=s(3),this.Wc=o([4,8],nt),this.Xc=o([4,17],nt)}function Ot(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function lr(){this.ld=this.La=this.dd=this.tc=0}function ur(){this.Na=this.la=0}function Fr(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function wa(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Cs(){this.uc=this.M=this.Nb=0,this.wa=Array(new lr),this.Y=0,this.ya=Array(new wa),this.aa=0,this.l=new $a}function Ga(){this.y=s(16),this.f=s(8),this.ea=s(8)}function Ra(){this.cb=this.a=0,this.sc="",this.m=new Oe,this.Od=new Je,this.Kc=new it,this.ed=new Ot,this.Qa=new gt,this.Ic=this.$c=this.Aa=0,this.D=new Cs,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=i(8,Oe),this.ia=0,this.pb=i(4,Fr),this.Pa=new ft,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Ga),this.Hd=0,this.rb=Array(new ur),this.sb=0,this.wa=Array(new lr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new wa),this.L=this.aa=0,this.gd=o([4,2],lr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function $a(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Wn(){var f=new Ra;return f!=null&&(f.a=0,f.sc="OK",f.cb=0,f.Xb=0,ju||(ju=cl)),f}function qr(f,x,b){return f.a==0&&(f.a=x,f.sc=b,f.cb=0),0}function ec(f,x,b){return 3<=b&&f[x+0]==157&&f[x+1]==1&&f[x+2]==42}function tc(f,x){if(f==null)return 0;if(f.a=0,f.sc="OK",x==null)return qr(f,2,"null VP8Io passed to VP8GetHeaders()");var b=x.data,D=x.w,V=x.ha;if(4>V)return qr(f,7,"Truncated header.");var H=b[D+0]|b[D+1]<<8|b[D+2]<<16,G=f.Od;if(G.Rb=!(1&H),G.td=H>>1&7,G.yd=H>>4&1,G.ub=H>>5,3<G.td)return qr(f,3,"Incorrect keyframe parameters.");if(!G.yd)return qr(f,4,"Frame not displayable.");D+=3,V-=3;var Y=f.Kc;if(G.Rb){if(7>V)return qr(f,7,"cannot parse picture header");if(!ec(b,D,V))return qr(f,3,"Bad code word");Y.c=16383&(b[D+4]<<8|b[D+3]),Y.Td=b[D+4]>>6,Y.i=16383&(b[D+6]<<8|b[D+5]),Y.Ud=b[D+6]>>6,D+=7,V-=7,f.za=Y.c+15>>4,f.Ub=Y.i+15>>4,x.width=Y.c,x.height=Y.i,x.Da=0,x.j=0,x.v=0,x.va=x.width,x.o=x.height,x.da=0,x.ib=x.width,x.hb=x.height,x.U=x.width,x.T=x.height,a((H=f.Pa).jb,0,255,H.jb.length),e((H=f.Qa)!=null),H.Cb=0,H.Bb=0,H.Fb=1,a(H.Zb,0,0,H.Zb.length),a(H.Lb,0,0,H.Lb)}if(G.ub>V)return qr(f,7,"bad partition length");ue(H=f.m,b,D,G.ub),D+=G.ub,V-=G.ub,G.Rb&&(Y.Ld=de(H),Y.Kd=de(H)),Y=f.Qa;var Q,ae=f.Pa;if(e(H!=null),e(Y!=null),Y.Cb=de(H),Y.Cb){if(Y.Bb=de(H),de(H)){for(Y.Fb=de(H),Q=0;4>Q;++Q)Y.Zb[Q]=de(H)?pe(H,7):0;for(Q=0;4>Q;++Q)Y.Lb[Q]=de(H)?pe(H,6):0}if(Y.Bb)for(Q=0;3>Q;++Q)ae.jb[Q]=de(H)?me(H,8):255}else Y.Bb=0;if(H.Ka)return qr(f,3,"cannot parse segment header");if((Y=f.ed).zd=de(H),Y.Tb=me(H,6),Y.wb=me(H,3),Y.Pc=de(H),Y.Pc&&de(H)){for(ae=0;4>ae;++ae)de(H)&&(Y.vd[ae]=pe(H,6));for(ae=0;4>ae;++ae)de(H)&&(Y.od[ae]=pe(H,6))}if(f.L=Y.Tb==0?0:Y.zd?1:2,H.Ka)return qr(f,3,"cannot parse filter header");var ve=V;if(V=Q=D,D=Q+ve,Y=ve,f.Xb=(1<<me(f.m,2))-1,ve<3*(ae=f.Xb))b=7;else{for(Q+=3*ae,Y-=3*ae,ve=0;ve<ae;++ve){var Ce=b[V+0]|b[V+1]<<8|b[V+2]<<16;Ce>Y&&(Ce=Y),ue(f.Jc[+ve],b,Q,Ce),Q+=Ce,Y-=Ce,V+=3}ue(f.Jc[+ae],b,Q,Y),b=Q<D?0:5}if(b!=0)return qr(f,b,"cannot parse partitions");for(b=me(Q=f.m,7),V=de(Q)?pe(Q,4):0,D=de(Q)?pe(Q,4):0,Y=de(Q)?pe(Q,4):0,ae=de(Q)?pe(Q,4):0,Q=de(Q)?pe(Q,4):0,ve=f.Qa,Ce=0;4>Ce;++Ce){if(ve.Cb){var Pe=ve.Zb[Ce];ve.Fb||(Pe+=b)}else{if(0<Ce){f.pb[Ce]=f.pb[0];continue}Pe=b}var Ne=f.pb[Ce];Ne.Sc[0]=Od[wr(Pe+V,127)],Ne.Sc[1]=Md[wr(Pe+0,127)],Ne.Eb[0]=2*Od[wr(Pe+D,127)],Ne.Eb[1]=101581*Md[wr(Pe+Y,127)]>>16,8>Ne.Eb[1]&&(Ne.Eb[1]=8),Ne.Qc[0]=Od[wr(Pe+ae,117)],Ne.Qc[1]=Md[wr(Pe+Q,127)],Ne.lc=Pe+Q}if(!G.Rb)return qr(f,4,"Not a key frame.");for(de(H),G=f.Pa,b=0;4>b;++b){for(V=0;8>V;++V)for(D=0;3>D;++D)for(Y=0;11>Y;++Y)ae=fe(H,t4[b][V][D][Y])?me(H,8):Zb[b][V][D][Y],G.Wc[b][V].Yb[D][Y]=ae;for(V=0;17>V;++V)G.Xc[b][V]=G.Wc[b][r4[V]]}return f.kc=de(H),f.kc&&(f.Bd=me(H,8)),f.cb=1}function cl(f,x,b,D,V,H,G){var Y=x[V].Yb[b];for(b=0;16>V;++V){if(!fe(f,Y[b+0]))return V;for(;!fe(f,Y[b+1]);)if(Y=x[++V].Yb[0],b=0,V==16)return 16;var Q=x[V+1].Yb;if(fe(f,Y[b+2])){var ae=f,ve=0;if(fe(ae,(Pe=Y)[(Ce=b)+3]))if(fe(ae,Pe[Ce+6])){for(Y=0,Ce=2*(ve=fe(ae,Pe[Ce+8]))+(Pe=fe(ae,Pe[Ce+9+ve])),ve=0,Pe=Jb[Ce];Pe[Y];++Y)ve+=ve+fe(ae,Pe[Y]);ve+=3+(8<<Ce)}else fe(ae,Pe[Ce+7])?(ve=7+2*fe(ae,165),ve+=fe(ae,145)):ve=5+fe(ae,159);else ve=fe(ae,Pe[Ce+4])?3+fe(ae,Pe[Ce+5]):2;Y=Q[2]}else ve=1,Y=Q[1];Q=G+Qb[V],0>(ae=f).b&&he(ae);var Ce,Pe=ae.b,Ne=(Ce=ae.Ca>>1)-(ae.I>>Pe)>>31;--ae.b,ae.Ca+=Ne,ae.Ca|=1,ae.I-=(Ce+1&Ne)<<Pe,H[Q]=((ve^Ne)-Ne)*D[(0<V)+0]}return 16}function rc(f){var x=f.rb[f.sb-1];x.la=0,x.Na=0,a(f.zc,0,0,f.zc.length),f.ja=0}function ll(f,x){if(f==null)return 0;if(x==null)return qr(f,2,"NULL VP8Io parameter in VP8Decode().");if(!f.cb&&!tc(f,x))return 0;if(e(f.cb),x.ac==null||x.ac(x)){x.ob&&(f.L=0);var b=E0[f.L];if(f.L==2?(f.yb=0,f.zb=0):(f.yb=x.v-b>>4,f.zb=x.j-b>>4,0>f.yb&&(f.yb=0),0>f.zb&&(f.zb=0)),f.Va=x.o+15+b>>4,f.Hb=x.va+15+b>>4,f.Hb>f.za&&(f.Hb=f.za),f.Va>f.Ub&&(f.Va=f.Ub),0<f.L){var D=f.ed;for(b=0;4>b;++b){var V;if(f.Qa.Cb){var H=f.Qa.Lb[b];f.Qa.Fb||(H+=D.Tb)}else H=D.Tb;for(V=0;1>=V;++V){var G=f.gd[b][V],Y=H;if(D.Pc&&(Y+=D.vd[0],V&&(Y+=D.od[0])),0<(Y=0>Y?0:63<Y?63:Y)){var Q=Y;0<D.wb&&(Q=4<D.wb?Q>>2:Q>>1)>9-D.wb&&(Q=9-D.wb),1>Q&&(Q=1),G.dd=Q,G.tc=2*Y+Q,G.ld=40<=Y?2:15<=Y?1:0}else G.tc=0;G.La=V}}}b=0}else qr(f,6,"Frame setup failed"),b=f.a;if(b=b==0){if(b){f.$c=0,0<f.Aa||(f.Ic=p4);e:{b=f.Ic,D=4*(Q=f.za);var ae=32*Q,ve=Q+1,Ce=0<f.L?Q*(0<f.Aa?2:1):0,Pe=(f.Aa==2?2:1)*Q;if((G=D+832+(V=3*(16*b+E0[f.L])/2*ae)+(H=f.Fa!=null&&0<f.Fa.length?f.Kc.c*f.Kc.i:0))!=G)b=0;else{if(G>f.Vb){if(f.Vb=0,f.Ec=s(G),f.Fc=0,f.Ec==null){b=qr(f,1,"no memory during frame initialization.");break e}f.Vb=G}G=f.Ec,Y=f.Fc,f.Ac=G,f.Bc=Y,Y+=D,f.Gd=i(ae,Ga),f.Hd=0,f.rb=i(ve+1,ur),f.sb=1,f.wa=Ce?i(Ce,lr):null,f.Y=0,f.D.Nb=0,f.D.wa=f.wa,f.D.Y=f.Y,0<f.Aa&&(f.D.Y+=Q),e(!0),f.oc=G,f.pc=Y,Y+=832,f.ya=i(Pe,wa),f.aa=0,f.D.ya=f.ya,f.D.aa=f.aa,f.Aa==2&&(f.D.aa+=Q),f.R=16*Q,f.B=8*Q,Q=(ae=E0[f.L])*f.R,ae=ae/2*f.B,f.sa=G,f.ta=Y+Q,f.qa=f.sa,f.ra=f.ta+16*b*f.R+ae,f.Ha=f.qa,f.Ia=f.ra+8*b*f.B+ae,f.$c=0,Y+=V,f.mb=H?G:null,f.nb=H?Y:null,e(Y+H<=f.Fc+f.Vb),rc(f),a(f.Ac,f.Bc,0,D),b=1}}if(b){if(x.ka=0,x.y=f.sa,x.O=f.ta,x.f=f.qa,x.N=f.ra,x.ea=f.Ha,x.Vd=f.Ia,x.fa=f.R,x.Rc=f.B,x.F=null,x.J=0,!m0){for(b=-255;255>=b;++b)Pn[255+b]=0>b?-b:b;for(b=-1020;1020>=b;++b)Pi[1020+b]=-128>b?-128:127<b?127:b;for(b=-112;112>=b;++b)Lu[112+b]=-16>b?-16:15<b?15:b;for(b=-255;510>=b;++b)Sl[255+b]=0>b?0:255<b?255:b;m0=1}_l=Ei,Ci=Ji,Fu=nc,Ea=_r,hs=bi,dn=_i,bl=ao,d0=Ls,Ru=io,dc=hc,mc=so,po=Ai,pc=oo,El=ei,gc=Si,go=Ya,Du=Cn,fs=ml,Ms[0]=ls,Ms[1]=Au,Ms[2]=Qs,Ms[3]=Tu,Ms[4]=fl,Ms[5]=eo,Ms[6]=Ka,Ms[7]=sc,Ms[8]=ro,Ms[9]=to,xo[0]=Js,xo[1]=Nu,xo[2]=Fs,xo[3]=Qi,xo[4]=zr,xo[5]=hl,xo[6]=ac,Fi[0]=Ds,Fi[1]=ul,Fi[2]=dl,Fi[3]=Rs,Fi[4]=yr,Fi[5]=ic,Fi[6]=oc,b=1}else b=0}b&&(b=function(Ne,He){for(Ne.M=0;Ne.M<Ne.Va;++Ne.M){var Be,ye=Ne.Jc[Ne.M&Ne.Xb],_e=Ne.m,ze=Ne;for(Be=0;Be<ze.za;++Be){var Ye=_e,We=ze,yt=We.Ac,mt=We.Bc+4*Be,Lt=We.zc,xt=We.ya[We.aa+Be];if(We.Qa.Bb?xt.$b=fe(Ye,We.Pa.jb[0])?2+fe(Ye,We.Pa.jb[2]):fe(Ye,We.Pa.jb[1]):xt.$b=0,We.kc&&(xt.Ad=fe(Ye,We.Bd)),xt.Za=!fe(Ye,145)+0,xt.Za){var vr=xt.Ob,br=0;for(We=0;4>We;++We){var dr,ar=Lt[0+We];for(dr=0;4>dr;++dr){ar=e4[yt[mt+dr]][ar];for(var Mr=og[fe(Ye,ar[0])];0<Mr;)Mr=og[2*Mr+fe(Ye,ar[Mr])];ar=-Mr,yt[mt+dr]=ar}n(vr,br,yt,mt,4),br+=4,Lt[0+We]=ar}}else ar=fe(Ye,156)?fe(Ye,128)?1:3:fe(Ye,163)?2:0,xt.Ob[0]=ar,a(yt,mt,ar,4),a(Lt,0,ar,4);xt.Dd=fe(Ye,142)?fe(Ye,114)?fe(Ye,183)?1:3:2:0}if(ze.m.Ka)return qr(Ne,7,"Premature end-of-partition0 encountered.");for(;Ne.ja<Ne.za;++Ne.ja){if(ze=ye,Ye=(_e=Ne).rb[_e.sb-1],yt=_e.rb[_e.sb+_e.ja],Be=_e.ya[_e.aa+_e.ja],mt=_e.kc?Be.Ad:0)Ye.la=yt.la=0,Be.Za||(Ye.Na=yt.Na=0),Be.Hc=0,Be.Gc=0,Be.ia=0;else{var Rr,Yt;if(Ye=yt,yt=ze,mt=_e.Pa.Xc,Lt=_e.ya[_e.aa+_e.ja],xt=_e.pb[Lt.$b],We=Lt.ad,vr=0,br=_e.rb[_e.sb-1],ar=dr=0,a(We,vr,0,384),Lt.Za)var bn=0,Oa=mt[3];else{Mr=s(16);var En=Ye.Na+br.Na;if(En=ju(yt,mt[1],En,xt.Eb,0,Mr,0),Ye.Na=br.Na=(0<En)+0,1<En)_l(Mr,0,We,vr);else{var Ma=Mr[0]+3>>3;for(Mr=0;256>Mr;Mr+=16)We[vr+Mr]=Ma}bn=1,Oa=mt[0]}var Er=15&Ye.la,Qa=15&br.la;for(Mr=0;4>Mr;++Mr){var Za=1&Qa;for(Ma=Yt=0;4>Ma;++Ma)Er=Er>>1|(Za=(En=ju(yt,Oa,En=Za+(1&Er),xt.Sc,bn,We,vr))>bn)<<7,Yt=Yt<<2|(3<En?3:1<En?2:We[vr+0]!=0),vr+=16;Er>>=4,Qa=Qa>>1|Za<<7,dr=(dr<<8|Yt)>>>0}for(Oa=Er,bn=Qa>>4,Rr=0;4>Rr;Rr+=2){for(Yt=0,Er=Ye.la>>4+Rr,Qa=br.la>>4+Rr,Mr=0;2>Mr;++Mr){for(Za=1&Qa,Ma=0;2>Ma;++Ma)En=Za+(1&Er),Er=Er>>1|(Za=0<(En=ju(yt,mt[2],En,xt.Qc,0,We,vr)))<<3,Yt=Yt<<2|(3<En?3:1<En?2:We[vr+0]!=0),vr+=16;Er>>=2,Qa=Qa>>1|Za<<5}ar|=Yt<<4*Rr,Oa|=Er<<4<<Rr,bn|=(240&Qa)<<Rr}Ye.la=Oa,br.la=bn,Lt.Hc=dr,Lt.Gc=ar,Lt.ia=43690&ar?0:xt.ia,mt=!(dr|ar)}if(0<_e.L&&(_e.wa[_e.Y+_e.ja]=_e.gd[Be.$b][Be.Za],_e.wa[_e.Y+_e.ja].La|=!mt),ze.Ka)return qr(Ne,7,"Premature end-of-file encountered.")}if(rc(Ne),_e=He,ze=1,Be=(ye=Ne).D,Ye=0<ye.L&&ye.M>=ye.zb&&ye.M<=ye.Va,ye.Aa==0)e:{if(Be.M=ye.M,Be.uc=Ye,ri(ye,Be),ze=1,Be=(Yt=ye.D).Nb,Ye=(ar=E0[ye.L])*ye.R,yt=ar/2*ye.B,Mr=16*Be*ye.R,Ma=8*Be*ye.B,mt=ye.sa,Lt=ye.ta-Ye+Mr,xt=ye.qa,We=ye.ra-yt+Ma,vr=ye.Ha,br=ye.Ia-yt+Ma,Qa=(Er=Yt.M)==0,dr=Er>=ye.Va-1,ye.Aa==2&&ri(ye,Yt),Yt.uc)for(Za=(En=ye).D.M,e(En.D.uc),Yt=En.yb;Yt<En.Hb;++Yt){bn=Yt,Oa=Za;var jn=(Kn=(on=En).D).Nb;Rr=on.R;var Kn=Kn.wa[Kn.Y+bn],Sa=on.sa,gs=on.ta+16*jn*Rr+16*bn,ai=Kn.dd,On=Kn.tc;if(On!=0)if(e(3<=On),on.L==1)0<bn&&go(Sa,gs,Rr,On+4),Kn.La&&fs(Sa,gs,Rr,On),0<Oa&&gc(Sa,gs,Rr,On+4),Kn.La&&Du(Sa,gs,Rr,On);else{var Ri=on.B,xc=on.qa,Al=on.ra+8*jn*Ri+8*bn,yo=on.Ha,on=on.Ia+8*jn*Ri+8*bn;jn=Kn.ld,0<bn&&(d0(Sa,gs,Rr,On+4,ai,jn),dc(xc,Al,yo,on,Ri,On+4,ai,jn)),Kn.La&&(po(Sa,gs,Rr,On,ai,jn),El(xc,Al,yo,on,Ri,On,ai,jn)),0<Oa&&(bl(Sa,gs,Rr,On+4,ai,jn),Ru(xc,Al,yo,on,Ri,On+4,ai,jn)),Kn.La&&(mc(Sa,gs,Rr,On,ai,jn),pc(xc,Al,yo,on,Ri,On,ai,jn))}}if(ye.ia&&alert("todo:DitherRow"),_e.put!=null){if(Yt=16*Er,Er=16*(Er+1),Qa?(_e.y=ye.sa,_e.O=ye.ta+Mr,_e.f=ye.qa,_e.N=ye.ra+Ma,_e.ea=ye.Ha,_e.W=ye.Ia+Ma):(Yt-=ar,_e.y=mt,_e.O=Lt,_e.f=xt,_e.N=We,_e.ea=vr,_e.W=br),dr||(Er-=ar),Er>_e.o&&(Er=_e.o),_e.F=null,_e.J=null,ye.Fa!=null&&0<ye.Fa.length&&Yt<Er&&(_e.J=ho(ye,_e,Yt,Er-Yt),_e.F=ye.mb,_e.F==null&&_e.F.length==0)){ze=qr(ye,3,"Could not decode alpha data.");break e}Yt<_e.j&&(ar=_e.j-Yt,Yt=_e.j,e(!(1&ar)),_e.O+=ye.R*ar,_e.N+=ye.B*(ar>>1),_e.W+=ye.B*(ar>>1),_e.F!=null&&(_e.J+=_e.width*ar)),Yt<Er&&(_e.O+=_e.v,_e.N+=_e.v>>1,_e.W+=_e.v>>1,_e.F!=null&&(_e.J+=_e.v),_e.ka=Yt-_e.j,_e.U=_e.va-_e.v,_e.T=Er-Yt,ze=_e.put(_e))}Be+1!=ye.Ic||dr||(n(ye.sa,ye.ta-Ye,mt,Lt+16*ye.R,Ye),n(ye.qa,ye.ra-yt,xt,We+8*ye.B,yt),n(ye.Ha,ye.Ia-yt,vr,br+8*ye.B,yt))}if(!ze)return qr(Ne,6,"Output aborted.")}return 1}(f,x)),x.bc!=null&&x.bc(x),b&=1}return b?(f.cb=0,b):0}function Da(f,x,b,D,V){V=f[x+b+32*D]+(V>>3),f[x+b+32*D]=-256&V?0>V?0:255:V}function Yi(f,x,b,D,V,H){Da(f,x,0,b,D+V),Da(f,x,1,b,D+H),Da(f,x,2,b,D-H),Da(f,x,3,b,D-V)}function sn(f){return(20091*f>>16)+f}function _a(f,x,b,D){var V,H=0,G=s(16);for(V=0;4>V;++V){var Y=f[x+0]+f[x+8],Q=f[x+0]-f[x+8],ae=(35468*f[x+4]>>16)-sn(f[x+12]),ve=sn(f[x+4])+(35468*f[x+12]>>16);G[H+0]=Y+ve,G[H+1]=Q+ae,G[H+2]=Q-ae,G[H+3]=Y-ve,H+=4,x++}for(V=H=0;4>V;++V)Y=(f=G[H+0]+4)+G[H+8],Q=f-G[H+8],ae=(35468*G[H+4]>>16)-sn(G[H+12]),Da(b,D,0,0,Y+(ve=sn(G[H+4])+(35468*G[H+12]>>16))),Da(b,D,1,0,Q+ae),Da(b,D,2,0,Q-ae),Da(b,D,3,0,Y-ve),H++,D+=32}function _i(f,x,b,D){var V=f[x+0]+4,H=35468*f[x+4]>>16,G=sn(f[x+4]),Y=35468*f[x+1]>>16;Yi(b,D,0,V+G,f=sn(f[x+1]),Y),Yi(b,D,1,V+H,f,Y),Yi(b,D,2,V-H,f,Y),Yi(b,D,3,V-G,f,Y)}function Ji(f,x,b,D,V){_a(f,x,b,D),V&&_a(f,x+16,b,D+4)}function nc(f,x,b,D){Ci(f,x+0,b,D,1),Ci(f,x+32,b,D+128,1)}function _r(f,x,b,D){var V;for(f=f[x+0]+4,V=0;4>V;++V)for(x=0;4>x;++x)Da(b,D,x,V,f)}function bi(f,x,b,D){f[x+0]&&Ea(f,x+0,b,D),f[x+16]&&Ea(f,x+16,b,D+4),f[x+32]&&Ea(f,x+32,b,D+128),f[x+48]&&Ea(f,x+48,b,D+128+4)}function Ei(f,x,b,D){var V,H=s(16);for(V=0;4>V;++V){var G=f[x+0+V]+f[x+12+V],Y=f[x+4+V]+f[x+8+V],Q=f[x+4+V]-f[x+8+V],ae=f[x+0+V]-f[x+12+V];H[0+V]=G+Y,H[8+V]=G-Y,H[4+V]=ae+Q,H[12+V]=ae-Q}for(V=0;4>V;++V)G=(f=H[0+4*V]+3)+H[3+4*V],Y=H[1+4*V]+H[2+4*V],Q=H[1+4*V]-H[2+4*V],ae=f-H[3+4*V],b[D+0]=G+Y>>3,b[D+16]=ae+Q>>3,b[D+32]=G-Y>>3,b[D+48]=ae-Q>>3,D+=64}function Ps(f,x,b){var D,V=x-32,H=Ja,G=255-f[V-1];for(D=0;D<b;++D){var Y,Q=H,ae=G+f[x-1];for(Y=0;Y<b;++Y)f[x+Y]=Q[ae+f[V+Y]];x+=32}}function Au(f,x){Ps(f,x,4)}function ul(f,x){Ps(f,x,8)}function Nu(f,x){Ps(f,x,16)}function Fs(f,x){var b;for(b=0;16>b;++b)n(f,x+32*b,f,x-32,16)}function Qi(f,x){var b;for(b=16;0<b;--b)a(f,x,f[x-1],16),x+=32}function Zi(f,x,b){var D;for(D=0;16>D;++D)a(x,b+32*D,f,16)}function Js(f,x){var b,D=16;for(b=0;16>b;++b)D+=f[x-1+32*b]+f[x+b-32];Zi(D>>5,f,x)}function zr(f,x){var b,D=8;for(b=0;16>b;++b)D+=f[x-1+32*b];Zi(D>>4,f,x)}function hl(f,x){var b,D=8;for(b=0;16>b;++b)D+=f[x+b-32];Zi(D>>4,f,x)}function ac(f,x){Zi(128,f,x)}function zt(f,x,b){return f+2*x+b+2>>2}function Qs(f,x){var b,D=x-32;for(D=new Uint8Array([zt(f[D-1],f[D+0],f[D+1]),zt(f[D+0],f[D+1],f[D+2]),zt(f[D+1],f[D+2],f[D+3]),zt(f[D+2],f[D+3],f[D+4])]),b=0;4>b;++b)n(f,x+32*b,D,0,D.length)}function Tu(f,x){var b=f[x-1],D=f[x-1+32],V=f[x-1+64],H=f[x-1+96];be(f,x+0,16843009*zt(f[x-1-32],b,D)),be(f,x+32,16843009*zt(b,D,V)),be(f,x+64,16843009*zt(D,V,H)),be(f,x+96,16843009*zt(V,H,H))}function ls(f,x){var b,D=4;for(b=0;4>b;++b)D+=f[x+b-32]+f[x-1+32*b];for(D>>=3,b=0;4>b;++b)a(f,x+32*b,D,4)}function fl(f,x){var b=f[x-1+0],D=f[x-1+32],V=f[x-1+64],H=f[x-1-32],G=f[x+0-32],Y=f[x+1-32],Q=f[x+2-32],ae=f[x+3-32];f[x+0+96]=zt(D,V,f[x-1+96]),f[x+1+96]=f[x+0+64]=zt(b,D,V),f[x+2+96]=f[x+1+64]=f[x+0+32]=zt(H,b,D),f[x+3+96]=f[x+2+64]=f[x+1+32]=f[x+0+0]=zt(G,H,b),f[x+3+64]=f[x+2+32]=f[x+1+0]=zt(Y,G,H),f[x+3+32]=f[x+2+0]=zt(Q,Y,G),f[x+3+0]=zt(ae,Q,Y)}function Ka(f,x){var b=f[x+1-32],D=f[x+2-32],V=f[x+3-32],H=f[x+4-32],G=f[x+5-32],Y=f[x+6-32],Q=f[x+7-32];f[x+0+0]=zt(f[x+0-32],b,D),f[x+1+0]=f[x+0+32]=zt(b,D,V),f[x+2+0]=f[x+1+32]=f[x+0+64]=zt(D,V,H),f[x+3+0]=f[x+2+32]=f[x+1+64]=f[x+0+96]=zt(V,H,G),f[x+3+32]=f[x+2+64]=f[x+1+96]=zt(H,G,Y),f[x+3+64]=f[x+2+96]=zt(G,Y,Q),f[x+3+96]=zt(Y,Q,Q)}function eo(f,x){var b=f[x-1+0],D=f[x-1+32],V=f[x-1+64],H=f[x-1-32],G=f[x+0-32],Y=f[x+1-32],Q=f[x+2-32],ae=f[x+3-32];f[x+0+0]=f[x+1+64]=H+G+1>>1,f[x+1+0]=f[x+2+64]=G+Y+1>>1,f[x+2+0]=f[x+3+64]=Y+Q+1>>1,f[x+3+0]=Q+ae+1>>1,f[x+0+96]=zt(V,D,b),f[x+0+64]=zt(D,b,H),f[x+0+32]=f[x+1+96]=zt(b,H,G),f[x+1+32]=f[x+2+96]=zt(H,G,Y),f[x+2+32]=f[x+3+96]=zt(G,Y,Q),f[x+3+32]=zt(Y,Q,ae)}function sc(f,x){var b=f[x+0-32],D=f[x+1-32],V=f[x+2-32],H=f[x+3-32],G=f[x+4-32],Y=f[x+5-32],Q=f[x+6-32],ae=f[x+7-32];f[x+0+0]=b+D+1>>1,f[x+1+0]=f[x+0+64]=D+V+1>>1,f[x+2+0]=f[x+1+64]=V+H+1>>1,f[x+3+0]=f[x+2+64]=H+G+1>>1,f[x+0+32]=zt(b,D,V),f[x+1+32]=f[x+0+96]=zt(D,V,H),f[x+2+32]=f[x+1+96]=zt(V,H,G),f[x+3+32]=f[x+2+96]=zt(H,G,Y),f[x+3+64]=zt(G,Y,Q),f[x+3+96]=zt(Y,Q,ae)}function to(f,x){var b=f[x-1+0],D=f[x-1+32],V=f[x-1+64],H=f[x-1+96];f[x+0+0]=b+D+1>>1,f[x+2+0]=f[x+0+32]=D+V+1>>1,f[x+2+32]=f[x+0+64]=V+H+1>>1,f[x+1+0]=zt(b,D,V),f[x+3+0]=f[x+1+32]=zt(D,V,H),f[x+3+32]=f[x+1+64]=zt(V,H,H),f[x+3+64]=f[x+2+64]=f[x+0+96]=f[x+1+96]=f[x+2+96]=f[x+3+96]=H}function ro(f,x){var b=f[x-1+0],D=f[x-1+32],V=f[x-1+64],H=f[x-1+96],G=f[x-1-32],Y=f[x+0-32],Q=f[x+1-32],ae=f[x+2-32];f[x+0+0]=f[x+2+32]=b+G+1>>1,f[x+0+32]=f[x+2+64]=D+b+1>>1,f[x+0+64]=f[x+2+96]=V+D+1>>1,f[x+0+96]=H+V+1>>1,f[x+3+0]=zt(Y,Q,ae),f[x+2+0]=zt(G,Y,Q),f[x+1+0]=f[x+3+32]=zt(b,G,Y),f[x+1+32]=f[x+3+64]=zt(D,b,G),f[x+1+64]=f[x+3+96]=zt(V,D,b),f[x+1+96]=zt(H,V,D)}function dl(f,x){var b;for(b=0;8>b;++b)n(f,x+32*b,f,x-32,8)}function Rs(f,x){var b;for(b=0;8>b;++b)a(f,x,f[x-1],8),x+=32}function Xa(f,x,b){var D;for(D=0;8>D;++D)a(x,b+32*D,f,8)}function Ds(f,x){var b,D=8;for(b=0;8>b;++b)D+=f[x+b-32]+f[x-1+32*b];Xa(D>>4,f,x)}function ic(f,x){var b,D=4;for(b=0;8>b;++b)D+=f[x+b-32];Xa(D>>3,f,x)}function yr(f,x){var b,D=4;for(b=0;8>b;++b)D+=f[x-1+32*b];Xa(D>>3,f,x)}function oc(f,x){Xa(128,f,x)}function no(f,x,b){var D=f[x-b],V=f[x+0],H=3*(V-D)+Fd[1020+f[x-2*b]-f[x+b]],G=p0[112+(H+4>>3)];f[x-b]=Ja[255+D+p0[112+(H+3>>3)]],f[x+0]=Ja[255+V-G]}function cc(f,x,b,D){var V=f[x+0],H=f[x+b];return ms[255+f[x-2*b]-f[x-b]]>D||ms[255+H-V]>D}function lc(f,x,b,D){return 4*ms[255+f[x-b]-f[x+0]]+ms[255+f[x-2*b]-f[x+b]]<=D}function uc(f,x,b,D,V){var H=f[x-3*b],G=f[x-2*b],Y=f[x-b],Q=f[x+0],ae=f[x+b],ve=f[x+2*b],Ce=f[x+3*b];return 4*ms[255+Y-Q]+ms[255+G-ae]>D?0:ms[255+f[x-4*b]-H]<=V&&ms[255+H-G]<=V&&ms[255+G-Y]<=V&&ms[255+Ce-ve]<=V&&ms[255+ve-ae]<=V&&ms[255+ae-Q]<=V}function Si(f,x,b,D){var V=2*D+1;for(D=0;16>D;++D)lc(f,x+D,b,V)&&no(f,x+D,b)}function Ya(f,x,b,D){var V=2*D+1;for(D=0;16>D;++D)lc(f,x+D*b,1,V)&&no(f,x+D*b,1)}function Cn(f,x,b,D){var V;for(V=3;0<V;--V)Si(f,x+=4*b,b,D)}function ml(f,x,b,D){var V;for(V=3;0<V;--V)Ya(f,x+=4,b,D)}function Zs(f,x,b,D,V,H,G,Y){for(H=2*H+1;0<V--;){if(uc(f,x,b,H,G))if(cc(f,x,b,Y))no(f,x,b);else{var Q=f,ae=x,ve=b,Ce=Q[ae-2*ve],Pe=Q[ae-ve],Ne=Q[ae+0],He=Q[ae+ve],Be=Q[ae+2*ve],ye=27*(ze=Fd[1020+3*(Ne-Pe)+Fd[1020+Ce-He]])+63>>7,_e=18*ze+63>>7,ze=9*ze+63>>7;Q[ae-3*ve]=Ja[255+Q[ae-3*ve]+ze],Q[ae-2*ve]=Ja[255+Ce+_e],Q[ae-ve]=Ja[255+Pe+ye],Q[ae+0]=Ja[255+Ne-ye],Q[ae+ve]=Ja[255+He-_e],Q[ae+2*ve]=Ja[255+Be-ze]}x+=D}}function Hn(f,x,b,D,V,H,G,Y){for(H=2*H+1;0<V--;){if(uc(f,x,b,H,G))if(cc(f,x,b,Y))no(f,x,b);else{var Q=f,ae=x,ve=b,Ce=Q[ae-ve],Pe=Q[ae+0],Ne=Q[ae+ve],He=p0[112+((Be=3*(Pe-Ce))+4>>3)],Be=p0[112+(Be+3>>3)],ye=He+1>>1;Q[ae-2*ve]=Ja[255+Q[ae-2*ve]+ye],Q[ae-ve]=Ja[255+Ce+Be],Q[ae+0]=Ja[255+Pe-He],Q[ae+ve]=Ja[255+Ne-ye]}x+=D}}function ao(f,x,b,D,V,H){Zs(f,x,b,1,16,D,V,H)}function Ls(f,x,b,D,V,H){Zs(f,x,1,b,16,D,V,H)}function so(f,x,b,D,V,H){var G;for(G=3;0<G;--G)Hn(f,x+=4*b,b,1,16,D,V,H)}function Ai(f,x,b,D,V,H){var G;for(G=3;0<G;--G)Hn(f,x+=4,1,b,16,D,V,H)}function io(f,x,b,D,V,H,G,Y){Zs(f,x,V,1,8,H,G,Y),Zs(b,D,V,1,8,H,G,Y)}function hc(f,x,b,D,V,H,G,Y){Zs(f,x,1,V,8,H,G,Y),Zs(b,D,1,V,8,H,G,Y)}function oo(f,x,b,D,V,H,G,Y){Hn(f,x+4*V,V,1,8,H,G,Y),Hn(b,D+4*V,V,1,8,H,G,Y)}function ei(f,x,b,D,V,H,G,Y){Hn(f,x+4,1,V,8,H,G,Y),Hn(b,D+4,1,V,8,H,G,Y)}function Ni(){this.ba=new In,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new xr,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function co(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Ti(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function lo(){this.ua=0,this.Wa=new se,this.vb=new se,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new J,this.yc=new A}function pl(){this.xb=this.a=0,this.l=new $a,this.ca=new In,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new k,this.Pb=0,this.wd=new k,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new lo,this.ab=0,this.gc=i(4,Ti),this.Oc=0}function js(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new $a,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function ti(f,x,b,D,V,H,G){for(f=f==null?0:f[x+0],x=0;x<G;++x)V[H+x]=f+b[D+x]&255,f=V[H+x]}function uo(f,x,b,D,V,H,G){var Y;if(f==null)ti(null,null,b,D,V,H,G);else for(Y=0;Y<G;++Y)V[H+Y]=f[x+Y]+b[D+Y]&255}function ra(f,x,b,D,V,H,G){if(f==null)ti(null,null,b,D,V,H,G);else{var Y,Q=f[x+0],ae=Q,ve=Q;for(Y=0;Y<G;++Y)ae=ve+(Q=f[x+Y])-ae,ve=b[D+Y]+(-256&ae?0>ae?0:255:ae)&255,ae=Q,V[H+Y]=ve}}function ho(f,x,b,D){var V=x.width,H=x.o;if(e(f!=null&&x!=null),0>b||0>=D||b+D>H)return null;if(!f.Cc){if(f.ga==null){var G;if(f.ga=new js,(G=f.ga==null)||(G=x.width*x.o,e(f.Gb.length==0),f.Gb=s(G),f.Uc=0,f.Gb==null?G=0:(f.mb=f.Gb,f.nb=f.Uc,f.rc=null,G=1),G=!G),!G){G=f.ga;var Y=f.Fa,Q=f.P,ae=f.qc,ve=f.mb,Ce=f.nb,Pe=Q+1,Ne=ae-1,He=G.l;if(e(Y!=null&&ve!=null&&x!=null),vo[0]=null,vo[1]=ti,vo[2]=uo,vo[3]=ra,G.ca=ve,G.tb=Ce,G.c=x.width,G.i=x.height,e(0<G.c&&0<G.i),1>=ae)x=0;else if(G.$a=Y[Q+0]>>0&3,G.Z=Y[Q+0]>>2&3,G.Lc=Y[Q+0]>>4&3,Q=Y[Q+0]>>6&3,0>G.$a||1<G.$a||4<=G.Z||1<G.Lc||Q)x=0;else if(He.put=Ln,He.ac=nn,He.bc=ya,He.ma=G,He.width=x.width,He.height=x.height,He.Da=x.Da,He.v=x.v,He.va=x.va,He.j=x.j,He.o=x.o,G.$a)e:{e(G.$a==1),x=je();t:for(;;){if(x==null){x=0;break e}if(e(G!=null),G.mc=x,x.c=G.c,x.i=G.i,x.l=G.l,x.l.ma=G,x.l.width=G.c,x.l.height=G.i,x.a=0,ge(x.m,Y,Pe,Ne),!ke(G.c,G.i,1,x,null)||(x.ab==1&&x.gc[0].hc==3&&te(x.s)?(G.ic=1,Y=x.c*x.i,x.Ta=null,x.Ua=0,x.V=s(Y),x.Ba=0,x.V==null?(x.a=1,x=0):x=1):(G.ic=0,x=Ie(x,G.c)),!x))break t;x=1;break e}G.mc=null,x=0}else x=Ne>=G.c*G.i;G=!x}if(G)return null;f.ga.Lc!=1?f.Ga=0:D=H-b}e(f.ga!=null),e(b+D<=H);e:{if(x=(Y=f.ga).c,H=Y.l.o,Y.$a==0){if(Pe=f.rc,Ne=f.Vc,He=f.Fa,Q=f.P+1+b*x,ae=f.mb,ve=f.nb+b*x,e(Q<=f.P+f.qc),Y.Z!=0)for(e(vo[Y.Z]!=null),G=0;G<D;++G)vo[Y.Z](Pe,Ne,He,Q,ae,ve,x),Pe=ae,Ne=ve,ve+=x,Q+=x;else for(G=0;G<D;++G)n(ae,ve,He,Q,x),Pe=ae,Ne=ve,ve+=x,Q+=x;f.rc=Pe,f.Vc=Ne}else{if(e(Y.mc!=null),x=b+D,e((G=Y.mc)!=null),e(x<=G.i),G.C>=x)x=1;else if(Y.ic||Ae(),Y.ic){Y=G.V,Pe=G.Ba,Ne=G.c;var Be=G.i,ye=(He=1,Q=G.$/Ne,ae=G.$%Ne,ve=G.m,Ce=G.s,G.$),_e=Ne*Be,ze=Ne*x,Ye=Ce.wc,We=ye<ze?Kr(Ce,ae,Q):null;e(ye<=_e),e(x<=Be),e(te(Ce));t:for(;;){for(;!ve.h&&ye<ze;){if(ae&Ye||(We=Kr(Ce,ae,Q)),e(We!=null),ee(ve),256>(Be=an(We.G[0],We.H[0],ve)))Y[Pe+ye]=Be,++ye,++ae>=Ne&&(ae=0,++Q<=x&&!(Q%16)&&ie(G,Q));else{if(!(280>Be)){He=0;break t}Be=ta(Be-256,ve);var yt,mt=an(We.G[4],We.H[4],ve);if(ee(ve),!(ye>=(mt=_n(Ne,mt=ta(mt,ve)))&&_e-ye>=Be)){He=0;break t}for(yt=0;yt<Be;++yt)Y[Pe+ye+yt]=Y[Pe+ye+yt-mt];for(ye+=Be,ae+=Be;ae>=Ne;)ae-=Ne,++Q<=x&&!(Q%16)&&ie(G,Q);ye<ze&&ae&Ye&&(We=Kr(Ce,ae,Q))}e(ve.h==M(ve))}ie(G,Q>x?x:Q);break t}!He||ve.h&&ye<_e?(He=0,G.a=ve.h?5:3):G.$=ye,x=He}else x=ce(G,G.V,G.Ba,G.c,G.i,x,Le);if(!x){D=0;break e}}b+D>=H&&(f.Cc=1),D=1}if(!D)return null;if(f.Cc&&((D=f.ga)!=null&&(D.mc=null),f.ga=null,0<f.Ga))return alert("todo:WebPDequantizeLevels"),null}return f.nb+b*V}function _(f,x,b,D,V,H){for(;0<V--;){var G,Y=f,Q=x+(b?1:0),ae=f,ve=x+(b?0:3);for(G=0;G<D;++G){var Ce=ae[ve+4*G];Ce!=255&&(Ce*=32897,Y[Q+4*G+0]=Y[Q+4*G+0]*Ce>>23,Y[Q+4*G+1]=Y[Q+4*G+1]*Ce>>23,Y[Q+4*G+2]=Y[Q+4*G+2]*Ce>>23)}x+=H}}function B(f,x,b,D,V){for(;0<D--;){var H;for(H=0;H<b;++H){var G=f[x+2*H+0],Y=15&(ae=f[x+2*H+1]),Q=4369*Y,ae=(240&ae|ae>>4)*Q>>16;f[x+2*H+0]=(240&G|G>>4)*Q>>16&240|(15&G|G<<4)*Q>>16>>4&15,f[x+2*H+1]=240&ae|Y}x+=V}}function le(f,x,b,D,V,H,G,Y){var Q,ae,ve=255;for(ae=0;ae<V;++ae){for(Q=0;Q<D;++Q){var Ce=f[x+Q];H[G+4*Q]=Ce,ve&=Ce}x+=b,G+=Y}return ve!=255}function xe(f,x,b,D,V){var H;for(H=0;H<V;++H)b[D+H]=f[x+H]>>8}function Ae(){ds=_,Vr=B,Ur=le,mn=xe}function Ve(f,x,b){N[f]=function(D,V,H,G,Y,Q,ae,ve,Ce,Pe,Ne,He,Be,ye,_e,ze,Ye){var We,yt=Ye-1>>1,mt=Y[Q+0]|ae[ve+0]<<16,Lt=Ce[Pe+0]|Ne[He+0]<<16;e(D!=null);var xt=3*mt+Lt+131074>>2;for(x(D[V+0],255&xt,xt>>16,Be,ye),H!=null&&(xt=3*Lt+mt+131074>>2,x(H[G+0],255&xt,xt>>16,_e,ze)),We=1;We<=yt;++We){var vr=Y[Q+We]|ae[ve+We]<<16,br=Ce[Pe+We]|Ne[He+We]<<16,dr=mt+vr+Lt+br+524296,ar=dr+2*(vr+Lt)>>3;xt=ar+mt>>1,mt=(dr=dr+2*(mt+br)>>3)+vr>>1,x(D[V+2*We-1],255&xt,xt>>16,Be,ye+(2*We-1)*b),x(D[V+2*We-0],255&mt,mt>>16,Be,ye+(2*We-0)*b),H!=null&&(xt=dr+Lt>>1,mt=ar+br>>1,x(H[G+2*We-1],255&xt,xt>>16,_e,ze+(2*We-1)*b),x(H[G+2*We+0],255&mt,mt>>16,_e,ze+(2*We+0)*b)),mt=vr,Lt=br}1&Ye||(xt=3*mt+Lt+131074>>2,x(D[V+Ye-1],255&xt,xt>>16,Be,ye+(Ye-1)*b),H!=null&&(xt=3*Lt+mt+131074>>2,x(H[G+Ye-1],255&xt,xt>>16,_e,ze+(Ye-1)*b)))}}function Qe(){ps[g0]=a4,ps[x0]=lg,ps[ag]=s4,ps[v0]=ug,ps[y0]=hg,ps[Rd]=fg,ps[sg]=i4,ps[Dd]=lg,ps[Ld]=ug,ps[w0]=hg,ps[jd]=fg}function pt(f){return f&~o4?0>f?0:255:f>>dg}function m(f,x){return pt((19077*f>>8)+(26149*x>>8)-14234)}function T(f,x,b){return pt((19077*f>>8)-(6419*x>>8)-(13320*b>>8)+8708)}function L(f,x){return pt((19077*f>>8)+(33050*x>>8)-17685)}function X(f,x,b,D,V){D[V+0]=m(f,b),D[V+1]=T(f,x,b),D[V+2]=L(f,x)}function Ee(f,x,b,D,V){D[V+0]=L(f,x),D[V+1]=T(f,x,b),D[V+2]=m(f,b)}function Re(f,x,b,D,V){var H=T(f,x,b);x=H<<3&224|L(f,x)>>3,D[V+0]=248&m(f,b)|H>>5,D[V+1]=x}function Ze(f,x,b,D,V){var H=240&L(f,x)|15;D[V+0]=240&m(f,b)|T(f,x,b)>>4,D[V+1]=H}function Gt(f,x,b,D,V){D[V+0]=255,X(f,x,b,D,V+1)}function nr(f,x,b,D,V){Ee(f,x,b,D,V),D[V+3]=255}function $t(f,x,b,D,V){X(f,x,b,D,V),D[V+3]=255}function wr(f,x){return 0>f?0:f>x?x:f}function Or(f,x,b){N[f]=function(D,V,H,G,Y,Q,ae,ve,Ce){for(var Pe=ve+(-2&Ce)*b;ve!=Pe;)x(D[V+0],H[G+0],Y[Q+0],ae,ve),x(D[V+1],H[G+0],Y[Q+0],ae,ve+b),V+=2,++G,++Q,ve+=2*b;1&Ce&&x(D[V+0],H[G+0],Y[Q+0],ae,ve)}}function Os(f,x,b){return b==0?f==0?x==0?6:5:x==0?4:0:b}function Gn(f,x,b,D,V){switch(f>>>30){case 3:Ci(x,b,D,V,0);break;case 2:dn(x,b,D,V);break;case 1:Ea(x,b,D,V)}}function ri(f,x){var b,D,V=x.M,H=x.Nb,G=f.oc,Y=f.pc+40,Q=f.oc,ae=f.pc+584,ve=f.oc,Ce=f.pc+600;for(b=0;16>b;++b)G[Y+32*b-1]=129;for(b=0;8>b;++b)Q[ae+32*b-1]=129,ve[Ce+32*b-1]=129;for(0<V?G[Y-1-32]=Q[ae-1-32]=ve[Ce-1-32]=129:(a(G,Y-32-1,127,21),a(Q,ae-32-1,127,9),a(ve,Ce-32-1,127,9)),D=0;D<f.za;++D){var Pe=x.ya[x.aa+D];if(0<D){for(b=-1;16>b;++b)n(G,Y+32*b-4,G,Y+32*b+12,4);for(b=-1;8>b;++b)n(Q,ae+32*b-4,Q,ae+32*b+4,4),n(ve,Ce+32*b-4,ve,Ce+32*b+4,4)}var Ne=f.Gd,He=f.Hd+D,Be=Pe.ad,ye=Pe.Hc;if(0<V&&(n(G,Y-32,Ne[He].y,0,16),n(Q,ae-32,Ne[He].f,0,8),n(ve,Ce-32,Ne[He].ea,0,8)),Pe.Za){var _e=G,ze=Y-32+16;for(0<V&&(D>=f.za-1?a(_e,ze,Ne[He].y[15],4):n(_e,ze,Ne[He+1].y,0,4)),b=0;4>b;b++)_e[ze+128+b]=_e[ze+256+b]=_e[ze+384+b]=_e[ze+0+b];for(b=0;16>b;++b,ye<<=2)_e=G,ze=Y+pg[b],Ms[Pe.Ob[b]](_e,ze),Gn(ye,Be,16*+b,_e,ze)}else if(_e=Os(D,V,Pe.Ob[0]),xo[_e](G,Y),ye!=0)for(b=0;16>b;++b,ye<<=2)Gn(ye,Be,16*+b,G,Y+pg[b]);for(b=Pe.Gc,_e=Os(D,V,Pe.Dd),Fi[_e](Q,ae),Fi[_e](ve,Ce),ye=Be,_e=Q,ze=ae,255&(Pe=b>>0)&&(170&Pe?Fu(ye,256,_e,ze):hs(ye,256,_e,ze)),Pe=ve,ye=Ce,255&(b>>=8)&&(170&b?Fu(Be,320,Pe,ye):hs(Be,320,Pe,ye)),V<f.Ub-1&&(n(Ne[He].y,0,G,Y+480,16),n(Ne[He].f,0,Q,ae+224,8),n(Ne[He].ea,0,ve,Ce+224,8)),b=8*H*f.B,Ne=f.sa,He=f.ta+16*D+16*H*f.R,Be=f.qa,Pe=f.ra+8*D+b,ye=f.Ha,_e=f.Ia+8*D+b,b=0;16>b;++b)n(Ne,He+b*f.R,G,Y+32*b,16);for(b=0;8>b;++b)n(Be,Pe+b*f.B,Q,ae+32*b,8),n(ye,_e+b*f.B,ve,Ce+32*b,8)}}function ni(f,x,b,D,V,H,G,Y,Q){var ae=[0],ve=[0],Ce=0,Pe=Q!=null?Q.kd:0,Ne=Q??new co;if(f==null||12>b)return 7;Ne.data=f,Ne.w=x,Ne.ha=b,x=[x],b=[b],Ne.gb=[Ne.gb];e:{var He=x,Be=b,ye=Ne.gb;if(e(f!=null),e(Be!=null),e(ye!=null),ye[0]=0,12<=Be[0]&&!t(f,He[0],"RIFF")){if(t(f,He[0]+8,"WEBP")){ye=3;break e}var _e=Xe(f,He[0]+4);if(12>_e||4294967286<_e){ye=3;break e}if(Pe&&_e>Be[0]-8){ye=7;break e}ye[0]=_e,He[0]+=12,Be[0]-=12}ye=0}if(ye!=0)return ye;for(_e=0<Ne.gb[0],b=b[0];;){e:{var ze=f;Be=x,ye=b;var Ye=ae,We=ve,yt=He=[0];if((xt=Ce=[Ce])[0]=0,8>ye[0])ye=7;else{if(!t(ze,Be[0],"VP8X")){if(Xe(ze,Be[0]+4)!=10){ye=3;break e}if(18>ye[0]){ye=7;break e}var mt=Xe(ze,Be[0]+8),Lt=1+Z(ze,Be[0]+12);if(2147483648<=Lt*(ze=1+Z(ze,Be[0]+15))){ye=3;break e}yt!=null&&(yt[0]=mt),Ye!=null&&(Ye[0]=Lt),We!=null&&(We[0]=ze),Be[0]+=18,ye[0]-=18,xt[0]=1}ye=0}}if(Ce=Ce[0],He=He[0],ye!=0)return ye;if(Be=!!(2&He),!_e&&Ce)return 3;if(H!=null&&(H[0]=!!(16&He)),G!=null&&(G[0]=Be),Y!=null&&(Y[0]=0),G=ae[0],He=ve[0],Ce&&Be&&Q==null){ye=0;break}if(4>b){ye=7;break}if(_e&&Ce||!_e&&!Ce&&!t(f,x[0],"ALPH")){b=[b],Ne.na=[Ne.na],Ne.P=[Ne.P],Ne.Sa=[Ne.Sa];e:{mt=f,ye=x,_e=b;var xt=Ne.gb;Ye=Ne.na,We=Ne.P,yt=Ne.Sa,Lt=22,e(mt!=null),e(_e!=null),ze=ye[0];var vr=_e[0];for(e(Ye!=null),e(yt!=null),Ye[0]=null,We[0]=null,yt[0]=0;;){if(ye[0]=ze,_e[0]=vr,8>vr){ye=7;break e}var br=Xe(mt,ze+4);if(4294967286<br){ye=3;break e}var dr=8+br+1&-2;if(Lt+=dr,0<xt&&Lt>xt){ye=3;break e}if(!t(mt,ze,"VP8 ")||!t(mt,ze,"VP8L")){ye=0;break e}if(vr[0]<dr){ye=7;break e}t(mt,ze,"ALPH")||(Ye[0]=mt,We[0]=ze+8,yt[0]=br),ze+=dr,vr-=dr}}if(b=b[0],Ne.na=Ne.na[0],Ne.P=Ne.P[0],Ne.Sa=Ne.Sa[0],ye!=0)break}b=[b],Ne.Ja=[Ne.Ja],Ne.xa=[Ne.xa];e:if(xt=f,ye=x,_e=b,Ye=Ne.gb[0],We=Ne.Ja,yt=Ne.xa,mt=ye[0],ze=!t(xt,mt,"VP8 "),Lt=!t(xt,mt,"VP8L"),e(xt!=null),e(_e!=null),e(We!=null),e(yt!=null),8>_e[0])ye=7;else{if(ze||Lt){if(xt=Xe(xt,mt+4),12<=Ye&&xt>Ye-12){ye=3;break e}if(Pe&&xt>_e[0]-8){ye=7;break e}We[0]=xt,ye[0]+=8,_e[0]-=8,yt[0]=Lt}else yt[0]=5<=_e[0]&&xt[mt+0]==47&&!(xt[mt+4]>>5),We[0]=_e[0];ye=0}if(b=b[0],Ne.Ja=Ne.Ja[0],Ne.xa=Ne.xa[0],x=x[0],ye!=0)break;if(4294967286<Ne.Ja)return 3;if(Y==null||Be||(Y[0]=Ne.xa?2:1),G=[G],He=[He],Ne.xa){if(5>b){ye=7;break}Y=G,Pe=He,Be=H,f==null||5>b?f=0:5<=b&&f[x+0]==47&&!(f[x+4]>>5)?(_e=[0],xt=[0],Ye=[0],ge(We=new k,f,x,b),bt(We,_e,xt,Ye)?(Y!=null&&(Y[0]=_e[0]),Pe!=null&&(Pe[0]=xt[0]),Be!=null&&(Be[0]=Ye[0]),f=1):f=0):f=0}else{if(10>b){ye=7;break}Y=He,f==null||10>b||!ec(f,x+3,b-3)?f=0:(Pe=f[x+0]|f[x+1]<<8|f[x+2]<<16,Be=16383&(f[x+7]<<8|f[x+6]),f=16383&(f[x+9]<<8|f[x+8]),1&Pe||3<(Pe>>1&7)||!(Pe>>4&1)||Pe>>5>=Ne.Ja||!Be||!f?f=0:(G&&(G[0]=Be),Y&&(Y[0]=f),f=1))}if(!f||(G=G[0],He=He[0],Ce&&(ae[0]!=G||ve[0]!=He)))return 3;Q!=null&&(Q[0]=Ne,Q.offset=x-Q.w,e(4294967286>x-Q.w),e(Q.offset==Q.ha-b));break}return ye==0||ye==7&&Ce&&Q==null?(H!=null&&(H[0]|=Ne.na!=null&&0<Ne.na.length),D!=null&&(D[0]=G),V!=null&&(V[0]=He),0):ye}function ku(f,x,b){var D=x.width,V=x.height,H=0,G=0,Y=D,Q=V;if(x.Da=f!=null&&0<f.Da,x.Da&&(Y=f.cd,Q=f.bd,H=f.v,G=f.j,11>b||(H&=-2,G&=-2),0>H||0>G||0>=Y||0>=Q||H+Y>D||G+Q>V))return 0;if(x.v=H,x.j=G,x.va=H+Y,x.o=G+Q,x.U=Y,x.T=Q,x.da=f!=null&&0<f.da,x.da){if(!qe(Y,Q,b=[f.ib],H=[f.hb]))return 0;x.ib=b[0],x.hb=H[0]}return x.ob=f!=null&&f.ob,x.Kb=f==null||!f.Sd,x.da&&(x.ob=x.ib<3*D/4&&x.hb<3*V/4,x.Kb=0),1}function Iu(f){if(f==null)return 2;if(11>f.S){var x=f.f.RGBA;x.fb+=(f.height-1)*x.A,x.A=-x.A}else x=f.f.kb,f=f.height,x.O+=(f-1)*x.fa,x.fa=-x.fa,x.N+=(f-1>>1)*x.Ab,x.Ab=-x.Ab,x.W+=(f-1>>1)*x.Db,x.Db=-x.Db,x.F!=null&&(x.J+=(f-1)*x.lb,x.lb=-x.lb);return 0}function gl(f,x,b,D){if(D==null||0>=f||0>=x)return 2;if(b!=null){if(b.Da){var V=b.cd,H=b.bd,G=-2&b.v,Y=-2&b.j;if(0>G||0>Y||0>=V||0>=H||G+V>f||Y+H>x)return 2;f=V,x=H}if(b.da){if(!qe(f,x,V=[b.ib],H=[b.hb]))return 2;f=V[0],x=H[0]}}D.width=f,D.height=x;e:{var Q=D.width,ae=D.height;if(f=D.S,0>=Q||0>=ae||!(f>=g0&&13>f))f=2;else{if(0>=D.Rd&&D.sd==null){G=H=V=x=0;var ve=(Y=Q*gg[f])*ae;if(11>f||(H=(ae+1)/2*(x=(Q+1)/2),f==12&&(G=(V=Q)*ae)),(ae=s(ve+2*H+G))==null){f=1;break e}D.sd=ae,11>f?((Q=D.f.RGBA).eb=ae,Q.fb=0,Q.A=Y,Q.size=ve):((Q=D.f.kb).y=ae,Q.O=0,Q.fa=Y,Q.Fd=ve,Q.f=ae,Q.N=0+ve,Q.Ab=x,Q.Cd=H,Q.ea=ae,Q.W=0+ve+H,Q.Db=x,Q.Ed=H,f==12&&(Q.F=ae,Q.J=0+ve+2*H),Q.Tc=G,Q.lb=V)}if(x=1,V=D.S,H=D.width,G=D.height,V>=g0&&13>V)if(11>V)f=D.f.RGBA,x&=(Y=Math.abs(f.A))*(G-1)+H<=f.size,x&=Y>=H*gg[V],x&=f.eb!=null;else{f=D.f.kb,Y=(H+1)/2,ve=(G+1)/2,Q=Math.abs(f.fa),ae=Math.abs(f.Ab);var Ce=Math.abs(f.Db),Pe=Math.abs(f.lb),Ne=Pe*(G-1)+H;x&=Q*(G-1)+H<=f.Fd,x&=ae*(ve-1)+Y<=f.Cd,x=(x&=Ce*(ve-1)+Y<=f.Ed)&Q>=H&ae>=Y&Ce>=Y,x&=f.y!=null,x&=f.f!=null,x&=f.ea!=null,V==12&&(x&=Pe>=H,x&=Ne<=f.Tc,x&=f.F!=null)}else x=0;f=x?0:2}}return f!=0||b!=null&&b.fd&&(f=Iu(D)),f}var $n=64,xl=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],vl=24,yl=32,Cu=8,La=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];rt("Predictor0","PredictorAdd0"),N.Predictor0=function(){return 4278190080},N.Predictor1=function(f){return f},N.Predictor2=function(f,x,b){return x[b+0]},N.Predictor3=function(f,x,b){return x[b+1]},N.Predictor4=function(f,x,b){return x[b-1]},N.Predictor5=function(f,x,b){return ht(ht(f,x[b+1]),x[b+0])},N.Predictor6=function(f,x,b){return ht(f,x[b-1])},N.Predictor7=function(f,x,b){return ht(f,x[b+0])},N.Predictor8=function(f,x,b){return ht(x[b-1],x[b+0])},N.Predictor9=function(f,x,b){return ht(x[b+0],x[b+1])},N.Predictor10=function(f,x,b){return ht(ht(f,x[b-1]),ht(x[b+0],x[b+1]))},N.Predictor11=function(f,x,b){var D=x[b+0];return 0>=Ft(D>>24&255,f>>24&255,(x=x[b-1])>>24&255)+Ft(D>>16&255,f>>16&255,x>>16&255)+Ft(D>>8&255,f>>8&255,x>>8&255)+Ft(255&D,255&f,255&x)?D:f},N.Predictor12=function(f,x,b){var D=x[b+0];return(_t((f>>24&255)+(D>>24&255)-((x=x[b-1])>>24&255))<<24|_t((f>>16&255)+(D>>16&255)-(x>>16&255))<<16|_t((f>>8&255)+(D>>8&255)-(x>>8&255))<<8|_t((255&f)+(255&D)-(255&x)))>>>0},N.Predictor13=function(f,x,b){var D=x[b-1];return(At((f=ht(f,x[b+0]))>>24&255,D>>24&255)<<24|At(f>>16&255,D>>16&255)<<16|At(f>>8&255,D>>8&255)<<8|At(f>>0&255,D>>0&255))>>>0};var Pd=N.PredictorAdd0;N.PredictorAdd1=Et,rt("Predictor2","PredictorAdd2"),rt("Predictor3","PredictorAdd3"),rt("Predictor4","PredictorAdd4"),rt("Predictor5","PredictorAdd5"),rt("Predictor6","PredictorAdd6"),rt("Predictor7","PredictorAdd7"),rt("Predictor8","PredictorAdd8"),rt("Predictor9","PredictorAdd9"),rt("Predictor10","PredictorAdd10"),rt("Predictor11","PredictorAdd11"),rt("Predictor12","PredictorAdd12"),rt("Predictor13","PredictorAdd13");var Pu=N.PredictorAdd2;dt("ColorIndexInverseTransform","MapARGB","32b",function(f){return f>>8&255},function(f){return f}),dt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(f){return f},function(f){return f>>8&255});var u0,us=N.ColorIndexInverseTransform,wl=N.MapARGB,h0=N.VP8LColorIndexInverseTransformAlpha,f0=N.MapAlpha,fo=N.VP8LPredictorsAdd=[];fo.length=16,(N.VP8LPredictors=[]).length=16,(N.VP8LPredictorsAdd_C=[]).length=16,(N.VP8LPredictors_C=[]).length=16;var fc,ja,ba,mo,ki,Ii,_l,Ci,dn,Fu,Ea,hs,bl,d0,Ru,dc,mc,po,pc,El,gc,go,Du,fs,ds,Vr,Ur,mn,Pn=s(511),Pi=s(2041),Lu=s(225),Sl=s(767),m0=0,Fd=Pi,p0=Lu,Ja=Sl,ms=Pn,g0=0,x0=1,ag=2,v0=3,y0=4,Rd=5,sg=6,Dd=7,Ld=8,w0=9,jd=10,Wb=[2,3,7],Hb=[3,3,11],ig=[280,256,256,256,40],Gb=[0,1,1,1,0],$b=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Kb=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Xb=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Yb=8,Od=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Md=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],ju=null,Jb=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Qb=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],og=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Zb=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],e4=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],t4=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],r4=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],xo=[],Ms=[],Fi=[],n4=1,cg=2,vo=[],ps=[];Ve("UpsampleRgbLinePair",X,3),Ve("UpsampleBgrLinePair",Ee,3),Ve("UpsampleRgbaLinePair",$t,4),Ve("UpsampleBgraLinePair",nr,4),Ve("UpsampleArgbLinePair",Gt,4),Ve("UpsampleRgba4444LinePair",Ze,2),Ve("UpsampleRgb565LinePair",Re,2);var a4=N.UpsampleRgbLinePair,s4=N.UpsampleBgrLinePair,lg=N.UpsampleRgbaLinePair,ug=N.UpsampleBgraLinePair,hg=N.UpsampleArgbLinePair,fg=N.UpsampleRgba4444LinePair,i4=N.UpsampleRgb565LinePair,_0=16,b0=1<<_0-1,Ou=-227,Bd=482,dg=6,o4=(256<<dg)-1,mg=0,c4=s(256),l4=s(256),u4=s(256),h4=s(256),f4=s(Bd-Ou),d4=s(Bd-Ou);Or("YuvToRgbRow",X,3),Or("YuvToBgrRow",Ee,3),Or("YuvToRgbaRow",$t,4),Or("YuvToBgraRow",nr,4),Or("YuvToArgbRow",Gt,4),Or("YuvToRgba4444Row",Ze,2),Or("YuvToRgb565Row",Re,2);var pg=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],E0=[0,2,8],m4=[8,7,6,4,4,2,2,2,1,1,1,1],p4=1;this.WebPDecodeRGBA=function(f,x,b,D,V){var H=x0,G=new Ni,Y=new In;G.ba=Y,Y.S=H,Y.width=[Y.width],Y.height=[Y.height];var Q=Y.width,ae=Y.height,ve=new va;if(ve==null||f==null)var Ce=2;else e(ve!=null),Ce=ni(f,x,b,ve.width,ve.height,ve.Pd,ve.Qd,ve.format,null);if(Ce!=0?Q=0:(Q!=null&&(Q[0]=ve.width[0]),ae!=null&&(ae[0]=ve.height[0]),Q=1),Q){Y.width=Y.width[0],Y.height=Y.height[0],D!=null&&(D[0]=Y.width),V!=null&&(V[0]=Y.height);e:{if(D=new $a,(V=new co).data=f,V.w=x,V.ha=b,V.kd=1,x=[0],e(V!=null),((f=ni(V.data,V.w,V.ha,null,null,null,x,null,V))==0||f==7)&&x[0]&&(f=4),(x=f)==0){if(e(G!=null),D.data=V.data,D.w=V.w+V.offset,D.ha=V.ha-V.offset,D.put=Ln,D.ac=nn,D.bc=ya,D.ma=G,V.xa){if((f=je())==null){G=1;break e}if(function(Pe,Ne){var He=[0],Be=[0],ye=[0];t:for(;;){if(Pe==null)return 0;if(Ne==null)return Pe.a=2,0;if(Pe.l=Ne,Pe.a=0,ge(Pe.m,Ne.data,Ne.w,Ne.ha),!bt(Pe.m,He,Be,ye)){Pe.a=3;break t}if(Pe.xb=cg,Ne.width=He[0],Ne.height=Be[0],!ke(He[0],Be[0],1,Pe,null))break t;return 1}return e(Pe.a!=0),0}(f,D)){if(D=(x=gl(D.width,D.height,G.Oa,G.ba))==0){t:{D=f;r:for(;;){if(D==null){D=0;break t}if(e(D.s.yc!=null),e(D.s.Ya!=null),e(0<D.s.Wb),e((b=D.l)!=null),e((V=b.ma)!=null),D.xb!=0){if(D.ca=V.ba,D.tb=V.tb,e(D.ca!=null),!ku(V.Oa,b,v0)){D.a=2;break r}if(!Ie(D,b.width)||b.da)break r;if((b.da||rr(D.ca.S))&&Ae(),11>D.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),D.ca.f.kb.F!=null&&Ae()),D.Pb&&0<D.s.ua&&D.s.vb.X==null&&!st(D.s.vb,D.s.Wa.Xa)){D.a=1;break r}D.xb=0}if(!ce(D,D.V,D.Ba,D.c,D.i,b.o,oe))break r;V.Dc=D.Ma,D=1;break t}e(D.a!=0),D=0}D=!D}D&&(x=f.a)}else x=f.a}else{if((f=new Wn)==null){G=1;break e}if(f.Fa=V.na,f.P=V.P,f.qc=V.Sa,tc(f,D)){if((x=gl(D.width,D.height,G.Oa,G.ba))==0){if(f.Aa=0,b=G.Oa,e((V=f)!=null),b!=null){if(0<(Q=0>(Q=b.Md)?0:100<Q?255:255*Q/100)){for(ae=ve=0;4>ae;++ae)12>(Ce=V.pb[ae]).lc&&(Ce.ia=Q*m4[0>Ce.lc?0:Ce.lc]>>3),ve|=Ce.ia;ve&&(alert("todo:VP8InitRandom"),V.ia=1)}V.Ga=b.Id,100<V.Ga?V.Ga=100:0>V.Ga&&(V.Ga=0)}ll(f,D)||(x=f.a)}}else x=f.a}x==0&&G.Oa!=null&&G.Oa.fd&&(x=Iu(G.ba))}G=x}H=G!=0?null:11>H?Y.f.RGBA.eb:Y.f.kb.y}else H=null;return H};var gg=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function l(N,F){for(var j="",S=0;S<4;S++)j+=String.fromCharCode(N[F++]);return j}function u(N,F){return(N[F+0]<<0|N[F+1]<<8|N[F+2]<<16)>>>0}function d(N,F){return(N[F+0]<<0|N[F+1]<<8|N[F+2]<<16|N[F+3]<<24)>>>0}new c;var g=[0],p=[0],y=[],v=new c,w=r,E=function(N,F){var j={},S=0,A=!1,C=0,J=0;if(j.frames=[],!function(O,M,U,ee){for(var he=0;he<ee;he++)if(O[M+he]!=U.charCodeAt(he))return!0;return!1}(N,F,"RIFF",4)){var ue,me;for(d(N,F+=4),F+=8;F<N.length;){var pe=l(N,F),ge=d(N,F+=4);F+=4;var ne=ge+(1&ge);switch(pe){case"VP8 ":case"VP8L":j.frames[S]===void 0&&(j.frames[S]={}),(k=j.frames[S]).src_off=A?J:F-8,k.src_size=C+ge+8,S++,A&&(A=!1,C=0,J=0);break;case"VP8X":(k=j.header={}).feature_flags=N[F];var we=F+4;k.canvas_width=1+u(N,we),we+=3,k.canvas_height=1+u(N,we),we+=3;break;case"ALPH":A=!0,C=ne+8,J=F-8;break;case"ANIM":(k=j.header).bgcolor=d(N,F),we=F+4,k.loop_count=(ue=N)[(me=we)+0]<<0|ue[me+1]<<8,we+=2;break;case"ANMF":var Oe,k;(k=j.frames[S]={}).offset_x=2*u(N,F),F+=3,k.offset_y=2*u(N,F),F+=3,k.width=1+u(N,F),F+=3,k.height=1+u(N,F),F+=3,k.duration=u(N,F),F+=3,Oe=N[F++],k.dispose=1&Oe,k.blend=Oe>>1&1}pe!="ANMF"&&(F+=ne)}return j}}(w,0);E.response=w,E.rgbaoutput=!0,E.dataurl=!1;var R=E.header?E.header:null,P=E.frames?E.frames:null;if(R){R.loop_counter=R.loop_count,g=[R.canvas_height],p=[R.canvas_width];for(var q=0;q<P.length&&P[q].blend!=0;q++);}var z=P[0],K=v.WebPDecodeRGBA(w,z.src_off,z.src_size,p,g);z.rgba=K,z.imgwidth=p[0],z.imgheight=g[0];for(var I=0;I<p[0]*g[0]*4;I++)y[I]=K[I];return this.width=p,this.height=g,this.data=y,this}(function(r){var e=function(){return typeof yp=="function"},t=function(g,p,y,v){var w=4,E=i;switch(v){case r.image_compression.FAST:w=1,E=s;break;case r.image_compression.MEDIUM:w=6,E=o;break;case r.image_compression.SLOW:w=9,E=c}g=n(g,p,y,E);var R=yp(g,{level:w});return r.__addimage__.arrayBufferToBinaryString(R)},n=function(g,p,y,v){for(var w,E,R,P=g.length/p,q=new Uint8Array(g.length+P),z=u(),K=0;K<P;K+=1){if(R=K*p,w=g.subarray(R,R+p),v)q.set(v(w,y,E),R+K);else{for(var I,N=z.length,F=[];I<N;I+=1)F[I]=z[I](w,y,E);var j=d(F.concat());q.set(F[j],R+K)}E=w}return q},a=function(g){var p=Array.apply([],g);return p.unshift(0),p},s=function(g,p){var y,v=[],w=g.length;v[0]=1;for(var E=0;E<w;E+=1)y=g[E-p]||0,v[E+1]=g[E]-y+256&255;return v},i=function(g,p,y){var v,w=[],E=g.length;w[0]=2;for(var R=0;R<E;R+=1)v=y&&y[R]||0,w[R+1]=g[R]-v+256&255;return w},o=function(g,p,y){var v,w,E=[],R=g.length;E[0]=3;for(var P=0;P<R;P+=1)v=g[P-p]||0,w=y&&y[P]||0,E[P+1]=g[P]+256-(v+w>>>1)&255;return E},c=function(g,p,y){var v,w,E,R,P=[],q=g.length;P[0]=4;for(var z=0;z<q;z+=1)v=g[z-p]||0,w=y&&y[z]||0,E=y&&y[z-p]||0,R=l(v,w,E),P[z+1]=g[z]-R+256&255;return P},l=function(g,p,y){if(g===p&&p===y)return g;var v=Math.abs(p-y),w=Math.abs(g-y),E=Math.abs(g+p-y-y);return v<=w&&v<=E?g:w<=E?p:y},u=function(){return[a,s,i,o,c]},d=function(g){var p=g.map(function(y){return y.reduce(function(v,w){return v+Math.abs(w)},0)});return p.indexOf(Math.min.apply(null,p))};r.processPNG=function(g,p,y,v){var w,E,R,P,q,z,K,I,N,F,j,S,A,C,J,ue=this.decode.FLATE_DECODE,me="";if(this.__addimage__.isArrayBuffer(g)&&(g=new Uint8Array(g)),this.__addimage__.isArrayBufferView(g)){if(g=(R=new t9(g)).imgData,E=R.bits,w=R.colorSpace,q=R.colors,[4,6].indexOf(R.colorType)!==-1){if(R.bits===8){N=(I=R.pixelBitlength==32?new Uint32Array(R.decodePixels().buffer):R.pixelBitlength==16?new Uint16Array(R.decodePixels().buffer):new Uint8Array(R.decodePixels().buffer)).length,j=new Uint8Array(N*R.colors),F=new Uint8Array(N);var pe,ge=R.pixelBitlength-R.bits;for(C=0,J=0;C<N;C++){for(A=I[C],pe=0;pe<ge;)j[J++]=A>>>pe&255,pe+=R.bits;F[C]=A>>>pe&255}}if(R.bits===16){N=(I=new Uint32Array(R.decodePixels().buffer)).length,j=new Uint8Array(N*(32/R.pixelBitlength)*R.colors),F=new Uint8Array(N*(32/R.pixelBitlength)),S=R.colors>1,C=0,J=0;for(var ne=0;C<N;)A=I[C++],j[J++]=A>>>0&255,S&&(j[J++]=A>>>16&255,A=I[C++],j[J++]=A>>>0&255),F[ne++]=A>>>16&255;E=8}v!==r.image_compression.NONE&&e()?(g=t(j,R.width*R.colors,R.colors,v),K=t(F,R.width,1,v)):(g=j,K=F,ue=void 0)}if(R.colorType===3&&(w=this.color_spaces.INDEXED,z=R.palette,R.transparency.indexed)){var we=R.transparency.indexed,Oe=0;for(C=0,N=we.length;C<N;++C)Oe+=we[C];if((Oe/=255)===N-1&&we.indexOf(0)!==-1)P=[we.indexOf(0)];else if(Oe!==N){for(I=R.decodePixels(),F=new Uint8Array(I.length),C=0,N=I.length;C<N;C++)F[C]=we[I[C]];K=t(F,R.width,1)}}var k=function(O){var M;switch(O){case r.image_compression.FAST:M=11;break;case r.image_compression.MEDIUM:M=13;break;case r.image_compression.SLOW:M=14;break;default:M=12}return M}(v);return ue===this.decode.FLATE_DECODE&&(me="/Predictor "+k+" "),me+="/Colors "+q+" /BitsPerComponent "+E+" /Columns "+R.width,(this.__addimage__.isArrayBuffer(g)||this.__addimage__.isArrayBufferView(g))&&(g=this.__addimage__.arrayBufferToBinaryString(g)),(K&&this.__addimage__.isArrayBuffer(K)||this.__addimage__.isArrayBufferView(K))&&(K=this.__addimage__.arrayBufferToBinaryString(K)),{alias:y,data:g,index:p,filter:ue,decodeParameters:me,transparency:P,palette:z,sMask:K,predictor:k,width:R.width,height:R.height,bitsPerComponent:E,colorSpace:w}}}})(jt.API),function(r){r.processGIF89A=function(e,t,n,a){var s=new r9(e),i=s.width,o=s.height,c=[];s.decodeAndBlitFrameRGBA(0,c);var l={data:c,width:i,height:o},u=new Nm(100).encode(l,100);return r.processJPEG.call(this,u,t,n,a)},r.processGIF87A=r.processGIF89A}(jt.API),qs.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var r=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(r);for(var e=0;e<r;e++){var t=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:a,green:n,blue:t,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},qs.prototype.parseBGR=function(){this.pos=this.offset;try{var r="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[r]()}catch(t){Br.log("bit decode error:"+t)}},qs.prototype.bit1=function(){var r,e=Math.ceil(this.width/8),t=e%4;for(r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<e;a++)for(var s=this.datav.getUint8(this.pos++,!0),i=n*this.width*4+8*a*4,o=0;o<8&&8*a+o<this.width;o++){var c=this.palette[s>>7-o&1];this.data[i+4*o]=c.blue,this.data[i+4*o+1]=c.green,this.data[i+4*o+2]=c.red,this.data[i+4*o+3]=255}t!==0&&(this.pos+=4-t)}},qs.prototype.bit4=function(){for(var r=Math.ceil(this.width/2),e=r%4,t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,a=0;a<r;a++){var s=this.datav.getUint8(this.pos++,!0),i=n*this.width*4+2*a*4,o=s>>4,c=15&s,l=this.palette[o];if(this.data[i]=l.blue,this.data[i+1]=l.green,this.data[i+2]=l.red,this.data[i+3]=255,2*a+1>=this.width)break;l=this.palette[c],this.data[i+4]=l.blue,this.data[i+4+1]=l.green,this.data[i+4+2]=l.red,this.data[i+4+3]=255}e!==0&&(this.pos+=4-e)}},qs.prototype.bit8=function(){for(var r=this.width%4,e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var a=this.datav.getUint8(this.pos++,!0),s=t*this.width*4+4*n;if(a<this.palette.length){var i=this.palette[a];this.data[s]=i.red,this.data[s+1]=i.green,this.data[s+2]=i.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}r!==0&&(this.pos+=4-r)}},qs.prototype.bit15=function(){for(var r=this.width%3,e=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,a=0;a<this.width;a++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var i=(s&e)/e*255|0,o=(s>>5&e)/e*255|0,c=(s>>10&e)/e*255|0,l=s>>15?255:0,u=n*this.width*4+4*a;this.data[u]=c,this.data[u+1]=o,this.data[u+2]=i,this.data[u+3]=l}this.pos+=r}},qs.prototype.bit16=function(){for(var r=this.width%3,e=parseInt("11111",2),t=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var a=this.bottom_up?n:this.height-1-n,s=0;s<this.width;s++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(i&e)/e*255|0,c=(i>>5&t)/t*255|0,l=(i>>11)/e*255|0,u=a*this.width*4+4*s;this.data[u]=l,this.data[u+1]=c,this.data[u+2]=o,this.data[u+3]=255}this.pos+=r}},qs.prototype.bit24=function(){for(var r=this.height-1;r>=0;r--){for(var e=this.bottom_up?r:this.height-1-r,t=0;t<this.width;t++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=e*this.width*4+4*t;this.data[i]=s,this.data[i+1]=a,this.data[i+2]=n,this.data[i+3]=255}this.pos+=this.width%4}},qs.prototype.bit32=function(){for(var r=this.height-1;r>=0;r--)for(var e=this.bottom_up?r:this.height-1-r,t=0;t<this.width;t++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*t;this.data[o]=s,this.data[o+1]=a,this.data[o+2]=n,this.data[o+3]=i}},qs.prototype.getData=function(){return this.data},function(r){r.processBMP=function(e,t,n,a){var s=new qs(e,!1),i=s.width,o=s.height,c={data:s.getData(),width:i,height:o},l=new Nm(100).encode(c,100);return r.processJPEG.call(this,l,t,n,a)}}(jt.API),kv.prototype.getData=function(){return this.data},function(r){r.processWEBP=function(e,t,n,a){var s=new kv(e),i=s.width,o=s.height,c={data:s.getData(),width:i,height:o},l=new Nm(100).encode(c,100);return r.processJPEG.call(this,l,t,n,a)}}(jt.API),jt.API.processRGBA=function(r,e,t){for(var n=r.data,a=n.length,s=new Uint8Array(a/4*3),i=new Uint8Array(a/4),o=0,c=0,l=0;l<a;l+=4){var u=n[l],d=n[l+1],g=n[l+2],p=n[l+3];s[o++]=u,s[o++]=d,s[o++]=g,i[c++]=p}var y=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(i),data:y,index:e,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:r.width,height:r.height}},jt.API.setLanguage=function(r){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[r]!==void 0&&(this.internal.languageSettings.languageCode=r,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Ol=jt.API,tf=Ol.getCharWidthsArray=function(r,e){var t,n,a=(e=e||{}).font||this.internal.getFont(),s=e.fontSize||this.internal.getFontSize(),i=e.charSpace||this.internal.getCharSpace(),o=e.widths?e.widths:a.metadata.Unicode.widths,c=o.fof?o.fof:1,l=e.kerning?e.kerning:a.metadata.Unicode.kerning,u=l.fof?l.fof:1,d=e.doKerning!==!1,g=0,p=r.length,y=0,v=o[0]||c,w=[];for(t=0;t<p;t++)n=r.charCodeAt(t),typeof a.metadata.widthOfString=="function"?w.push((a.metadata.widthOfGlyph(a.metadata.characterToGlyph(n))+i*(1e3/s)||0)/1e3):(g=d&&kr(l[n])==="object"&&!isNaN(parseInt(l[n][y],10))?l[n][y]/u:0,w.push((o[n]||v)/c+g)),y=n;return w},Sv=Ol.getStringUnitWidth=function(r,e){var t=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),a=e.charSpace||this.internal.getCharSpace();return Ol.processArabic&&(r=Ol.processArabic(r)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(r,t,a)/t:tf.apply(this,arguments).reduce(function(s,i){return s+i},0)},Av=function(r,e,t,n){for(var a=[],s=0,i=r.length,o=0;s!==i&&o+e[s]<t;)o+=e[s],s++;a.push(r.slice(0,s));var c=s;for(o=0;s!==i;)o+e[s]>n&&(a.push(r.slice(c,s)),o=0,c=s),o+=e[s],s++;return c!==s&&a.push(r.slice(c,s)),a},Nv=function(r,e,t){t||(t={});var n,a,s,i,o,c,l,u=[],d=[u],g=t.textIndent||0,p=0,y=0,v=r.split(" "),w=tf.apply(this,[" ",t])[0];if(c=t.lineIndent===-1?v[0].length+2:t.lineIndent||0){var E=Array(c).join(" "),R=[];v.map(function(q){(q=q.split(/\s*\n/)).length>1?R=R.concat(q.map(function(z,K){return(K&&z.length?`
`:"")+z})):R.push(q[0])}),v=R,c=Sv.apply(this,[E,t])}for(s=0,i=v.length;s<i;s++){var P=0;if(n=v[s],c&&n[0]==`
`&&(n=n.substr(1),P=1),g+p+(y=(a=tf.apply(this,[n,t])).reduce(function(q,z){return q+z},0))>e||P){if(y>e){for(o=Av.apply(this,[n,a,e-(g+p),e]),u.push(o.shift()),u=[o.pop()];o.length;)d.push([o.shift()]);y=a.slice(n.length-(u[0]?u[0].length:0)).reduce(function(q,z){return q+z},0)}else u=[n];d.push(u),g=y+c,p=w}else u.push(n),g+=p+y,p=w}return l=c?function(q,z){return(z?E:"")+q.join(" ")}:function(q){return q.join(" ")},d.map(l)},Ol.splitTextToSize=function(r,e,t){var n,a=(t=t||{}).fontSize||this.internal.getFontSize(),s=(function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var d=this.internal.getFont(u.fontName,u.fontStyle);return d.metadata.Unicode?{widths:d.metadata.Unicode.widths||{0:1},kerning:d.metadata.Unicode.kerning||{}}:{font:d.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,t);n=Array.isArray(r)?r:String(r).split(/\r?\n/);var i=1*this.internal.scaleFactor*e/a;s.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/a:0,s.lineIndent=t.lineIndent;var o,c,l=[];for(o=0,c=n.length;o<c;o++)l=l.concat(Nv.apply(this,[n[o],i,s]));return l},function(r){r.__fontmetrics__=r.__fontmetrics__||{};for(var e="klmnopqrstuvwxyz",t={},n={},a=0;a<e.length;a++)t[e[a]]="0123456789abcdef"[a],n["0123456789abcdef"[a]]=e[a];var s=function(d){return"0x"+parseInt(d,10).toString(16)},i=r.__fontmetrics__.compress=function(d){var g,p,y,v,w=["{"];for(var E in d){if(g=d[E],isNaN(parseInt(E,10))?p="'"+E+"'":(E=parseInt(E,10),p=(p=s(E).slice(2)).slice(0,-1)+n[p.slice(-1)]),typeof g=="number")g<0?(y=s(g).slice(3),v="-"):(y=s(g).slice(2),v=""),y=v+y.slice(0,-1)+n[y.slice(-1)];else{if(kr(g)!=="object")throw new Error("Don't know what to do with value type "+kr(g)+".");y=i(g)}w.push(p+y)}return w.push("}"),w.join("")},o=r.__fontmetrics__.uncompress=function(d){if(typeof d!="string")throw new Error("Invalid argument passed to uncompress.");for(var g,p,y,v,w={},E=1,R=w,P=[],q="",z="",K=d.length-1,I=1;I<K;I+=1)(v=d[I])=="'"?g?(y=g.join(""),g=void 0):g=[]:g?g.push(v):v=="{"?(P.push([R,y]),R={},y=void 0):v=="}"?((p=P.pop())[0][p[1]]=R,y=void 0,R=p[0]):v=="-"?E=-1:y===void 0?t.hasOwnProperty(v)?(q+=t[v],y=parseInt(q,16)*E,E=1,q=""):q+=v:t.hasOwnProperty(v)?(z+=t[v],R[y]=parseInt(z,16)*E,E=1,y=void 0,z=""):z+=v;return w},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:o("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},l={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},u={Unicode:{"Courier-Oblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":o("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":o("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:o("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:o("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":o("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":o("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};r.events.push(["addFont",function(d){var g=d.font,p=u.Unicode[g.postScriptName];p&&(g.metadata.Unicode={},g.metadata.Unicode.widths=p.widths,g.metadata.Unicode.kerning=p.kerning);var y=l.Unicode[g.postScriptName];y&&(g.metadata.Unicode.encoding=y,g.encoding=y.codePages[0])}])}(jt.API),function(r){var e=function(t){for(var n=t.length,a=new Uint8Array(n),s=0;s<n;s++)a[s]=t.charCodeAt(s);return a};r.API.events.push(["addFont",function(t){var n=void 0,a=t.font,s=t.instance;if(!a.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");if(typeof(n=s.existsFileInVFS(a.postScriptName)===!1?s.loadFile(a.postScriptName):s.getFileFromVFS(a.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");(function(i,o){o=/^\x00\x01\x00\x00/.test(o)?e(o):e(vh(o)),i.metadata=r.API.TTFFont.open(o),i.metadata.Unicode=i.metadata.Unicode||{encoding:{},kerning:{},widths:[]},i.metadata.glyIdsUsed=[0]})(a,n)}}])}(jt),function(r){function e(){return(Ut.canvg?Promise.resolve(Ut.canvg):mp(()=>import("./index.es-D62rbPxN.js"),__vite__mapDeps([0,1]))).catch(function(t){return Promise.reject(new Error("Could not load canvg: "+t))}).then(function(t){return t.default?t.default:t})}jt.API.addSvgAsImage=function(t,n,a,s,i,o,c,l){if(isNaN(n)||isNaN(a))throw Br.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(s)||isNaN(i))throw Br.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var u=document.createElement("canvas");u.width=s,u.height=i;var d=u.getContext("2d");d.fillStyle="#fff",d.fillRect(0,0,u.width,u.height);var g={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},p=this;return e().then(function(y){return y.fromString(d,t,g)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(y){return y.render(g)}).then(function(){p.addImage(u.toDataURL("image/jpeg",1),n,a,s,i,c,l)})}}(),jt.API.putTotalPages=function(r){var e,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(r,"g"),t=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(r,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var a=0;a<this.internal.pages[n].length;a++)this.internal.pages[n][a]=this.internal.pages[n][a].replace(e,t);return this},jt.API.viewerPreferences=function(r,e){var t;r=r||{},e=e||!1;var n,a,s,i={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(i),c=[],l=0,u=0,d=0;function g(y,v){var w,E=!1;for(w=0;w<y.length;w+=1)y[w]===v&&(E=!0);return E}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(i)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,r==="reset"||e===!0){var p=o.length;for(d=0;d<p;d+=1)t[o[d]].value=t[o[d]].defaultValue,t[o[d]].explicitSet=!1}if(kr(r)==="object"){for(a in r)if(s=r[a],g(o,a)&&s!==void 0){if(t[a].type==="boolean"&&typeof s=="boolean")t[a].value=s;else if(t[a].type==="name"&&g(t[a].valueSet,s))t[a].value=s;else if(t[a].type==="integer"&&Number.isInteger(s))t[a].value=s;else if(t[a].type==="array"){for(l=0;l<s.length;l+=1)if(n=!0,s[l].length===1&&typeof s[l][0]=="number")c.push(String(s[l]-1));else if(s[l].length>1){for(u=0;u<s[l].length;u+=1)typeof s[l][u]!="number"&&(n=!1);n===!0&&c.push([s[l][0]-1,s[l][1]-1].join(" "))}t[a].value="["+c.join(" ")+"]"}else t[a].value=t[a].defaultValue;t[a].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var y,v=[];for(y in t)t[y].explicitSet===!0&&(t[y].type==="name"?v.push("/"+y+" /"+t[y].value):v.push("/"+y+" "+t[y].value));v.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+v.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},function(r){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',a=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(n)),i=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),l=s.length+i.length+o.length+a.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+l+" >>"),this.internal.write("stream"),this.internal.write(a+s+i+o+c),this.internal.write("endstream"),this.internal.write("endobj")},t=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};r.addMetadata=function(n,a){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:a||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t),this.internal.events.subscribe("postPutResources",e)),this}}(jt.API),function(r){var e=r.API,t=e.pdfEscape16=function(s,i){for(var o,c=i.metadata.Unicode.widths,l=["","0","00","000","0000"],u=[""],d=0,g=s.length;d<g;++d){if(o=i.metadata.characterToGlyph(s.charCodeAt(d)),i.metadata.glyIdsUsed.push(o),i.metadata.toUnicode[o]=s.charCodeAt(d),c.indexOf(o)==-1&&(c.push(o),c.push([parseInt(i.metadata.widthOfGlyph(o),10)])),o=="0")return u.join("");o=o.toString(16),u.push(l[4-o.length],o)}return u.join("")},n=function(s){var i,o,c,l,u,d,g;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],d=0,g=(o=Object.keys(s).sort(function(p,y){return p-y})).length;d<g;d++)i=o[d],c.length>=100&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),s[i]!==void 0&&s[i]!==null&&typeof s[i].toString=="function"&&(l=("0000"+s[i].toString(16)).slice(-4),i=("0000"+(+i).toString(16)).slice(-4),c.push("<"+i+"><"+l+">"));return c.length&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),u+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(s){(function(i){var o=i.font,c=i.out,l=i.newObject,u=i.putStream;if(o.metadata instanceof r.API.TTFFont&&o.encoding==="Identity-H"){for(var d=o.metadata.Unicode.widths,g=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),p="",y=0;y<g.length;y++)p+=String.fromCharCode(g[y]);var v=l();u({data:p,addLength1:!0,objectId:v}),c("endobj");var w=l();u({data:n(o.metadata.toUnicode),addLength1:!0,objectId:w}),c("endobj");var E=l();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+Hl(o.fontName)),c("/FontFile2 "+v+" 0 R"),c("/FontBBox "+r.API.PDFObject.convert(o.metadata.bbox)),c("/Flags "+o.metadata.flags),c("/StemV "+o.metadata.stemV),c("/ItalicAngle "+o.metadata.italicAngle),c("/Ascent "+o.metadata.ascender),c("/Descent "+o.metadata.decender),c("/CapHeight "+o.metadata.capHeight),c(">>"),c("endobj");var R=l();c("<<"),c("/Type /Font"),c("/BaseFont /"+Hl(o.fontName)),c("/FontDescriptor "+E+" 0 R"),c("/W "+r.API.PDFObject.convert(d)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+o.encoding+")"),c(">>"),c(">>"),c("endobj"),o.objectNumber=l(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+w+" 0 R"),c("/BaseFont /"+Hl(o.fontName)),c("/Encoding /"+o.encoding),c("/DescendantFonts ["+R+" 0 R]"),c(">>"),c("endobj"),o.isAlreadyPutted=!0}})(s)}]),e.events.push(["putFont",function(s){(function(i){var o=i.font,c=i.out,l=i.newObject,u=i.putStream;if(o.metadata instanceof r.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var d=o.metadata.rawData,g="",p=0;p<d.length;p++)g+=String.fromCharCode(d[p]);var y=l();u({data:g,addLength1:!0,objectId:y}),c("endobj");var v=l();u({data:n(o.metadata.toUnicode),addLength1:!0,objectId:v}),c("endobj");var w=l();c("<<"),c("/Descent "+o.metadata.decender),c("/CapHeight "+o.metadata.capHeight),c("/StemV "+o.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+y+" 0 R"),c("/Flags 96"),c("/FontBBox "+r.API.PDFObject.convert(o.metadata.bbox)),c("/FontName /"+Hl(o.fontName)),c("/ItalicAngle "+o.metadata.italicAngle),c("/Ascent "+o.metadata.ascender),c(">>"),c("endobj"),o.objectNumber=l();for(var E=0;E<o.metadata.hmtx.widths.length;E++)o.metadata.hmtx.widths[E]=parseInt(o.metadata.hmtx.widths[E]*(1e3/o.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+v+" 0 R/BaseFont/"+Hl(o.fontName)+"/FontDescriptor "+w+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+r.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),c("endobj"),o.isAlreadyPutted=!0}})(s)}]);var a=function(s){var i,o=s.text||"",c=s.x,l=s.y,u=s.options||{},d=s.mutex||{},g=d.pdfEscape,p=d.activeFontKey,y=d.fonts,v=p,w="",E=0,R="",P=y[v].encoding;if(y[v].encoding!=="Identity-H")return{text:o,x:c,y:l,options:u,mutex:d};for(R=o,v=p,Array.isArray(o)&&(R=o[0]),E=0;E<R.length;E+=1)y[v].metadata.hasOwnProperty("cmap")&&(i=y[v].metadata.cmap.unicode.codeMap[R[E].charCodeAt(0)]),i||R[E].charCodeAt(0)<256&&y[v].metadata.hasOwnProperty("Unicode")?w+=R[E]:w+="";var q="";return parseInt(v.slice(1))<14||P==="WinAnsiEncoding"?q=g(w,v).split("").map(function(z){return z.charCodeAt(0).toString(16)}).join(""):P==="Identity-H"&&(q=t(w,y[v])),d.isHex=!0,{text:q,x:c,y:l,options:u,mutex:d}};e.events.push(["postProcessText",function(s){var i=s.text||"",o=[],c={text:i,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(i)){var l=0;for(l=0;l<i.length;l+=1)Array.isArray(i[l])&&i[l].length===3?o.push([a(Object.assign({},c,{text:i[l][0]})).text,i[l][1],i[l][2]]):o.push(a(Object.assign({},c,{text:i[l]})).text);s.text=o}else s.text=a(Object.assign({},c,{text:i})).text}])}(jt),function(r){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};r.existsFileInVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0},r.addFileToVFS=function(t,n){return e.call(this),this.internal.vFS[t]=n,this},r.getFileFromVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0?this.internal.vFS[t]:null}}(jt.API),function(r){r.__bidiEngine__=r.prototype.__bidiEngine__=function(n){var a,s,i,o,c,l,u,d=e,g=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],p=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],y={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},v={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},w=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],E=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),R=!1,P=0;this.__bidiEngine__={};var q=function(S){var A=S.charCodeAt(),C=A>>8,J=v[C];return J!==void 0?d[256*J+(255&A)]:C===252||C===253?"AL":E.test(C)?"L":C===8?"R":"N"},z=function(S){for(var A,C=0;C<S.length;C++){if((A=q(S.charAt(C)))==="L")return!1;if(A==="R")return!0}return!1},K=function(S,A,C,J){var ue,me,pe,ge,ne=A[J];switch(ne){case"L":case"R":R=!1;break;case"N":case"AN":break;case"EN":R&&(ne="AN");break;case"AL":R=!0,ne="R";break;case"WS":ne="N";break;case"CS":J<1||J+1>=A.length||(ue=C[J-1])!=="EN"&&ue!=="AN"||(me=A[J+1])!=="EN"&&me!=="AN"?ne="N":R&&(me="AN"),ne=me===ue?me:"N";break;case"ES":ne=(ue=J>0?C[J-1]:"B")==="EN"&&J+1<A.length&&A[J+1]==="EN"?"EN":"N";break;case"ET":if(J>0&&C[J-1]==="EN"){ne="EN";break}if(R){ne="N";break}for(pe=J+1,ge=A.length;pe<ge&&A[pe]==="ET";)pe++;ne=pe<ge&&A[pe]==="EN"?"EN":"N";break;case"NSM":if(i&&!o){for(ge=A.length,pe=J+1;pe<ge&&A[pe]==="NSM";)pe++;if(pe<ge){var we=S[J],Oe=we>=1425&&we<=2303||we===64286;if(ue=A[pe],Oe&&(ue==="R"||ue==="AL")){ne="R";break}}}ne=J<1||(ue=A[J-1])==="B"?"N":C[J-1];break;case"B":R=!1,a=!0,ne=P;break;case"S":s=!0,ne="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":R=!1;break;case"BN":ne="N"}return ne},I=function(S,A,C){var J=S.split("");return C&&N(J,C,{hiLevel:P}),J.reverse(),A&&A.reverse(),J.join("")},N=function(S,A,C){var J,ue,me,pe,ge,ne=-1,we=S.length,Oe=0,k=[],O=P?p:g,M=[];for(R=!1,a=!1,s=!1,ue=0;ue<we;ue++)M[ue]=q(S[ue]);for(me=0;me<we;me++){if(ge=Oe,k[me]=K(S,M,k,me),J=240&(Oe=O[ge][y[k[me]]]),Oe&=15,A[me]=pe=O[Oe][5],J>0)if(J===16){for(ue=ne;ue<me;ue++)A[ue]=1;ne=-1}else ne=-1;if(O[Oe][6])ne===-1&&(ne=me);else if(ne>-1){for(ue=ne;ue<me;ue++)A[ue]=pe;ne=-1}M[me]==="B"&&(A[me]=0),C.hiLevel|=pe}s&&function(U,ee,he){for(var de=0;de<he;de++)if(U[de]==="S"){ee[de]=P;for(var fe=de-1;fe>=0&&U[fe]==="WS";fe--)ee[fe]=P}}(M,A,we)},F=function(S,A,C,J,ue){if(!(ue.hiLevel<S)){if(S===1&&P===1&&!a)return A.reverse(),void(C&&C.reverse());for(var me,pe,ge,ne,we=A.length,Oe=0;Oe<we;){if(J[Oe]>=S){for(ge=Oe+1;ge<we&&J[ge]>=S;)ge++;for(ne=Oe,pe=ge-1;ne<pe;ne++,pe--)me=A[ne],A[ne]=A[pe],A[pe]=me,C&&(me=C[ne],C[ne]=C[pe],C[pe]=me);Oe=ge}Oe++}}},j=function(S,A,C){var J=S.split(""),ue={hiLevel:P};return C||(C=[]),N(J,C,ue),function(me,pe,ge){if(ge.hiLevel!==0&&u)for(var ne,we=0;we<me.length;we++)pe[we]===1&&(ne=w.indexOf(me[we]))>=0&&(me[we]=w[ne+1])}(J,C,ue),F(2,J,A,C,ue),F(1,J,A,C,ue),J.join("")};return this.__bidiEngine__.doBidiReorder=function(S,A,C){if(function(ue,me){if(me)for(var pe=0;pe<ue.length;pe++)me[pe]=pe;o===void 0&&(o=z(ue)),l===void 0&&(l=z(ue))}(S,A),i||!c||l)if(i&&c&&o^l)P=o?1:0,S=I(S,A,C);else if(!i&&c&&l)P=o?1:0,S=j(S,A,C),S=I(S,A);else if(!i||o||c||l){if(i&&!c&&o^l)S=I(S,A),o?(P=0,S=j(S,A,C)):(P=1,S=j(S,A,C),S=I(S,A));else if(i&&o&&!c&&l)P=1,S=j(S,A,C),S=I(S,A);else if(!i&&!c&&o^l){var J=u;o?(P=1,S=j(S,A,C),P=0,u=!1,S=j(S,A,C),u=J):(P=0,S=j(S,A,C),S=I(S,A),P=1,u=!1,S=j(S,A,C),u=J,S=I(S,A))}}else P=0,S=j(S,A,C);else P=o?1:0,S=j(S,A,C);return S},this.__bidiEngine__.setOptions=function(S){S&&(i=S.isInputVisual,c=S.isOutputVisual,o=S.isInputRtl,l=S.isOutputRtl,u=S.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new r.__bidiEngine__({isInputVisual:!0});r.API.events.push(["postProcessText",function(n){var a=n.text,s=(n.x,n.y,n.options||{}),i=(n.mutex,s.lang,[]);if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,t.setOptions(s),Object.prototype.toString.call(a)==="[object Array]"){var o=0;for(i=[],o=0;o<a.length;o+=1)Object.prototype.toString.call(a[o])==="[object Array]"?i.push([t.doBidiReorder(a[o][0]),a[o][1],a[o][2]]):i.push([t.doBidiReorder(a[o])]);n.text=i}else n.text=t.doBidiReorder(a);t.setOptions({isInputVisual:!0})}])}(jt),jt.API.TTFFont=function(){function r(e){var t;if(this.rawData=e,t=this.contents=new Ko(e),this.contents.pos=4,t.readString(4)==="ttcf")throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new x9(this),this.registerTTF()}return r.open=function(e){return new r(e)},r.prototype.parse=function(){return this.directory=new n9(this.contents),this.head=new s9(this),this.name=new u9(this),this.cmap=new Ub(this),this.toUnicode={},this.hhea=new i9(this),this.maxp=new h9(this),this.hmtx=new f9(this),this.post=new c9(this),this.os2=new o9(this),this.loca=new g9(this),this.glyf=new d9(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},r.prototype.registerTTF=function(){var e,t,n,a,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var i,o,c,l;for(l=[],i=0,o=(c=this.bbox).length;i<o;i++)e=c[i],l.push(Math.round(e*this.scaleFactor));return l}).call(this),this.stemV=0,this.post.exists?(n=255&(a=this.post.italic_angle),32768&(t=a>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},r.prototype.characterToGlyph=function(e){var t;return((t=this.cmap.unicode)!=null?t.codeMap[e]:void 0)||0},r.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},r.prototype.widthOfString=function(e,t,n){var a,s,i,o;for(i=0,s=0,o=(e=""+e).length;0<=o?s<o:s>o;s=0<=o?++s:--s)a=e.charCodeAt(s),i+=this.widthOfGlyph(this.characterToGlyph(a))+n*(1e3/t)||0;return i*(t/1e3)},r.prototype.lineHeight=function(e,t){var n;return t==null&&(t=!1),n=t?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},r}();var Ys,Ko=function(){function r(e){this.data=e??[],this.pos=0,this.length=this.data.length}return r.prototype.readByte=function(){return this.data[this.pos++]},r.prototype.writeByte=function(e){return this.data[this.pos++]=e},r.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},r.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},r.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},r.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},r.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},r.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},r.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},r.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},r.prototype.readString=function(e){var t,n;for(n=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)n[t]=String.fromCharCode(this.readByte());return n.join("")},r.prototype.writeString=function(e){var t,n,a;for(a=[],t=0,n=e.length;0<=n?t<n:t>n;t=0<=n?++t:--t)a.push(this.writeByte(e.charCodeAt(t)));return a},r.prototype.readShort=function(){return this.readInt16()},r.prototype.writeShort=function(e){return this.writeInt16(e)},r.prototype.readLongLong=function(){var e,t,n,a,s,i,o,c;return e=this.readByte(),t=this.readByte(),n=this.readByte(),a=this.readByte(),s=this.readByte(),i=this.readByte(),o=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^n)+4294967296*(255^a)+16777216*(255^s)+65536*(255^i)+256*(255^o)+(255^c)+1):72057594037927940*e+281474976710656*t+1099511627776*n+4294967296*a+16777216*s+65536*i+256*o+c},r.prototype.writeLongLong=function(e){var t,n;return t=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},r.prototype.readInt=function(){return this.readInt32()},r.prototype.writeInt=function(e){return this.writeInt32(e)},r.prototype.read=function(e){var t,n;for(t=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)t.push(this.readByte());return t},r.prototype.write=function(e){var t,n,a,s;for(s=[],n=0,a=e.length;n<a;n++)t=e[n],s.push(this.writeByte(t));return s},r}(),n9=function(){var r;function e(t){var n,a,s;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},a=0,s=this.tableCount;0<=s?a<s:a>s;a=0<=s?++a:--a)n={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(t){var n,a,s,i,o,c,l,u,d,g,p,y,v;for(v in p=Object.keys(t).length,c=Math.log(2),d=16*Math.floor(Math.log(p)/c),i=Math.floor(d/c),u=16*p-d,(a=new Ko).writeInt(this.scalarType),a.writeShort(p),a.writeShort(d),a.writeShort(i),a.writeShort(u),s=16*p,l=a.pos+s,o=null,y=[],t)for(g=t[v],a.writeString(v),a.writeInt(r(g)),a.writeInt(l),a.writeInt(g.length),y=y.concat(g),v==="head"&&(o=l),l+=g.length;l%4;)y.push(0),l++;return a.write(y),n=2981146554-r(a.data),a.pos=o+8,a.writeUInt32(n),a.data},r=function(t){var n,a,s,i;for(t=qb.call(t);t.length%4;)t.push(0);for(s=new Ko(t),a=0,n=0,i=t.length;n<i;n=n+=4)a+=s.readUInt32();return 4294967295&a},e}(),a9={}.hasOwnProperty,wi=function(r,e){for(var t in e)a9.call(e,t)&&(r[t]=e[t]);function n(){this.constructor=r}return n.prototype=e.prototype,r.prototype=new n,r.__super__=e.prototype,r};Ys=function(){function r(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return r.prototype.parse=function(){},r.prototype.encode=function(){},r.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},r}();var s9=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return wi(e,Ys),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var n;return(n=new Ko).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(t),n.writeShort(this.glyphDataFormat),n.data},e}(),Iv=function(){function r(e,t){var n,a,s,i,o,c,l,u,d,g,p,y,v,w,E,R,P;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),d=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(p=e.readUInt16(),g=p/2,e.pos+=6,s=function(){var q,z;for(z=[],c=q=0;0<=g?q<g:q>g;c=0<=g?++q:--q)z.push(e.readUInt16());return z}(),e.pos+=2,v=function(){var q,z;for(z=[],c=q=0;0<=g?q<g:q>g;c=0<=g?++q:--q)z.push(e.readUInt16());return z}(),l=function(){var q,z;for(z=[],c=q=0;0<=g?q<g:q>g;c=0<=g?++q:--q)z.push(e.readUInt16());return z}(),u=function(){var q,z;for(z=[],c=q=0;0<=g?q<g:q>g;c=0<=g?++q:--q)z.push(e.readUInt16());return z}(),a=(this.length-e.pos+this.offset)/2,o=function(){var q,z;for(z=[],c=q=0;0<=a?q<a:q>a;c=0<=a?++q:--q)z.push(e.readUInt16());return z}(),c=E=0,P=s.length;E<P;c=++E)for(w=s[c],n=R=y=v[c];y<=w?R<=w:R>=w;n=y<=w?++R:--R)u[c]===0?i=n+l[c]:(i=o[u[c]/2+(n-y)-(g-c)]||0)!==0&&(i+=l[c]),this.codeMap[n]=65535&i}e.pos=d}return r.encode=function(e,t){var n,a,s,i,o,c,l,u,d,g,p,y,v,w,E,R,P,q,z,K,I,N,F,j,S,A,C,J,ue,me,pe,ge,ne,we,Oe,k,O,M,U,ee,he,de,fe,be,Me,Z;switch(J=new Ko,i=Object.keys(e).sort(function(Xe,st){return Xe-st}),t){case"macroman":for(v=0,w=function(){var Xe=[];for(y=0;y<256;++y)Xe.push(0);return Xe}(),R={0:0},s={},ue=0,ne=i.length;ue<ne;ue++)R[fe=e[a=i[ue]]]==null&&(R[fe]=++v),s[a]={old:e[a],new:R[e[a]]},w[a]=R[e[a]];return J.writeUInt16(1),J.writeUInt16(0),J.writeUInt32(12),J.writeUInt16(0),J.writeUInt16(262),J.writeUInt16(0),J.write(w),{charMap:s,subtable:J.data,maxGlyphID:v+1};case"unicode":for(A=[],d=[],P=0,R={},n={},E=l=null,me=0,we=i.length;me<we;me++)R[z=e[a=i[me]]]==null&&(R[z]=++P),n[a]={old:z,new:R[z]},o=R[z]-a,E!=null&&o===l||(E&&d.push(E),A.push(a),l=o),E=a;for(E&&d.push(E),d.push(65535),A.push(65535),j=2*(F=A.length),N=2*Math.pow(Math.log(F)/Math.LN2,2),g=Math.log(N/2)/Math.LN2,I=2*F-N,c=[],K=[],p=[],y=pe=0,Oe=A.length;pe<Oe;y=++pe){if(S=A[y],u=d[y],S===65535){c.push(0),K.push(0);break}if(S-(C=n[S].new)>=32768)for(c.push(0),K.push(2*(p.length+F-y)),a=ge=S;S<=u?ge<=u:ge>=u;a=S<=u?++ge:--ge)p.push(n[a].new);else c.push(C-S),K.push(0)}for(J.writeUInt16(3),J.writeUInt16(1),J.writeUInt32(12),J.writeUInt16(4),J.writeUInt16(16+8*F+2*p.length),J.writeUInt16(0),J.writeUInt16(j),J.writeUInt16(N),J.writeUInt16(g),J.writeUInt16(I),he=0,k=d.length;he<k;he++)a=d[he],J.writeUInt16(a);for(J.writeUInt16(0),de=0,O=A.length;de<O;de++)a=A[de],J.writeUInt16(a);for(be=0,M=c.length;be<M;be++)o=c[be],J.writeUInt16(o);for(Me=0,U=K.length;Me<U;Me++)q=K[Me],J.writeUInt16(q);for(Z=0,ee=p.length;Z<ee;Z++)v=p[Z],J.writeUInt16(v);return{charMap:n,subtable:J.data,maxGlyphID:P+1}}},r}(),Ub=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return wi(e,Ys),e.prototype.tag="cmap",e.prototype.parse=function(t){var n,a,s;for(t.pos=this.offset,this.version=t.readUInt16(),s=t.readUInt16(),this.tables=[],this.unicode=null,a=0;0<=s?a<s:a>s;a=0<=s?++a:--a)n=new Iv(t,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},e.encode=function(t,n){var a,s;return n==null&&(n="macroman"),a=Iv.encode(t,n),(s=new Ko).writeUInt16(0),s.writeUInt16(1),a.table=s.data.concat(a.subtable),a},e}(),i9=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return wi(e,Ys),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),o9=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return wi(e,Ys),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var n,a;for(a=[],n=0;n<10;++n)a.push(t.readByte());return a}(),this.charRange=function(){var n,a;for(a=[],n=0;n<4;++n)a.push(t.readInt());return a}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var n,a;for(a=[],n=0;n<2;n=++n)a.push(t.readInt());return a}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),c9=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return wi(e,Ys),e.prototype.tag="post",e.prototype.parse=function(t){var n,a,s;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:break;case 131072:var i;for(a=t.readUInt16(),this.glyphNameIndex=[],i=0;0<=a?i<a:i>a;i=0<=a?++i:--i)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],s=[];t.pos<this.offset+this.length;)n=t.readByte(),s.push(this.names.push(t.readString(n)));return s;case 151552:return a=t.readUInt16(),this.offsets=t.read(a);case 196608:break;case 262144:return this.map=(function(){var o,c,l;for(l=[],i=o=0,c=this.file.maxp.numGlyphs;0<=c?o<c:o>c;i=0<=c?++o:--o)l.push(t.readUInt32());return l}).call(this)}},e}(),l9=function(r,e){this.raw=r,this.length=r.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},u9=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return wi(e,Ys),e.prototype.tag="name",e.prototype.parse=function(t){var n,a,s,i,o,c,l,u,d,g,p;for(t.pos=this.offset,t.readShort(),n=t.readShort(),c=t.readShort(),a=[],i=0;0<=n?i<n:i>n;i=0<=n?++i:--i)a.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+c+t.readShort()});for(l={},i=d=0,g=a.length;d<g;i=++d)s=a[i],t.pos=s.offset,u=t.readString(s.length),o=new l9(u,s),l[p=s.nameID]==null&&(l[p]=[]),l[s.nameID].push(o);this.strings=l,this.copyright=l[0],this.fontFamily=l[1],this.fontSubfamily=l[2],this.uniqueSubfamily=l[3],this.fontName=l[4],this.version=l[5];try{this.postscriptName=l[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=l[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=l[7],this.manufacturer=l[8],this.designer=l[9],this.description=l[10],this.vendorUrl=l[11],this.designerUrl=l[12],this.license=l[13],this.licenseUrl=l[14],this.preferredFamily=l[15],this.preferredSubfamily=l[17],this.compatibleFull=l[18],this.sampleText=l[19]},e}(),h9=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return wi(e,Ys),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),f9=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return wi(e,Ys),e.prototype.tag="hmtx",e.prototype.parse=function(t){var n,a,s,i,o,c,l;for(t.pos=this.offset,this.metrics=[],n=0,c=this.file.hhea.numberOfMetrics;0<=c?n<c:n>c;n=0<=c?++n:--n)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var u,d;for(d=[],n=u=0;0<=s?u<s:u>s;n=0<=s?++u:--u)d.push(t.readInt16());return d}(),this.widths=(function(){var u,d,g,p;for(p=[],u=0,d=(g=this.metrics).length;u<d;u++)i=g[u],p.push(i.advance);return p}).call(this),a=this.widths[this.widths.length-1],l=[],n=o=0;0<=s?o<s:o>s;n=0<=s?++o:--o)l.push(this.widths.push(a));return l},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),qb=[].slice,d9=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return wi(e,Ys),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var n,a,s,i,o,c,l,u,d,g;return t in this.cache?this.cache[t]:(i=this.file.loca,n=this.file.contents,a=i.indexOf(t),(s=i.lengthOf(t))===0?this.cache[t]=null:(n.pos=this.offset+a,o=(c=new Ko(n.read(s))).readShort(),u=c.readShort(),g=c.readShort(),l=c.readShort(),d=c.readShort(),this.cache[t]=o===-1?new p9(c,u,g,l,d):new m9(c,o,u,g,l,d),this.cache[t]))},e.prototype.encode=function(t,n,a){var s,i,o,c,l;for(o=[],i=[],c=0,l=n.length;c<l;c++)s=t[n[c]],i.push(o.length),s&&(o=o.concat(s.encode(a)));return i.push(o.length),{table:o,offsets:i}},e}(),m9=function(){function r(e,t,n,a,s,i){this.raw=e,this.numberOfContours=t,this.xMin=n,this.yMin=a,this.xMax=s,this.yMax=i,this.compound=!1}return r.prototype.encode=function(){return this.raw.data},r}(),p9=function(){function r(e,t,n,a,s){var i,o;for(this.raw=e,this.xMin=t,this.yMin=n,this.xMax=a,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],i=this.raw;o=i.readShort(),this.glyphOffsets.push(i.pos),this.glyphIDs.push(i.readUInt16()),32&o;)i.pos+=1&o?4:2,128&o?i.pos+=8:64&o?i.pos+=4:8&o&&(i.pos+=2)}return r.prototype.encode=function(){var e,t,n;for(t=new Ko(qb.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)t.pos=this.glyphOffsets[e];return t.data},r}(),g9=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return wi(e,Ys),e.prototype.tag="loca",e.prototype.parse=function(t){var n,a;return t.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var s,i;for(i=[],a=0,s=this.length;a<s;a+=2)i.push(2*t.readUInt16());return i}).call(this):(function(){var s,i;for(i=[],a=0,s=this.length;a<s;a+=4)i.push(t.readUInt32());return i}).call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,n){for(var a=new Uint32Array(this.offsets.length),s=0,i=0,o=0;o<a.length;++o)if(a[o]=s,i<n.length&&n[i]==o){++i,a[o]=s;var c=this.offsets[o],l=this.offsets[o+1]-c;l>0&&(s+=l)}for(var u=new Array(4*a.length),d=0;d<a.length;++d)u[4*d+3]=255&a[d],u[4*d+2]=(65280&a[d])>>8,u[4*d+1]=(16711680&a[d])>>16,u[4*d]=(4278190080&a[d])>>24;return u},e}(),x9=function(){function r(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return r.prototype.generateCmap=function(){var e,t,n,a,s;for(t in a=this.font.cmap.tables[0].codeMap,e={},s=this.subset)n=s[t],e[t]=a[n];return e},r.prototype.glyphsFor=function(e){var t,n,a,s,i,o,c;for(a={},i=0,o=e.length;i<o;i++)a[s=e[i]]=this.font.glyf.glyphFor(s);for(s in t=[],a)(n=a[s])!=null&&n.compound&&t.push.apply(t,n.glyphIDs);if(t.length>0)for(s in c=this.glyphsFor(t))n=c[s],a[s]=n;return a},r.prototype.encode=function(e,t){var n,a,s,i,o,c,l,u,d,g,p,y,v,w,E;for(a in n=Ub.encode(this.generateCmap(),"unicode"),i=this.glyphsFor(e),p={0:0},E=n.charMap)p[(c=E[a]).old]=c.new;for(y in g=n.maxGlyphID,i)y in p||(p[y]=g++);return u=function(R){var P,q;for(P in q={},R)q[R[P]]=P;return q}(p),d=Object.keys(u).sort(function(R,P){return R-P}),v=function(){var R,P,q;for(q=[],R=0,P=d.length;R<P;R++)o=d[R],q.push(u[o]);return q}(),s=this.font.glyf.encode(i,v,p),l=this.font.loca.encode(s.offsets,v),w={cmap:this.font.cmap.raw(),glyf:s.table,loca:l,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(w["OS/2"]=this.font.os2.raw()),this.font.directory.encode(w)},r}();jt.API.PDFObject=function(){var r;function e(){}return r=function(t,n){return(Array(n+1).join("0")+t).slice(-n)},e.convert=function(t){var n,a,s,i;if(Array.isArray(t))return"["+function(){var o,c,l;for(l=[],o=0,c=t.length;o<c;o++)n=t[o],l.push(e.convert(n));return l}().join(" ")+"]";if(typeof t=="string")return"/"+t;if(t!=null&&t.isString)return"("+t+")";if(t instanceof Date)return"(D:"+r(t.getUTCFullYear(),4)+r(t.getUTCMonth(),2)+r(t.getUTCDate(),2)+r(t.getUTCHours(),2)+r(t.getUTCMinutes(),2)+r(t.getUTCSeconds(),2)+"Z)";if({}.toString.call(t)==="[object Object]"){for(a in s=["<<"],t)i=t[a],s.push("/"+a+" "+e.convert(i));return s.push(">>"),s.join(`
`)}return""+t},e}();const v9=(r,e,t)=>{const n=new jt;let a=20;n.setFontSize(16),n.text("Reporte Financiero",105,a,{align:"center"}),a+=10,n.setFontSize(12),n.text(`Período: ${new Date(e).toLocaleDateString("es-NI")} - ${new Date(t).toLocaleDateString("es-NI")}`,105,a,{align:"center"});const s=(i,o)=>{a+=15,n.setFontSize(14),n.text(i,20,a),a+=8,n.setFontSize(12),o.forEach(c=>{n.text(c.label,30,a),n.text(c.value,160,a,{align:"right"}),a+=7})};return s("Ventas y Ganancias",[{label:"Ventas Totales:",value:et(r.totalSales)},{label:"Costo de Ventas:",value:et(r.costOfSales)},{label:"Gastos:",value:et(r.totalExpenses)},{label:"Ganancia Neta:",value:et(r.netProfit)}]),s("Métodos de Pago",[{label:"Efectivo:",value:et(r.cashPayments)},{label:"Tarjeta:",value:et(r.cardPayments)},{label:"Transferencia:",value:et(r.transferPayments)}]),s("Créditos",[{label:"Total en Créditos:",value:et(r.creditTotal)},{label:"Créditos Pagados:",value:et(r.creditPaid)},{label:"Créditos Pendientes:",value:et(r.creditPending)},{label:"Ganancia en Créditos:",value:et(r.creditProfit)}]),s("Inventario",[{label:"Valor del Inventario:",value:et(r.inventoryCost)}]),n.setFontSize(10),n.text(`Generado el ${new Date().toLocaleDateString("es-NI",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}`,105,280,{align:"center"}),n};function y9({metrics:r,startDate:e,endDate:t,onStartDateChange:n,onEndDateChange:a,onSearch:s}){return h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Reportes"}),h.jsx(eg,{startDate:e,endDate:t,onStartDateChange:n,onEndDateChange:a,onSearch:s})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[h.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[h.jsxs("div",{className:"flex items-center justify-between mb-4",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Ventas Totales"}),h.jsx(gu,{className:"w-6 h-6 text-green-600"})]}),h.jsx("p",{className:"text-3xl font-bold text-green-600",children:et(r.totalSales)})]}),h.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[h.jsxs("div",{className:"flex items-center justify-between mb-4",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Total en Créditos"}),h.jsx(Xf,{className:"w-6 h-6 text-blue-600"})]}),h.jsx("p",{className:"text-3xl font-bold text-blue-600",children:et(r.creditTotal)})]}),h.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[h.jsxs("div",{className:"flex items-center justify-between mb-4",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Gastos Totales"}),h.jsx(Gh,{className:"w-6 h-6 text-red-600"})]}),h.jsx("p",{className:"text-3xl font-bold text-red-600",children:et(r.totalExpenses)})]})]}),h.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Métodos de Pago"}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[h.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[h.jsx("p",{className:"text-gray-600",children:"Efectivo"}),h.jsx("p",{className:"text-xl font-bold text-gray-900",children:et(r.cashPayments)})]}),h.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[h.jsx("p",{className:"text-gray-600",children:"Tarjeta"}),h.jsx("p",{className:"text-xl font-bold text-gray-900",children:et(r.cardPayments)})]}),h.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[h.jsx("p",{className:"text-gray-600",children:"Transferencia"}),h.jsx("p",{className:"text-xl font-bold text-gray-900",children:et(r.transferPayments)})]})]})]})]})}function Cv({userRole:r="admin"}){const[e,t]=Se.useState([]),[n,a]=Se.useState([]),[s,i]=Se.useState([]),[o,c]=Se.useState([]),[l,u]=Se.useState([]),[d,g]=Se.useState(!0),[p,y]=Se.useState(null),[v,w]=Se.useState(()=>new Date().toISOString().split("T")[0]),[E,R]=Se.useState(()=>new Date().toISOString().split("T")[0]),[P,q]=Se.useState(()=>Ku([],[],[],[],v,E));Se.useEffect(()=>{(async()=>{g(!0);try{const[N,F,j,S]=await Promise.all([Bt.sales.load(),Bt.products.load(),Bt.expenses.load(),Bt.credits.load()]);t(N||[]),i(F),c(j),u(S);const A=J0(N,v,E);a(A),q(Ku(A,F,j,S,v,E)),y(null)}catch(N){console.error("Error loading data:",N),y("Error loading data"),t([]),i([]),c([]),u([])}finally{g(!1)}})()},[]),Se.useEffect(()=>{if(!v||!E){console.warn("Invalid date range:",{startDate:v,endDate:E});return}const I=J0(e,v,E);a(I),q(Ku(I,s,o,l,v,E))},[e,v,E,s,o,l]);const z=()=>{if(!v||!E){console.warn("Invalid date range for search:",{startDate:v,endDate:E});return}const I=J0(e,v,E);a(I),q(Ku(I,s,o,l,v,E))};if(d)return h.jsx("div",{className:"flex justify-center items-center h-64",children:h.jsx("div",{className:"text-gray-500",children:"Cargando..."})});if(p)return h.jsxs("div",{className:"text-red-500",children:["Error: ",p]});const K=()=>{v9(P,v,E).save(`reporte-financiero-${v}-${E}.pdf`)};return r!=="admin"&&r!=="super"?h.jsx(y9,{metrics:{totalSales:P.totalSales,creditTotal:P.creditTotal,totalExpenses:P.totalExpenses,cashPayments:P.cashPayments,cardPayments:P.cardPayments,transferPayments:P.transferPayments},startDate:v,endDate:E,onStartDateChange:w,onEndDateChange:R,onSearch:()=>{const I=J0(e,v,E);a(I),q(Ku(I,s,o,l,v,E))}}):h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:justify-between sm:items-center sm:space-y-0",children:[h.jsxs("div",{className:"flex items-center space-x-4",children:[h.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Reportes Financieros"}),h.jsxs("button",{onClick:K,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center",title:"Descargar reporte PDF",children:[h.jsx(zv,{className:"w-4 h-4 mr-2"}),"Descargar PDF"]})]}),h.jsx("div",{className:"flex-shrink-0",children:h.jsx(eg,{startDate:v,endDate:E,onStartDateChange:w,onEndDateChange:R,onSearch:z})})]}),h.jsx(vj,{...P})]})}const rf={paperSize:{width:70,height:297},fontSize:{title:12,subtitle:10,body:8},businessInfo:{name:"Alvaro Rugama",subtitle:"Make Up Studio & Beauty Salon"}},w9=r=>{localStorage.setItem("receiptConfig",JSON.stringify(r))},Cd=()=>{try{const r=localStorage.getItem("receiptConfig");if(!r)return rf;const e=JSON.parse(r);return{...rf,...e,paperSize:{...rf.paperSize,...e.paperSize,width:70}}}catch(r){return console.error("Error loading receipt config:",r),rf}},_9=r=>{const e=Cd(),t=new jt({orientation:"portrait",unit:"mm",format:[e.paperSize.width,e.paperSize.height],compress:!0});let n=10;const a=e.paperSize.width*.07;t.setFontSize(e.fontSize.title);const s=e.businessInfo.name,i=t.getStringUnitWidth(s)*t.getFontSize()/t.internal.scaleFactor;t.text(s,(e.paperSize.width-i)/2,n),n+=5,t.setFontSize(e.fontSize.subtitle);const o=e.businessInfo.subtitle,c=t.getStringUnitWidth(o)*t.getFontSize()/t.internal.scaleFactor;t.text(o,(e.paperSize.width-c)/2,n),e.businessInfo.address&&(n+=4,t.setFontSize(e.fontSize.body),t.text(e.businessInfo.address,a,n)),e.businessInfo.phone&&(n+=4,t.text(`Tel: ${e.businessInfo.phone}`,a,n)),e.businessInfo.email&&(n+=4,t.text(e.businessInfo.email,a,n)),n+=8,t.setFontSize(e.fontSize.body),t.text(`Factura #${String(r.invoiceNumber).padStart(6,"0")}`,a,n),n+=4;const l=new Date(r.date).toLocaleDateString("es-NI",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});t.text(`Fecha: ${l}`,a,n),n+=4,t.text(`Cliente: ${r.clientName}`,a,n),r.clientCode&&(n+=4,t.text(`Código: ${r.clientCode}`,a,n)),n+=8,t.text("Productos:",a,n),n+=4,r.products.forEach(p=>{t.text(p.name,a,n),t.text(String(p.quantity),a+30,n),t.text(et(p.finalPrice),a+45,n),t.text(et(p.finalPrice*p.quantity),a+65,n),n+=4}),n+=4,t.text("Subtotal:",a+45,n),t.text(et(r.subtotal),a+65,n),r.discount>0&&(n+=4,t.text("Descuento:",a+45,n),t.text(`-${et(r.discount)}`,a+65,n)),n+=4,t.setFontSize(e.fontSize.subtitle),t.text("Total:",a+45,n),t.text(et(r.total),a+65,n),n+=8,t.setFontSize(e.fontSize.body);const u={cash:"Efectivo",card:"Tarjeta",transfer:"Transferencia"};t.text(`Método de pago: ${u[r.paymentMethod]}`,a,n),r.reference&&(n+=4,t.text(`Referencia: ${r.reference}`,a,n)),n+=8;const d="¡Gracias por su preferencia!",g=t.getStringUnitWidth(d)*t.getFontSize()/t.internal.scaleFactor;return t.text(d,(e.paperSize.width-g)/2,n),t},b9=r=>{const e=Cd(),t=new Date(r.date).toLocaleDateString("es-NI",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),n={cash:"Efectivo",card:"Tarjeta",transfer:"Transferencia"};return`
    <div class="receipt" style="
      font-family: 'Courier New', monospace;
      max-width: ${e.paperSize.width}mm;
      margin: 0 auto;
      padding: 10mm;
      background: white;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    ">
      <div style="text-align: center; margin-bottom: 5mm;">
        <h1 style="
          font-size: ${e.fontSize.title}pt;
          margin: 0;
          margin-bottom: 2mm;
        ">${e.businessInfo.name}</h1>
        <div style="
          font-size: ${e.fontSize.subtitle}pt;
          margin-bottom: 2mm;
        ">${e.businessInfo.subtitle}</div>
        ${e.businessInfo.address?`
          <div style="font-size: ${e.fontSize.body}pt;">
            ${e.businessInfo.address}
          </div>
        `:""}
        ${e.businessInfo.phone?`
          <div style="font-size: ${e.fontSize.body}pt;">
            Tel: ${e.businessInfo.phone}
          </div>
        `:""}
        ${e.businessInfo.email?`
          <div style="font-size: ${e.fontSize.body}pt;">
            ${e.businessInfo.email}
          </div>
        `:""}
      </div>

      <div style="margin-bottom: 5mm; font-size: ${e.fontSize.body}pt;">
        <div>Factura #${String(r.invoiceNumber).padStart(6,"0")}</div>
        <div>Fecha: ${t}</div>
        <div>Cliente: ${r.clientName}</div>
        ${r.clientCode?`<div>Código: ${r.clientCode}</div>`:""}
      </div>

      <table style="
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 5mm;
        font-size: ${e.fontSize.body}pt;
      ">
        <thead>
          <tr style="border-bottom: 1px solid #000;">
            <th style="text-align: left;">Producto</th>
            <th style="text-align: right;">Cant.</th>
            <th style="text-align: right;">Precio</th>
            <th style="text-align: right;">Total</th>
          </tr>
        </thead>
        <tbody>
          ${r.products.map(a=>`
            <tr>
              <td style="padding: 1mm 0;">${a.name}</td>
              <td style="text-align: right;">${a.quantity}</td>
              <td style="text-align: right;">${et(a.finalPrice)}</td>
              <td style="text-align: right;">${et(a.finalPrice*a.quantity)}</td>
            </tr>
          `).join("")}
          <tr style="border-top: 1px solid #000;">
            <td colspan="3" style="text-align: right; padding-top: 2mm;">Subtotal:</td>
            <td style="text-align: right; padding-top: 2mm;">${et(r.subtotal)}</td>
          </tr>
          ${r.discount>0?`
            <tr>
              <td colspan="3" style="text-align: right;">Descuento:</td>
              <td style="text-align: right;">-${et(r.discount)}</td>
            </tr>
          `:""}
          <tr>
            <td colspan="3" style="text-align: right; font-weight: bold;">Total:</td>
            <td style="text-align: right; font-weight: bold;">${et(r.total)}</td>
          </tr>
        </tbody>
      </table>

      <div style="
        margin-bottom: 5mm;
        font-size: ${e.fontSize.body}pt;
      ">
        <div>Método de pago: ${n[r.paymentMethod]}</div>
        ${r.reference?`<div>Referencia: ${r.reference}</div>`:""}
      </div>

      <div style="
        text-align: center;
        margin-top: 10mm;
        font-size: ${e.fontSize.body}pt;
      ">
        ¡Gracias por su preferencia!
      </div>
    </div>
  `};function E9({sale:r,onClose:e}){return Tm.useEffect(()=>{window.print()},[]),h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 print:p-0",children:h.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-md w-full print:shadow-none print:w-auto",children:[h.jsxs("div",{className:"flex justify-between items-center p-4 border-b print:hidden",children:[h.jsx("h2",{className:"text-lg font-semibold",children:"Vista Previa de Impresión"}),h.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700",children:h.jsx(Ir,{className:"w-6 h-6"})})]}),h.jsx("div",{className:"p-4 print:p-0",dangerouslySetInnerHTML:{__html:b9(r)}}),h.jsx("div",{className:"p-4 border-t print:hidden",children:h.jsx("button",{onClick:()=>window.print(),className:"w-full px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:"Imprimir"})})]})})}function S9({sales:r,onCancel:e,onDelete:t}){const[n,a]=Se.useState(null),s=o=>new Date(o).toLocaleDateString("es-NI",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),i=o=>{switch(o){case"cash":return"Efectivo";case"card":return"Tarjeta";case"transfer":return"Transferencia";default:return o}};return h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"space-y-4",children:[...r].sort((o,c)=>new Date(c.date).getTime()-new Date(o.date).getTime()).map(o=>h.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[h.jsxs("div",{className:"p-4 border-b",children:[h.jsxs("div",{className:"flex justify-between items-start",children:[h.jsxs("div",{children:[h.jsx("h3",{className:"font-medium text-gray-900",children:o.clientName}),h.jsxs("p",{className:"text-sm text-gray-500",children:["Factura #",String(o.invoiceNumber).padStart(6,"0")," -",s(o.date)," -",h.jsx("span",{className:`${o.status==="cancelled"?"text-red-600":"text-green-600"} font-medium`,children:o.status==="cancelled"?"Cancelada":"Activa"}),o.clientCode&&` - Código: ${o.clientCode}`]}),o.status==="cancelled"&&o.cancellationReason&&h.jsxs("p",{className:"text-sm text-red-500 mt-1",children:["Motivo: ",o.cancellationReason]})]}),h.jsxs("div",{className:"text-right",children:[h.jsx("div",{className:"font-medium text-gray-900",children:et(o.total)}),h.jsxs("p",{className:"text-sm text-gray-500",children:[i(o.paymentMethod),o.reference&&` - Ref: ${o.reference}`]}),h.jsxs("div",{className:"mt-2 flex justify-end space-x-2",children:[h.jsx("button",{onClick:()=>a(o),className:"text-blue-600 hover:text-blue-900",title:"Imprimir factura",children:h.jsx(Hh,{className:"w-4 h-4"})}),o.status==="active"&&h.jsx("button",{onClick:()=>e(o),className:"text-yellow-600 hover:text-yellow-900",title:"Cancelar venta",children:h.jsx(Kh,{className:"w-4 h-4"})}),o.status==="cancelled"&&h.jsx("button",{onClick:()=>t(o.id),className:"text-red-600 hover:text-red-900",title:"Eliminar venta",children:h.jsx(pi,{className:"w-4 h-4"})})]})]})]}),o.staffName&&h.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:["Vendedor: ",o.staffName,h.jsxs("span",{className:"ml-2 text-green-600",children:["(Comisión: ",et(o.staffCommission||0),")"]})]})]}),h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"min-w-full",children:[h.jsx("thead",{className:"bg-gray-50",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Producto"}),h.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Cantidad"}),h.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Precio"}),h.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Subtotal"})]})}),h.jsxs("tbody",{className:"divide-y divide-gray-200",children:[o.products.map(c=>h.jsxs("tr",{children:[h.jsxs("td",{className:"px-6 py-4",children:[h.jsx("div",{className:"font-medium text-gray-900",children:c.name}),h.jsxs("div",{className:"text-sm text-gray-500",children:["Código: ",c.code," - ",c.category]})]}),h.jsx("td",{className:"px-6 py-4 text-right text-gray-900",children:c.quantity}),h.jsx("td",{className:"px-6 py-4 text-right text-gray-900",children:et(c.finalPrice)}),h.jsx("td",{className:"px-6 py-4 text-right text-gray-900",children:et(c.finalPrice*c.quantity)})]},c.id)),h.jsxs("tr",{className:"bg-gray-50",children:[h.jsx("td",{colSpan:3,className:"px-6 py-4 text-right font-medium",children:"Subtotal:"}),h.jsx("td",{className:"px-6 py-4 text-right font-medium",children:et(o.subtotal)})]}),o.discount>0&&h.jsxs("tr",{className:"bg-gray-50",children:[h.jsx("td",{colSpan:3,className:"px-6 py-4 text-right font-medium text-red-600",children:"Descuento:"}),h.jsxs("td",{className:"px-6 py-4 text-right font-medium text-red-600",children:["-",et(o.discount)]})]}),h.jsxs("tr",{className:"bg-gray-50",children:[h.jsx("td",{colSpan:3,className:"px-6 py-4 text-right font-bold",children:"Total:"}),h.jsx("td",{className:"px-6 py-4 text-right font-bold",children:et(o.total)})]})]})]})})]},o.id))}),n&&h.jsx(E9,{sale:n,onClose:()=>a(null)})]})}function A9({products:r,staff:e,clients:t,onSubmit:n,onClose:a}){const[s,i]=Se.useState({clientName:"",clientCode:"",isNewClient:!1,products:[],staffId:"",staffName:"",staffCommission:0,staffCommissionRate:30,subtotal:0,discount:0,total:0,paymentMethod:"cash",reference:""}),[o,c]=Se.useState(""),[l,u]=Se.useState(""),[d,g]=Se.useState(!1),[p,y]=Se.useState(!1),[v,w]=Se.useState({}),E=()=>{if(!l.trim()){w({clientName:"El nombre del cliente es requerido"});return}const C=`C${Date.now().toString().slice(-6)}`,J={id:Date.now().toString(),code:C,name:l,phone:"",purchases:[]};i(me=>({...me,clientName:J.name,clientCode:J.code,isNewClient:!1}));const ue=Bt.clients.load();Bt.clients.save([...ue,J]),y(!1),u("")},R=t.filter(C=>C.name.toLowerCase().includes(l.toLowerCase())||C.code.toLowerCase().includes(l.toLowerCase())),P=r.filter(C=>C.name.toLowerCase().includes(o.toLowerCase())||C.code.toLowerCase().includes(o.toLowerCase())||C.category.toLowerCase().includes(o.toLowerCase()));Se.useEffect(()=>{const C=s.products.reduce((me,pe)=>me+pe.finalPrice*pe.quantity,0),J=C-s.discount,ue=s.products.reduce((me,pe)=>me+(pe.finalPrice-pe.originalPrice)*pe.quantity,0);i(me=>({...me,subtotal:C,total:J,staffCommission:s.staffId?ue*(s.staffCommissionRate/100):0}))},[s.products,s.discount,s.staffId,s.staffCommissionRate]);const q=C=>{if(C.quantity===0){alert("Este producto está agotado");return}const J=s.products.find(ue=>ue.id===C.id);if(J){if(J.quantity+1>C.quantity){alert("No hay suficiente stock disponible");return}i({...s,products:s.products.map(ue=>ue.id===C.id?{...ue,quantity:ue.quantity+1}:ue)})}else{if(C.quantity<1){alert("No hay suficiente stock disponible");return}i({...s,products:[...s.products,{id:C.id,code:C.code,name:C.name,quantity:1,originalPrice:C.costPrice,finalPrice:C.salePrice,category:C.category}]})}g(!1)},z=C=>{i({...s,isNewClient:!1,clientName:C.name,clientCode:C.code}),y(!1)},K=()=>{i({...s,clientName:l,isNewClient:!0,clientCode:""}),y(!1),u("")},I=(C,J)=>{const ue=r.find(ge=>ge.id===C);if(!ue)return;const me=s.products.find(ge=>ge.id===C);if(!me)return;const pe=me.quantity+J;if(pe>ue.quantity){alert("No hay suficiente stock disponible");return}pe<1||i({...s,products:s.products.map(ge=>ge.id===C?{...ge,quantity:pe}:ge)})},N=(C,J)=>{i({...s,products:s.products.map(ue=>ue.id===C?{...ue,finalPrice:J}:ue)})},F=C=>{i({...s,products:s.products.filter(J=>J.id!==C)})},j=C=>{i({...s,staffId:C.id,staffName:C.name,staffCommissionRate:C.commissionRate})},S=()=>{const C={};return s.clientName.trim()||(C.clientName="El nombre del cliente es requerido"),s.products.length===0&&(C.products="Debe agregar al menos un producto"),s.paymentMethod!=="cash"&&!s.reference&&(C.reference="La referencia es requerida para pagos con tarjeta o transferencia"),w(C),Object.keys(C).length===0},A=C=>{if(C.preventDefault(),S())try{const J={...s,invoiceNumber:Date.now(),date:new Date().toISOString(),status:"active"};n(J),setTimeout(()=>{const me=_9(J).output("blob"),pe=URL.createObjectURL(me),ge=window.open(pe,"_blank");ge&&(ge.onload=()=>{ge.print(),URL.revokeObjectURL(pe)})},100)}catch(J){console.error("Error processing sale:",J),alert("Error al procesar la venta. Por favor intente nuevamente.")}};return h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[h.jsxs("div",{className:"flex justify-between items-center p-6 border-b sticky top-0 bg-white",children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Nueva Venta"}),h.jsx("button",{onClick:a,className:"text-gray-500 hover:text-gray-700",children:h.jsx(Ir,{className:"w-6 h-6"})})]}),h.jsxs("form",{onSubmit:A,className:"p-6 space-y-6",children:[h.jsx("div",{className:"grid grid-cols-2 gap-4",children:h.jsxs("div",{children:[h.jsxs("div",{className:"relative",children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:s.isNewClient?"Nombre del Cliente Nuevo *":"Nombre del Cliente *"}),h.jsxs("div",{className:"flex space-x-2",children:[h.jsx("input",{type:"text",value:s.clientName,onClick:()=>y(!0),readOnly:!0,className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:s.isNewClient?"Ingrese el nombre del cliente":"Buscar cliente..."}),h.jsx("button",{type:"button",onClick:()=>y(!0),className:"px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",title:s.isNewClient?"Buscar cliente existente":"Buscar cliente",children:h.jsx(Wv,{className:"w-4 h-4"})})]}),s.isNewClient&&h.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Cliente nuevo - No registrado en el sistema"})]}),v.clientName&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:v.clientName})]})}),h.jsxs("div",{children:[h.jsxs("div",{className:"flex justify-between items-center mb-2",children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Productos *"}),h.jsxs("button",{type:"button",onClick:()=>g(!0),className:"px-3 py-1 bg-purple-600 text-white rounded-lg hover:bg-purple-700 flex items-center text-sm",children:[h.jsx(Ts,{className:"w-4 h-4 mr-1"}),"Agregar Producto"]})]}),v.products&&h.jsx("p",{className:"text-red-500 text-sm mb-2",children:v.products}),h.jsx("div",{className:"border rounded-lg divide-y",children:s.products.map(C=>h.jsxs("div",{className:"p-4 flex items-center justify-between",children:[h.jsxs("div",{className:"flex-1",children:[h.jsx("div",{className:"font-medium",children:C.name}),h.jsxs("div",{className:"text-sm text-gray-500",children:["Código: ",C.code," - ",C.category]})]}),h.jsxs("div",{className:"flex items-center space-x-4",children:[h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx("button",{type:"button",onClick:()=>I(C.id,-1),className:"p-1 text-gray-500 hover:text-gray-700",children:h.jsx(Hv,{className:"w-4 h-4"})}),h.jsx("input",{type:"number",value:C.quantity,onChange:J=>I(C.id,parseInt(J.target.value)-C.quantity),className:"w-16 px-2 py-1 border rounded text-center",min:"1"}),h.jsx("button",{type:"button",onClick:()=>I(C.id,1),className:"p-1 text-gray-500 hover:text-gray-700",children:h.jsx(Ts,{className:"w-4 h-4"})})]}),h.jsx("input",{type:"number",value:C.finalPrice,onChange:J=>N(C.id,parseFloat(J.target.value)),className:"w-24 px-2 py-1 border rounded text-right",min:C.originalPrice,step:"0.01"}),h.jsx("div",{className:"w-24 text-right",children:et(C.finalPrice*C.quantity)}),h.jsx("button",{type:"button",onClick:()=>F(C.id),className:"p-1 text-red-500 hover:text-red-700",children:h.jsx(pi,{className:"w-4 h-4"})})]})]},C.id))})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Colaborador (opcional)"}),h.jsxs("select",{value:s.staffId,onChange:C=>{const J=e.find(ue=>ue.id===C.target.value);J&&j(J)},className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[h.jsx("option",{value:"",children:"Seleccionar colaborador"}),e.map(C=>h.jsx("option",{value:C.id,children:C.name},C.id))]})]}),s.staffId&&h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Porcentaje de Comisión"}),h.jsxs("div",{className:"flex items-center",children:[h.jsx("input",{type:"number",value:s.staffCommissionRate,onChange:C=>i({...s,staffCommissionRate:Number(C.target.value)}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",min:"0",max:"100"}),h.jsx("span",{className:"ml-2",children:"%"})]})]})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Método de Pago *"}),h.jsxs("select",{value:s.paymentMethod,onChange:C=>i({...s,paymentMethod:C.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[h.jsx("option",{value:"cash",children:"Efectivo"}),h.jsx("option",{value:"card",children:"Tarjeta"}),h.jsx("option",{value:"transfer",children:"Transferencia"})]})]}),s.paymentMethod!=="cash"&&h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Referencia *"}),h.jsx("input",{type:"text",value:s.reference,onChange:C=>i({...s,reference:C.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:`Número de ${s.paymentMethod==="card"?"autorización":"transferencia"}`}),v.reference&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:v.reference})]})]}),h.jsx("div",{className:"border-t pt-4",children:h.jsx("div",{className:"flex justify-end space-y-2",children:h.jsxs("div",{className:"w-64 space-y-2",children:[h.jsxs("div",{className:"flex justify-between",children:[h.jsx("span",{children:"Subtotal:"}),h.jsx("span",{children:et(s.subtotal)})]}),h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("span",{children:"Descuento:"}),h.jsx("input",{type:"number",value:s.discount,onChange:C=>i({...s,discount:Math.min(s.subtotal,Math.max(0,Number(C.target.value)))}),className:"w-24 px-2 py-1 border rounded text-right",min:"0",max:s.subtotal,step:"0.01"})]}),s.staffId&&h.jsxs("div",{className:"flex justify-between text-sm text-gray-500",children:[h.jsxs("span",{children:["Comisión (",s.staffCommissionRate,"%):"]}),h.jsx("span",{children:et(s.staffCommission)})]}),h.jsxs("div",{className:"flex justify-between font-bold text-lg",children:[h.jsx("span",{children:"Total:"}),h.jsx("span",{children:et(s.total)})]})]})})}),h.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[h.jsx("button",{type:"button",onClick:a,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancelar"}),h.jsx("button",{type:"submit",className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:"Completar Venta"})]})]}),p&&h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full",children:[h.jsx("div",{className:"p-4 border-b",children:h.jsx("input",{type:"text",value:l,onChange:C=>{const J=C.target.value;u(J),i(ue=>({...ue,clientName:J,isNewClient:!0}))},placeholder:"Buscar por nombre o código...",className:"w-full px-4 py-2 border rounded-lg",autoFocus:!0})}),h.jsx("div",{className:"max-h-96 overflow-y-auto p-4",children:R.length>0?h.jsxs("table",{className:"min-w-full",children:[h.jsx("thead",{children:h.jsxs("tr",{children:[h.jsx("th",{className:"text-left",children:"Código"}),h.jsx("th",{className:"text-left",children:"Nombre"}),h.jsx("th",{className:"text-left",children:"Teléfono"})]})}),h.jsx("tbody",{children:R.map(C=>h.jsxs("tr",{onClick:()=>z(C),className:"hover:bg-gray-50 cursor-pointer",children:[h.jsx("td",{className:"py-2",children:C.code}),h.jsx("td",{children:C.name}),h.jsx("td",{children:C.phone})]},C.id))})]}):h.jsxs("div",{className:"text-center space-y-4 py-4",children:[h.jsx("p",{className:"text-gray-500",children:"No se encontraron clientes registrados"}),h.jsxs("div",{className:"space-y-2",children:[h.jsx("button",{type:"button",onClick:K,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:"Ingresar Cliente Temporal"}),h.jsx("button",{type:"button",onClick:E,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 block w-full",children:"Registrar Como Nuevo Cliente"})]})]})}),h.jsx("div",{className:"p-4 border-t",children:h.jsx("button",{onClick:()=>y(!1),className:"w-full px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"Cerrar"})})]})}),d&&h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full",children:[h.jsx("div",{className:"p-4 border-b",children:h.jsx("input",{type:"text",value:o,onChange:C=>c(C.target.value),placeholder:"Buscar por nombre, código o categoría...",className:"w-full px-4 py-2 border rounded-lg",autoFocus:!0})}),h.jsx("div",{className:"max-h-96 overflow-y-auto p-4",children:P.length>0?h.jsxs("table",{className:"min-w-full",children:[h.jsx("thead",{children:h.jsxs("tr",{children:[h.jsx("th",{className:"text-left",children:"Código"}),h.jsx("th",{className:"text-left",children:"Nombre"}),h.jsx("th",{className:"text-left",children:"Categoría"}),h.jsx("th",{className:"text-right",children:"Precio"})]})}),h.jsx("tbody",{children:P.map(C=>h.jsxs("tr",{onClick:()=>q(C),className:"hover:bg-gray-50 cursor-pointer",children:[h.jsx("td",{className:"py-2",children:C.code}),h.jsx("td",{children:C.name}),h.jsx("td",{children:C.category}),h.jsx("td",{className:"text-right",children:et(C.salePrice)})]},C.id))})]}):h.jsx("p",{className:"text-center text-gray-500",children:"No se encontraron productos"})}),h.jsx("div",{className:"p-4 border-t",children:h.jsx("button",{onClick:()=>g(!1),className:"w-full px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"Cerrar"})})]})})]})})}function N9({onConfirm:r,onClose:e,error:t}){const[n,a]=Se.useState(""),[s,i]=Se.useState(""),o=c=>{if(c.preventDefault(),!n){i("La contraseña es requerida");return}r(n)};return h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full",children:[h.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[h.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center",children:[h.jsx(jc,{className:"w-6 h-6 text-red-500 mr-2"}),"Eliminar Todas las Ventas"]}),h.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700",children:h.jsx(Ir,{className:"w-6 h-6"})})]}),h.jsxs("form",{onSubmit:o,className:"p-6 space-y-4",children:[h.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4",children:h.jsxs("div",{className:"flex",children:[h.jsx("div",{className:"flex-shrink-0",children:h.jsx(jc,{className:"h-5 w-5 text-yellow-400"})}),h.jsx("div",{className:"ml-3",children:h.jsx("p",{className:"text-sm text-yellow-700",children:"¡Advertencia! Esta acción eliminará permanentemente todas las ventas registradas. Esta acción no se puede deshacer."})})]})}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contraseña de Administrador *"}),h.jsx("input",{type:"password",value:n,onChange:c=>a(c.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),(s||t)&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:s||t})]}),h.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[h.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancelar"}),h.jsx("button",{type:"submit",className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Eliminar Todas las Ventas"})]})]})]})})}function T9({onConfirm:r,onClose:e}){const[t,n]=Se.useState(""),[a,s]=Se.useState(""),i=o=>{if(o.preventDefault(),!t.trim()){s("El motivo de cancelación es requerido");return}r(t)};return h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full",children:[h.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Cancelar Venta"}),h.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700",children:h.jsx(Ir,{className:"w-6 h-6"})})]}),h.jsxs("form",{onSubmit:i,className:"p-6 space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Motivo de Cancelación *"}),h.jsx("textarea",{value:t,onChange:o=>n(o.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",rows:3,placeholder:"Ingrese el motivo de la cancelación..."}),a&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:a})]}),h.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[h.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancelar"}),h.jsx("button",{type:"submit",className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Confirmar Cancelación"})]})]})]})})}function k9({onConfirm:r,onClose:e,error:t}){const[n,a]=Se.useState(""),[s,i]=Se.useState(""),o=c=>{if(c.preventDefault(),!n){i("La contraseña es requerida");return}r(n)};return h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full",children:[h.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[h.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center",children:[h.jsx(jc,{className:"w-6 h-6 text-red-500 mr-2"}),"Eliminar Venta"]}),h.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700",children:h.jsx(Ir,{className:"w-6 h-6"})})]}),h.jsxs("form",{onSubmit:o,className:"p-6 space-y-4",children:[h.jsx("p",{className:"text-gray-600",children:"Esta acción es irreversible. Por favor, ingrese la contraseña de administrador para confirmar."}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contraseña de Administrador *"}),h.jsx("input",{type:"password",value:n,onChange:c=>a(c.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),(s||t)&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:s||t})]}),h.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[h.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancelar"}),h.jsx("button",{type:"submit",className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Eliminar Venta"})]})]})]})})}const Np=(r,e)=>r.map(t=>{const n=e.find(a=>a.id===t.id);if(n){const a=t.quantity+n.quantity;if(a<0)throw new Error(`No hay suficiente stock para el producto: ${t.name}`);return{...t,quantity:a}}return t});function Pv(){const[r,e]=Se.useState([]),[t,n]=Se.useState([]),[a,s]=Se.useState([]),[i,o]=Se.useState([]),[c,l]=Se.useState(!1),[u,d]=Se.useState(),[g,p]=Se.useState(),[y,v]=Se.useState(""),[w,E]=Se.useState(!1),[R,P]=Se.useState(!0),[q,z]=Se.useState(null),[K,I]=Se.useState(()=>{const ge=new Date;return ge.setMonth(ge.getMonth()-1),ge.toISOString().split("T")[0]}),[N,F]=Se.useState([]),[j,S]=Se.useState(()=>new Date().toISOString().split("T")[0]),[A,C]=Se.useState(r);Se.useEffect(()=>{(async()=>{P(!0);try{const[ne,we,Oe,k]=await Promise.all([Bt.sales.load(),Bt.products.load(),Bt.staff.load(),Bt.clients.load()]);e(ne),n(we),s(Oe),o(k),F(k),z(null)}catch(ne){console.error("Error loading data:",ne),z("Error loading data"),e([]),n([]),s([]),o([])}finally{P(!1)}})()},[]),Se.useEffect(()=>{R||Bt.sales.save(r)},[r,R]),Se.useEffect(()=>{const ge=r.filter(ne=>{const we=new Date(ne.date).setHours(0,0,0,0),Oe=new Date(K).setHours(0,0,0,0),k=new Date(j).setHours(23,59,59,999);return we>=Oe&&we<=k});C(ge)},[r,K,j]),Se.useEffect(()=>{Bt.staff.save(a)},[a]),Se.useEffect(()=>{t.length>0&&Bt.products.save(t).catch(ge=>{console.error("Error saving products:",ge)})},[t]);const J=async ge=>{try{const ne=r.reduce((O,M)=>Math.max(O,M.invoiceNumber||0),0),we={...ge,id:Date.now().toString(),invoiceNumber:ne+1,date:new Date().toISOString(),status:"active"};if(ge.clientCode){const O=N.map(M=>{if(M.code===ge.clientCode){const U={id:we.id,date:we.date,total:we.total,products:we.products.map(ee=>({id:ee.id,name:ee.name,quantity:ee.quantity,price:ee.finalPrice}))};return{...M,purchases:[...M.purchases||[],U]}}return M});try{await Bt.clients.save(O),o(O)}catch(M){console.error("Error saving client purchase:",M)}F(O)}if(!Array.isArray(r)){console.error("Sales is not initialized properly"),alert("Error: Sistema no inicializado correctamente");return}const Oe=ge.products.map(O=>({id:O.id,quantity:-O.quantity})),k=Np(t,Oe);n(k);try{const O=[...r,we];if(await Bt.sales.save(O),e(O),we.staffId){const M=a.map(U=>U.id===we.staffId?{...U,sales:[...U.sales,{id:we.id,date:we.date,total:we.total,commission:we.staffCommission||0,commissionPaid:!1,products:we.products.map(ee=>({id:ee.id,name:ee.name,quantity:ee.quantity,price:ee.finalPrice}))}]}:U);await Bt.staff.save(M),s(M)}l(!1)}catch(O){console.error("Error saving sale:",O),alert("Error al guardar la venta. Los cambios serán revertidos."),n(t),o(i),s(a)}}catch(ne){alert(ne instanceof Error?ne.message:"Error al actualizar el inventario")}},ue=ge=>{if(u){const ne=t.map(Oe=>{const k=u.products.find(O=>O.id===Oe.id);return k?{...Oe,quantity:Oe.quantity+k.quantity}:Oe});n(ne);const we=r.map(Oe=>{if(Oe.id===u.id){const k={...Oe,status:"cancelled",cancellationReason:ge};return k.staffDiscount&&(k.staffDiscount={...k.staffDiscount,status:"cancelled",cancellationReason:ge}),k}return Oe});if(e(we),u.staffId){const Oe=a.map(k=>k.id===u.staffId?{...k,sales:k.sales.filter(O=>O.id!==u.id)}:k);s(Oe),Bt.staff.save(Oe)}d(void 0)}},me=ge=>{if(ge!=="admin2019"){v("Contraseña incorrecta");return}e(r.filter(ne=>ne.id!==g)),p(void 0)},pe=async ge=>{if(ge!=="admin2019"){v("Contraseña incorrecta");return}try{const ne=[];await Bt.sales.save(ne),e(ne),C(ne),E(!1),v("")}catch(ne){console.error("Error deleting all sales:",ne),v("Error al eliminar las ventas")}};return h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:justify-between sm:items-center sm:space-y-0",children:[h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Ventas"}),h.jsxs("button",{onClick:()=>l(!0),className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 flex items-center",children:[h.jsx(Ts,{className:"w-4 h-4 mr-2"}),"Nueva Venta"]}),h.jsx("button",{onClick:()=>E(!0),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Eliminar Todo"})]}),h.jsx("div",{className:"flex-shrink-0",children:h.jsx(eg,{startDate:K,endDate:j,onStartDateChange:I,onEndDateChange:S,onSearch:()=>{}})})]}),A.length>0?h.jsx(S9,{sales:A,onCancel:d,onDelete:p}):h.jsx("div",{className:"bg-white rounded-lg shadow p-6 text-center text-gray-500",children:r.length>0?"No hay ventas en el rango de fechas seleccionado.":"No hay ventas registradas. Comienza agregando una nueva."}),c&&h.jsx(A9,{products:t,staff:a,clients:i,onSubmit:J,onClose:()=>l(!1)}),u&&h.jsx(T9,{onConfirm:ue,onClose:()=>d(void 0)}),g&&h.jsx(k9,{onConfirm:me,onClose:()=>{p(void 0),v("")},error:y}),w&&h.jsx(N9,{onConfirm:pe,onClose:()=>{E(!1),v("")},error:y})]})}function I9({staff:r,onEdit:e,onDelete:t,onViewHistory:n,onAddDiscount:a}){const s=i=>{const c=i.sales.reduce((u,d)=>u+d.commission,0),l=i.discounts.filter(u=>u.status==="active").reduce((u,d)=>u+d.amount,0);return{totalCommissions:c,totalDiscounts:l,total:c-l}};return h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"min-w-full bg-white rounded-lg overflow-hidden",children:[h.jsx("thead",{className:"bg-gray-50",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Código"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nombre"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Teléfono"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Comisión"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Ventas"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Comisión Total"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),h.jsx("tbody",{className:"divide-y divide-gray-200",children:r.map(i=>h.jsxs("tr",{className:"hover:bg-gray-50",children:[h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:i.code}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:i.name}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:i.phone}),h.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[i.commissionRate,"%"]}),h.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[et(i.sales.reduce((o,c)=>o+c.total,0)),h.jsxs("div",{className:"text-xs text-gray-500",children:[i.sales.length," ventas realizadas"]})]}),h.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[et(s(i).total),i.discounts.length>0&&h.jsxs("div",{className:"text-xs text-red-500",children:[i.discounts.filter(o=>o.status==="active").length," descuentos activos",h.jsx("br",{}),i.sales.filter(o=>!o.commissionPaid).length," comisiones pendientes"]})]}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:h.jsxs("div",{className:"flex space-x-2",children:[h.jsx("button",{onClick:()=>n(i),className:"text-blue-600 hover:text-blue-900",title:"Ver historial",children:h.jsx(kp,{className:"w-4 h-4"})}),h.jsx("button",{onClick:()=>a(i),className:"text-yellow-600 hover:text-yellow-900",title:"Agregar descuento",children:h.jsx(gu,{className:"w-4 h-4"})}),h.jsx("button",{onClick:()=>e(i),className:"text-indigo-600 hover:text-indigo-900",title:"Editar",children:h.jsx($h,{className:"w-4 h-4"})}),h.jsx("button",{onClick:()=>t(i.id),className:"text-red-600 hover:text-red-900",title:"Eliminar",children:h.jsx(pi,{className:"w-4 h-4"})})]})})]},i.id))})]})})}function C9({staff:r,onSubmit:e,onClose:t,existingCodes:n}){const[a,s]=Se.useState({code:"",name:"",phone:"",commissionRate:30}),[i,o]=Se.useState({});Se.useEffect(()=>{r&&s({code:r.code,name:r.name,phone:r.phone,commissionRate:r.commissionRate})},[r]);const c=()=>{const u={};return a.code?!r&&n.includes(a.code)&&(u.code="Este código ya existe"):u.code="El código es requerido",a.name||(u.name="El nombre es requerido"),a.phone?/^\d{8}$/.test(a.phone)||(u.phone="El teléfono debe tener 8 dígitos"):u.phone="El teléfono es requerido",(a.commissionRate<0||a.commissionRate>100)&&(u.commissionRate="La comisión debe estar entre 0% y 100%"),o(u),Object.keys(u).length===0},l=u=>{u.preventDefault(),c()&&e(a)};return h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full",children:[h.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:r?"Editar Colaborador":"Nuevo Colaborador"}),h.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700",children:h.jsx(Ir,{className:"w-6 h-6"})})]}),h.jsxs("form",{onSubmit:l,className:"p-6 space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Código *"}),h.jsx("input",{type:"text",value:a.code,onChange:u=>s({...a,code:u.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",disabled:!!r}),i.code&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.code})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre *"}),h.jsx("input",{type:"text",value:a.name,onChange:u=>s({...a,name:u.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),i.name&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.name})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Teléfono *"}),h.jsx("input",{type:"tel",value:a.phone,onChange:u=>s({...a,phone:u.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",maxLength:8}),i.phone&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.phone})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Porcentaje de Comisión *"}),h.jsxs("div",{className:"flex items-center",children:[h.jsx("input",{type:"number",value:a.commissionRate,onChange:u=>s({...a,commissionRate:Number(u.target.value)}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",min:"0",max:"100"}),h.jsx("span",{className:"ml-2",children:"%"})]}),i.commissionRate&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.commissionRate})]}),h.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[h.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancelar"}),h.jsx("button",{type:"submit",className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:r?"Guardar Cambios":"Crear Colaborador"})]})]})]})})}function P9({staff:r,onUpdateSale:e,onCancelDiscount:t,onClose:n}){const a=o=>new Date(o).toLocaleDateString("es-NI",{year:"numeric",month:"long",day:"numeric"}),i=(()=>{const o=r.sales.map(d=>({id:d.id,commission:d.commission,commissionPaid:d.commissionPaid})),c=o.filter(d=>d.commissionPaid).reduce((d,g)=>d+g.commission,0),l=o.filter(d=>!d.commissionPaid).reduce((d,g)=>d+g.commission,0),u=r.discounts.filter(d=>d.status==="active").reduce((d,g)=>d+g.amount,0);return{paidCommissions:c,unpaidCommissions:l,totalDiscounts:u,total:c+l-u}})();return h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[h.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[h.jsxs("div",{children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Historial de Ventas y Descuentos"}),h.jsxs("p",{className:"text-gray-600",children:["Colaborador: ",r.name]})]}),h.jsx("button",{onClick:n,className:"text-gray-500 hover:text-gray-700",children:h.jsx(Ir,{className:"w-6 h-6"})})]}),h.jsxs("div",{className:"flex-1 overflow-auto p-6",children:[h.jsxs("div",{className:"mb-8",children:[h.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-4",children:"Resumen"}),h.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[h.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[h.jsx("p",{className:"text-sm text-purple-600",children:"Total Ventas"}),h.jsx("p",{className:"text-2xl font-bold text-purple-700",children:et(r.sales.reduce((o,c)=>o+c.total,0))})]}),h.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[h.jsx("p",{className:"text-sm text-green-600",children:"Total Comisiones"}),h.jsxs("p",{className:"text-2xl font-bold text-green-700",children:[et(i.paidCommissions+i.unpaidCommissions),h.jsxs("span",{className:"block text-sm",children:["(Pagado: ",et(i.paidCommissions),")",h.jsx("br",{}),"(Pendiente: ",et(i.unpaidCommissions),")"]})]})]}),h.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[h.jsx("p",{className:"text-sm text-red-600",children:"Total Descuentos"}),h.jsx("p",{className:"text-2xl font-bold text-red-700",children:et(i.totalDiscounts)})]})]}),h.jsx("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:h.jsxs("p",{className:"text-lg font-medium text-gray-800",children:["Comisión Total: ",et(i.total)]})})]}),h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{children:[h.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-4",children:"Ventas"}),r.sales.length===0?h.jsx("p",{className:"text-gray-500",children:"No hay ventas registradas."}):h.jsx("div",{className:"space-y-4",children:r.sales.map(o=>h.jsxs("div",{className:"border rounded-lg p-4",children:[h.jsxs("div",{className:"flex justify-between items-center mb-4",children:[h.jsxs("div",{children:[h.jsx("div",{className:"text-sm text-gray-500",children:a(o.date)}),h.jsxs("div",{className:"font-medium text-gray-900",children:["Total: ",et(o.total)]}),h.jsxs("div",{className:"text-sm text-green-600",children:["Comisión: ",et(o.commission),h.jsx("span",{className:`ml-2 px-2 py-1 text-xs rounded-full ${o.commissionPaid?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:o.commissionPaid?"Pagada":"Pendiente"})]})]}),h.jsx("button",{onClick:()=>{e(o.id,!o.commissionPaid)},className:`px-3 py-1 rounded-lg text-sm ${o.commissionPaid?"bg-yellow-100 text-yellow-800 hover:bg-yellow-200":"bg-green-100 text-green-800 hover:bg-green-200"}`,children:o.commissionPaid?"Marcar como Pendiente":"Marcar como Pagada"})]}),h.jsxs("table",{className:"min-w-full",children:[h.jsx("thead",{children:h.jsxs("tr",{className:"text-xs text-gray-500 uppercase",children:[h.jsx("th",{className:"text-left pb-2",children:"Producto"}),h.jsx("th",{className:"text-right pb-2",children:"Cantidad"}),h.jsx("th",{className:"text-right pb-2",children:"Precio"}),h.jsx("th",{className:"text-right pb-2",children:"Subtotal"})]})}),h.jsx("tbody",{className:"divide-y divide-gray-200",children:o.products.map(c=>h.jsxs("tr",{children:[h.jsx("td",{className:"py-2",children:c.name}),h.jsx("td",{className:"text-right py-2",children:c.quantity}),h.jsx("td",{className:"text-right py-2",children:et(c.price)}),h.jsx("td",{className:"text-right py-2",children:et(c.price*c.quantity)})]},c.id))})]})]},o.id))})]}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-4",children:"Descuentos"}),r.discounts.length===0?h.jsx("p",{className:"text-gray-500",children:"No hay descuentos registrados."}):h.jsx("div",{className:"space-y-4",children:r.discounts.map(o=>h.jsx("div",{className:"border rounded-lg p-4",children:h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsxs("div",{children:[h.jsx("div",{className:"text-sm text-gray-500",children:a(o.date)}),h.jsxs("div",{className:`font-medium ${o.status==="cancelled"?"text-gray-500":"text-red-600"}`,children:["Monto: ",et(o.amount),o.status==="cancelled"&&h.jsx("span",{className:"ml-2 text-sm text-red-600",children:"(Cancelado)"})]}),h.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:["Motivo: ",o.reason]}),o.status==="cancelled"&&o.cancellationReason&&h.jsxs("div",{className:"text-sm text-red-500 mt-1",children:["Motivo de cancelación: ",o.cancellationReason]})]}),o.status==="active"&&h.jsx("button",{onClick:()=>t(o.id),className:"text-yellow-600 hover:text-yellow-900",title:"Cancelar descuento",children:h.jsx(Kh,{className:"w-4 h-4"})})]})},o.id))})]})]})]}),h.jsx("div",{className:"border-t p-4",children:h.jsx("button",{onClick:n,className:"w-full px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"Cerrar"})})]})})}function F9({onConfirm:r,onClose:e}){const[t,n]=Se.useState(""),[a,s]=Se.useState(""),[i,o]=Se.useState({}),c=l=>{l.preventDefault();const u={};if((!t||parseFloat(t)<=0)&&(u.amount="El monto debe ser mayor a 0"),a.trim()||(u.reason="El motivo es requerido"),Object.keys(u).length>0){o(u);return}r(parseFloat(t),a)};return h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full",children:[h.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Agregar Descuento"}),h.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700",children:h.jsx(Ir,{className:"w-6 h-6"})})]}),h.jsxs("form",{onSubmit:c,className:"p-6 space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monto *"}),h.jsx("input",{type:"number",step:"0.01",value:t,onChange:l=>n(l.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),i.amount&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.amount})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Motivo *"}),h.jsx("textarea",{value:a,onChange:l=>s(l.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",rows:3}),i.reason&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.reason})]}),h.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[h.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancelar"}),h.jsx("button",{type:"submit",className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:"Agregar Descuento"})]})]})]})})}function R9({onConfirm:r,onClose:e}){const[t,n]=Se.useState(""),[a,s]=Se.useState(""),i=o=>{if(o.preventDefault(),!t.trim()){s("El motivo de cancelación es requerido");return}r(t)};return h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full",children:[h.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Cancelar Descuento"}),h.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700",children:h.jsx(Ir,{className:"w-6 h-6"})})]}),h.jsxs("form",{onSubmit:i,className:"p-6 space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Motivo de Cancelación *"}),h.jsx("textarea",{value:t,onChange:o=>n(o.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",rows:3,placeholder:"Ingrese el motivo de la cancelación..."}),a&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:a})]}),h.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[h.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancelar"}),h.jsx("button",{type:"submit",className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Confirmar Cancelación"})]})]})]})})}function D9({onConfirm:r,onClose:e,error:t}){const[n,a]=Se.useState(""),[s,i]=Se.useState(""),o=c=>{if(c.preventDefault(),!n){i("La contraseña es requerida");return}r(n)};return h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full",children:[h.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[h.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center",children:[h.jsx(jc,{className:"w-6 h-6 text-red-500 mr-2"}),"Eliminar Colaborador"]}),h.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700",children:h.jsx(Ir,{className:"w-6 h-6"})})]}),h.jsxs("form",{onSubmit:o,className:"p-6 space-y-4",children:[h.jsx("p",{className:"text-gray-600",children:"Esta acción es irreversible. Por favor, ingrese la contraseña de administrador para confirmar."}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contraseña de Administrador *"}),h.jsx("input",{type:"password",value:n,onChange:c=>a(c.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),(s||t)&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:s||t})]}),h.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[h.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancelar"}),h.jsx("button",{type:"submit",className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Eliminar Colaborador"})]})]})]})})}function L9(){const[r,e]=Se.useState([]),[t,n]=Se.useState(!1),[a,s]=Se.useState(),[i,o]=Se.useState(),[c,l]=Se.useState(),[u,d]=Se.useState(),[g,p]=Se.useState(),[y,v]=Se.useState(),[w,E]=Se.useState("");Se.useEffect(()=>{(async()=>{try{const F=await Bt.staff.load();Array.isArray(F)&&e(F)}catch(F){console.error("Error loading staff:",F),e([])}})()},[]),Se.useEffect(()=>{r.length>0&&Bt.staff.save(r).catch(N=>{console.error("Error saving staff:",N)})},[r]);const R=N=>{const F={...N,id:Date.now().toString(),sales:[],discounts:[]};e([...r,F]),n(!1)},P=N=>{a&&(e(r.map(F=>F.id===a.id?{...F,...N}:F)),s(void 0),n(!1))},q=(N,F)=>{if(g){const j={id:Date.now().toString(),date:new Date().toISOString(),amount:N,reason:F,status:"active"};e(r.map(S=>S.id===g.id?{...S,discounts:[...S.discounts,j]}:S)),p(void 0)}},z=N=>{if(N!=="admin2019"){E("Contraseña incorrecta");return}if(y){const F=r.filter(j=>j.id!==y);e(F),Bt.staff.save(F).catch(j=>{console.error("Error saving staff after deletion:",j),e(r),alert("Error al eliminar el colaborador. Por favor intente nuevamente.")}),v(void 0),E("")}},K=(N,F,j)=>{e(r.map(S=>S.id===N?{...S,sales:S.sales.map(A=>A.id===F?{...A,commissionPaid:j}:A)}:S))},I=N=>{if(i){const F=Bt.sales.load().map(j=>j.id===i.saleId?{...j,staffDiscount:j.staffDiscount?{...j.staffDiscount,status:"cancelled",cancellationReason:N}:void 0}:j);Bt.sales.save(F),e(r.map(j=>j.id===i.staffId?{...j,sales:j.sales.map(S=>S.id===i.saleId&&S.discount?{...S,discount:{...S.discount,status:"cancelled",cancellationReason:N}}:S)}:j)),o(void 0)}};return h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Colaboradores"}),h.jsxs("button",{onClick:()=>{s(void 0),n(!0)},className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 flex items-center",children:[h.jsx(Ts,{className:"w-4 h-4 mr-2"}),"Nuevo Colaborador"]})]}),r.length>0?h.jsx(I9,{staff:r,onEdit:N=>{s(N),n(!0)},onDelete:N=>v(N),onViewHistory:N=>l(N),onAddDiscount:N=>p(N)}):h.jsx("div",{className:"bg-white rounded-lg shadow p-6 text-center text-gray-500",children:"No hay colaboradores registrados . Comienza agregando uno nuevo."}),t&&h.jsx(C9,{staff:a,onSubmit:a?P:R,onClose:()=>{n(!1),s(void 0)},existingCodes:r.map(N=>N.code)}),c&&h.jsx(P9,{staff:c,onUpdateSale:(N,F)=>K(c.id,N,F),onCancelDiscount:d,onClose:()=>l(void 0)}),g&&h.jsx(F9,{onConfirm:q,onClose:()=>p(void 0)}),y&&h.jsx(D9,{onConfirm:z,onClose:()=>{v(void 0),E("")},error:w}),u&&h.jsx(R9,{onConfirm:I,onClose:()=>d(void 0)})]})}function j9({appointments:r,onEdit:e,onCancel:t,onDelete:n,userRole:a}){const s=o=>new Date(o).toLocaleDateString("es-NI",{year:"numeric",month:"long",day:"numeric"}),i=o=>o;return h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"min-w-full bg-white rounded-lg overflow-hidden",children:[h.jsx("thead",{className:"bg-gray-50",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Código"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cliente"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Teléfono"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Costo"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fecha"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Hora"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nota"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estado"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),h.jsx("tbody",{className:"divide-y divide-gray-200",children:r.map(o=>h.jsxs("tr",{className:"hover:bg-gray-50",children:[h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:o.code}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:o.clientName}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:o.clientPhone}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:et(o.reservationCost)}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s(o.date)}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:i(o.time)}),h.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:o.note||"-"}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:o.status==="cancelled"?h.jsxs("div",{children:[h.jsx("span",{className:"text-red-600 font-medium",children:"Cancelada"}),o.cancellationReason&&h.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Motivo: ",o.cancellationReason]})]}):h.jsx("span",{className:"text-green-600 font-medium",children:"Programada"})}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:h.jsxs("div",{className:"flex space-x-2",children:[o.status==="scheduled"&&h.jsxs(h.Fragment,{children:[h.jsx("button",{onClick:()=>e(o),className:"text-indigo-600 hover:text-indigo-900",title:"Editar",children:h.jsx($h,{className:"w-4 h-4"})}),h.jsx("button",{onClick:()=>t(o),className:"text-yellow-600 hover:text-yellow-900",title:"Cancelar",children:h.jsx(Kh,{className:"w-4 h-4"})}),h.jsx("a",{href:`https://wa.me/505${o.clientPhone}?text=${encodeURIComponent(`¡Hola ${o.clientName}!
Te confirmamos tu cita en Alvaro Rugama Make Up Studio & Beauty Salon:

Fecha: ${s(o.date)}
Hora: ${i(o.time)}
Costo: ${et(o.reservationCost)}`+(o.note?`
Nota: ${o.note}`:""))}`,target:"_blank",rel:"noopener noreferrer",className:"text-green-600 hover:text-green-900",title:"Enviar información por WhatsApp",children:h.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor",children:h.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})})})]}),o.status==="cancelled"&&a==="admin"&&h.jsx("button",{onClick:()=>n(o.id),className:"text-red-600 hover:text-red-900",title:"Eliminar",children:h.jsx(pi,{className:"w-4 h-4"})})]})})]},o.id))})]})})}function O9({appointment:r,onSubmit:e,onClose:t,existingCodes:n}){const[a,s]=Se.useState({code:"",clientName:"",clientPhone:"",reservationCost:"",date:"",time:"",note:""}),[i,o]=Se.useState({});Se.useEffect(()=>{r&&s({code:r.code,clientName:r.clientName,clientPhone:r.clientPhone,reservationCost:r.reservationCost.toString(),date:r.date,time:r.time,note:r.note||""})},[r]);const c=()=>{const u={};if(a.code?!r&&n.includes(a.code)&&(u.code="Este código ya existe"):u.code="El código es requerido",a.clientName||(u.clientName="El nombre del cliente es requerido"),a.clientPhone?/^\d{8}$/.test(a.clientPhone)||(u.clientPhone="El teléfono debe tener 8 dígitos"):u.clientPhone="El teléfono es requerido",(!a.reservationCost||parseFloat(a.reservationCost)<=0)&&(u.reservationCost="El costo de reserva debe ser mayor a 0"),!a.date)u.date="La fecha es requerida";else{const d=new Date(a.date),g=new Date;g.setHours(0,0,0,0),d<g&&(u.date="La fecha no puede ser anterior a hoy")}return a.time||(u.time="La hora es requerida"),o(u),Object.keys(u).length===0},l=u=>{u.preventDefault(),c()&&e({code:a.code,clientName:a.clientName,clientPhone:a.clientPhone,reservationCost:parseFloat(a.reservationCost),date:a.date,time:a.time,note:a.note})};return h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full",children:[h.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:r?"Editar Cita":"Nueva Cita"}),h.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700",children:h.jsx(Ir,{className:"w-6 h-6"})})]}),h.jsxs("form",{onSubmit:l,className:"p-6 space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Código *"}),h.jsx("input",{type:"text",value:a.code,onChange:u=>s({...a,code:u.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",disabled:!!r}),i.code&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.code})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre del Cliente *"}),h.jsx("input",{type:"text",value:a.clientName,onChange:u=>s({...a,clientName:u.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),i.clientName&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.clientName})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Teléfono *"}),h.jsx("input",{type:"tel",value:a.clientPhone,onChange:u=>s({...a,clientPhone:u.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",maxLength:8}),i.clientPhone&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.clientPhone})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Costo de Reserva *"}),h.jsx("input",{type:"number",step:"0.01",value:a.reservationCost,onChange:u=>s({...a,reservationCost:u.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),i.reservationCost&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.reservationCost})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha *"}),h.jsx("input",{type:"date",value:a.date,onChange:u=>s({...a,date:u.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",min:new Date().toISOString().split("T")[0]}),i.date&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.date})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hora *"}),h.jsx("input",{type:"time",value:a.time,onChange:u=>s({...a,time:u.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),i.time&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.time})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nota (opcional)"}),h.jsx("textarea",{value:a.note,onChange:u=>s({...a,note:u.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",rows:3,placeholder:"Agregar notas o detalles adicionales..."})]}),h.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[h.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancelar"}),h.jsx("button",{type:"submit",className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:r?"Guardar Cambios":"Crear Cita"})]})]})]})})}function M9({onConfirm:r,onClose:e}){const[t,n]=Se.useState(""),[a,s]=Se.useState(""),i=o=>{if(o.preventDefault(),!t.trim()){s("El motivo de cancelación es requerido");return}r(t)};return h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full",children:[h.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Cancelar Cita"}),h.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700",children:h.jsx(Ir,{className:"w-6 h-6"})})]}),h.jsxs("form",{onSubmit:i,className:"p-6 space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Motivo de Cancelación *"}),h.jsx("textarea",{value:t,onChange:o=>n(o.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",rows:3,placeholder:"Ingrese el motivo de la cancelación..."}),a&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:a})]}),h.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[h.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancelar"}),h.jsx("button",{type:"submit",className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Confirmar Cancelación"})]})]})]})})}function Fv({userRole:r}){const[e,t]=Se.useState([]),[n,a]=Se.useState(!0),[s,i]=Se.useState(null),[o,c]=Se.useState(!1),[l,u]=Se.useState(),[d,g]=Se.useState();Se.useEffect(()=>{(async()=>{a(!0);try{const P=await Bt.appointments.load();t(Array.isArray(P)?P:[]),i(null)}catch(P){console.error("Error loading appointments:",P),i("Error loading appointments"),t([])}finally{a(!1)}})()},[]);const p=Se.useCallback(async R=>{try{await Bt.appointments.save(R),t(R)}catch(P){console.error("Error saving appointments:",P),i("Error saving appointments")}},[]),y=R=>{const P={...R,id:Date.now().toString(),status:"scheduled"};p([...e,P]),c(!1)},v=R=>{l&&(t(e.map(P=>P.id===l.id?{...P,...R}:P)),p(e.map(P=>P.id===l.id?{...P,...R}:P)),c(!1))},w=R=>{d&&(p(e.map(P=>P.id===d.id?{...P,status:"cancelled",cancellationReason:R}:P)),g(void 0))};if(n)return h.jsx("div",{className:"flex justify-center items-center h-64",children:h.jsx("div",{className:"text-gray-500",children:"Cargando..."})});if(s)return h.jsxs("div",{className:"text-red-500",children:["Error: ",s]});const E=R=>{if(r!=="admin"){alert("Solo los administradores pueden eliminar citas");return}if(window.confirm("¿Estás seguro de que deseas eliminar esta cita?")){const P=e.filter(q=>q.id!==R);t(P),Bt.appointments.save(P).catch(q=>{console.error("Error saving appointments after deletion:",q),t(e),alert("Error al eliminar la cita. Por favor intente nuevamente.")})}};return h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Citas"}),h.jsxs("button",{onClick:()=>{u(void 0),c(!0)},className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 flex items-center",children:[h.jsx(Ts,{className:"w-4 h-4 mr-2"}),"Nueva Cita"]})]}),e.length>0?h.jsx(j9,{appointments:e,onEdit:R=>{if(R.status!=="scheduled"){alert("No se pueden editar citas canceladas");return}u(R),c(!0)},onCancel:R=>g(R),onDelete:E,userRole:r}):h.jsx("div",{className:"bg-white rounded-lg shadow p-6 text-center text-gray-500",children:"No hay citas registradas. Comienza agregando una nueva."}),o&&h.jsx(O9,{appointment:l,onSubmit:l?v:y,onClose:()=>{c(!1),u(void 0)},existingCodes:e.map(R=>R.code)}),d&&h.jsx(M9,{onConfirm:w,onClose:()=>g(void 0)})]})}function B9(){const[r,e]=Se.useState(()=>{try{return Jf()}catch(s){return console.error("Error loading config:",s),zs}}),[t,n]=Se.useState(null),a=s=>{s.preventDefault();try{document.title=r.tabTitle;const i=document.querySelector("link[rel~='icon']");i&&(i.href=r.faviconUrl),$4(r),n("Configuración guardada correctamente"),setTimeout(()=>n(null),3e3)}catch(i){console.error("Error saving config:",i),n("Error al guardar la configuración"),setTimeout(()=>n(null),3e3)}};return h.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[h.jsxs("h2",{className:"text-xl font-semibold text-gray-800 mb-6 flex items-center",children:[h.jsx(O4,{className:"w-6 h-6 mr-2"}),"Apariencia"]}),t&&h.jsx("div",{className:"bg-green-50 text-green-700 p-4 rounded-lg mb-6",children:t}),h.jsxs("form",{onSubmit:a,className:"space-y-6",children:[h.jsxs("div",{children:[h.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-4",children:"Apariencia"}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Color Primario"}),h.jsxs("div",{className:"flex space-x-2",children:[h.jsx("input",{type:"color",value:r.colors.primary,onChange:s=>e({...r,colors:{...r.colors,primary:s.target.value}}),className:"h-10 w-20 rounded border p-1"}),h.jsx("input",{type:"text",value:r.colors.primary,onChange:s=>e({...r,colors:{...r.colors,primary:s.target.value}}),className:"flex-1 px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"#000000"})]}),h.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Color principal para botones y acentos"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Color Secundario"}),h.jsxs("div",{className:"flex space-x-2",children:[h.jsx("input",{type:"color",value:r.colors.secondary,onChange:s=>e({...r,colors:{...r.colors,secondary:s.target.value}}),className:"h-10 w-20 rounded border p-1"}),h.jsx("input",{type:"text",value:r.colors.secondary,onChange:s=>e({...r,colors:{...r.colors,secondary:s.target.value}}),className:"flex-1 px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"#000000"})]}),h.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Color secundario para elementos decorativos"})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"URL del Logo"}),h.jsx("input",{type:"url",value:r.logoUrl,onChange:s=>e({...r,logoUrl:s.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"https://ejemplo.com/logo.png"}),h.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Recomendado: Imagen cuadrada con fondo transparente (PNG)"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"URL del Favicon"}),h.jsx("input",{type:"url",value:r.faviconUrl,onChange:s=>e({...r,faviconUrl:s.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"https://ejemplo.com/favicon.ico"}),h.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Icono que aparecerá en la pestaña del navegador (formatos: .ico, .png, .svg)"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"URL de Imagen de Fondo"}),h.jsx("input",{type:"url",value:r.backgroundImage,onChange:s=>e({...r,backgroundImage:s.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"https://ejemplo.com/imagen.jpg"}),h.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Recomendado: Usar imágenes de Unsplash con dimensiones grandes"})]})]})]}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-4",children:"Configuración General"}),h.jsx("div",{className:"space-y-4",children:h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Título de la Pestaña del Navegador"}),h.jsx("input",{type:"text",value:r.tabTitle,onChange:s=>e({...r,tabTitle:s.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Título de la pestaña del navegador"}),h.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Este texto aparecerá en la pestaña del navegador"})]})})]}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-4",children:"Información del Negocio"}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre del Negocio"}),h.jsx("input",{type:"text",value:r.businessInfo.name,onChange:s=>e({...r,businessInfo:{...r.businessInfo,name:s.target.value}}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subtítulo"}),h.jsx("input",{type:"text",value:r.businessInfo.subtitle,onChange:s=>e({...r,businessInfo:{...r.businessInfo,subtitle:s.target.value}}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]})]}),h.jsx("div",{className:"flex justify-end",children:h.jsx("button",{type:"submit",className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:"Guardar Configuración"})})]})]})}function V9({expenses:r,onEdit:e,onCancel:t,onDelete:n}){const a=s=>new Date(s).toLocaleDateString("es-NI",{year:"numeric",month:"long",day:"numeric"});return h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"min-w-full bg-white rounded-lg overflow-hidden",children:[h.jsx("thead",{className:"bg-gray-50",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fecha"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Categoría"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Motivo"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Monto"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nota"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estado"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),h.jsx("tbody",{className:"divide-y divide-gray-200",children:r.map(s=>h.jsxs("tr",{className:"hover:bg-gray-50",children:[h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:a(s.date)}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.category}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.reason}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:et(s.amount)}),h.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:s.note||"-"}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:s.status==="cancelled"?h.jsxs("div",{children:[h.jsx("span",{className:"text-red-600 font-medium",children:"Cancelado"}),s.cancellationReason&&h.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Motivo: ",s.cancellationReason]})]}):h.jsx("span",{className:"text-green-600 font-medium",children:"Activo"})}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:h.jsxs("div",{className:"flex space-x-2",children:[s.status==="active"&&h.jsxs(h.Fragment,{children:[h.jsx("button",{onClick:()=>e(s),className:"text-indigo-600 hover:text-indigo-900",title:"Editar",children:h.jsx($h,{className:"w-4 h-4"})}),h.jsx("button",{onClick:()=>t(s),className:"text-yellow-600 hover:text-yellow-900",title:"Cancelar",children:h.jsx(Kh,{className:"w-4 h-4"})})]}),s.status==="cancelled"&&h.jsx("button",{onClick:()=>n(s.id),className:"text-red-600 hover:text-red-900",title:"Eliminar",children:h.jsx(pi,{className:"w-4 h-4"})})]})})]},s.id))})]})})}function U9({expense:r,categories:e,onSubmit:t,onClose:n}){const[a,s]=Se.useState({category:"",reason:"",amount:"",note:""}),[i,o]=Se.useState({});Se.useEffect(()=>{r&&s({category:r.category,reason:r.reason,amount:r.amount.toString(),note:r.note||""})},[r]);const c=()=>{const u={};return a.category||(u.category="La categoría es requerida"),a.reason||(u.reason="El motivo es requerido"),(!a.amount||parseFloat(a.amount)<=0)&&(u.amount="El monto debe ser mayor a 0"),o(u),Object.keys(u).length===0},l=u=>{u.preventDefault(),c()&&t({category:a.category,reason:a.reason,amount:parseFloat(a.amount),note:a.note})};return h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full",children:[h.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:r?"Editar Gasto":"Nuevo Gasto"}),h.jsx("button",{onClick:n,className:"text-gray-500 hover:text-gray-700",children:h.jsx(Ir,{className:"w-6 h-6"})})]}),h.jsxs("form",{onSubmit:l,className:"p-6 space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Categoría *"}),h.jsxs("select",{value:a.category,onChange:u=>s({...a,category:u.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[h.jsx("option",{value:"",children:"Seleccionar categoría"}),e.map((u,d)=>h.jsx("option",{value:u,children:u},`category-${u}-${d}`))]}),i.category&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.category})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Motivo *"}),h.jsx("input",{type:"text",value:a.reason,onChange:u=>s({...a,reason:u.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),i.reason&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.reason})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monto *"}),h.jsx("input",{type:"number",step:"0.01",value:a.amount,onChange:u=>s({...a,amount:u.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),i.amount&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.amount})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nota (opcional)"}),h.jsx("textarea",{value:a.note,onChange:u=>s({...a,note:u.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",rows:3})]}),h.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[h.jsx("button",{type:"button",onClick:n,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancelar"}),h.jsx("button",{type:"submit",className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:r?"Guardar Cambios":"Registrar Gasto"})]})]})]})})}function q9({onConfirm:r,onClose:e}){const[t,n]=Se.useState(""),[a,s]=Se.useState(""),i=o=>{if(o.preventDefault(),!t.trim()){s("El motivo de cancelación es requerido");return}r(t)};return h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full",children:[h.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Cancelar Gasto"}),h.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700",children:h.jsx(Ir,{className:"w-6 h-6"})})]}),h.jsxs("form",{onSubmit:i,className:"p-6 space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Motivo de Cancelación *"}),h.jsx("textarea",{value:t,onChange:o=>n(o.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",rows:3,placeholder:"Ingrese el motivo de la cancelación..."}),a&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:a})]}),h.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[h.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancelar"}),h.jsx("button",{type:"submit",className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Confirmar Cancelación"})]})]})]})})}function z9({onConfirm:r,onClose:e}){const[t,n]=Se.useState(""),[a,s]=Se.useState(""),i=o=>{if(o.preventDefault(),!t){s("La contraseña es requerida");return}r(t)};return h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full",children:[h.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[h.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center",children:[h.jsx(jc,{className:"w-6 h-6 text-red-500 mr-2"}),"Eliminar Gasto"]}),h.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700",children:h.jsx(Ir,{className:"w-6 h-6"})})]}),h.jsxs("form",{onSubmit:i,className:"p-6 space-y-4",children:[h.jsx("p",{className:"text-gray-600",children:"Esta acción es irreversible. Por favor, ingrese la contraseña de administrador para confirmar."}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contraseña de Administrador *"}),h.jsx("input",{type:"password",value:t,onChange:o=>n(o.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Ingrese la contraseña..."}),a&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:a})]}),h.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[h.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancelar"}),h.jsx("button",{type:"submit",className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Eliminar Gasto"})]})]})]})})}function W9({categories:r,onAddCategory:e,onDeleteCategory:t,onClose:n}){const[a,s]=Se.useState(""),[i,o]=Se.useState(""),c=l=>{if(l.preventDefault(),!a.trim()){o("El nombre de la categoría es requerido");return}if(r.some(u=>u.name.toLowerCase()===a.toLowerCase())){o("Esta categoría ya existe");return}e(a),s(""),o("")};return h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full",children:[h.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Gestionar Categorías de Gastos"}),h.jsx("button",{onClick:n,className:"text-gray-500 hover:text-gray-700",children:h.jsx(Ir,{className:"w-6 h-6"})})]}),h.jsxs("div",{className:"p-6",children:[h.jsxs("form",{onSubmit:c,className:"flex gap-2 mb-4",children:[h.jsxs("div",{className:"flex-1",children:[h.jsx("input",{type:"text",value:a,onChange:l=>s(l.target.value),placeholder:"Nueva categoría",className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),i&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:i})]}),h.jsxs("button",{type:"submit",className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 flex items-center",children:[h.jsx(Ts,{className:"w-4 h-4 mr-1"}),"Agregar"]})]}),h.jsx("div",{className:"space-y-2",children:r.map(l=>h.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[h.jsx("span",{className:"text-gray-700",children:l.name}),h.jsx("button",{onClick:()=>t(l.id),className:"text-red-600 hover:text-red-900",children:h.jsx(Ir,{className:"w-4 h-4"})})]},l.id))})]})]})})}function Rv(){const[r,e]=Se.useState([]),[t,n]=Se.useState(!0),[a,s]=Se.useState(null),[i,o]=Se.useState([]),[c,l]=Se.useState(!1),[u,d]=Se.useState(!1),[g,p]=Se.useState(),[y,v]=Se.useState(),[w,E]=Se.useState(),[R,P]=Se.useState("");Se.useEffect(()=>{(async()=>{n(!0);try{const A=await Bt.expenses.load();e(Array.isArray(A)?A:[]),s(null)}catch(A){s("Error loading expenses"),console.error("Error loading expenses:",A)}finally{n(!1)}})()},[]),Se.useEffect(()=>{r.length>0&&Bt.expenses.save(r).catch(S=>{console.error("Error saving expenses:",S)})},[r]);const q=S=>{const A={...S,id:Date.now().toString(),date:new Date().toISOString(),status:"active"};e([...r,A]),l(!1)},z=S=>{g&&(e(r.map(A=>A.id===g.id?{...A,...S}:A)),p(void 0),l(!1))},K=S=>{y&&(e(r.map(A=>A.id===y.id?{...A,status:"cancelled",cancellationReason:S}:A)),v(void 0))},I=S=>{if(S!=="admin2019"){P("Contraseña incorrecta");return}w&&(e(r.filter(A=>A.id!==w)),E(void 0),P(""))},N=S=>{const A=r.find(C=>C.id===S);if((A==null?void 0:A.status)!=="cancelled"){alert("Solo se pueden eliminar gastos cancelados");return}E(S)},F=S=>{const A={id:Date.now().toString(),name:S};o([...i,A])},j=S=>{const A=i.find(C=>C.id===S);if(A&&r.some(C=>C.category===A.name)){alert("No se puede eliminar una categoría que tiene gastos asociados");return}window.confirm("¿Estás seguro de que deseas eliminar esta categoría?")&&o(i.filter(C=>C.id!==S))};return h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Gastos"}),h.jsxs("div",{className:"space-x-3",children:[h.jsxs("button",{onClick:()=>d(!0),className:"px-4 py-2 border border-purple-600 text-purple-600 rounded-lg hover:bg-purple-50 flex items-center",children:[h.jsx(M4,{className:"w-4 h-4 mr-2"}),"Gestionar Categorías"]}),h.jsxs("button",{onClick:()=>{p(void 0),l(!0)},className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 flex items-center",children:[h.jsx(Ts,{className:"w-4 h-4 mr-2"}),"Nuevo Gasto"]})]})]}),r.length>0?h.jsx(V9,{expenses:r,onEdit:S=>{if(S.status!=="active"){alert("No se pueden editar gastos cancelados");return}p(S),l(!0)},onCancel:S=>v(S),onDelete:N}):h.jsx("div",{className:"bg-white rounded-lg shadow p-6 text-center text-gray-500",children:"No hay gastos registrados. Comienza agregando uno nuevo."}),c&&h.jsx(U9,{expense:g,categories:i.map(S=>S.name),onSubmit:g?z:q,onClose:()=>{l(!1),p(void 0)}}),u&&h.jsx(W9,{categories:i,onAddCategory:F,onDeleteCategory:j,onClose:()=>d(!1)}),y&&h.jsx(q9,{onConfirm:K,onClose:()=>v(void 0)}),w&&h.jsx(z9,{onConfirm:I,onClose:()=>{E(void 0),P("")}})]})}const zb=(r,e)=>{const t=Cd(),n=new jt({orientation:"portrait",unit:"mm",format:[t.paperSize.width,t.paperSize.height],compress:!0});let a=10;const s=t.paperSize.width*.07;n.setFontSize(t.fontSize.title);const i=t.businessInfo.name,o=n.getStringUnitWidth(i)*n.getFontSize()/n.internal.scaleFactor;n.text(i,(t.paperSize.width-o)/2,a),a+=5,n.setFontSize(t.fontSize.subtitle);const c=t.businessInfo.subtitle,l=n.getStringUnitWidth(c)*n.getFontSize()/n.internal.scaleFactor;n.text(c,(t.paperSize.width-l)/2,a),t.businessInfo.address&&(a+=4,n.setFontSize(t.fontSize.body),n.text(t.businessInfo.address,s,a)),t.businessInfo.phone&&(a+=4,n.text(`Tel: ${t.businessInfo.phone}`,s,a)),t.businessInfo.email&&(a+=4,n.text(t.businessInfo.email,s,a)),a+=8,n.setFontSize(t.fontSize.body),n.text(`Código: ${r.code}`,s,a),a+=4;const u=new Date(e.date).toLocaleDateString("es-NI",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});n.text(`Fecha: ${u}`,s,a),a+=4,n.text(`Cliente: ${r.clientName}`,s,a),a+=4,n.text(`Teléfono: ${r.clientPhone}`,s,a),a+=6,n.text("Producto:",s,a),a+=4,n.text(r.productName,s,a),a+=6,n.setFontSize(7),n.text("Detalle del Pago",s,a),a+=4;const d={cash:"Efectivo",card:"Tarjeta",transfer:"Transferencia"};n.text(`Método: ${d[e.method]}`,s,a),e.reference&&(a+=4,n.text(`Referencia: ${e.reference}`,s,a)),a+=4,n.text(`Monto Pagado: ${et(e.amount)}`,s,a);const g=r.payments.reduce((w,E)=>w+E.amount,0),p=r.finalPrice-g;a+=6,n.text("Resumen del Crédito",s,a),a+=4,n.text(`Monto Total: ${et(r.finalPrice)}`,s,a),a+=4,n.text(`Total Pagado: ${et(g)}`,s,a),a+=4,n.text(`Saldo Pendiente: ${et(p)}`,s,a),a+=8,n.setFontSize(8);const y="¡Gracias por su pago!",v=n.getStringUnitWidth(y)*n.getFontSize()/n.internal.scaleFactor;return n.text(y,(70-v)/2,a),n};function H9({credits:r,onMakePayment:e,onCancel:t,onDelete:n,onViewHistory:a}){const s=u=>new Date(u).toLocaleDateString("es-NI",{year:"numeric",month:"long",day:"numeric"}),i=u=>{const d=u.payments.reduce((g,p)=>g+p.amount,0);return u.finalPrice-d},o=u=>{const d=u.payments.reduce((E,R)=>E+R.amount,0),g=u.payments[u.payments.length-1]||{id:"summary",date:new Date().toISOString(),amount:d,method:"cash"},y=zb(u,g).output("blob"),v=URL.createObjectURL(y),w=window.open(v,"_blank");w&&(w.onload=()=>{w.print(),URL.revokeObjectURL(v)})},c=u=>{switch(u){case"completed":return"text-green-600";case"overdue":return"text-red-600";default:return"text-blue-600"}},l=u=>{switch(u){case"completed":return"Completado";case"overdue":return"Vencido";default:return"Activo"}};return h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"min-w-full bg-white rounded-lg overflow-hidden",children:[h.jsx("thead",{className:"bg-gray-50",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Código"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cliente"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Producto"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Monto Total"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Saldo"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cuotas"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Vencimiento"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estado"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),h.jsx("tbody",{className:"divide-y divide-gray-200",children:r.map(u=>h.jsxs("tr",{className:"hover:bg-gray-50",children:[h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:u.code}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:h.jsxs("div",{children:[u.clientName,h.jsx("div",{className:"text-xs text-gray-500",children:u.clientPhone})]})}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:u.productName}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:et(u.finalPrice)}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:et(i(u))}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:h.jsxs("div",{children:[u.payments.length," de ",u.installments,h.jsxs("div",{className:"text-xs text-gray-500",children:[et(u.installmentAmount)," por cuota"]})]})}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s(u.dueDate)}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:h.jsx("span",{className:`font-medium ${c(u.status)}`,children:l(u.status)})}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:h.jsxs("div",{className:"flex space-x-2",children:[u.status==="active"&&h.jsx("button",{onClick:()=>e(u),className:"text-green-600 hover:text-green-900",title:"Registrar pago",children:h.jsx(gu,{className:"w-4 h-4"})}),h.jsx("button",{onClick:()=>o(u),className:"text-blue-600 hover:text-blue-900",title:"Imprimir factura",children:h.jsx(Hh,{className:"w-4 h-4"})}),h.jsx("button",{onClick:()=>a(u),className:"text-blue-600 hover:text-blue-900",title:"Ver historial",children:h.jsx(kp,{className:"w-4 h-4"})}),u.status==="active"&&h.jsx("button",{onClick:()=>t(u),className:"text-yellow-600 hover:text-yellow-900",title:"Cancelar crédito",children:h.jsx(Kh,{className:"w-4 h-4"})}),u.status==="cancelled"&&h.jsx("button",{onClick:()=>n(u.id),className:"text-red-600 hover:text-red-900",title:"Eliminar crédito",children:h.jsx(pi,{className:"w-4 h-4"})}),u.status==="completed"&&h.jsx("button",{onClick:()=>n(u.id),className:"text-red-600 hover:text-red-900",title:"Eliminar crédito",children:h.jsx(pi,{className:"w-4 h-4"})})]})})]},u.id))})]})})}function G9({products:r,onSubmit:e,onClose:t,existingCodes:n}){const[a,s]=Se.useState({code:"",clientName:"",clientPhone:"",productId:"",productName:"",originalPrice:0,finalPrice:0,dueDate:"",installments:1,installmentAmount:0}),[i,o]=Se.useState(""),[c,l]=Se.useState(!1),[u,d]=Se.useState({}),g=r.filter(w=>w.name.toLowerCase().includes(i.toLowerCase())||w.code.toLowerCase().includes(i.toLowerCase())||w.category.toLowerCase().includes(i.toLowerCase())),p=()=>{const w={};return a.code?n.includes(a.code)&&(w.code="Este código ya existe"):w.code="El código es requerido",a.clientName||(w.clientName="El nombre del cliente es requerido"),a.clientPhone?/^\d{8}$/.test(a.clientPhone)||(w.clientPhone="El teléfono debe tener 8 dígitos"):w.clientPhone="El teléfono es requerido",a.productId||(w.productId="Debe seleccionar un producto"),a.finalPrice<=0&&(w.finalPrice="El precio final debe ser mayor a 0"),a.dueDate?new Date(a.dueDate)<=new Date&&(w.dueDate="La fecha debe ser posterior a hoy"):w.dueDate="La fecha máxima es requerida",a.installments<1&&(w.installments="Debe haber al menos 1 cuota"),d(w),Object.keys(w).length===0},y=w=>{s({...a,productId:w.id,productName:w.name,originalPrice:w.costPrice,finalPrice:w.salePrice}),l(!1)};Se.useEffect(()=>{a.finalPrice&&a.installments&&s(w=>({...w,installmentAmount:a.finalPrice/a.installments}))},[a.finalPrice,a.installments]);const v=w=>{w.preventDefault(),p()&&e(a)};return h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full",children:[h.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Nuevo Crédito"}),h.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700",children:h.jsx(Ir,{className:"w-6 h-6"})})]}),h.jsxs("form",{onSubmit:v,className:"p-6 space-y-4",children:[h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Código *"}),h.jsx("input",{type:"text",value:a.code,onChange:w=>s({...a,code:w.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),u.code&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.code})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre del Cliente *"}),h.jsx("input",{type:"text",value:a.clientName,onChange:w=>s({...a,clientName:w.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),u.clientName&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.clientName})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Teléfono *"}),h.jsx("input",{type:"tel",value:a.clientPhone,onChange:w=>s({...a,clientPhone:w.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",maxLength:8}),u.clientPhone&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.clientPhone})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Producto *"}),h.jsxs("div",{className:"relative",children:[h.jsx("input",{type:"text",value:a.productName,onClick:()=>l(!0),readOnly:!0,className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent cursor-pointer",placeholder:"Buscar producto..."}),h.jsx(Wv,{className:"absolute right-3 top-2.5 w-5 h-5 text-gray-400"})]}),u.productId&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.productId})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Precio Original"}),h.jsx("input",{type:"number",value:a.originalPrice,readOnly:!0,className:"w-full px-3 py-2 border rounded-lg bg-gray-50"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Precio Final *"}),h.jsx("input",{type:"number",value:a.finalPrice,onChange:w=>s({...a,finalPrice:Number(w.target.value)}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),u.finalPrice&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.finalPrice})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha Máxima *"}),h.jsx("input",{type:"date",value:a.dueDate,onChange:w=>s({...a,dueDate:w.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",min:new Date().toISOString().split("T")[0]}),u.dueDate&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.dueDate})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Número de Cuotas *"}),h.jsx("input",{type:"number",value:a.installments,onChange:w=>s({...a,installments:Number(w.target.value)}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",min:"1"}),u.installments&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.installments})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monto por Cuota"}),h.jsx("input",{type:"number",value:a.installmentAmount,readOnly:!0,className:"w-full px-3 py-2 border rounded-lg bg-gray-50"})]})]}),h.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[h.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancelar"}),h.jsx("button",{type:"submit",className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:"Crear Crédito"})]})]}),c&&h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full",children:[h.jsx("div",{className:"p-4 border-b",children:h.jsx("input",{type:"text",value:i,onChange:w=>o(w.target.value),placeholder:"Buscar por nombre, código o categoría...",className:"w-full px-4 py-2 border rounded-lg"})}),h.jsx("div",{className:"max-h-96 overflow-y-auto p-4",children:g.length>0?h.jsxs("table",{className:"min-w-full",children:[h.jsx("thead",{children:h.jsxs("tr",{children:[h.jsx("th",{className:"text-left",children:"Código"}),h.jsx("th",{className:"text-left",children:"Nombre"}),h.jsx("th",{className:"text-left",children:"Categoría"}),h.jsx("th",{className:"text-right",children:"Precio"})]})}),h.jsx("tbody",{children:g.map(w=>h.jsxs("tr",{onClick:()=>y(w),className:"hover:bg-gray-50 cursor-pointer",children:[h.jsx("td",{className:"py-2",children:w.code}),h.jsx("td",{children:w.name}),h.jsx("td",{children:w.category}),h.jsx("td",{className:"text-right",children:et(w.salePrice)})]},w.id))})]}):h.jsx("p",{className:"text-center text-gray-500",children:"No se encontraron productos"})}),h.jsx("div",{className:"p-4 border-t",children:h.jsx("button",{onClick:()=>l(!1),className:"w-full px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"Cerrar"})})]})})]})})}function $9({creditId:r,remainingAmount:e,onSubmit:t,onClose:n}){const[a,s]=Se.useState({amount:e,method:"cash",reference:""}),[i,o]=Se.useState({}),c=()=>{const u={};return!a.amount||a.amount<=0?u.amount="El monto debe ser mayor a 0":a.amount>e&&(u.amount="El monto no puede ser mayor al saldo pendiente"),a.method!=="cash"&&!a.reference&&(u.reference="La referencia es requerida para pagos con tarjeta o transferencia"),o(u),Object.keys(u).length===0},l=u=>{u.preventDefault(),c()&&t(a)};return h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full",children:[h.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Registrar Pago"}),h.jsx("button",{onClick:n,className:"text-gray-500 hover:text-gray-700",children:h.jsx(Ir,{className:"w-6 h-6"})})]}),h.jsxs("form",{onSubmit:l,className:"p-6 space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Saldo Pendiente"}),h.jsx("input",{type:"text",value:et(e),readOnly:!0,className:"w-full px-3 py-2 border rounded-lg bg-gray-50"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monto a Pagar *"}),h.jsx("input",{type:"number",step:"0.01",value:a.amount,onChange:u=>s({...a,amount:Number(u.target.value)}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),i.amount&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.amount})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Método de Pago *"}),h.jsxs("select",{value:a.method,onChange:u=>s({...a,method:u.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[h.jsx("option",{value:"cash",children:"Efectivo"}),h.jsx("option",{value:"card",children:"Tarjeta"}),h.jsx("option",{value:"transfer",children:"Transferencia"})]})]}),a.method!=="cash"&&h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Referencia *"}),h.jsx("input",{type:"text",value:a.reference,onChange:u=>s({...a,reference:u.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:`Número de ${a.method==="card"?"autorización":"transferencia"}`}),i.reference&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.reference})]}),h.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[h.jsx("button",{type:"button",onClick:n,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancelar"}),h.jsx("button",{type:"submit",className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:"Registrar Pago"})]})]})]})})}function K9({onConfirm:r,onClose:e}){const[t,n]=Se.useState(""),[a,s]=Se.useState(""),i=o=>{if(o.preventDefault(),!t.trim()){s("El motivo de cancelación es requerido");return}r(t)};return h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full",children:[h.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Cancelar Crédito"}),h.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700",children:h.jsx(Ir,{className:"w-6 h-6"})})]}),h.jsxs("form",{onSubmit:i,className:"p-6 space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Motivo de Cancelación *"}),h.jsx("textarea",{value:t,onChange:o=>n(o.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",rows:3,placeholder:"Ingrese el motivo de la cancelación..."}),a&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:a})]}),h.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[h.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancelar"}),h.jsx("button",{type:"submit",className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Confirmar Cancelación"})]})]})]})})}function X9({onConfirm:r,onClose:e,error:t}){const[n,a]=Se.useState(""),[s,i]=Se.useState(""),o=c=>{if(c.preventDefault(),!n){i("La contraseña es requerida");return}r(n)};return h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full",children:[h.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[h.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center",children:[h.jsx(jc,{className:"w-6 h-6 text-red-500 mr-2"}),"Eliminar Crédito"]}),h.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700",children:h.jsx(Ir,{className:"w-6 h-6"})})]}),h.jsxs("form",{onSubmit:o,className:"p-6 space-y-4",children:[h.jsx("p",{className:"text-gray-600",children:"Esta acción es irreversible. Por favor, ingrese la contraseña de administrador para confirmar."}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contraseña de Administrador *"}),h.jsx("input",{type:"password",value:n,onChange:c=>a(c.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),(s||t)&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:s||t})]}),h.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[h.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancelar"}),h.jsx("button",{type:"submit",className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Eliminar Crédito"})]})]})]})})}function Y9({credit:r,onClose:e}){const t=i=>new Date(i).toLocaleDateString("es-NI",{year:"numeric",month:"long",day:"numeric"}),n=i=>{switch(i){case"cash":return"Efectivo";case"card":return"Tarjeta";case"transfer":return"Transferencia";default:return i}},a=i=>{const c=zb(r,i).output("blob"),l=URL.createObjectURL(c),u=window.open(l,"_blank");u&&(u.onload=()=>{u.print(),URL.revokeObjectURL(l)})},s=()=>{const i=r.payments.reduce((o,c)=>o+c.amount,0);return r.finalPrice-i};return h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full",children:[h.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[h.jsxs("div",{children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Historial de Pagos"}),h.jsxs("p",{className:"text-gray-600",children:["Cliente: ",r.clientName," - Código: ",r.code]})]}),h.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700",children:h.jsx(Ir,{className:"w-6 h-6"})})]}),h.jsxs("div",{className:"p-6",children:[h.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[h.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[h.jsx("p",{className:"text-sm text-gray-600",children:"Monto Total"}),h.jsx("p",{className:"text-xl font-bold text-gray-900",children:et(r.finalPrice)})]}),h.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[h.jsx("p",{className:"text-sm text-gray-600",children:"Total Pagado"}),h.jsx("p",{className:"text-xl font-bold text-green-600",children:et(r.payments.reduce((i,o)=>i+o.amount,0))})]}),h.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[h.jsx("p",{className:"text-sm text-gray-600",children:"Saldo Pendiente"}),h.jsx("p",{className:"text-xl font-bold text-blue-600",children:et(s())})]})]}),h.jsx("div",{className:"space-y-4",children:r.payments.length>0?r.payments.map(i=>h.jsx("div",{className:"border rounded-lg p-4",children:h.jsx("div",{className:"flex justify-between items-center",children:h.jsxs("div",{children:[h.jsx("div",{className:"text-sm text-gray-500",children:t(i.date)}),h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx("span",{className:"font-medium text-gray-900",children:et(i.amount)}),h.jsx("button",{onClick:()=>a(i),className:"text-blue-600 hover:text-blue-900",title:"Imprimir recibo",children:h.jsx(Hh,{className:"w-4 h-4"})})]}),h.jsxs("div",{className:"text-sm text-gray-600",children:[n(i.method),i.reference&&h.jsxs("span",{className:"ml-2",children:["- Ref: ",i.reference]})]})]})})},i.id)):h.jsx("p",{className:"text-center text-gray-500",children:"No hay pagos registrados"})})]}),h.jsx("div",{className:"border-t p-4",children:h.jsx("button",{onClick:e,className:"w-full px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"Cerrar"})})]})})}function Dv(){const[r,e]=Se.useState([]),[t,n]=Se.useState(!0),[a,s]=Se.useState(null),[i,o]=Se.useState(()=>Bt.products.load()),[c,l]=Se.useState(!1),[u,d]=Se.useState(),[g,p]=Se.useState(),[y,v]=Se.useState(),[w,E]=Se.useState(),[R,P]=Se.useState("");Se.useEffect(()=>{(async()=>{n(!0);try{const[S,A]=await Promise.all([Bt.credits.load(),Bt.products.load()]);e(S),o(A),s(null)}catch(S){console.error("Error loading data:",S),s("Error loading data"),e([]),o([])}finally{n(!1)}})()},[]),Se.useEffect(()=>{!t&&r.length>0&&Bt.credits.save(r).catch(j=>{console.error("Error saving credits:",j)})},[r,t]),Se.useEffect(()=>{i.length>0&&Bt.products.save(i).catch(j=>{console.error("Error saving products:",j)})},[i]);const q=j=>{const S=Np(i,[{id:j.productId,quantity:-1}]);o(S);const A={...j,id:Date.now().toString(),payments:[],status:"active",createdAt:new Date().toISOString()};e([...r,A]),l(!1)},z=j=>{if(g){const S={id:Date.now().toString(),date:new Date().toISOString(),...j},A=r.map(C=>{if(C.id===g.id){const J=[...C.payments,S].reduce((me,pe)=>me+pe.amount,0);let ue=C.status;return J>=C.finalPrice?ue="completed":new Date(C.dueDate)<new Date&&(ue="overdue"),{...C,payments:[...C.payments,S],status:ue}}return C});e(A),p(void 0)}},K=j=>{if(y){if(y.status==="active"){const S=Np(i,[{id:y.productId,quantity:1}]);o(S)}e(r.map(S=>S.id===y.id?{...S,status:"cancelled",cancellationReason:j}:S)),v(void 0)}},I=j=>{if(j!=="admin2019"){P("Contraseña incorrecta");return}w&&(e(r.filter(S=>S.id!==w)),E(void 0),P(""))},N=j=>{const S=r.find(A=>A.id===j);if((S==null?void 0:S.status)==="active"){alert("Solo se pueden eliminar créditos completados o cancelados");return}E(j)},F=j=>{const S=j.payments.reduce((A,C)=>A+C.amount,0);return j.finalPrice-S};return t?h.jsx("div",{className:"flex justify-center items-center h-64",children:h.jsx("div",{className:"text-gray-500",children:"Cargando..."})}):a?h.jsxs("div",{className:"text-red-500",children:["Error: ",a]}):h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Créditos"}),h.jsxs("button",{onClick:()=>l(!0),className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 flex items-center",children:[h.jsx(Ts,{className:"w-4 h-4 mr-2"}),"Nuevo Crédito"]})]}),r.length>0?h.jsx(H9,{credits:r,onCancel:v,onDelete:N,onMakePayment:p,onViewHistory:d}):h.jsx("div",{className:"bg-white rounded-lg shadow p-6 text-center text-gray-500",children:"No hay créditos registrados. Comienza agregando uno nuevo."}),c&&h.jsx(G9,{products:i,onSubmit:q,onClose:()=>l(!1),existingCodes:r.map(j=>j.code)}),g&&h.jsx($9,{creditId:g.id,remainingAmount:F(g),onSubmit:z,onClose:()=>p(void 0)}),u&&h.jsx(Y9,{credit:u,onClose:()=>d(void 0)}),y&&h.jsx(K9,{onConfirm:K,onClose:()=>v(void 0)}),w&&h.jsx(X9,{onConfirm:I,onClose:()=>{E(void 0),P("")},error:R})]})}function J9(){const[r,e]=Se.useState(Cd()),[t,n]=Se.useState(null),a=s=>{s.preventDefault(),w9(r),n("Configuración guardada correctamente"),setTimeout(()=>n(null),3e3)};return h.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[h.jsxs("h2",{className:"text-xl font-semibold text-gray-800 mb-6 flex items-center",children:[h.jsx(Hh,{className:"w-5 h-5 mr-2"}),"Configuración de Facturas"]}),t&&h.jsx("div",{className:"bg-green-50 text-green-700 p-4 rounded-lg mb-6",children:t}),h.jsxs("form",{onSubmit:a,className:"space-y-6",children:[h.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[h.jsxs("div",{children:[h.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-4",children:"Tamaño del Papel"}),h.jsx("div",{className:"space-y-4",children:h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ancho (mm)"}),h.jsx("input",{type:"number",value:r.paperSize.width,onChange:s=>e({...r,paperSize:{...r.paperSize,width:Number(s.target.value)}}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})})]}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-4",children:"Tamaño de Fuente"}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Título"}),h.jsx("input",{type:"number",value:r.fontSize.title,onChange:s=>e({...r,fontSize:{...r.fontSize,title:Number(s.target.value)}}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subtítulo"}),h.jsx("input",{type:"number",value:r.fontSize.subtitle,onChange:s=>e({...r,fontSize:{...r.fontSize,subtitle:Number(s.target.value)}}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Texto General"}),h.jsx("input",{type:"number",value:r.fontSize.body,onChange:s=>e({...r,fontSize:{...r.fontSize,body:Number(s.target.value)}}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]})]})]}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-4",children:"Información del Negocio"}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre del Negocio"}),h.jsx("input",{type:"text",value:r.businessInfo.name,onChange:s=>e({...r,businessInfo:{...r.businessInfo,name:s.target.value}}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subtítulo"}),h.jsx("input",{type:"text",value:r.businessInfo.subtitle,onChange:s=>e({...r,businessInfo:{...r.businessInfo,subtitle:s.target.value}}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Dirección (opcional)"}),h.jsx("input",{type:"text",value:r.businessInfo.address||"",onChange:s=>e({...r,businessInfo:{...r.businessInfo,address:s.target.value}}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Teléfono (opcional)"}),h.jsx("input",{type:"text",value:r.businessInfo.phone||"",onChange:s=>e({...r,businessInfo:{...r.businessInfo,phone:s.target.value}}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email (opcional)"}),h.jsx("input",{type:"email",value:r.businessInfo.email||"",onChange:s=>e({...r,businessInfo:{...r.businessInfo,email:s.target.value}}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]})]}),h.jsx("div",{className:"flex justify-end",children:h.jsx("button",{type:"submit",className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:"Guardar Configuración"})})]})]})}function Lv({type:r,maxAmount:e,onSubmit:t,onClose:n}){const[a,s]=Se.useState(""),[i,o]=Se.useState(""),[c,l]=Se.useState({}),u=()=>{const g={},p=Number(a),y=r==="subtract"?"El motivo de retiro es requerido":"El motivo es requerido";return(!a||p<=0)&&(g.amount="El monto debe ser mayor a 0"),r==="subtract"&&e!==void 0&&p>e&&(g.amount=`El monto no puede ser mayor a ${et(e)}`),i.trim()||(g.reason=y),l(g),Object.keys(g).length===0},d=g=>{g.preventDefault(),u()&&t(Number(a),i)};return h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full",children:[h.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:r==="add"?"Agregar Monto":"Retirar Monto"}),h.jsx("button",{onClick:n,className:"text-gray-500 hover:text-gray-700",children:h.jsx(Ir,{className:"w-6 h-6"})})]}),h.jsxs("form",{onSubmit:d,className:"p-6 space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monto *"}),h.jsx("input",{type:"number",step:"0.01",value:a,onChange:g=>s(g.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),c.amount&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:c.amount})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:r==="subtract"?"Motivo de Retiro *":"Motivo *"}),h.jsx("textarea",{value:i,onChange:g=>o(g.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",rows:3,placeholder:r==="subtract"?"Ingrese el motivo del retiro...":"Ingrese el motivo..."}),c.reason&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:c.reason})]}),h.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[h.jsx("button",{type:"button",onClick:n,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancelar"}),h.jsx("button",{type:"submit",className:`px-4 py-2 text-white rounded-lg ${r==="add"?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700"}`,children:r==="add"?"Agregar":"Retirar"})]})]})]})})}function Q9({movements:r,onClose:e,onClearHistory:t}){const n=a=>new Date(a).toLocaleDateString("es-NI",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full",children:[h.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[h.jsxs("div",{className:"flex items-center justify-between w-full",children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Historial de Movimientos"}),r.length>0&&h.jsxs("button",{onClick:t,className:"text-red-600 hover:text-red-900 flex items-center",title:"Borrar historial",children:[h.jsx(pi,{className:"w-4 h-4 mr-1"}),"Borrar Historial"]})]}),h.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700",children:h.jsx(Ir,{className:"w-6 h-6"})})]}),h.jsx("div",{className:"p-6 max-h-[60vh] overflow-y-auto",children:r.length>0?h.jsx("div",{className:"space-y-4",children:r.map(a=>h.jsx("div",{className:"border rounded-lg p-4",children:h.jsx("div",{className:"flex justify-between items-start",children:h.jsxs("div",{children:[h.jsx("div",{className:"text-sm text-gray-500",children:n(a.date)}),h.jsxs("div",{className:`font-medium ${a.type==="add"?"text-green-600":"text-red-600"}`,children:[a.type==="add"?"+":"-",et(a.amount)]}),h.jsx("div",{className:"text-sm text-gray-600 mt-1",children:a.reason})]})})},a.id))}):h.jsx("p",{className:"text-center text-gray-500",children:"No hay movimientos registrados"})}),h.jsx("div",{className:"border-t p-4",children:h.jsx("button",{onClick:e,className:"w-full px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"Cerrar"})})]})})}function Z9({onConfirm:r,onClose:e,error:t}){const[n,a]=Se.useState(""),[s,i]=Se.useState(""),o=c=>{if(c.preventDefault(),!n){i("La contraseña es requerida");return}r(n)};return h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full",children:[h.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[h.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center",children:[h.jsx(jc,{className:"w-6 h-6 text-red-500 mr-2"}),"Borrar Historial"]}),h.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700",children:h.jsx(Ir,{className:"w-6 h-6"})})]}),h.jsxs("form",{onSubmit:o,className:"p-6 space-y-4",children:[h.jsx("p",{className:"text-gray-600",children:"Esta acción es irreversible. Por favor, ingrese la contraseña de administrador para confirmar."}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contraseña de Administrador *"}),h.jsx("input",{type:"password",value:n,onChange:c=>a(c.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),(s||t)&&h.jsx("p",{className:"text-red-500 text-sm mt-1",children:s||t})]}),h.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[h.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancelar"}),h.jsx("button",{type:"submit",className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Borrar Historial"})]})]})]})})}function jv(){const[r,e]=Se.useState(()=>({id:"current",amount:0,lastModified:new Date().toISOString()})),[t,n]=Se.useState([]),[a,s]=Se.useState(!1),[i,o]=Se.useState(!1),[c,l]=Se.useState(!1),[u,d]=Se.useState(!1),[g,p]=Se.useState(""),[y,v]=Se.useState(!0),[w,E]=Se.useState(null);Se.useEffect(()=>{(async()=>{v(!0);try{const[z,K]=await Promise.all([Bt.cashRegister.load().catch(()=>null),Bt.cashMovements.load().catch(()=>[])]);z&&typeof z.amount=="number"&&e(z),n(Array.isArray(K)?K:[]),E(null)}catch(z){console.error("Error loading data:",z),E("Error loading data")}finally{v(!1)}})()},[]),Se.useEffect(()=>{y||(Bt.cashRegister.save({...r,amount:Number(r.amount)||0}),t.length>0&&Bt.cashMovements.save(t))},[r,t,y]);const R=(q,z,K)=>{const I={id:Date.now().toString(),date:new Date().toISOString(),type:K,amount:q,reason:z},N=K==="add"?r.amount+q:r.amount-q;e({...r,amount:Number(N)||0,lastModified:new Date().toISOString()}),n([I,...t]),s(!1),o(!1)},P=q=>{if(q!=="admin2019"){p("Contraseña incorrecta");return}n([]),d(!1),l(!1),p("")};return y?h.jsx("div",{className:"flex justify-center items-center h-64",children:h.jsx("div",{className:"text-gray-500",children:"Cargando..."})}):w?h.jsxs("div",{className:"text-red-500",children:["Error: ",w]}):h.jsxs("div",{className:"space-y-6",children:[h.jsx("div",{className:"flex justify-between items-center",children:h.jsxs("h2",{className:"text-2xl font-bold text-gray-800 flex items-center",children:[h.jsx(Gh,{className:"w-6 h-6 mr-2"}),"Caja Chica"]})}),h.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[h.jsxs("div",{className:"text-center mb-8",children:[h.jsx("p",{className:"text-gray-600 mb-2",children:"Monto Actual"}),h.jsx("p",{className:"text-4xl font-bold text-gray-900",children:et(r.amount)}),h.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Última modificación: ",new Date(r.lastModified).toLocaleString()]})]}),h.jsxs("div",{className:"flex justify-center space-x-4",children:[h.jsxs("button",{onClick:()=>s(!0),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center",children:[h.jsx(Ts,{className:"w-4 h-4 mr-2"}),"Agregar"]}),h.jsxs("button",{onClick:()=>o(!0),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 flex items-center",children:[h.jsx(Hv,{className:"w-4 h-4 mr-2"}),"Retirar"]}),h.jsx("button",{onClick:()=>l(!0),className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Ver Historial"})]})]}),a&&h.jsx(Lv,{type:"add",onSubmit:(q,z)=>R(q,z,"add"),onClose:()=>s(!1)}),i&&h.jsx(Lv,{type:"subtract",maxAmount:r.amount,onSubmit:(q,z)=>R(q,z,"subtract"),onClose:()=>o(!1)}),c&&h.jsx(Q9,{movements:t,onClearHistory:()=>d(!0),onClose:()=>l(!1)}),u&&h.jsx(Z9,{onConfirm:P,onClose:()=>{d(!1),p("")},error:g})]})}function Ov(){const[r,e]=Se.useState(fw),[t,n]=Se.useState(null),[a,s]=Se.useState({isConnected:!1,message:"Verificando conexión..."});Se.useEffect(()=>{const o=()=>{const l=Un!==null&&hw(r);s({isConnected:l,message:l?"Conexión Exitosa":"Sin Conexión"})};o();const c=setInterval(o,5e3);return()=>clearInterval(c)},[r]);const i=o=>{if(o.preventDefault(),!Object.values(r).every(c=>c.trim())){n({type:"error",text:"Todos los campos son requeridos"});return}try{rT(r),n({type:"success",text:"Configuración guardada correctamente. La página se recargará."})}catch{n({type:"error",text:"Error al guardar la configuración"})}};return h.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[h.jsxs("h2",{className:"text-xl font-semibold text-gray-800 mb-6 flex items-center",children:[h.jsx(Mv,{className:"w-6 h-6 mr-2"}),"Configuración de Firebase",h.jsxs("div",{className:"ml-4 flex items-center",children:[h.jsx("div",{className:`w-3 h-3 rounded-full mr-2 ${a.isConnected?"bg-green-500":"bg-red-500"}`}),h.jsx("span",{className:`text-sm ${a.isConnected?"text-green-600":"text-red-600"}`,children:a.message}),a.isConnected&&h.jsxs("span",{className:"ml-2 text-sm text-gray-500",children:["Base de datos conectada: ",r.projectId]})]})]}),t&&h.jsx("div",{className:`p-4 rounded-lg mb-6 ${t.type==="success"?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`,children:t.text}),h.jsxs("form",{onSubmit:i,className:"space-y-6",children:[h.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"API Key"}),h.jsx("input",{type:"text",value:r.apiKey,onChange:o=>e({...r,apiKey:o.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"AIzaSyD-yyoJqi8AYcVVAb9btqmhhNCS8cqOILY"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Auth Domain"}),h.jsx("input",{type:"text",value:r.authDomain,onChange:o=>e({...r,authDomain:o.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"your-app.firebaseapp.com"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Project ID"}),h.jsx("input",{type:"text",value:r.projectId,onChange:o=>e({...r,projectId:o.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"your-project-id"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Storage Bucket"}),h.jsx("input",{type:"text",value:r.storageBucket,onChange:o=>e({...r,storageBucket:o.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"your-app.appspot.com"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Messaging Sender ID"}),h.jsx("input",{type:"text",value:r.messagingSenderId,onChange:o=>e({...r,messagingSenderId:o.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"123456789012"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"App ID"}),h.jsx("input",{type:"text",value:r.appId,onChange:o=>e({...r,appId:o.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"1:123456789012:web:abcdef1234567890"})]})]}),h.jsx("div",{className:"flex justify-end",children:h.jsx("button",{type:"submit",className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:"Guardar Configuración"})})]})]})}function eO({user:r,onLogout:e}){const[t,n]=Tm.useState("dashboard"),a={settings:{Component:J4,props:{userRole:r.role}},products:{Component:mj,props:{}},sales:{Component:Pv,props:{}},clients:{Component:ov,props:{}},reports:{Component:Cv,props:{userRole:r.role}},staff:{Component:L9,props:{}},appointments:{Component:Fv,props:{userRole:r.role}},expenses:{Component:Rv,props:{}},credits:{Component:Dv,props:{}},receipts:{Component:J9,props:{}},cash:{Component:jv,props:{}}},s={...a,appearance:{Component:B9,props:{}},database:{Component:Ov,props:{}}},i={sales:{Component:Pv,props:{}},clients:{Component:ov,props:{}},expenses:{Component:Rv,props:{}},appointments:{Component:Fv,props:{userRole:r.role}},credits:{Component:Dv,props:{}},reports:{Component:Cv,props:{userRole:r.role}},cash:{Component:jv,props:{}}};({...s});const o=r.role==="admin"?r.username==="masteradmin"?s:a:i,c=l=>{o[l]&&n(l)};return h.jsxs("div",{className:"flex h-screen bg-gray-100",children:[h.jsx(Y4,{userRole:r.role,username:r.username,onLogout:e,onNavigate:c}),h.jsxs("main",{className:"flex-1 p-8",children:[h.jsxs("div",{className:"mb-8",children:[h.jsxs("h1",{className:"text-2xl font-bold text-gray-800",children:["Bienvenido, ",r.username]}),h.jsxs("p",{className:"text-gray-600",children:["Rol: ",r.role==="admin"?"Administrador":"Vendedor"]})]}),t==="dashboard"?h.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:h.jsx("p",{className:"text-gray-600",children:"Selecciona una opción del menú lateral para comenzar."})}):o[t]?Tm.createElement(o[t].Component,o[t].props):null]})]})}function tO(){const[r,e]=Se.useState(null);Se.useEffect(()=>{uT()},[]),Se.useEffect(()=>{const a=Jf();document.title=a.tabTitle;const s=document.querySelector("link[rel~='icon']");s&&(s.href=a.faviconUrl)},[]);const t=a=>{e(a)},n=()=>{e(null)};return r?h.jsx(eO,{user:r,onLogout:n}):h.jsx(K4,{onLogin:t})}Kv(document.getElementById("root")).render(h.jsx(Se.StrictMode,{children:h.jsx(tO,{})}));export{kr as _};
